2025-02-05 00:00:50.971 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/list - application/json; charset=utf-8 45
2025-02-05 00:00:50.984 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI)'
2025-02-05 00:00:50.986 +03:00 [INF] Route matched with {action = "GetNotifications", controller = "Notifications"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetNotifications(NayifatAPI.Controllers.GetNotificationsRequest) on controller NayifatAPI.Controllers.NotificationsController (NayifatAPI).
2025-02-05 00:00:51.069 +03:00 [INF] Executed DbCommand (78ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 00:00:51.076 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[@__request_NationalId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[national_id], [u].[last_updated], [u].[notifications]
FROM [user_notifications] AS [u]
WHERE [u].[national_id] = @__request_NationalId_0
2025-02-05 00:00:51.079 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 00:00:51.081 +03:00 [INF] Executed action NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI) in 90.5402ms
2025-02-05 00:00:51.082 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI)'
2025-02-05 00:00:51.084 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/list - 200 null application/json; charset=utf-8 113.1006ms
2025-02-05 00:01:01.600 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/list - application/json; charset=utf-8 45
2025-02-05 00:01:01.610 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI)'
2025-02-05 00:01:01.612 +03:00 [INF] Route matched with {action = "GetNotifications", controller = "Notifications"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetNotifications(NayifatAPI.Controllers.GetNotificationsRequest) on controller NayifatAPI.Controllers.NotificationsController (NayifatAPI).
2025-02-05 00:01:01.618 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 00:01:01.626 +03:00 [INF] Executed DbCommand (5ms) [Parameters=[@__request_NationalId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[national_id], [u].[last_updated], [u].[notifications]
FROM [user_notifications] AS [u]
WHERE [u].[national_id] = @__request_NationalId_0
2025-02-05 00:01:01.629 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 00:01:01.630 +03:00 [INF] Executed action NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI) in 15.4742ms
2025-02-05 00:01:01.631 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI)'
2025-02-05 00:01:01.633 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/list - 200 null application/json; charset=utf-8 32.4617ms
2025-02-05 00:01:18.035 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/list - application/json; charset=utf-8 45
2025-02-05 00:01:18.039 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI)'
2025-02-05 00:01:18.040 +03:00 [INF] Route matched with {action = "GetNotifications", controller = "Notifications"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetNotifications(NayifatAPI.Controllers.GetNotificationsRequest) on controller NayifatAPI.Controllers.NotificationsController (NayifatAPI).
2025-02-05 00:01:18.043 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 00:01:18.047 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__request_NationalId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[national_id], [u].[last_updated], [u].[notifications]
FROM [user_notifications] AS [u]
WHERE [u].[national_id] = @__request_NationalId_0
2025-02-05 00:01:18.050 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 00:01:18.052 +03:00 [INF] Executed action NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI) in 10.405ms
2025-02-05 00:01:18.053 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI)'
2025-02-05 00:01:18.054 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/list - 200 null application/json; charset=utf-8 19.6845ms
2025-02-05 00:01:20.952 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/list - application/json; charset=utf-8 45
2025-02-05 00:01:20.963 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI)'
2025-02-05 00:01:20.966 +03:00 [INF] Route matched with {action = "GetNotifications", controller = "Notifications"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetNotifications(NayifatAPI.Controllers.GetNotificationsRequest) on controller NayifatAPI.Controllers.NotificationsController (NayifatAPI).
2025-02-05 00:01:20.974 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 00:01:20.980 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__request_NationalId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[national_id], [u].[last_updated], [u].[notifications]
FROM [user_notifications] AS [u]
WHERE [u].[national_id] = @__request_NationalId_0
2025-02-05 00:01:20.983 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 00:01:20.984 +03:00 [INF] Executed action NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI) in 13.8888ms
2025-02-05 00:01:20.986 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI)'
2025-02-05 00:01:20.987 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/list - 200 null application/json; charset=utf-8 35.5471ms
2025-02-05 00:01:22.088 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/list - application/json; charset=utf-8 45
2025-02-05 00:01:22.097 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI)'
2025-02-05 00:01:22.098 +03:00 [INF] Route matched with {action = "GetNotifications", controller = "Notifications"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetNotifications(NayifatAPI.Controllers.GetNotificationsRequest) on controller NayifatAPI.Controllers.NotificationsController (NayifatAPI).
2025-02-05 00:01:22.103 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 00:01:22.109 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__request_NationalId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[national_id], [u].[last_updated], [u].[notifications]
FROM [user_notifications] AS [u]
WHERE [u].[national_id] = @__request_NationalId_0
2025-02-05 00:01:22.111 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 00:01:22.113 +03:00 [INF] Executed action NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI) in 13.3484ms
2025-02-05 00:01:22.114 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI)'
2025-02-05 00:01:22.115 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/list - 200 null application/json; charset=utf-8 27.0281ms
2025-02-05 00:01:26.272 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/list - application/json; charset=utf-8 45
2025-02-05 00:01:26.275 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI)'
2025-02-05 00:01:26.277 +03:00 [INF] Route matched with {action = "GetNotifications", controller = "Notifications"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetNotifications(NayifatAPI.Controllers.GetNotificationsRequest) on controller NayifatAPI.Controllers.NotificationsController (NayifatAPI).
2025-02-05 00:01:26.283 +03:00 [INF] Executed DbCommand (4ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 00:01:26.287 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__request_NationalId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[national_id], [u].[last_updated], [u].[notifications]
FROM [user_notifications] AS [u]
WHERE [u].[national_id] = @__request_NationalId_0
2025-02-05 00:01:26.289 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 00:01:26.291 +03:00 [INF] Executed action NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI) in 12.709ms
2025-02-05 00:01:26.293 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI)'
2025-02-05 00:01:26.294 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/list - 200 null application/json; charset=utf-8 21.4078ms
2025-02-05 00:01:30.789 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/list - application/json; charset=utf-8 45
2025-02-05 00:01:30.799 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI)'
2025-02-05 00:01:30.800 +03:00 [INF] Route matched with {action = "GetNotifications", controller = "Notifications"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetNotifications(NayifatAPI.Controllers.GetNotificationsRequest) on controller NayifatAPI.Controllers.NotificationsController (NayifatAPI).
2025-02-05 00:01:30.804 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 00:01:30.808 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__request_NationalId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[national_id], [u].[last_updated], [u].[notifications]
FROM [user_notifications] AS [u]
WHERE [u].[national_id] = @__request_NationalId_0
2025-02-05 00:01:30.810 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 00:01:30.812 +03:00 [INF] Executed action NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI) in 9.2532ms
2025-02-05 00:01:30.813 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI)'
2025-02-05 00:01:30.814 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/list - 200 null application/json; charset=utf-8 25.8336ms
2025-02-05 00:01:32.123 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/list - application/json; charset=utf-8 45
2025-02-05 00:01:32.133 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI)'
2025-02-05 00:01:32.135 +03:00 [INF] Route matched with {action = "GetNotifications", controller = "Notifications"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetNotifications(NayifatAPI.Controllers.GetNotificationsRequest) on controller NayifatAPI.Controllers.NotificationsController (NayifatAPI).
2025-02-05 00:01:32.138 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 00:01:32.141 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__request_NationalId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[national_id], [u].[last_updated], [u].[notifications]
FROM [user_notifications] AS [u]
WHERE [u].[national_id] = @__request_NationalId_0
2025-02-05 00:01:32.144 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 00:01:32.145 +03:00 [INF] Executed action NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI) in 8.3331ms
2025-02-05 00:01:32.146 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI)'
2025-02-05 00:01:32.148 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/list - 200 null application/json; charset=utf-8 25.6143ms
2025-02-05 00:01:45.773 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/list - application/json; charset=utf-8 45
2025-02-05 00:01:45.783 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI)'
2025-02-05 00:01:45.784 +03:00 [INF] Route matched with {action = "GetNotifications", controller = "Notifications"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetNotifications(NayifatAPI.Controllers.GetNotificationsRequest) on controller NayifatAPI.Controllers.NotificationsController (NayifatAPI).
2025-02-05 00:01:45.788 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 00:01:45.793 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__request_NationalId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[national_id], [u].[last_updated], [u].[notifications]
FROM [user_notifications] AS [u]
WHERE [u].[national_id] = @__request_NationalId_0
2025-02-05 00:01:45.795 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 00:01:45.796 +03:00 [INF] Executed action NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI) in 9.5298ms
2025-02-05 00:01:45.798 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI)'
2025-02-05 00:01:45.799 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/list - 200 null application/json; charset=utf-8 25.7649ms
2025-02-05 00:02:18.956 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/list - application/json; charset=utf-8 45
2025-02-05 00:02:18.965 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI)'
2025-02-05 00:02:18.967 +03:00 [INF] Route matched with {action = "GetNotifications", controller = "Notifications"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetNotifications(NayifatAPI.Controllers.GetNotificationsRequest) on controller NayifatAPI.Controllers.NotificationsController (NayifatAPI).
2025-02-05 00:02:18.973 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 00:02:18.979 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__request_NationalId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[national_id], [u].[last_updated], [u].[notifications]
FROM [user_notifications] AS [u]
WHERE [u].[national_id] = @__request_NationalId_0
2025-02-05 00:02:18.982 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 00:02:18.983 +03:00 [INF] Executed action NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI) in 14.5183ms
2025-02-05 00:02:18.985 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI)'
2025-02-05 00:02:18.986 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/list - 200 null application/json; charset=utf-8 29.8197ms
2025-02-05 00:02:40.748 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/list - application/json; charset=utf-8 45
2025-02-05 00:02:40.756 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI)'
2025-02-05 00:02:40.757 +03:00 [INF] Route matched with {action = "GetNotifications", controller = "Notifications"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetNotifications(NayifatAPI.Controllers.GetNotificationsRequest) on controller NayifatAPI.Controllers.NotificationsController (NayifatAPI).
2025-02-05 00:02:40.764 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 00:02:40.768 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__request_NationalId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[national_id], [u].[last_updated], [u].[notifications]
FROM [user_notifications] AS [u]
WHERE [u].[national_id] = @__request_NationalId_0
2025-02-05 00:02:40.770 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 00:02:40.772 +03:00 [INF] Executed action NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI) in 11.6143ms
2025-02-05 00:02:40.773 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI)'
2025-02-05 00:02:40.774 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/list - 200 null application/json; charset=utf-8 25.5086ms
2025-02-05 00:02:47.988 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/list - application/json; charset=utf-8 45
2025-02-05 00:02:47.994 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI)'
2025-02-05 00:02:47.995 +03:00 [INF] Route matched with {action = "GetNotifications", controller = "Notifications"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetNotifications(NayifatAPI.Controllers.GetNotificationsRequest) on controller NayifatAPI.Controllers.NotificationsController (NayifatAPI).
2025-02-05 00:02:47.998 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 00:02:48.002 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__request_NationalId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[national_id], [u].[last_updated], [u].[notifications]
FROM [user_notifications] AS [u]
WHERE [u].[national_id] = @__request_NationalId_0
2025-02-05 00:02:48.004 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 00:02:48.006 +03:00 [INF] Executed action NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI) in 9.8259ms
2025-02-05 00:02:48.008 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI)'
2025-02-05 00:02:48.009 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/list - 200 null application/json; charset=utf-8 20.1075ms
2025-02-05 00:02:57.316 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/list - application/json; charset=utf-8 45
2025-02-05 00:02:57.324 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI)'
2025-02-05 00:02:57.326 +03:00 [INF] Route matched with {action = "GetNotifications", controller = "Notifications"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetNotifications(NayifatAPI.Controllers.GetNotificationsRequest) on controller NayifatAPI.Controllers.NotificationsController (NayifatAPI).
2025-02-05 00:02:57.331 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 00:02:57.334 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__request_NationalId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[national_id], [u].[last_updated], [u].[notifications]
FROM [user_notifications] AS [u]
WHERE [u].[national_id] = @__request_NationalId_0
2025-02-05 00:02:57.338 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 00:02:57.339 +03:00 [INF] Executed action NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI) in 10.0715ms
2025-02-05 00:02:57.340 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI)'
2025-02-05 00:02:57.342 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/list - 200 null application/json; charset=utf-8 25.1536ms
2025-02-05 00:03:04.056 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/list - application/json; charset=utf-8 45
2025-02-05 00:03:04.060 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI)'
2025-02-05 00:03:04.061 +03:00 [INF] Route matched with {action = "GetNotifications", controller = "Notifications"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetNotifications(NayifatAPI.Controllers.GetNotificationsRequest) on controller NayifatAPI.Controllers.NotificationsController (NayifatAPI).
2025-02-05 00:03:04.064 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 00:03:04.069 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__request_NationalId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[national_id], [u].[last_updated], [u].[notifications]
FROM [user_notifications] AS [u]
WHERE [u].[national_id] = @__request_NationalId_0
2025-02-05 00:03:04.073 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 00:03:04.074 +03:00 [INF] Executed action NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI) in 10.8756ms
2025-02-05 00:03:04.076 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI)'
2025-02-05 00:03:04.077 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/list - 200 null application/json; charset=utf-8 20.524ms
2025-02-05 00:03:04.727 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/list - application/json; charset=utf-8 45
2025-02-05 00:03:04.731 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI)'
2025-02-05 00:03:04.732 +03:00 [INF] Route matched with {action = "GetNotifications", controller = "Notifications"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetNotifications(NayifatAPI.Controllers.GetNotificationsRequest) on controller NayifatAPI.Controllers.NotificationsController (NayifatAPI).
2025-02-05 00:03:04.736 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 00:03:04.739 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__request_NationalId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[national_id], [u].[last_updated], [u].[notifications]
FROM [user_notifications] AS [u]
WHERE [u].[national_id] = @__request_NationalId_0
2025-02-05 00:03:04.741 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 00:03:04.742 +03:00 [INF] Executed action NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI) in 8.5528ms
2025-02-05 00:03:04.744 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI)'
2025-02-05 00:03:04.745 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/list - 200 null application/json; charset=utf-8 18.4764ms
2025-02-05 00:03:07.702 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/list - application/json; charset=utf-8 45
2025-02-05 00:03:07.714 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI)'
2025-02-05 00:03:07.719 +03:00 [INF] Route matched with {action = "GetNotifications", controller = "Notifications"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetNotifications(NayifatAPI.Controllers.GetNotificationsRequest) on controller NayifatAPI.Controllers.NotificationsController (NayifatAPI).
2025-02-05 00:03:07.727 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 00:03:07.732 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[@__request_NationalId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[national_id], [u].[last_updated], [u].[notifications]
FROM [user_notifications] AS [u]
WHERE [u].[national_id] = @__request_NationalId_0
2025-02-05 00:03:07.735 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 00:03:07.736 +03:00 [INF] Executed action NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI) in 12.9743ms
2025-02-05 00:03:07.738 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI)'
2025-02-05 00:03:07.739 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/list - 200 null application/json; charset=utf-8 37.3285ms
2025-02-05 00:03:08.905 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/list - application/json; charset=utf-8 45
2025-02-05 00:03:08.919 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI)'
2025-02-05 00:03:08.922 +03:00 [INF] Route matched with {action = "GetNotifications", controller = "Notifications"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetNotifications(NayifatAPI.Controllers.GetNotificationsRequest) on controller NayifatAPI.Controllers.NotificationsController (NayifatAPI).
2025-02-05 00:03:08.927 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 00:03:08.934 +03:00 [INF] Executed DbCommand (4ms) [Parameters=[@__request_NationalId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[national_id], [u].[last_updated], [u].[notifications]
FROM [user_notifications] AS [u]
WHERE [u].[national_id] = @__request_NationalId_0
2025-02-05 00:03:08.937 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 00:03:08.938 +03:00 [INF] Executed action NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI) in 13.7257ms
2025-02-05 00:03:08.940 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI)'
2025-02-05 00:03:08.941 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/list - 200 null application/json; charset=utf-8 35.8383ms
2025-02-05 00:03:10.930 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/list - application/json; charset=utf-8 45
2025-02-05 00:03:10.933 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI)'
2025-02-05 00:03:10.934 +03:00 [INF] Route matched with {action = "GetNotifications", controller = "Notifications"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetNotifications(NayifatAPI.Controllers.GetNotificationsRequest) on controller NayifatAPI.Controllers.NotificationsController (NayifatAPI).
2025-02-05 00:03:10.938 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 00:03:10.945 +03:00 [INF] Executed DbCommand (4ms) [Parameters=[@__request_NationalId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[national_id], [u].[last_updated], [u].[notifications]
FROM [user_notifications] AS [u]
WHERE [u].[national_id] = @__request_NationalId_0
2025-02-05 00:03:10.948 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 00:03:10.950 +03:00 [INF] Executed action NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI) in 14.2623ms
2025-02-05 00:03:10.951 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI)'
2025-02-05 00:03:10.953 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/list - 200 null application/json; charset=utf-8 22.2565ms
2025-02-05 00:03:13.687 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/list - application/json; charset=utf-8 45
2025-02-05 00:03:13.699 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI)'
2025-02-05 00:03:13.700 +03:00 [INF] Route matched with {action = "GetNotifications", controller = "Notifications"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetNotifications(NayifatAPI.Controllers.GetNotificationsRequest) on controller NayifatAPI.Controllers.NotificationsController (NayifatAPI).
2025-02-05 00:03:13.704 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 00:03:13.707 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__request_NationalId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[national_id], [u].[last_updated], [u].[notifications]
FROM [user_notifications] AS [u]
WHERE [u].[national_id] = @__request_NationalId_0
2025-02-05 00:03:13.709 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 00:03:13.710 +03:00 [INF] Executed action NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI) in 7.4163ms
2025-02-05 00:03:13.711 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI)'
2025-02-05 00:03:13.713 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/list - 200 null application/json; charset=utf-8 25.8956ms
2025-02-05 00:04:20.003 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/list - application/json; charset=utf-8 45
2025-02-05 00:04:20.008 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI)'
2025-02-05 00:04:20.011 +03:00 [INF] Route matched with {action = "GetNotifications", controller = "Notifications"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetNotifications(NayifatAPI.Controllers.GetNotificationsRequest) on controller NayifatAPI.Controllers.NotificationsController (NayifatAPI).
2025-02-05 00:04:20.019 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 00:04:20.030 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__request_NationalId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[national_id], [u].[last_updated], [u].[notifications]
FROM [user_notifications] AS [u]
WHERE [u].[national_id] = @__request_NationalId_0
2025-02-05 00:04:20.034 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 00:04:20.035 +03:00 [INF] Executed action NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI) in 20.2489ms
2025-02-05 00:04:20.037 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI)'
2025-02-05 00:04:20.039 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/list - 200 null application/json; charset=utf-8 35.2254ms
2025-02-05 00:04:22.317 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/device/unregister - application/json; charset=utf-8 174
2025-02-05 00:04:22.328 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/device/unregister - 404 0 null 10.946ms
2025-02-05 00:04:22.332 +03:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: POST http://45f9-51-252-155-185.ngrok-free.app/api/device/unregister, Response status code: 404
2025-02-05 00:06:31.999 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/auth/signin - application/json; charset=utf-8 78
2025-02-05 00:06:32.003 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.AuthController.SignIn (NayifatAPI)'
2025-02-05 00:06:32.004 +03:00 [INF] Route matched with {action = "SignIn", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] SignIn(NayifatAPI.Controllers.SignInRequest) on controller NayifatAPI.Controllers.AuthController (NayifatAPI).
2025-02-05 00:06:32.012 +03:00 [INF] Executed DbCommand (4ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 00:06:32.018 +03:00 [INF] Executed DbCommand (4ms) [Parameters=[@__request_NationalId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[NationalId], [c].[AddNo], [c].[BuildingNo], [c].[City], [c].[Consent], [c].[ConsentDate], [c].[DateOfBirth], [c].[Dependents], [c].[District], [c].[Email], [c].[Employer], [c].[FamilyNameAr], [c].[FamilyNameEn], [c].[FirstNameAr], [c].[FirstNameEn], [c].[Iban], [c].[IdExpiryDate], [c].[Los], [c].[Mpin], [c].[MpinEnabled], [c].[NafathStatus], [c].[NafathTimestamp], [c].[Password], [c].[Phone], [c].[RegistrationDate], [c].[SalaryCustomer], [c].[SalaryDakhli], [c].[SecondNameAr], [c].[SecondNameEn], [c].[Sector], [c].[Street], [c].[ThirdNameAr], [c].[ThirdNameEn], [c].[Zipcode]
FROM [Customers] AS [c]
WHERE [c].[NationalId] = @__request_NationalId_0
2025-02-05 00:06:32.024 +03:00 [INF] Starting password verification for NationalId: 1112345679
2025-02-05 00:06:32.251 +03:00 [INF] Password verification result for NationalId 1112345679: Success
2025-02-05 00:06:32.333 +03:00 [INF] Executed DbCommand (78ms) [Parameters=[@p0='?' (Size = 4000), @p1='?' (DbType = DateTime2), @p2='?' (Size = 4000), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (Size = 450), @p6='?' (Size = 4000), @p7='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [AuthLogs] ([AuthType], [CreatedAt], [DeviceId], [FailureReason], [IpAddress], [NationalId], [Status], [UserAgent])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7);
2025-02-05 00:06:32.336 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 00:06:32.338 +03:00 [INF] Executed action NayifatAPI.Controllers.AuthController.SignIn (NayifatAPI) in 332.0305ms
2025-02-05 00:06:32.339 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.AuthController.SignIn (NayifatAPI)'
2025-02-05 00:06:32.341 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/auth/signin - 200 null application/json; charset=utf-8 341.3068ms
2025-02-05 00:06:33.194 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/proxy/forward?url=https://icreditdept.com/api/testasp/test_local_generate_otp.php - application/json; charset=utf-8 84
2025-02-05 00:06:33.198 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.ProxyController.ForwardRequest (NayifatAPI)'
2025-02-05 00:06:33.199 +03:00 [INF] Route matched with {action = "ForwardRequest", controller = "Proxy"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] ForwardRequest() on controller NayifatAPI.Controllers.ProxyController (NayifatAPI).
2025-02-05 00:06:33.201 +03:00 [INF] Start processing HTTP request POST https://icreditdept.com/api/testasp/test_local_generate_otp.php
2025-02-05 00:06:33.203 +03:00 [INF] Sending HTTP request POST https://icreditdept.com/api/testasp/test_local_generate_otp.php
2025-02-05 00:06:34.623 +03:00 [INF] Received HTTP response headers after 1418.5503ms - 200
2025-02-05 00:06:34.624 +03:00 [INF] End processing HTTP request after 1423.5928ms - 200
2025-02-05 00:06:34.626 +03:00 [INF] Raw response length: 200
2025-02-05 00:06:34.627 +03:00 [INF] Response content: {"success":true,"errors":[],"result":{"nationalId":"1112345679","otp":783334,"expiryDate":"2025-02-05 00:11:34","successMsg":"Success","errCode":0,"errMsg":null},"type":"N","message":null,"code":null}
2025-02-05 00:06:34.629 +03:00 [INF] Executing ContentResult with HTTP Response ContentType of application/json
2025-02-05 00:06:34.630 +03:00 [INF] Executed action NayifatAPI.Controllers.ProxyController.ForwardRequest (NayifatAPI) in 1429.2914ms
2025-02-05 00:06:34.631 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.ProxyController.ForwardRequest (NayifatAPI)'
2025-02-05 00:06:34.634 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/proxy/forward?url=https://icreditdept.com/api/testasp/test_local_generate_otp.php - 200 200 application/json 1439.0428ms
2025-02-05 00:06:41.242 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/proxy/forward?url=https://icreditdept.com/api/testasp/test_local_verify_otp.php - application/json; charset=utf-8 53
2025-02-05 00:06:41.247 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.ProxyController.ForwardRequest (NayifatAPI)'
2025-02-05 00:06:41.248 +03:00 [INF] Route matched with {action = "ForwardRequest", controller = "Proxy"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] ForwardRequest() on controller NayifatAPI.Controllers.ProxyController (NayifatAPI).
2025-02-05 00:06:41.251 +03:00 [INF] Start processing HTTP request POST https://icreditdept.com/api/testasp/test_local_verify_otp.php
2025-02-05 00:06:41.252 +03:00 [INF] Sending HTTP request POST https://icreditdept.com/api/testasp/test_local_verify_otp.php
2025-02-05 00:06:41.664 +03:00 [INF] Received HTTP response headers after 410.4753ms - 200
2025-02-05 00:06:41.665 +03:00 [INF] End processing HTTP request after 414.3679ms - 200
2025-02-05 00:06:41.666 +03:00 [INF] Raw response length: 202
2025-02-05 00:06:41.667 +03:00 [INF] Response content: {"success":true,"errors":[],"result":{"nationalId":"1112345679","otp":"783334","verifiedFlag":true,"successMsg":"Verified successfully.","errCode":0,"errMsg":null},"type":"N","message":null,"code":null}
2025-02-05 00:06:41.668 +03:00 [INF] Executing ContentResult with HTTP Response ContentType of application/json
2025-02-05 00:06:41.669 +03:00 [INF] Executed action NayifatAPI.Controllers.ProxyController.ForwardRequest (NayifatAPI) in 418.7017ms
2025-02-05 00:06:41.670 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.ProxyController.ForwardRequest (NayifatAPI)'
2025-02-05 00:06:41.674 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/proxy/forward?url=https://icreditdept.com/api/testasp/test_local_verify_otp.php - 200 202 application/json 432.3751ms
2025-02-05 00:06:48.427 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/list - application/json; charset=utf-8 45
2025-02-05 00:06:48.438 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI)'
2025-02-05 00:06:48.439 +03:00 [INF] Route matched with {action = "GetNotifications", controller = "Notifications"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetNotifications(NayifatAPI.Controllers.GetNotificationsRequest) on controller NayifatAPI.Controllers.NotificationsController (NayifatAPI).
2025-02-05 00:06:48.443 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 00:06:48.447 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__request_NationalId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[national_id], [u].[last_updated], [u].[notifications]
FROM [user_notifications] AS [u]
WHERE [u].[national_id] = @__request_NationalId_0
2025-02-05 00:06:48.450 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 00:06:48.453 +03:00 [INF] Executed action NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI) in 11.6903ms
2025-02-05 00:06:48.456 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI)'
2025-02-05 00:06:48.458 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/list - 200 null application/json; charset=utf-8 31.1103ms
2025-02-05 00:06:54.909 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/list - application/json; charset=utf-8 45
2025-02-05 00:06:54.921 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI)'
2025-02-05 00:06:54.922 +03:00 [INF] Route matched with {action = "GetNotifications", controller = "Notifications"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetNotifications(NayifatAPI.Controllers.GetNotificationsRequest) on controller NayifatAPI.Controllers.NotificationsController (NayifatAPI).
2025-02-05 00:06:54.928 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 00:06:54.933 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__request_NationalId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[national_id], [u].[last_updated], [u].[notifications]
FROM [user_notifications] AS [u]
WHERE [u].[national_id] = @__request_NationalId_0
2025-02-05 00:06:54.936 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 00:06:54.938 +03:00 [INF] Executed action NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI) in 14.0284ms
2025-02-05 00:06:54.939 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI)'
2025-02-05 00:06:54.940 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/list - 200 null application/json; charset=utf-8 30.4155ms
2025-02-05 00:06:59.597 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/list - application/json; charset=utf-8 45
2025-02-05 00:06:59.612 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI)'
2025-02-05 00:06:59.614 +03:00 [INF] Route matched with {action = "GetNotifications", controller = "Notifications"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetNotifications(NayifatAPI.Controllers.GetNotificationsRequest) on controller NayifatAPI.Controllers.NotificationsController (NayifatAPI).
2025-02-05 00:06:59.619 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 00:06:59.626 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[@__request_NationalId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[national_id], [u].[last_updated], [u].[notifications]
FROM [user_notifications] AS [u]
WHERE [u].[national_id] = @__request_NationalId_0
2025-02-05 00:06:59.628 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 00:06:59.630 +03:00 [INF] Executed action NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI) in 14.5436ms
2025-02-05 00:06:59.635 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI)'
2025-02-05 00:06:59.636 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/list - 200 null application/json; charset=utf-8 38.8305ms
2025-02-05 00:07:05.444 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/list - application/json; charset=utf-8 45
2025-02-05 00:07:05.458 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI)'
2025-02-05 00:07:05.459 +03:00 [INF] Route matched with {action = "GetNotifications", controller = "Notifications"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetNotifications(NayifatAPI.Controllers.GetNotificationsRequest) on controller NayifatAPI.Controllers.NotificationsController (NayifatAPI).
2025-02-05 00:07:05.462 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 00:07:05.465 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__request_NationalId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[national_id], [u].[last_updated], [u].[notifications]
FROM [user_notifications] AS [u]
WHERE [u].[national_id] = @__request_NationalId_0
2025-02-05 00:07:05.468 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 00:07:05.470 +03:00 [INF] Executed action NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI) in 9.446ms
2025-02-05 00:07:05.471 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI)'
2025-02-05 00:07:05.473 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/list - 200 null application/json; charset=utf-8 28.8167ms
2025-02-05 00:07:12.695 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/timestamps - application/json; charset=utf-8 2
2025-02-05 00:07:12.705 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.ContentController.GetTimestamps (NayifatAPI)'
2025-02-05 00:07:12.707 +03:00 [INF] Route matched with {action = "GetTimestamps", controller = "Content"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetTimestamps() on controller NayifatAPI.Controllers.ContentController (NayifatAPI).
2025-02-05 00:07:12.711 +03:00 [INF] TTT_
2025-02-05 00:07:12.712 +03:00 [INF] TTT_=== Getting Content Timestamps ===
2025-02-05 00:07:12.715 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 00:07:12.722 +03:00 [INF] TTT_Fetching timestamps from database
2025-02-05 00:07:12.726 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [m].[page] AS [Page], [m].[key_name] AS [KeyName], [m].[last_updated] AS [LastUpdated]
FROM [master_config] AS [m]
2025-02-05 00:07:12.732 +03:00 [INF] TTT_Found 18 content items
2025-02-05 00:07:12.733 +03:00 [INF] TTT_Page: home
2025-02-05 00:07:12.734 +03:00 [INF] TTT_  - slideshow_content: "2025-02-04T10:01:06.9430000"
2025-02-05 00:07:12.735 +03:00 [INF] TTT_  - slideshow_content_ar: "2025-02-04T10:01:06.9430000"
2025-02-05 00:07:12.736 +03:00 [INF] TTT_  - contact_details: "2025-02-04T10:01:06.9430000"
2025-02-05 00:07:12.736 +03:00 [INF] TTT_  - contact_details_ar: "2025-02-04T10:01:06.9430000"
2025-02-05 00:07:12.737 +03:00 [INF] TTT_  - termsEN1: "2025-02-03T14:23:58.0000000"
2025-02-05 00:07:12.738 +03:00 [INF] TTT_  - termsEN2: "2025-02-03T14:25:20.1730000"
2025-02-05 00:07:12.739 +03:00 [INF] TTT_  - privacyEN1: "2025-02-03T14:26:08.6130000"
2025-02-05 00:07:12.740 +03:00 [INF] TTT_  - privacyEN2: "2025-02-03T14:25:20.1730000"
2025-02-05 00:07:12.740 +03:00 [INF] TTT_  - termsAR1: "2025-02-03T14:23:58.0000000"
2025-02-05 00:07:12.741 +03:00 [INF] TTT_  - termsAR2: "2025-02-03T14:25:20.1730000"
2025-02-05 00:07:12.742 +03:00 [INF] TTT_  - privacyAR1: "2025-02-03T14:26:08.6130000"
2025-02-05 00:07:12.745 +03:00 [INF] TTT_  - privacyAR2: "2025-02-03T14:25:20.1730000"
2025-02-05 00:07:12.746 +03:00 [INF] TTT_  - terms&conditionsCC_AR: "2025-02-03T17:06:57.7700000"
2025-02-05 00:07:12.747 +03:00 [INF] TTT_  - terms&conditionsCC_EN: "2025-02-03T17:07:47.4900000"
2025-02-05 00:07:12.748 +03:00 [INF] TTT_  - terms&conditionsPF_AR: "2025-02-03T17:06:57.7700000"
2025-02-05 00:07:12.749 +03:00 [INF] TTT_  - terms&conditionsPF_EN: "2025-02-03T17:06:57.7700000"
2025-02-05 00:07:12.749 +03:00 [INF] TTT_Page: loans
2025-02-05 00:07:12.750 +03:00 [INF] TTT_  - loan_ad: "2025-02-04T10:01:06.9430000"
2025-02-05 00:07:12.751 +03:00 [INF] TTT_Page: cards
2025-02-05 00:07:12.752 +03:00 [INF] TTT_  - card_ad: "2025-02-04T10:01:06.9430000"
2025-02-05 00:07:12.752 +03:00 [INF] TTT_Successfully retrieved all timestamps
2025-02-05 00:07:12.753 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 00:07:12.754 +03:00 [INF] Executed action NayifatAPI.Controllers.ContentController.GetTimestamps (NayifatAPI) in 43.4681ms
2025-02-05 00:07:12.755 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.ContentController.GetTimestamps (NayifatAPI)'
2025-02-05 00:07:12.756 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/timestamps - 200 null application/json; charset=utf-8 61.2209ms
2025-02-05 00:07:13.380 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - application/json; charset=utf-8 45
2025-02-05 00:07:13.392 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 00:07:13.395 +03:00 [INF] Route matched with {action = "MasterFetch", controller = "Content"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] MasterFetch(NayifatAPI.Controllers.MasterFetchRequest) on controller NayifatAPI.Controllers.ContentController (NayifatAPI).
2025-02-05 00:07:13.398 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 00:07:13.404 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__request_Page_0='?' (Size = 450), @__request_KeyName_1='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[config_id], [m].[key_name], [m].[last_updated], [m].[page], [m].[value]
FROM [master_config] AS [m]
WHERE [m].[page] = @__request_Page_0 AND [m].[key_name] = @__request_KeyName_1
2025-02-05 00:07:13.407 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 00:07:13.408 +03:00 [INF] Executed action NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI) in 11.1249ms
2025-02-05 00:07:13.410 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 00:07:13.411 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - 200 null application/json; charset=utf-8 30.661ms
2025-02-05 00:07:15.343 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/list - application/json; charset=utf-8 45
2025-02-05 00:07:15.355 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI)'
2025-02-05 00:07:15.356 +03:00 [INF] Route matched with {action = "GetNotifications", controller = "Notifications"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetNotifications(NayifatAPI.Controllers.GetNotificationsRequest) on controller NayifatAPI.Controllers.NotificationsController (NayifatAPI).
2025-02-05 00:07:15.360 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 00:07:15.366 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__request_NationalId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[national_id], [u].[last_updated], [u].[notifications]
FROM [user_notifications] AS [u]
WHERE [u].[national_id] = @__request_NationalId_0
2025-02-05 00:07:15.368 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 00:07:15.370 +03:00 [INF] Executed action NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI) in 11.2386ms
2025-02-05 00:07:15.372 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI)'
2025-02-05 00:07:15.373 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/list - 200 null application/json; charset=utf-8 29.8499ms
2025-02-05 00:07:16.383 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - application/json; charset=utf-8 48
2025-02-05 00:07:16.390 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 00:07:16.392 +03:00 [INF] Route matched with {action = "MasterFetch", controller = "Content"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] MasterFetch(NayifatAPI.Controllers.MasterFetchRequest) on controller NayifatAPI.Controllers.ContentController (NayifatAPI).
2025-02-05 00:07:16.395 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 00:07:16.400 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__request_Page_0='?' (Size = 450), @__request_KeyName_1='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[config_id], [m].[key_name], [m].[last_updated], [m].[page], [m].[value]
FROM [master_config] AS [m]
WHERE [m].[page] = @__request_Page_0 AND [m].[key_name] = @__request_KeyName_1
2025-02-05 00:07:16.403 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 00:07:16.404 +03:00 [INF] Executed action NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI) in 10.4443ms
2025-02-05 00:07:16.405 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 00:07:16.406 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - 200 null application/json; charset=utf-8 23.3289ms
2025-02-05 00:07:18.990 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - application/json; charset=utf-8 43
2025-02-05 00:07:18.998 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 00:07:19.000 +03:00 [INF] Route matched with {action = "MasterFetch", controller = "Content"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] MasterFetch(NayifatAPI.Controllers.MasterFetchRequest) on controller NayifatAPI.Controllers.ContentController (NayifatAPI).
2025-02-05 00:07:19.006 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 00:07:19.009 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__request_Page_0='?' (Size = 450), @__request_KeyName_1='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[config_id], [m].[key_name], [m].[last_updated], [m].[page], [m].[value]
FROM [master_config] AS [m]
WHERE [m].[page] = @__request_Page_0 AND [m].[key_name] = @__request_KeyName_1
2025-02-05 00:07:19.012 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 00:07:19.014 +03:00 [INF] Executed action NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI) in 9.4381ms
2025-02-05 00:07:19.015 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 00:07:19.018 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - 200 null application/json; charset=utf-8 28.1047ms
2025-02-05 00:07:19.747 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - application/json; charset=utf-8 46
2025-02-05 00:07:19.755 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 00:07:19.757 +03:00 [INF] Route matched with {action = "MasterFetch", controller = "Content"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] MasterFetch(NayifatAPI.Controllers.MasterFetchRequest) on controller NayifatAPI.Controllers.ContentController (NayifatAPI).
2025-02-05 00:07:19.760 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 00:07:19.763 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__request_Page_0='?' (Size = 450), @__request_KeyName_1='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[config_id], [m].[key_name], [m].[last_updated], [m].[page], [m].[value]
FROM [master_config] AS [m]
WHERE [m].[page] = @__request_Page_0 AND [m].[key_name] = @__request_KeyName_1
2025-02-05 00:07:19.766 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 00:07:19.767 +03:00 [INF] Executed action NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI) in 8.1113ms
2025-02-05 00:07:19.770 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 00:07:19.773 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - 200 null application/json; charset=utf-8 25.9951ms
2025-02-05 00:07:20.395 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - application/json; charset=utf-8 36
2025-02-05 00:07:20.402 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 00:07:20.403 +03:00 [INF] Route matched with {action = "MasterFetch", controller = "Content"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] MasterFetch(NayifatAPI.Controllers.MasterFetchRequest) on controller NayifatAPI.Controllers.ContentController (NayifatAPI).
2025-02-05 00:07:20.407 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 00:07:20.412 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__request_Page_0='?' (Size = 450), @__request_KeyName_1='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[config_id], [m].[key_name], [m].[last_updated], [m].[page], [m].[value]
FROM [master_config] AS [m]
WHERE [m].[page] = @__request_Page_0 AND [m].[key_name] = @__request_KeyName_1
2025-02-05 00:07:20.413 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 00:07:20.415 +03:00 [INF] Executed action NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI) in 9.3446ms
2025-02-05 00:07:20.416 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 00:07:20.417 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - 200 null application/json; charset=utf-8 21.3885ms
2025-02-05 00:07:21.026 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - application/json; charset=utf-8 36
2025-02-05 00:07:21.031 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 00:07:21.032 +03:00 [INF] Route matched with {action = "MasterFetch", controller = "Content"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] MasterFetch(NayifatAPI.Controllers.MasterFetchRequest) on controller NayifatAPI.Controllers.ContentController (NayifatAPI).
2025-02-05 00:07:21.035 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 00:07:21.041 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__request_Page_0='?' (Size = 450), @__request_KeyName_1='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[config_id], [m].[key_name], [m].[last_updated], [m].[page], [m].[value]
FROM [master_config] AS [m]
WHERE [m].[page] = @__request_Page_0 AND [m].[key_name] = @__request_KeyName_1
2025-02-05 00:07:21.043 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 00:07:21.045 +03:00 [INF] Executed action NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI) in 11.0322ms
2025-02-05 00:07:21.047 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 00:07:21.048 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - 200 null application/json; charset=utf-8 21.5771ms
2025-02-05 00:07:21.638 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - application/json; charset=utf-8 38
2025-02-05 00:07:21.644 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 00:07:21.646 +03:00 [INF] Route matched with {action = "MasterFetch", controller = "Content"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] MasterFetch(NayifatAPI.Controllers.MasterFetchRequest) on controller NayifatAPI.Controllers.ContentController (NayifatAPI).
2025-02-05 00:07:21.651 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 00:07:21.659 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__request_Page_0='?' (Size = 450), @__request_KeyName_1='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[config_id], [m].[key_name], [m].[last_updated], [m].[page], [m].[value]
FROM [master_config] AS [m]
WHERE [m].[page] = @__request_Page_0 AND [m].[key_name] = @__request_KeyName_1
2025-02-05 00:07:21.663 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 00:07:21.664 +03:00 [INF] Executed action NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI) in 14.562ms
2025-02-05 00:07:21.665 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 00:07:21.667 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - 200 null application/json; charset=utf-8 28.1738ms
2025-02-05 00:07:22.295 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - application/json; charset=utf-8 38
2025-02-05 00:07:22.299 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 00:07:22.301 +03:00 [INF] Route matched with {action = "MasterFetch", controller = "Content"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] MasterFetch(NayifatAPI.Controllers.MasterFetchRequest) on controller NayifatAPI.Controllers.ContentController (NayifatAPI).
2025-02-05 00:07:22.304 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 00:07:22.310 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__request_Page_0='?' (Size = 450), @__request_KeyName_1='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[config_id], [m].[key_name], [m].[last_updated], [m].[page], [m].[value]
FROM [master_config] AS [m]
WHERE [m].[page] = @__request_Page_0 AND [m].[key_name] = @__request_KeyName_1
2025-02-05 00:07:22.312 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 00:07:22.313 +03:00 [INF] Executed action NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI) in 10.9991ms
2025-02-05 00:07:22.315 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 00:07:22.316 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - 200 null application/json; charset=utf-8 21.4942ms
2025-02-05 00:07:22.963 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - application/json; charset=utf-8 36
2025-02-05 00:07:22.974 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 00:07:22.978 +03:00 [INF] Route matched with {action = "MasterFetch", controller = "Content"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] MasterFetch(NayifatAPI.Controllers.MasterFetchRequest) on controller NayifatAPI.Controllers.ContentController (NayifatAPI).
2025-02-05 00:07:22.982 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 00:07:22.986 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__request_Page_0='?' (Size = 450), @__request_KeyName_1='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[config_id], [m].[key_name], [m].[last_updated], [m].[page], [m].[value]
FROM [master_config] AS [m]
WHERE [m].[page] = @__request_Page_0 AND [m].[key_name] = @__request_KeyName_1
2025-02-05 00:07:22.988 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 00:07:22.989 +03:00 [INF] Executed action NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI) in 7.8812ms
2025-02-05 00:07:22.991 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 00:07:22.992 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - 200 null application/json; charset=utf-8 29.3324ms
2025-02-05 00:07:23.604 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - application/json; charset=utf-8 36
2025-02-05 00:07:23.617 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 00:07:23.619 +03:00 [INF] Route matched with {action = "MasterFetch", controller = "Content"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] MasterFetch(NayifatAPI.Controllers.MasterFetchRequest) on controller NayifatAPI.Controllers.ContentController (NayifatAPI).
2025-02-05 00:07:23.622 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 00:07:23.625 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__request_Page_0='?' (Size = 450), @__request_KeyName_1='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[config_id], [m].[key_name], [m].[last_updated], [m].[page], [m].[value]
FROM [master_config] AS [m]
WHERE [m].[page] = @__request_Page_0 AND [m].[key_name] = @__request_KeyName_1
2025-02-05 00:07:23.628 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 00:07:23.630 +03:00 [INF] Executed action NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI) in 8.8ms
2025-02-05 00:07:23.631 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 00:07:23.631 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - 200 null application/json; charset=utf-8 27.4595ms
2025-02-05 00:07:24.280 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - application/json; charset=utf-8 38
2025-02-05 00:07:24.289 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 00:07:24.290 +03:00 [INF] Route matched with {action = "MasterFetch", controller = "Content"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] MasterFetch(NayifatAPI.Controllers.MasterFetchRequest) on controller NayifatAPI.Controllers.ContentController (NayifatAPI).
2025-02-05 00:07:24.293 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 00:07:24.297 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__request_Page_0='?' (Size = 450), @__request_KeyName_1='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[config_id], [m].[key_name], [m].[last_updated], [m].[page], [m].[value]
FROM [master_config] AS [m]
WHERE [m].[page] = @__request_Page_0 AND [m].[key_name] = @__request_KeyName_1
2025-02-05 00:07:24.301 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 00:07:24.302 +03:00 [INF] Executed action NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI) in 10.725ms
2025-02-05 00:07:24.303 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 00:07:24.304 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - 200 null application/json; charset=utf-8 24.4895ms
2025-02-05 00:07:25.022 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - application/json; charset=utf-8 38
2025-02-05 00:07:25.031 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 00:07:25.034 +03:00 [INF] Route matched with {action = "MasterFetch", controller = "Content"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] MasterFetch(NayifatAPI.Controllers.MasterFetchRequest) on controller NayifatAPI.Controllers.ContentController (NayifatAPI).
2025-02-05 00:07:25.040 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 00:07:25.046 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__request_Page_0='?' (Size = 450), @__request_KeyName_1='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[config_id], [m].[key_name], [m].[last_updated], [m].[page], [m].[value]
FROM [master_config] AS [m]
WHERE [m].[page] = @__request_Page_0 AND [m].[key_name] = @__request_KeyName_1
2025-02-05 00:07:25.052 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 00:07:25.055 +03:00 [INF] Executed action NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI) in 16.1974ms
2025-02-05 00:07:25.056 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 00:07:25.058 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - 200 null application/json; charset=utf-8 35.3713ms
2025-02-05 00:07:25.687 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - application/json; charset=utf-8 49
2025-02-05 00:07:25.695 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 00:07:25.697 +03:00 [INF] Route matched with {action = "MasterFetch", controller = "Content"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] MasterFetch(NayifatAPI.Controllers.MasterFetchRequest) on controller NayifatAPI.Controllers.ContentController (NayifatAPI).
2025-02-05 00:07:25.699 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 00:07:25.702 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__request_Page_0='?' (Size = 450), @__request_KeyName_1='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[config_id], [m].[key_name], [m].[last_updated], [m].[page], [m].[value]
FROM [master_config] AS [m]
WHERE [m].[page] = @__request_Page_0 AND [m].[key_name] = @__request_KeyName_1
2025-02-05 00:07:25.705 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 00:07:25.707 +03:00 [INF] Executed action NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI) in 8.3001ms
2025-02-05 00:07:25.708 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 00:07:25.709 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - 200 null application/json; charset=utf-8 21.7474ms
2025-02-05 00:07:26.381 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - application/json; charset=utf-8 49
2025-02-05 00:07:26.391 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 00:07:26.396 +03:00 [INF] Route matched with {action = "MasterFetch", controller = "Content"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] MasterFetch(NayifatAPI.Controllers.MasterFetchRequest) on controller NayifatAPI.Controllers.ContentController (NayifatAPI).
2025-02-05 00:07:26.402 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 00:07:26.410 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__request_Page_0='?' (Size = 450), @__request_KeyName_1='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[config_id], [m].[key_name], [m].[last_updated], [m].[page], [m].[value]
FROM [master_config] AS [m]
WHERE [m].[page] = @__request_Page_0 AND [m].[key_name] = @__request_KeyName_1
2025-02-05 00:07:26.416 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 00:07:26.418 +03:00 [INF] Executed action NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI) in 17.0186ms
2025-02-05 00:07:26.420 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 00:07:26.421 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - 200 null application/json; charset=utf-8 39.6735ms
2025-02-05 00:07:27.008 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - application/json; charset=utf-8 49
2025-02-05 00:07:27.012 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 00:07:27.013 +03:00 [INF] Route matched with {action = "MasterFetch", controller = "Content"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] MasterFetch(NayifatAPI.Controllers.MasterFetchRequest) on controller NayifatAPI.Controllers.ContentController (NayifatAPI).
2025-02-05 00:07:27.016 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 00:07:27.019 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__request_Page_0='?' (Size = 450), @__request_KeyName_1='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[config_id], [m].[key_name], [m].[last_updated], [m].[page], [m].[value]
FROM [master_config] AS [m]
WHERE [m].[page] = @__request_Page_0 AND [m].[key_name] = @__request_KeyName_1
2025-02-05 00:07:27.021 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 00:07:27.023 +03:00 [INF] Executed action NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI) in 8.8438ms
2025-02-05 00:07:27.025 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 00:07:27.026 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - 200 null application/json; charset=utf-8 17.9574ms
2025-02-05 00:07:27.816 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - application/json; charset=utf-8 49
2025-02-05 00:07:27.821 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 00:07:27.823 +03:00 [INF] Route matched with {action = "MasterFetch", controller = "Content"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] MasterFetch(NayifatAPI.Controllers.MasterFetchRequest) on controller NayifatAPI.Controllers.ContentController (NayifatAPI).
2025-02-05 00:07:27.825 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 00:07:27.828 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__request_Page_0='?' (Size = 450), @__request_KeyName_1='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[config_id], [m].[key_name], [m].[last_updated], [m].[page], [m].[value]
FROM [master_config] AS [m]
WHERE [m].[page] = @__request_Page_0 AND [m].[key_name] = @__request_KeyName_1
2025-02-05 00:07:27.830 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 00:07:27.831 +03:00 [INF] Executed action NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI) in 7.0313ms
2025-02-05 00:07:27.832 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 00:07:27.833 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - 200 null application/json; charset=utf-8 17.2323ms
2025-02-05 00:07:28.555 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - application/json; charset=utf-8 36
2025-02-05 00:07:28.559 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 00:07:28.560 +03:00 [INF] Route matched with {action = "MasterFetch", controller = "Content"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] MasterFetch(NayifatAPI.Controllers.MasterFetchRequest) on controller NayifatAPI.Controllers.ContentController (NayifatAPI).
2025-02-05 00:07:28.563 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 00:07:28.567 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__request_Page_0='?' (Size = 450), @__request_KeyName_1='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[config_id], [m].[key_name], [m].[last_updated], [m].[page], [m].[value]
FROM [master_config] AS [m]
WHERE [m].[page] = @__request_Page_0 AND [m].[key_name] = @__request_KeyName_1
2025-02-05 00:07:28.573 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 00:07:28.575 +03:00 [INF] Executed action NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI) in 13.312ms
2025-02-05 00:07:28.576 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 00:07:28.577 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - 200 null application/json; charset=utf-8 22.3709ms
2025-02-05 00:07:29.875 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - application/json; charset=utf-8 36
2025-02-05 00:07:29.877 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 00:07:29.878 +03:00 [INF] Route matched with {action = "MasterFetch", controller = "Content"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] MasterFetch(NayifatAPI.Controllers.MasterFetchRequest) on controller NayifatAPI.Controllers.ContentController (NayifatAPI).
2025-02-05 00:07:29.881 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 00:07:29.886 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__request_Page_0='?' (Size = 450), @__request_KeyName_1='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[config_id], [m].[key_name], [m].[last_updated], [m].[page], [m].[value]
FROM [master_config] AS [m]
WHERE [m].[page] = @__request_Page_0 AND [m].[key_name] = @__request_KeyName_1
2025-02-05 00:07:29.888 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 00:07:29.890 +03:00 [INF] Executed action NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI) in 10.135ms
2025-02-05 00:07:29.891 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 00:07:29.892 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - 200 null application/json; charset=utf-8 16.7217ms
2025-02-05 00:09:04.109 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/list - application/json; charset=utf-8 45
2025-02-05 00:09:04.112 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI)'
2025-02-05 00:09:04.114 +03:00 [INF] Route matched with {action = "GetNotifications", controller = "Notifications"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetNotifications(NayifatAPI.Controllers.GetNotificationsRequest) on controller NayifatAPI.Controllers.NotificationsController (NayifatAPI).
2025-02-05 00:09:04.122 +03:00 [INF] Executed DbCommand (5ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 00:09:04.130 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[@__request_NationalId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[national_id], [u].[last_updated], [u].[notifications]
FROM [user_notifications] AS [u]
WHERE [u].[national_id] = @__request_NationalId_0
2025-02-05 00:09:04.135 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 00:09:04.138 +03:00 [INF] Executed action NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI) in 22.3149ms
2025-02-05 00:09:04.140 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI)'
2025-02-05 00:09:04.143 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/list - 200 null application/json; charset=utf-8 33.3755ms
2025-02-05 00:09:04.183 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/list - application/json; charset=utf-8 45
2025-02-05 00:09:04.190 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI)'
2025-02-05 00:09:04.191 +03:00 [INF] Route matched with {action = "GetNotifications", controller = "Notifications"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetNotifications(NayifatAPI.Controllers.GetNotificationsRequest) on controller NayifatAPI.Controllers.NotificationsController (NayifatAPI).
2025-02-05 00:09:04.196 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 00:09:04.201 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__request_NationalId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[national_id], [u].[last_updated], [u].[notifications]
FROM [user_notifications] AS [u]
WHERE [u].[national_id] = @__request_NationalId_0
2025-02-05 00:09:04.205 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 00:09:04.207 +03:00 [INF] Executed action NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI) in 12.5936ms
2025-02-05 00:09:04.210 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI)'
2025-02-05 00:09:04.212 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/list - 200 null application/json; charset=utf-8 29.1332ms
2025-02-05 00:09:54.694 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/list - application/json; charset=utf-8 45
2025-02-05 00:09:54.698 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI)'
2025-02-05 00:09:54.699 +03:00 [INF] Route matched with {action = "GetNotifications", controller = "Notifications"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetNotifications(NayifatAPI.Controllers.GetNotificationsRequest) on controller NayifatAPI.Controllers.NotificationsController (NayifatAPI).
2025-02-05 00:09:54.706 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 00:09:54.712 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__request_NationalId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[national_id], [u].[last_updated], [u].[notifications]
FROM [user_notifications] AS [u]
WHERE [u].[national_id] = @__request_NationalId_0
2025-02-05 00:09:54.715 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 00:09:54.716 +03:00 [INF] Executed action NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI) in 14.9029ms
2025-02-05 00:09:54.718 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI)'
2025-02-05 00:09:54.720 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/list - 200 null application/json; charset=utf-8 26.1523ms
2025-02-05 00:10:04.238 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/list - application/json; charset=utf-8 45
2025-02-05 00:10:04.247 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI)'
2025-02-05 00:10:04.249 +03:00 [INF] Route matched with {action = "GetNotifications", controller = "Notifications"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetNotifications(NayifatAPI.Controllers.GetNotificationsRequest) on controller NayifatAPI.Controllers.NotificationsController (NayifatAPI).
2025-02-05 00:10:04.253 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 00:10:04.257 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__request_NationalId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[national_id], [u].[last_updated], [u].[notifications]
FROM [user_notifications] AS [u]
WHERE [u].[national_id] = @__request_NationalId_0
2025-02-05 00:10:04.259 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 00:10:04.261 +03:00 [INF] Executed action NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI) in 9.3603ms
2025-02-05 00:10:04.262 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI)'
2025-02-05 00:10:04.264 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/list - 200 null application/json; charset=utf-8 25.3607ms
2025-02-05 00:10:34.063 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/list - application/json; charset=utf-8 45
2025-02-05 00:10:34.074 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI)'
2025-02-05 00:10:34.076 +03:00 [INF] Route matched with {action = "GetNotifications", controller = "Notifications"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetNotifications(NayifatAPI.Controllers.GetNotificationsRequest) on controller NayifatAPI.Controllers.NotificationsController (NayifatAPI).
2025-02-05 00:10:34.083 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 00:10:34.089 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__request_NationalId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[national_id], [u].[last_updated], [u].[notifications]
FROM [user_notifications] AS [u]
WHERE [u].[national_id] = @__request_NationalId_0
2025-02-05 00:10:34.092 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 00:10:34.093 +03:00 [INF] Executed action NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI) in 13.4461ms
2025-02-05 00:10:34.094 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI)'
2025-02-05 00:10:34.096 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/list - 200 null application/json; charset=utf-8 32.6239ms
2025-02-05 00:11:16.039 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/list - application/json; charset=utf-8 45
2025-02-05 00:11:16.045 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI)'
2025-02-05 00:11:16.046 +03:00 [INF] Route matched with {action = "GetNotifications", controller = "Notifications"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetNotifications(NayifatAPI.Controllers.GetNotificationsRequest) on controller NayifatAPI.Controllers.NotificationsController (NayifatAPI).
2025-02-05 00:11:16.062 +03:00 [INF] Executed DbCommand (8ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 00:11:16.071 +03:00 [INF] Executed DbCommand (4ms) [Parameters=[@__request_NationalId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[national_id], [u].[last_updated], [u].[notifications]
FROM [user_notifications] AS [u]
WHERE [u].[national_id] = @__request_NationalId_0
2025-02-05 00:11:16.076 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 00:11:16.077 +03:00 [INF] Executed action NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI) in 26.5378ms
2025-02-05 00:11:16.080 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI)'
2025-02-05 00:11:16.083 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/list - 200 null application/json; charset=utf-8 43.3136ms
2025-02-05 00:11:24.219 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/list - application/json; charset=utf-8 45
2025-02-05 00:11:24.228 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI)'
2025-02-05 00:11:24.231 +03:00 [INF] Route matched with {action = "GetNotifications", controller = "Notifications"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetNotifications(NayifatAPI.Controllers.GetNotificationsRequest) on controller NayifatAPI.Controllers.NotificationsController (NayifatAPI).
2025-02-05 00:11:24.240 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 00:11:24.248 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[@__request_NationalId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[national_id], [u].[last_updated], [u].[notifications]
FROM [user_notifications] AS [u]
WHERE [u].[national_id] = @__request_NationalId_0
2025-02-05 00:11:24.252 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 00:11:24.255 +03:00 [INF] Executed action NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI) in 18.8667ms
2025-02-05 00:11:24.258 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI)'
2025-02-05 00:11:24.261 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/list - 200 null application/json; charset=utf-8 41.4105ms
2025-02-05 00:11:59.159 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/list - application/json; charset=utf-8 45
2025-02-05 00:11:59.168 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI)'
2025-02-05 00:11:59.170 +03:00 [INF] Route matched with {action = "GetNotifications", controller = "Notifications"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetNotifications(NayifatAPI.Controllers.GetNotificationsRequest) on controller NayifatAPI.Controllers.NotificationsController (NayifatAPI).
2025-02-05 00:11:59.176 +03:00 [INF] Executed DbCommand (4ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 00:11:59.181 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__request_NationalId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[national_id], [u].[last_updated], [u].[notifications]
FROM [user_notifications] AS [u]
WHERE [u].[national_id] = @__request_NationalId_0
2025-02-05 00:11:59.184 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 00:11:59.185 +03:00 [INF] Executed action NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI) in 13.9229ms
2025-02-05 00:11:59.187 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI)'
2025-02-05 00:11:59.188 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/list - 200 null application/json; charset=utf-8 28.8442ms
2025-02-05 00:12:01.637 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/list - application/json; charset=utf-8 45
2025-02-05 00:12:01.645 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI)'
2025-02-05 00:12:01.648 +03:00 [INF] Route matched with {action = "GetNotifications", controller = "Notifications"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetNotifications(NayifatAPI.Controllers.GetNotificationsRequest) on controller NayifatAPI.Controllers.NotificationsController (NayifatAPI).
2025-02-05 00:12:01.656 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 00:12:01.661 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__request_NationalId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[national_id], [u].[last_updated], [u].[notifications]
FROM [user_notifications] AS [u]
WHERE [u].[national_id] = @__request_NationalId_0
2025-02-05 00:12:01.664 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 00:12:01.666 +03:00 [INF] Executed action NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI) in 13.5705ms
2025-02-05 00:12:01.667 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI)'
2025-02-05 00:12:01.668 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/list - 200 null application/json; charset=utf-8 31.0429ms
2025-02-05 00:12:08.452 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/list - application/json; charset=utf-8 45
2025-02-05 00:12:08.462 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI)'
2025-02-05 00:12:08.463 +03:00 [INF] Route matched with {action = "GetNotifications", controller = "Notifications"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetNotifications(NayifatAPI.Controllers.GetNotificationsRequest) on controller NayifatAPI.Controllers.NotificationsController (NayifatAPI).
2025-02-05 00:12:08.466 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 00:12:08.470 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__request_NationalId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[national_id], [u].[last_updated], [u].[notifications]
FROM [user_notifications] AS [u]
WHERE [u].[national_id] = @__request_NationalId_0
2025-02-05 00:12:08.472 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 00:12:08.473 +03:00 [INF] Executed action NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI) in 7.9561ms
2025-02-05 00:12:08.474 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI)'
2025-02-05 00:12:08.476 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/list - 200 null application/json; charset=utf-8 23.5752ms
2025-02-05 00:14:56.952 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/list - application/json; charset=utf-8 45
2025-02-05 00:14:56.960 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI)'
2025-02-05 00:14:56.961 +03:00 [INF] Route matched with {action = "GetNotifications", controller = "Notifications"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetNotifications(NayifatAPI.Controllers.GetNotificationsRequest) on controller NayifatAPI.Controllers.NotificationsController (NayifatAPI).
2025-02-05 00:14:56.968 +03:00 [INF] Executed DbCommand (4ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 00:14:56.973 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__request_NationalId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[national_id], [u].[last_updated], [u].[notifications]
FROM [user_notifications] AS [u]
WHERE [u].[national_id] = @__request_NationalId_0
2025-02-05 00:14:56.977 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 00:14:56.978 +03:00 [INF] Executed action NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI) in 14.5862ms
2025-02-05 00:14:56.979 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI)'
2025-02-05 00:14:56.980 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/list - 200 null application/json; charset=utf-8 27.7592ms
2025-02-05 00:15:05.707 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/list - application/json; charset=utf-8 45
2025-02-05 00:15:05.719 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI)'
2025-02-05 00:15:05.720 +03:00 [INF] Route matched with {action = "GetNotifications", controller = "Notifications"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetNotifications(NayifatAPI.Controllers.GetNotificationsRequest) on controller NayifatAPI.Controllers.NotificationsController (NayifatAPI).
2025-02-05 00:15:05.724 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 00:15:05.727 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__request_NationalId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[national_id], [u].[last_updated], [u].[notifications]
FROM [user_notifications] AS [u]
WHERE [u].[national_id] = @__request_NationalId_0
2025-02-05 00:15:05.730 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 00:15:05.731 +03:00 [INF] Executed action NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI) in 8.5361ms
2025-02-05 00:15:05.732 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI)'
2025-02-05 00:15:05.734 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/list - 200 null application/json; charset=utf-8 26.834ms
2025-02-05 00:15:35.316 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/list - application/json; charset=utf-8 45
2025-02-05 00:15:35.324 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI)'
2025-02-05 00:15:35.325 +03:00 [INF] Route matched with {action = "GetNotifications", controller = "Notifications"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetNotifications(NayifatAPI.Controllers.GetNotificationsRequest) on controller NayifatAPI.Controllers.NotificationsController (NayifatAPI).
2025-02-05 00:15:35.328 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 00:15:35.332 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__request_NationalId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[national_id], [u].[last_updated], [u].[notifications]
FROM [user_notifications] AS [u]
WHERE [u].[national_id] = @__request_NationalId_0
2025-02-05 00:15:35.333 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 00:15:35.334 +03:00 [INF] Executed action NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI) in 8.3447ms
2025-02-05 00:15:35.336 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI)'
2025-02-05 00:15:35.337 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/list - 200 null application/json; charset=utf-8 20.1859ms
2025-02-05 00:16:21.092 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/send - application/json 370
2025-02-05 00:16:21.094 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.NotificationsController.SendNotification (NayifatAPI)'
2025-02-05 00:16:21.096 +03:00 [INF] Route matched with {action = "SendNotification", controller = "Notifications"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] SendNotification(NayifatAPI.Controllers.SendNotificationRequest) on controller NayifatAPI.Controllers.NotificationsController (NayifatAPI).
2025-02-05 00:16:21.100 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 00:16:21.101 +03:00 [INF] Received notification request: {"Title":null,"TitleEn":"Test Notification English","TitleAr":"اختبار الإشعار","Filters":null,"NationalId":"all","NationalIds":null}
2025-02-05 00:16:21.104 +03:00 [INF] Starting GetTargetUsers with request type: Single User
2025-02-05 00:16:21.108 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[@__request_NationalId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[NationalId]
FROM [Customers] AS [c]
WHERE [c].[NationalId] = @__request_NationalId_0
2025-02-05 00:16:21.110 +03:00 [INF] Found 0 users matching national ID all
2025-02-05 00:16:21.110 +03:00 [INF] Target users query completed. Found 0 users
2025-02-05 00:16:21.111 +03:00 [WRN] No target users found. Filters: null
2025-02-05 00:16:21.112 +03:00 [INF] Executing ObjectResult, writing value of type '<>f__AnonymousType12`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 00:16:21.113 +03:00 [INF] Executed action NayifatAPI.Controllers.NotificationsController.SendNotification (NayifatAPI) in 15.7607ms
2025-02-05 00:16:21.114 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.NotificationsController.SendNotification (NayifatAPI)'
2025-02-05 00:16:21.116 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/send - 400 null application/json; charset=utf-8 23.8969ms
2025-02-05 00:17:00.515 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/list - application/json; charset=utf-8 45
2025-02-05 00:17:00.522 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI)'
2025-02-05 00:17:00.524 +03:00 [INF] Route matched with {action = "GetNotifications", controller = "Notifications"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetNotifications(NayifatAPI.Controllers.GetNotificationsRequest) on controller NayifatAPI.Controllers.NotificationsController (NayifatAPI).
2025-02-05 00:17:00.529 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 00:17:00.532 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__request_NationalId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[national_id], [u].[last_updated], [u].[notifications]
FROM [user_notifications] AS [u]
WHERE [u].[national_id] = @__request_NationalId_0
2025-02-05 00:17:00.533 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 00:17:00.536 +03:00 [INF] Executed action NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI) in 10.4328ms
2025-02-05 00:17:00.537 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI)'
2025-02-05 00:17:00.538 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/list - 200 null application/json; charset=utf-8 22.8233ms
2025-02-05 00:17:02.483 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/list - application/json; charset=utf-8 45
2025-02-05 00:17:02.491 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI)'
2025-02-05 00:17:02.493 +03:00 [INF] Route matched with {action = "GetNotifications", controller = "Notifications"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetNotifications(NayifatAPI.Controllers.GetNotificationsRequest) on controller NayifatAPI.Controllers.NotificationsController (NayifatAPI).
2025-02-05 00:17:02.503 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 00:17:02.513 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__request_NationalId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[national_id], [u].[last_updated], [u].[notifications]
FROM [user_notifications] AS [u]
WHERE [u].[national_id] = @__request_NationalId_0
2025-02-05 00:17:02.522 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 00:17:02.522 +03:00 [INF] Executed action NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI) in 21.3749ms
2025-02-05 00:17:02.523 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI)'
2025-02-05 00:17:02.524 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/list - 200 null application/json; charset=utf-8 41.8257ms
2025-02-05 00:17:09.798 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/list - application/json; charset=utf-8 45
2025-02-05 00:17:09.805 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI)'
2025-02-05 00:17:09.807 +03:00 [INF] Route matched with {action = "GetNotifications", controller = "Notifications"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetNotifications(NayifatAPI.Controllers.GetNotificationsRequest) on controller NayifatAPI.Controllers.NotificationsController (NayifatAPI).
2025-02-05 00:17:09.809 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 00:17:09.812 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__request_NationalId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[national_id], [u].[last_updated], [u].[notifications]
FROM [user_notifications] AS [u]
WHERE [u].[national_id] = @__request_NationalId_0
2025-02-05 00:17:09.814 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 00:17:09.814 +03:00 [INF] Executed action NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI) in 6.2747ms
2025-02-05 00:17:09.816 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI)'
2025-02-05 00:17:09.816 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/list - 200 null application/json; charset=utf-8 18.2881ms
2025-02-05 00:19:56.610 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/list - application/json; charset=utf-8 45
2025-02-05 00:19:56.617 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI)'
2025-02-05 00:19:56.618 +03:00 [INF] Route matched with {action = "GetNotifications", controller = "Notifications"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetNotifications(NayifatAPI.Controllers.GetNotificationsRequest) on controller NayifatAPI.Controllers.NotificationsController (NayifatAPI).
2025-02-05 00:19:56.624 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 00:19:56.627 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__request_NationalId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[national_id], [u].[last_updated], [u].[notifications]
FROM [user_notifications] AS [u]
WHERE [u].[national_id] = @__request_NationalId_0
2025-02-05 00:19:56.628 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 00:19:56.629 +03:00 [INF] Executed action NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI) in 8.576ms
2025-02-05 00:19:56.630 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI)'
2025-02-05 00:19:56.631 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/list - 200 null application/json; charset=utf-8 21.3777ms
2025-02-05 00:20:05.263 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/list - application/json; charset=utf-8 45
2025-02-05 00:20:05.268 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI)'
2025-02-05 00:20:05.270 +03:00 [INF] Route matched with {action = "GetNotifications", controller = "Notifications"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetNotifications(NayifatAPI.Controllers.GetNotificationsRequest) on controller NayifatAPI.Controllers.NotificationsController (NayifatAPI).
2025-02-05 00:20:05.273 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 00:20:05.275 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__request_NationalId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[national_id], [u].[last_updated], [u].[notifications]
FROM [user_notifications] AS [u]
WHERE [u].[national_id] = @__request_NationalId_0
2025-02-05 00:20:05.277 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 00:20:05.278 +03:00 [INF] Executed action NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI) in 6.2179ms
2025-02-05 00:20:05.278 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI)'
2025-02-05 00:20:05.279 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/list - 200 null application/json; charset=utf-8 16.0776ms
2025-02-05 00:20:13.753 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/list - application/json; charset=utf-8 45
2025-02-05 00:20:13.759 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI)'
2025-02-05 00:20:13.761 +03:00 [INF] Route matched with {action = "GetNotifications", controller = "Notifications"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetNotifications(NayifatAPI.Controllers.GetNotificationsRequest) on controller NayifatAPI.Controllers.NotificationsController (NayifatAPI).
2025-02-05 00:20:13.770 +03:00 [INF] Executed DbCommand (6ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 00:20:13.775 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__request_NationalId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[national_id], [u].[last_updated], [u].[notifications]
FROM [user_notifications] AS [u]
WHERE [u].[national_id] = @__request_NationalId_0
2025-02-05 00:20:13.777 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 00:20:13.777 +03:00 [INF] Executed action NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI) in 13.4434ms
2025-02-05 00:20:13.779 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI)'
2025-02-05 00:20:13.780 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/list - 200 null application/json; charset=utf-8 26.2867ms
2025-02-05 00:20:21.603 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/send - application/json 377
2025-02-05 00:20:21.609 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.NotificationsController.SendNotification (NayifatAPI)'
2025-02-05 00:20:21.615 +03:00 [INF] Route matched with {action = "SendNotification", controller = "Notifications"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] SendNotification(NayifatAPI.Controllers.SendNotificationRequest) on controller NayifatAPI.Controllers.NotificationsController (NayifatAPI).
2025-02-05 00:20:21.622 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 00:20:21.626 +03:00 [INF] Received notification request: {"Title":null,"TitleEn":"Test Notification English","TitleAr":"اختبار الإشعار","Filters":null,"NationalId":"1064448614","NationalIds":null}
2025-02-05 00:20:21.633 +03:00 [INF] Starting GetTargetUsers with request type: Single User
2025-02-05 00:20:21.638 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[@__request_NationalId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[NationalId]
FROM [Customers] AS [c]
WHERE [c].[NationalId] = @__request_NationalId_0
2025-02-05 00:20:21.641 +03:00 [INF] Found 1 users matching national ID 1064448614
2025-02-05 00:20:21.642 +03:00 [INF] Target users query completed. Found 1 users
2025-02-05 00:20:21.643 +03:00 [INF] Found 1 target users for notification
2025-02-05 00:20:21.720 +03:00 [INF] Executed DbCommand (75ms) [Parameters=[@p0='?' (Size = 4000), @p1='?' (Size = 8000) (DbType = AnsiString), @p2='?' (Size = 4000), @p3='?' (Size = 8000) (DbType = AnsiString), @p4='?' (DbType = DateTime2), @p5='?' (DbType = DateTime2), @p6='?' (Size = 255), @p7='?' (Size = 4000), @p8='?' (Size = 255), @p9='?' (Size = 255), @p10='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [notification_templates] ([additional_data], [Body], [body_ar], [body_en], [created_at], [expiry_at], [Route], [target_criteria], [Title], [title_ar], [title_en])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10);
2025-02-05 00:20:21.725 +03:00 [INF] Created notification template with ID: 10
2025-02-05 00:20:21.729 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@p0='?' (Size = 4000), @p1='?' (DbType = DateTime2), @p2='?' (Size = 4000), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (Size = 450), @p6='?' (Size = 4000), @p7='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [AuthLogs] ([AuthType], [CreatedAt], [DeviceId], [FailureReason], [IpAddress], [NationalId], [Status], [UserAgent])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7);
2025-02-05 00:20:21.737 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[@__userId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[national_id], [u].[last_updated], [u].[notifications]
FROM [user_notifications] AS [u]
WHERE [u].[national_id] = @__userId_0
2025-02-05 00:20:21.742 +03:00 [INF] Processing notification for user 1064448614. Existing notification record: true
2025-02-05 00:20:21.744 +03:00 [INF] Current notifications count for user 1064448614: 5
2025-02-05 00:20:21.746 +03:00 [INF] Serialized new notifications for user 1064448614. Length: 938
2025-02-05 00:20:21.757 +03:00 [INF] Executed DbCommand (11ms) [Parameters=[@p0='?' (Size = 4000), @p1='?' (DbType = DateTime2), @p2='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
UPDATE user_notifications SET notifications = @p0, last_updated = @p1 WHERE national_id = @p2
2025-02-05 00:20:21.760 +03:00 [INF] Updated existing UserNotification for user: 1064448614
2025-02-05 00:20:21.766 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@p0='?' (Size = 4000), @p1='?' (DbType = DateTime2), @p2='?' (Size = 4000), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (Size = 450), @p6='?' (Size = 4000), @p7='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [AuthLogs] ([AuthType], [CreatedAt], [DeviceId], [FailureReason], [IpAddress], [NationalId], [Status], [UserAgent])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7);
2025-02-05 00:20:21.768 +03:00 [INF] Successfully sent notifications. Template: 10, Success: 1, Total: 1
2025-02-05 00:20:21.770 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 00:20:21.771 +03:00 [INF] Executed action NayifatAPI.Controllers.NotificationsController.SendNotification (NayifatAPI) in 150.6683ms
2025-02-05 00:20:21.773 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.NotificationsController.SendNotification (NayifatAPI)'
2025-02-05 00:20:21.776 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/send - 200 null application/json; charset=utf-8 172.8907ms
2025-02-05 00:20:34.970 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/list - application/json; charset=utf-8 45
2025-02-05 00:20:34.980 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI)'
2025-02-05 00:20:34.981 +03:00 [INF] Route matched with {action = "GetNotifications", controller = "Notifications"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetNotifications(NayifatAPI.Controllers.GetNotificationsRequest) on controller NayifatAPI.Controllers.NotificationsController (NayifatAPI).
2025-02-05 00:20:34.983 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 00:20:34.986 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__request_NationalId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[national_id], [u].[last_updated], [u].[notifications]
FROM [user_notifications] AS [u]
WHERE [u].[national_id] = @__request_NationalId_0
2025-02-05 00:20:34.989 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__Parse_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [n].[Id], [n].[additional_data], [n].[Body], [n].[body_ar], [n].[body_en], [n].[created_at], [n].[expiry_at], [n].[Route], [n].[target_criteria], [n].[Title], [n].[title_ar], [n].[title_en]
FROM [notification_templates] AS [n]
WHERE [n].[Id] = @__Parse_0
2025-02-05 00:20:34.996 +03:00 [INF] Executed DbCommand (6ms) [Parameters=[@p0='?' (Size = 4000), @p1='?' (DbType = DateTime2), @p2='?' (Size = 4000), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (Size = 450), @p6='?' (Size = 4000), @p7='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [AuthLogs] ([AuthType], [CreatedAt], [DeviceId], [FailureReason], [IpAddress], [NationalId], [Status], [UserAgent])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7);
2025-02-05 00:20:35.002 +03:00 [INF] Executed DbCommand (4ms) [Parameters=[@p0='?' (Size = 4000), @p1='?' (DbType = DateTime2), @p2='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
UPDATE user_notifications SET notifications = @p0, last_updated = @p1 WHERE national_id = @p2
2025-02-05 00:20:35.005 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@p0='?' (Size = 4000), @p1='?' (DbType = DateTime2), @p2='?' (Size = 4000), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (Size = 450), @p6='?' (Size = 4000), @p7='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [AuthLogs] ([AuthType], [CreatedAt], [DeviceId], [FailureReason], [IpAddress], [NationalId], [Status], [UserAgent])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7);
2025-02-05 00:20:35.006 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 00:20:35.007 +03:00 [INF] Executed action NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI) in 25.34ms
2025-02-05 00:20:35.008 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI)'
2025-02-05 00:20:35.009 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/list - 200 null application/json; charset=utf-8 39.365ms
2025-02-05 00:22:00.870 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/list - application/json; charset=utf-8 45
2025-02-05 00:22:00.879 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI)'
2025-02-05 00:22:00.885 +03:00 [INF] Route matched with {action = "GetNotifications", controller = "Notifications"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetNotifications(NayifatAPI.Controllers.GetNotificationsRequest) on controller NayifatAPI.Controllers.NotificationsController (NayifatAPI).
2025-02-05 00:22:00.890 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 00:22:00.894 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__request_NationalId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[national_id], [u].[last_updated], [u].[notifications]
FROM [user_notifications] AS [u]
WHERE [u].[national_id] = @__request_NationalId_0
2025-02-05 00:22:00.896 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 00:22:00.897 +03:00 [INF] Executed action NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI) in 10.2954ms
2025-02-05 00:22:00.898 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI)'
2025-02-05 00:22:00.899 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/list - 200 null application/json; charset=utf-8 29.4786ms
2025-02-05 00:22:02.585 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/list - application/json; charset=utf-8 45
2025-02-05 00:22:02.594 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI)'
2025-02-05 00:22:02.596 +03:00 [INF] Route matched with {action = "GetNotifications", controller = "Notifications"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetNotifications(NayifatAPI.Controllers.GetNotificationsRequest) on controller NayifatAPI.Controllers.NotificationsController (NayifatAPI).
2025-02-05 00:22:02.600 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 00:22:02.603 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__request_NationalId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[national_id], [u].[last_updated], [u].[notifications]
FROM [user_notifications] AS [u]
WHERE [u].[national_id] = @__request_NationalId_0
2025-02-05 00:22:02.605 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 00:22:02.606 +03:00 [INF] Executed action NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI) in 6.6679ms
2025-02-05 00:22:02.606 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI)'
2025-02-05 00:22:02.607 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/list - 200 null application/json; charset=utf-8 22.2171ms
2025-02-05 00:22:09.726 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/list - application/json; charset=utf-8 45
2025-02-05 00:22:09.737 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI)'
2025-02-05 00:22:09.740 +03:00 [INF] Route matched with {action = "GetNotifications", controller = "Notifications"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetNotifications(NayifatAPI.Controllers.GetNotificationsRequest) on controller NayifatAPI.Controllers.NotificationsController (NayifatAPI).
2025-02-05 00:22:09.744 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 00:22:09.748 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__request_NationalId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[national_id], [u].[last_updated], [u].[notifications]
FROM [user_notifications] AS [u]
WHERE [u].[national_id] = @__request_NationalId_0
2025-02-05 00:22:09.750 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 00:22:09.751 +03:00 [INF] Executed action NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI) in 7.6119ms
2025-02-05 00:22:09.751 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI)'
2025-02-05 00:22:09.752 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/list - 200 null application/json; charset=utf-8 25.4903ms
2025-02-05 00:24:41.655 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/timestamps - application/json; charset=utf-8 2
2025-02-05 00:24:41.663 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.ContentController.GetTimestamps (NayifatAPI)'
2025-02-05 00:24:41.664 +03:00 [INF] Route matched with {action = "GetTimestamps", controller = "Content"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetTimestamps() on controller NayifatAPI.Controllers.ContentController (NayifatAPI).
2025-02-05 00:24:41.667 +03:00 [INF] TTT_
2025-02-05 00:24:41.668 +03:00 [INF] TTT_=== Getting Content Timestamps ===
2025-02-05 00:24:41.671 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 00:24:41.673 +03:00 [INF] TTT_Fetching timestamps from database
2025-02-05 00:24:41.675 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [m].[page] AS [Page], [m].[key_name] AS [KeyName], [m].[last_updated] AS [LastUpdated]
FROM [master_config] AS [m]
2025-02-05 00:24:41.676 +03:00 [INF] TTT_Found 18 content items
2025-02-05 00:24:41.677 +03:00 [INF] TTT_Page: home
2025-02-05 00:24:41.678 +03:00 [INF] TTT_  - slideshow_content: "2025-02-04T10:01:06.9430000"
2025-02-05 00:24:41.679 +03:00 [INF] TTT_  - slideshow_content_ar: "2025-02-04T10:01:06.9430000"
2025-02-05 00:24:41.680 +03:00 [INF] TTT_  - contact_details: "2025-02-04T10:01:06.9430000"
2025-02-05 00:24:41.681 +03:00 [INF] TTT_  - contact_details_ar: "2025-02-04T10:01:06.9430000"
2025-02-05 00:24:41.682 +03:00 [INF] TTT_  - termsEN1: "2025-02-03T14:23:58.0000000"
2025-02-05 00:24:41.682 +03:00 [INF] TTT_  - termsEN2: "2025-02-03T14:25:20.1730000"
2025-02-05 00:24:41.683 +03:00 [INF] TTT_  - privacyEN1: "2025-02-03T14:26:08.6130000"
2025-02-05 00:24:41.684 +03:00 [INF] TTT_  - privacyEN2: "2025-02-03T14:25:20.1730000"
2025-02-05 00:24:41.684 +03:00 [INF] TTT_  - termsAR1: "2025-02-03T14:23:58.0000000"
2025-02-05 00:24:41.685 +03:00 [INF] TTT_  - termsAR2: "2025-02-03T14:25:20.1730000"
2025-02-05 00:24:41.686 +03:00 [INF] TTT_  - privacyAR1: "2025-02-03T14:26:08.6130000"
2025-02-05 00:24:41.686 +03:00 [INF] TTT_  - privacyAR2: "2025-02-03T14:25:20.1730000"
2025-02-05 00:24:41.687 +03:00 [INF] TTT_  - terms&conditionsCC_AR: "2025-02-03T17:06:57.7700000"
2025-02-05 00:24:41.688 +03:00 [INF] TTT_  - terms&conditionsCC_EN: "2025-02-03T17:07:47.4900000"
2025-02-05 00:24:41.688 +03:00 [INF] TTT_  - terms&conditionsPF_AR: "2025-02-03T17:06:57.7700000"
2025-02-05 00:24:41.689 +03:00 [INF] TTT_  - terms&conditionsPF_EN: "2025-02-03T17:06:57.7700000"
2025-02-05 00:24:41.690 +03:00 [INF] TTT_Page: loans
2025-02-05 00:24:41.690 +03:00 [INF] TTT_  - loan_ad: "2025-02-04T10:01:06.9430000"
2025-02-05 00:24:41.691 +03:00 [INF] TTT_Page: cards
2025-02-05 00:24:41.692 +03:00 [INF] TTT_  - card_ad: "2025-02-04T10:01:06.9430000"
2025-02-05 00:24:41.692 +03:00 [INF] TTT_Successfully retrieved all timestamps
2025-02-05 00:24:41.693 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 00:24:41.694 +03:00 [INF] Executed action NayifatAPI.Controllers.ContentController.GetTimestamps (NayifatAPI) in 27.9602ms
2025-02-05 00:24:41.696 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.ContentController.GetTimestamps (NayifatAPI)'
2025-02-05 00:24:41.697 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/timestamps - 200 null application/json; charset=utf-8 41.1975ms
2025-02-05 00:24:42.606 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - application/json; charset=utf-8 45
2025-02-05 00:24:42.615 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 00:24:42.617 +03:00 [INF] Route matched with {action = "MasterFetch", controller = "Content"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] MasterFetch(NayifatAPI.Controllers.MasterFetchRequest) on controller NayifatAPI.Controllers.ContentController (NayifatAPI).
2025-02-05 00:24:42.620 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 00:24:42.623 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__request_Page_0='?' (Size = 450), @__request_KeyName_1='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[config_id], [m].[key_name], [m].[last_updated], [m].[page], [m].[value]
FROM [master_config] AS [m]
WHERE [m].[page] = @__request_Page_0 AND [m].[key_name] = @__request_KeyName_1
2025-02-05 00:24:42.625 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 00:24:42.626 +03:00 [INF] Executed action NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI) in 7.5293ms
2025-02-05 00:24:42.627 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 00:24:42.628 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - 200 null application/json; charset=utf-8 22.2585ms
2025-02-05 00:24:46.455 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/list - application/json; charset=utf-8 45
2025-02-05 00:24:46.459 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI)'
2025-02-05 00:24:46.459 +03:00 [INF] Route matched with {action = "GetNotifications", controller = "Notifications"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetNotifications(NayifatAPI.Controllers.GetNotificationsRequest) on controller NayifatAPI.Controllers.NotificationsController (NayifatAPI).
2025-02-05 00:24:46.462 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 00:24:46.467 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__request_NationalId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[national_id], [u].[last_updated], [u].[notifications]
FROM [user_notifications] AS [u]
WHERE [u].[national_id] = @__request_NationalId_0
2025-02-05 00:24:46.468 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 00:24:46.469 +03:00 [INF] Executed action NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI) in 8.356ms
2025-02-05 00:24:46.470 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI)'
2025-02-05 00:24:46.471 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/list - 200 null application/json; charset=utf-8 15.2854ms
2025-02-05 00:24:47.038 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - application/json; charset=utf-8 48
2025-02-05 00:24:47.048 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 00:24:47.049 +03:00 [INF] Route matched with {action = "MasterFetch", controller = "Content"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] MasterFetch(NayifatAPI.Controllers.MasterFetchRequest) on controller NayifatAPI.Controllers.ContentController (NayifatAPI).
2025-02-05 00:24:47.051 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 00:24:47.054 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__request_Page_0='?' (Size = 450), @__request_KeyName_1='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[config_id], [m].[key_name], [m].[last_updated], [m].[page], [m].[value]
FROM [master_config] AS [m]
WHERE [m].[page] = @__request_Page_0 AND [m].[key_name] = @__request_KeyName_1
2025-02-05 00:24:47.055 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 00:24:47.056 +03:00 [INF] Executed action NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI) in 6.1803ms
2025-02-05 00:24:47.058 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 00:24:47.058 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - 200 null application/json; charset=utf-8 20.5722ms
2025-02-05 00:24:50.952 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - application/json; charset=utf-8 43
2025-02-05 00:24:50.963 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 00:24:50.965 +03:00 [INF] Route matched with {action = "MasterFetch", controller = "Content"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] MasterFetch(NayifatAPI.Controllers.MasterFetchRequest) on controller NayifatAPI.Controllers.ContentController (NayifatAPI).
2025-02-05 00:24:50.967 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 00:24:50.970 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__request_Page_0='?' (Size = 450), @__request_KeyName_1='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[config_id], [m].[key_name], [m].[last_updated], [m].[page], [m].[value]
FROM [master_config] AS [m]
WHERE [m].[page] = @__request_Page_0 AND [m].[key_name] = @__request_KeyName_1
2025-02-05 00:24:50.972 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 00:24:50.973 +03:00 [INF] Executed action NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI) in 7.2719ms
2025-02-05 00:24:50.975 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 00:24:50.976 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - 200 null application/json; charset=utf-8 24.8257ms
2025-02-05 00:24:51.865 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - application/json; charset=utf-8 46
2025-02-05 00:24:51.877 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 00:24:51.881 +03:00 [INF] Route matched with {action = "MasterFetch", controller = "Content"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] MasterFetch(NayifatAPI.Controllers.MasterFetchRequest) on controller NayifatAPI.Controllers.ContentController (NayifatAPI).
2025-02-05 00:24:51.884 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 00:24:51.885 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__request_Page_0='?' (Size = 450), @__request_KeyName_1='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[config_id], [m].[key_name], [m].[last_updated], [m].[page], [m].[value]
FROM [master_config] AS [m]
WHERE [m].[page] = @__request_Page_0 AND [m].[key_name] = @__request_KeyName_1
2025-02-05 00:24:51.887 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 00:24:51.888 +03:00 [INF] Executed action NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI) in 5.5039ms
2025-02-05 00:24:51.889 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 00:24:51.890 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - 200 null application/json; charset=utf-8 24.916ms
2025-02-05 00:24:52.829 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - application/json; charset=utf-8 36
2025-02-05 00:24:52.832 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 00:24:52.833 +03:00 [INF] Route matched with {action = "MasterFetch", controller = "Content"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] MasterFetch(NayifatAPI.Controllers.MasterFetchRequest) on controller NayifatAPI.Controllers.ContentController (NayifatAPI).
2025-02-05 00:24:52.835 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 00:24:52.838 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__request_Page_0='?' (Size = 450), @__request_KeyName_1='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[config_id], [m].[key_name], [m].[last_updated], [m].[page], [m].[value]
FROM [master_config] AS [m]
WHERE [m].[page] = @__request_Page_0 AND [m].[key_name] = @__request_KeyName_1
2025-02-05 00:24:52.840 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 00:24:52.841 +03:00 [INF] Executed action NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI) in 6.5516ms
2025-02-05 00:24:52.842 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 00:24:52.842 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - 200 null application/json; charset=utf-8 13.5885ms
2025-02-05 00:24:53.754 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - application/json; charset=utf-8 36
2025-02-05 00:24:53.763 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 00:24:53.765 +03:00 [INF] Route matched with {action = "MasterFetch", controller = "Content"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] MasterFetch(NayifatAPI.Controllers.MasterFetchRequest) on controller NayifatAPI.Controllers.ContentController (NayifatAPI).
2025-02-05 00:24:53.767 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 00:24:53.771 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__request_Page_0='?' (Size = 450), @__request_KeyName_1='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[config_id], [m].[key_name], [m].[last_updated], [m].[page], [m].[value]
FROM [master_config] AS [m]
WHERE [m].[page] = @__request_Page_0 AND [m].[key_name] = @__request_KeyName_1
2025-02-05 00:24:53.773 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 00:24:53.775 +03:00 [INF] Executed action NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI) in 8.798ms
2025-02-05 00:24:53.776 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 00:24:53.777 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - 200 null application/json; charset=utf-8 22.3652ms
2025-02-05 00:24:54.474 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - application/json; charset=utf-8 38
2025-02-05 00:24:54.478 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 00:24:54.479 +03:00 [INF] Route matched with {action = "MasterFetch", controller = "Content"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] MasterFetch(NayifatAPI.Controllers.MasterFetchRequest) on controller NayifatAPI.Controllers.ContentController (NayifatAPI).
2025-02-05 00:24:54.481 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 00:24:54.482 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__request_Page_0='?' (Size = 450), @__request_KeyName_1='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[config_id], [m].[key_name], [m].[last_updated], [m].[page], [m].[value]
FROM [master_config] AS [m]
WHERE [m].[page] = @__request_Page_0 AND [m].[key_name] = @__request_KeyName_1
2025-02-05 00:24:54.484 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 00:24:54.485 +03:00 [INF] Executed action NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI) in 4.6773ms
2025-02-05 00:24:54.485 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 00:24:54.486 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - 200 null application/json; charset=utf-8 11.9089ms
2025-02-05 00:24:55.105 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - application/json; charset=utf-8 38
2025-02-05 00:24:55.115 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 00:24:55.117 +03:00 [INF] Route matched with {action = "MasterFetch", controller = "Content"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] MasterFetch(NayifatAPI.Controllers.MasterFetchRequest) on controller NayifatAPI.Controllers.ContentController (NayifatAPI).
2025-02-05 00:24:55.119 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 00:24:55.122 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__request_Page_0='?' (Size = 450), @__request_KeyName_1='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[config_id], [m].[key_name], [m].[last_updated], [m].[page], [m].[value]
FROM [master_config] AS [m]
WHERE [m].[page] = @__request_Page_0 AND [m].[key_name] = @__request_KeyName_1
2025-02-05 00:24:55.124 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 00:24:55.125 +03:00 [INF] Executed action NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI) in 6.1187ms
2025-02-05 00:24:55.125 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 00:24:55.126 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - 200 null application/json; charset=utf-8 21.0189ms
2025-02-05 00:24:55.665 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/list - application/json; charset=utf-8 45
2025-02-05 00:24:55.674 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI)'
2025-02-05 00:24:55.675 +03:00 [INF] Route matched with {action = "GetNotifications", controller = "Notifications"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetNotifications(NayifatAPI.Controllers.GetNotificationsRequest) on controller NayifatAPI.Controllers.NotificationsController (NayifatAPI).
2025-02-05 00:24:55.678 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 00:24:55.681 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__request_NationalId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[national_id], [u].[last_updated], [u].[notifications]
FROM [user_notifications] AS [u]
WHERE [u].[national_id] = @__request_NationalId_0
2025-02-05 00:24:55.682 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 00:24:55.683 +03:00 [INF] Executed action NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI) in 6.1169ms
2025-02-05 00:24:55.684 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI)'
2025-02-05 00:24:55.684 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/list - 200 null application/json; charset=utf-8 18.7873ms
2025-02-05 00:24:56.076 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - application/json; charset=utf-8 36
2025-02-05 00:24:56.084 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 00:24:56.085 +03:00 [INF] Route matched with {action = "MasterFetch", controller = "Content"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] MasterFetch(NayifatAPI.Controllers.MasterFetchRequest) on controller NayifatAPI.Controllers.ContentController (NayifatAPI).
2025-02-05 00:24:56.088 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 00:24:56.091 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__request_Page_0='?' (Size = 450), @__request_KeyName_1='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[config_id], [m].[key_name], [m].[last_updated], [m].[page], [m].[value]
FROM [master_config] AS [m]
WHERE [m].[page] = @__request_Page_0 AND [m].[key_name] = @__request_KeyName_1
2025-02-05 00:24:56.093 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 00:24:56.094 +03:00 [INF] Executed action NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI) in 6.3888ms
2025-02-05 00:24:56.095 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 00:24:56.095 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - 200 null application/json; charset=utf-8 19.4442ms
2025-02-05 00:24:57.022 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - application/json; charset=utf-8 36
2025-02-05 00:24:57.031 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 00:24:57.032 +03:00 [INF] Route matched with {action = "MasterFetch", controller = "Content"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] MasterFetch(NayifatAPI.Controllers.MasterFetchRequest) on controller NayifatAPI.Controllers.ContentController (NayifatAPI).
2025-02-05 00:24:57.035 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 00:24:57.039 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__request_Page_0='?' (Size = 450), @__request_KeyName_1='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[config_id], [m].[key_name], [m].[last_updated], [m].[page], [m].[value]
FROM [master_config] AS [m]
WHERE [m].[page] = @__request_Page_0 AND [m].[key_name] = @__request_KeyName_1
2025-02-05 00:24:57.040 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 00:24:57.041 +03:00 [INF] Executed action NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI) in 7.673ms
2025-02-05 00:24:57.042 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 00:24:57.043 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - 200 null application/json; charset=utf-8 21.0983ms
2025-02-05 00:24:57.952 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - application/json; charset=utf-8 38
2025-02-05 00:24:57.959 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 00:24:57.960 +03:00 [INF] Route matched with {action = "MasterFetch", controller = "Content"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] MasterFetch(NayifatAPI.Controllers.MasterFetchRequest) on controller NayifatAPI.Controllers.ContentController (NayifatAPI).
2025-02-05 00:24:57.962 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 00:24:57.964 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__request_Page_0='?' (Size = 450), @__request_KeyName_1='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[config_id], [m].[key_name], [m].[last_updated], [m].[page], [m].[value]
FROM [master_config] AS [m]
WHERE [m].[page] = @__request_Page_0 AND [m].[key_name] = @__request_KeyName_1
2025-02-05 00:24:57.965 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 00:24:57.966 +03:00 [INF] Executed action NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI) in 4.9274ms
2025-02-05 00:24:57.967 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 00:24:57.968 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - 200 null application/json; charset=utf-8 16.0647ms
2025-02-05 00:24:58.961 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - application/json; charset=utf-8 38
2025-02-05 00:24:58.969 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 00:24:58.970 +03:00 [INF] Route matched with {action = "MasterFetch", controller = "Content"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] MasterFetch(NayifatAPI.Controllers.MasterFetchRequest) on controller NayifatAPI.Controllers.ContentController (NayifatAPI).
2025-02-05 00:24:58.980 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 00:24:58.991 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__request_Page_0='?' (Size = 450), @__request_KeyName_1='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[config_id], [m].[key_name], [m].[last_updated], [m].[page], [m].[value]
FROM [master_config] AS [m]
WHERE [m].[page] = @__request_Page_0 AND [m].[key_name] = @__request_KeyName_1
2025-02-05 00:24:58.995 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 00:24:58.995 +03:00 [INF] Executed action NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI) in 17.0798ms
2025-02-05 00:24:58.996 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 00:24:58.997 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - 200 null application/json; charset=utf-8 35.7397ms
2025-02-05 00:24:59.862 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - application/json; charset=utf-8 49
2025-02-05 00:24:59.870 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 00:24:59.876 +03:00 [INF] Route matched with {action = "MasterFetch", controller = "Content"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] MasterFetch(NayifatAPI.Controllers.MasterFetchRequest) on controller NayifatAPI.Controllers.ContentController (NayifatAPI).
2025-02-05 00:24:59.885 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 00:24:59.888 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__request_Page_0='?' (Size = 450), @__request_KeyName_1='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[config_id], [m].[key_name], [m].[last_updated], [m].[page], [m].[value]
FROM [master_config] AS [m]
WHERE [m].[page] = @__request_Page_0 AND [m].[key_name] = @__request_KeyName_1
2025-02-05 00:24:59.891 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 00:24:59.892 +03:00 [INF] Executed action NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI) in 8.0542ms
2025-02-05 00:24:59.893 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 00:24:59.894 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - 200 null application/json; charset=utf-8 31.9228ms
2025-02-05 00:25:00.646 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - application/json; charset=utf-8 49
2025-02-05 00:25:00.658 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 00:25:00.659 +03:00 [INF] Route matched with {action = "MasterFetch", controller = "Content"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] MasterFetch(NayifatAPI.Controllers.MasterFetchRequest) on controller NayifatAPI.Controllers.ContentController (NayifatAPI).
2025-02-05 00:25:00.662 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 00:25:00.664 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__request_Page_0='?' (Size = 450), @__request_KeyName_1='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[config_id], [m].[key_name], [m].[last_updated], [m].[page], [m].[value]
FROM [master_config] AS [m]
WHERE [m].[page] = @__request_Page_0 AND [m].[key_name] = @__request_KeyName_1
2025-02-05 00:25:00.665 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 00:25:00.666 +03:00 [INF] Executed action NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI) in 5.345ms
2025-02-05 00:25:00.667 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 00:25:00.667 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - 200 null application/json; charset=utf-8 21.7752ms
2025-02-05 00:25:01.464 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - application/json; charset=utf-8 49
2025-02-05 00:25:01.472 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 00:25:01.473 +03:00 [INF] Route matched with {action = "MasterFetch", controller = "Content"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] MasterFetch(NayifatAPI.Controllers.MasterFetchRequest) on controller NayifatAPI.Controllers.ContentController (NayifatAPI).
2025-02-05 00:25:01.475 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 00:25:01.478 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__request_Page_0='?' (Size = 450), @__request_KeyName_1='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[config_id], [m].[key_name], [m].[last_updated], [m].[page], [m].[value]
FROM [master_config] AS [m]
WHERE [m].[page] = @__request_Page_0 AND [m].[key_name] = @__request_KeyName_1
2025-02-05 00:25:01.479 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 00:25:01.480 +03:00 [INF] Executed action NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI) in 5.389ms
2025-02-05 00:25:01.480 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 00:25:01.481 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - 200 null application/json; charset=utf-8 17.4962ms
2025-02-05 00:25:02.382 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - application/json; charset=utf-8 49
2025-02-05 00:25:02.388 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 00:25:02.388 +03:00 [INF] Route matched with {action = "MasterFetch", controller = "Content"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] MasterFetch(NayifatAPI.Controllers.MasterFetchRequest) on controller NayifatAPI.Controllers.ContentController (NayifatAPI).
2025-02-05 00:25:02.391 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 00:25:02.393 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__request_Page_0='?' (Size = 450), @__request_KeyName_1='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[config_id], [m].[key_name], [m].[last_updated], [m].[page], [m].[value]
FROM [master_config] AS [m]
WHERE [m].[page] = @__request_Page_0 AND [m].[key_name] = @__request_KeyName_1
2025-02-05 00:25:02.394 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 00:25:02.395 +03:00 [INF] Executed action NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI) in 5.4911ms
2025-02-05 00:25:02.396 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 00:25:02.396 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - 200 null application/json; charset=utf-8 14.6936ms
2025-02-05 00:25:03.075 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - application/json; charset=utf-8 36
2025-02-05 00:25:03.086 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 00:25:03.092 +03:00 [INF] Route matched with {action = "MasterFetch", controller = "Content"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] MasterFetch(NayifatAPI.Controllers.MasterFetchRequest) on controller NayifatAPI.Controllers.ContentController (NayifatAPI).
2025-02-05 00:25:03.095 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 00:25:03.097 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__request_Page_0='?' (Size = 450), @__request_KeyName_1='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[config_id], [m].[key_name], [m].[last_updated], [m].[page], [m].[value]
FROM [master_config] AS [m]
WHERE [m].[page] = @__request_Page_0 AND [m].[key_name] = @__request_KeyName_1
2025-02-05 00:25:03.098 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 00:25:03.099 +03:00 [INF] Executed action NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI) in 5.0051ms
2025-02-05 00:25:03.100 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 00:25:03.100 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - 200 null application/json; charset=utf-8 25.7091ms
2025-02-05 00:25:04.871 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - application/json; charset=utf-8 36
2025-02-05 00:25:04.874 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 00:25:04.878 +03:00 [INF] Route matched with {action = "MasterFetch", controller = "Content"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] MasterFetch(NayifatAPI.Controllers.MasterFetchRequest) on controller NayifatAPI.Controllers.ContentController (NayifatAPI).
2025-02-05 00:25:04.882 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 00:25:04.892 +03:00 [INF] Executed DbCommand (6ms) [Parameters=[@__request_Page_0='?' (Size = 450), @__request_KeyName_1='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[config_id], [m].[key_name], [m].[last_updated], [m].[page], [m].[value]
FROM [master_config] AS [m]
WHERE [m].[page] = @__request_Page_0 AND [m].[key_name] = @__request_KeyName_1
2025-02-05 00:25:04.896 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 00:25:04.897 +03:00 [INF] Executed action NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI) in 16.4128ms
2025-02-05 00:25:04.899 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 00:25:04.900 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - 200 null application/json; charset=utf-8 28.9992ms
2025-02-05 00:25:05.258 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/list - application/json; charset=utf-8 45
2025-02-05 00:25:05.267 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI)'
2025-02-05 00:25:05.272 +03:00 [INF] Route matched with {action = "GetNotifications", controller = "Notifications"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetNotifications(NayifatAPI.Controllers.GetNotificationsRequest) on controller NayifatAPI.Controllers.NotificationsController (NayifatAPI).
2025-02-05 00:25:05.276 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 00:25:05.278 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__request_NationalId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[national_id], [u].[last_updated], [u].[notifications]
FROM [user_notifications] AS [u]
WHERE [u].[national_id] = @__request_NationalId_0
2025-02-05 00:25:05.280 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 00:25:05.281 +03:00 [INF] Executed action NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI) in 7.4948ms
2025-02-05 00:25:05.282 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI)'
2025-02-05 00:25:05.283 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/list - 200 null application/json; charset=utf-8 25.8255ms
2025-02-05 00:25:14.862 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/list - application/json; charset=utf-8 45
2025-02-05 00:25:14.863 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI)'
2025-02-05 00:25:14.864 +03:00 [INF] Route matched with {action = "GetNotifications", controller = "Notifications"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetNotifications(NayifatAPI.Controllers.GetNotificationsRequest) on controller NayifatAPI.Controllers.NotificationsController (NayifatAPI).
2025-02-05 00:25:14.868 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 00:25:14.872 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__request_NationalId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[national_id], [u].[last_updated], [u].[notifications]
FROM [user_notifications] AS [u]
WHERE [u].[national_id] = @__request_NationalId_0
2025-02-05 00:25:14.873 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 00:25:14.874 +03:00 [INF] Executed action NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI) in 8.3528ms
2025-02-05 00:25:14.876 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI)'
2025-02-05 00:25:14.878 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/list - 200 null application/json; charset=utf-8 16.0502ms
2025-02-05 00:25:35.007 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/list - application/json; charset=utf-8 45
2025-02-05 00:25:35.013 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI)'
2025-02-05 00:25:35.014 +03:00 [INF] Route matched with {action = "GetNotifications", controller = "Notifications"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetNotifications(NayifatAPI.Controllers.GetNotificationsRequest) on controller NayifatAPI.Controllers.NotificationsController (NayifatAPI).
2025-02-05 00:25:35.016 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 00:25:35.018 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__request_NationalId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[national_id], [u].[last_updated], [u].[notifications]
FROM [user_notifications] AS [u]
WHERE [u].[national_id] = @__request_NationalId_0
2025-02-05 00:25:35.019 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 00:25:35.020 +03:00 [INF] Executed action NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI) in 4.9071ms
2025-02-05 00:25:35.021 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI)'
2025-02-05 00:25:35.021 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/list - 200 null application/json; charset=utf-8 14.0056ms
2025-02-05 00:25:52.224 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/list - application/json; charset=utf-8 45
2025-02-05 00:25:52.232 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI)'
2025-02-05 00:25:52.233 +03:00 [INF] Route matched with {action = "GetNotifications", controller = "Notifications"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetNotifications(NayifatAPI.Controllers.GetNotificationsRequest) on controller NayifatAPI.Controllers.NotificationsController (NayifatAPI).
2025-02-05 00:25:52.239 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 00:25:52.243 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__request_NationalId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[national_id], [u].[last_updated], [u].[notifications]
FROM [user_notifications] AS [u]
WHERE [u].[national_id] = @__request_NationalId_0
2025-02-05 00:25:52.245 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 00:25:52.246 +03:00 [INF] Executed action NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI) in 10.2704ms
2025-02-05 00:25:52.247 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI)'
2025-02-05 00:25:52.248 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/list - 200 null application/json; charset=utf-8 24.1946ms
2025-02-05 00:25:53.163 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/list - application/json; charset=utf-8 39
2025-02-05 00:25:53.165 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI)'
2025-02-05 00:25:53.166 +03:00 [INF] Route matched with {action = "GetNotifications", controller = "Notifications"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetNotifications(NayifatAPI.Controllers.GetNotificationsRequest) on controller NayifatAPI.Controllers.NotificationsController (NayifatAPI).
2025-02-05 00:25:53.169 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 00:25:53.171 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__request_NationalId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[national_id], [u].[last_updated], [u].[notifications]
FROM [user_notifications] AS [u]
WHERE [u].[national_id] = @__request_NationalId_0
2025-02-05 00:25:53.174 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__Parse_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [n].[Id], [n].[additional_data], [n].[Body], [n].[body_ar], [n].[body_en], [n].[created_at], [n].[expiry_at], [n].[Route], [n].[target_criteria], [n].[Title], [n].[title_ar], [n].[title_en]
FROM [notification_templates] AS [n]
WHERE [n].[Id] = @__Parse_0
2025-02-05 00:25:53.343 +03:00 [INF] Executed DbCommand (166ms) [Parameters=[@p0='?' (Size = 4000), @p1='?' (DbType = DateTime2), @p2='?' (Size = 4000), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (Size = 450), @p6='?' (Size = 4000), @p7='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [AuthLogs] ([AuthType], [CreatedAt], [DeviceId], [FailureReason], [IpAddress], [NationalId], [Status], [UserAgent])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7);
2025-02-05 00:25:53.374 +03:00 [ERR] An exception occurred in the database while saving changes for context type 'NayifatAPI.Data.ApplicationDbContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_AuthLogs_Customers_NationalId". The conflict occurred in database "NayifatApp", table "dbo.Customers", column 'NationalId'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:2f1879bc-4a17-43c4-898a-feeaf6815d79
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_AuthLogs_Customers_NationalId". The conflict occurred in database "NayifatApp", table "dbo.Customers", column 'NationalId'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:2f1879bc-4a17-43c4-898a-feeaf6815d79
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2025-02-05 00:25:53.389 +03:00 [ERR] Error logging audit event. NationalId: all, Action: notification_delivered, Details: {"notification_count":1,"notification_ids":[3],"timestamp":"2025-02-05T00:25:53.1732122"}
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_AuthLogs_Customers_NationalId". The conflict occurred in database "NayifatApp", table "dbo.Customers", column 'NationalId'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:2f1879bc-4a17-43c4-898a-feeaf6815d79
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at NayifatAPI.Services.AuditLogService.LogAsync(String nationalId, String action, Object details) in C:\Users\yamta\StudioProjects\nayifat_app_2025_new\nayifatapi\Services\AuditLogService.cs:line 36
2025-02-05 00:25:53.404 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 00:25:53.405 +03:00 [INF] Executed action NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI) in 237.1053ms
2025-02-05 00:25:53.406 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI)'
2025-02-05 00:25:53.407 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/list - 200 null application/json; charset=utf-8 244.7547ms
2025-02-05 00:26:41.548 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/timestamps - application/json; charset=utf-8 2
2025-02-05 00:26:41.551 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.ContentController.GetTimestamps (NayifatAPI)'
2025-02-05 00:26:41.552 +03:00 [INF] Route matched with {action = "GetTimestamps", controller = "Content"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetTimestamps() on controller NayifatAPI.Controllers.ContentController (NayifatAPI).
2025-02-05 00:26:41.553 +03:00 [INF] TTT_
2025-02-05 00:26:41.554 +03:00 [INF] TTT_=== Getting Content Timestamps ===
2025-02-05 00:26:41.557 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 00:26:41.558 +03:00 [INF] TTT_Fetching timestamps from database
2025-02-05 00:26:41.561 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [m].[page] AS [Page], [m].[key_name] AS [KeyName], [m].[last_updated] AS [LastUpdated]
FROM [master_config] AS [m]
2025-02-05 00:26:41.562 +03:00 [INF] TTT_Found 18 content items
2025-02-05 00:26:41.563 +03:00 [INF] TTT_Page: home
2025-02-05 00:26:41.563 +03:00 [INF] TTT_  - slideshow_content: "2025-02-04T10:01:06.9430000"
2025-02-05 00:26:41.564 +03:00 [INF] TTT_  - slideshow_content_ar: "2025-02-04T10:01:06.9430000"
2025-02-05 00:26:41.564 +03:00 [INF] TTT_  - contact_details: "2025-02-04T10:01:06.9430000"
2025-02-05 00:26:41.565 +03:00 [INF] TTT_  - contact_details_ar: "2025-02-04T10:01:06.9430000"
2025-02-05 00:26:41.565 +03:00 [INF] TTT_  - termsEN1: "2025-02-03T14:23:58.0000000"
2025-02-05 00:26:41.566 +03:00 [INF] TTT_  - termsEN2: "2025-02-03T14:25:20.1730000"
2025-02-05 00:26:41.567 +03:00 [INF] TTT_  - privacyEN1: "2025-02-03T14:26:08.6130000"
2025-02-05 00:26:41.567 +03:00 [INF] TTT_  - privacyEN2: "2025-02-03T14:25:20.1730000"
2025-02-05 00:26:41.568 +03:00 [INF] TTT_  - termsAR1: "2025-02-03T14:23:58.0000000"
2025-02-05 00:26:41.569 +03:00 [INF] TTT_  - termsAR2: "2025-02-03T14:25:20.1730000"
2025-02-05 00:26:41.569 +03:00 [INF] TTT_  - privacyAR1: "2025-02-03T14:26:08.6130000"
2025-02-05 00:26:41.570 +03:00 [INF] TTT_  - privacyAR2: "2025-02-03T14:25:20.1730000"
2025-02-05 00:26:41.570 +03:00 [INF] TTT_  - terms&conditionsCC_AR: "2025-02-03T17:06:57.7700000"
2025-02-05 00:26:41.571 +03:00 [INF] TTT_  - terms&conditionsCC_EN: "2025-02-03T17:07:47.4900000"
2025-02-05 00:26:41.571 +03:00 [INF] TTT_  - terms&conditionsPF_AR: "2025-02-03T17:06:57.7700000"
2025-02-05 00:26:41.572 +03:00 [INF] TTT_  - terms&conditionsPF_EN: "2025-02-03T17:06:57.7700000"
2025-02-05 00:26:41.572 +03:00 [INF] TTT_Page: loans
2025-02-05 00:26:41.573 +03:00 [INF] TTT_  - loan_ad: "2025-02-04T10:01:06.9430000"
2025-02-05 00:26:41.574 +03:00 [INF] TTT_Page: cards
2025-02-05 00:26:41.574 +03:00 [INF] TTT_  - card_ad: "2025-02-04T10:01:06.9430000"
2025-02-05 00:26:41.575 +03:00 [INF] TTT_Successfully retrieved all timestamps
2025-02-05 00:26:41.575 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 00:26:41.576 +03:00 [INF] Executed action NayifatAPI.Controllers.ContentController.GetTimestamps (NayifatAPI) in 22.7722ms
2025-02-05 00:26:41.577 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.ContentController.GetTimestamps (NayifatAPI)'
2025-02-05 00:26:41.577 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/timestamps - 200 null application/json; charset=utf-8 29.401ms
2025-02-05 00:26:42.570 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - application/json; charset=utf-8 45
2025-02-05 00:26:42.574 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 00:26:42.575 +03:00 [INF] Route matched with {action = "MasterFetch", controller = "Content"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] MasterFetch(NayifatAPI.Controllers.MasterFetchRequest) on controller NayifatAPI.Controllers.ContentController (NayifatAPI).
2025-02-05 00:26:42.577 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 00:26:42.581 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__request_Page_0='?' (Size = 450), @__request_KeyName_1='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[config_id], [m].[key_name], [m].[last_updated], [m].[page], [m].[value]
FROM [master_config] AS [m]
WHERE [m].[page] = @__request_Page_0 AND [m].[key_name] = @__request_KeyName_1
2025-02-05 00:26:42.583 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 00:26:42.584 +03:00 [INF] Executed action NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI) in 7.4911ms
2025-02-05 00:26:42.584 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 00:26:42.585 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - 200 null application/json; charset=utf-8 15.4784ms
2025-02-05 00:26:48.081 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - application/json; charset=utf-8 48
2025-02-05 00:26:48.092 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 00:26:48.093 +03:00 [INF] Route matched with {action = "MasterFetch", controller = "Content"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] MasterFetch(NayifatAPI.Controllers.MasterFetchRequest) on controller NayifatAPI.Controllers.ContentController (NayifatAPI).
2025-02-05 00:26:48.097 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 00:26:48.100 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__request_Page_0='?' (Size = 450), @__request_KeyName_1='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[config_id], [m].[key_name], [m].[last_updated], [m].[page], [m].[value]
FROM [master_config] AS [m]
WHERE [m].[page] = @__request_Page_0 AND [m].[key_name] = @__request_KeyName_1
2025-02-05 00:26:48.102 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 00:26:48.103 +03:00 [INF] Executed action NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI) in 8.7487ms
2025-02-05 00:26:48.104 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 00:26:48.104 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - 200 null application/json; charset=utf-8 23.7835ms
2025-02-05 00:26:54.358 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - application/json; charset=utf-8 43
2025-02-05 00:26:54.360 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 00:26:54.362 +03:00 [INF] Route matched with {action = "MasterFetch", controller = "Content"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] MasterFetch(NayifatAPI.Controllers.MasterFetchRequest) on controller NayifatAPI.Controllers.ContentController (NayifatAPI).
2025-02-05 00:26:54.365 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 00:26:54.367 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__request_Page_0='?' (Size = 450), @__request_KeyName_1='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[config_id], [m].[key_name], [m].[last_updated], [m].[page], [m].[value]
FROM [master_config] AS [m]
WHERE [m].[page] = @__request_Page_0 AND [m].[key_name] = @__request_KeyName_1
2025-02-05 00:26:54.370 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 00:26:54.372 +03:00 [INF] Executed action NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI) in 8.5277ms
2025-02-05 00:26:54.373 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 00:26:54.373 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - 200 null application/json; charset=utf-8 15.914ms
2025-02-05 00:26:55.000 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - application/json; charset=utf-8 46
2025-02-05 00:26:55.007 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 00:26:55.010 +03:00 [INF] Route matched with {action = "MasterFetch", controller = "Content"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] MasterFetch(NayifatAPI.Controllers.MasterFetchRequest) on controller NayifatAPI.Controllers.ContentController (NayifatAPI).
2025-02-05 00:26:55.016 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 00:26:55.021 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__request_Page_0='?' (Size = 450), @__request_KeyName_1='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[config_id], [m].[key_name], [m].[last_updated], [m].[page], [m].[value]
FROM [master_config] AS [m]
WHERE [m].[page] = @__request_Page_0 AND [m].[key_name] = @__request_KeyName_1
2025-02-05 00:26:55.024 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 00:26:55.026 +03:00 [INF] Executed action NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI) in 11.3447ms
2025-02-05 00:26:55.030 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 00:26:55.030 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - 200 null application/json; charset=utf-8 30.7255ms
2025-02-05 00:26:55.827 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - application/json; charset=utf-8 36
2025-02-05 00:26:55.831 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 00:26:55.833 +03:00 [INF] Route matched with {action = "MasterFetch", controller = "Content"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] MasterFetch(NayifatAPI.Controllers.MasterFetchRequest) on controller NayifatAPI.Controllers.ContentController (NayifatAPI).
2025-02-05 00:26:55.841 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 00:26:55.850 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__request_Page_0='?' (Size = 450), @__request_KeyName_1='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[config_id], [m].[key_name], [m].[last_updated], [m].[page], [m].[value]
FROM [master_config] AS [m]
WHERE [m].[page] = @__request_Page_0 AND [m].[key_name] = @__request_KeyName_1
2025-02-05 00:26:55.855 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 00:26:55.858 +03:00 [INF] Executed action NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI) in 19.3005ms
2025-02-05 00:26:55.861 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 00:26:55.864 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - 200 null application/json; charset=utf-8 36.5675ms
2025-02-05 00:26:56.767 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - application/json; charset=utf-8 36
2025-02-05 00:26:56.777 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 00:26:56.779 +03:00 [INF] Route matched with {action = "MasterFetch", controller = "Content"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] MasterFetch(NayifatAPI.Controllers.MasterFetchRequest) on controller NayifatAPI.Controllers.ContentController (NayifatAPI).
2025-02-05 00:26:56.786 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 00:26:56.793 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__request_Page_0='?' (Size = 450), @__request_KeyName_1='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[config_id], [m].[key_name], [m].[last_updated], [m].[page], [m].[value]
FROM [master_config] AS [m]
WHERE [m].[page] = @__request_Page_0 AND [m].[key_name] = @__request_KeyName_1
2025-02-05 00:26:56.798 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 00:26:56.801 +03:00 [INF] Executed action NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI) in 18.2684ms
2025-02-05 00:26:56.803 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 00:26:56.804 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - 200 null application/json; charset=utf-8 37.3543ms
2025-02-05 00:26:57.602 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - application/json; charset=utf-8 38
2025-02-05 00:26:57.608 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 00:26:57.611 +03:00 [INF] Route matched with {action = "MasterFetch", controller = "Content"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] MasterFetch(NayifatAPI.Controllers.MasterFetchRequest) on controller NayifatAPI.Controllers.ContentController (NayifatAPI).
2025-02-05 00:26:57.618 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 00:26:57.624 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__request_Page_0='?' (Size = 450), @__request_KeyName_1='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[config_id], [m].[key_name], [m].[last_updated], [m].[page], [m].[value]
FROM [master_config] AS [m]
WHERE [m].[page] = @__request_Page_0 AND [m].[key_name] = @__request_KeyName_1
2025-02-05 00:26:57.626 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 00:26:57.628 +03:00 [INF] Executed action NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI) in 10.6331ms
2025-02-05 00:26:57.629 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 00:26:57.630 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - 200 null application/json; charset=utf-8 27.404ms
2025-02-05 00:26:58.401 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - application/json; charset=utf-8 38
2025-02-05 00:26:58.406 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 00:26:58.408 +03:00 [INF] Route matched with {action = "MasterFetch", controller = "Content"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] MasterFetch(NayifatAPI.Controllers.MasterFetchRequest) on controller NayifatAPI.Controllers.ContentController (NayifatAPI).
2025-02-05 00:26:58.412 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 00:26:58.415 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__request_Page_0='?' (Size = 450), @__request_KeyName_1='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[config_id], [m].[key_name], [m].[last_updated], [m].[page], [m].[value]
FROM [master_config] AS [m]
WHERE [m].[page] = @__request_Page_0 AND [m].[key_name] = @__request_KeyName_1
2025-02-05 00:26:58.417 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 00:26:58.419 +03:00 [INF] Executed action NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI) in 8.1704ms
2025-02-05 00:26:58.420 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 00:26:58.423 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - 200 null application/json; charset=utf-8 21.27ms
2025-02-05 00:26:59.060 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - application/json; charset=utf-8 36
2025-02-05 00:26:59.067 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 00:26:59.071 +03:00 [INF] Route matched with {action = "MasterFetch", controller = "Content"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] MasterFetch(NayifatAPI.Controllers.MasterFetchRequest) on controller NayifatAPI.Controllers.ContentController (NayifatAPI).
2025-02-05 00:26:59.077 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 00:26:59.084 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__request_Page_0='?' (Size = 450), @__request_KeyName_1='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[config_id], [m].[key_name], [m].[last_updated], [m].[page], [m].[value]
FROM [master_config] AS [m]
WHERE [m].[page] = @__request_Page_0 AND [m].[key_name] = @__request_KeyName_1
2025-02-05 00:26:59.089 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 00:26:59.094 +03:00 [INF] Executed action NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI) in 18.0665ms
2025-02-05 00:26:59.099 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 00:26:59.101 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - 200 null application/json; charset=utf-8 40.7012ms
2025-02-05 00:26:59.808 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - application/json; charset=utf-8 36
2025-02-05 00:26:59.816 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 00:26:59.817 +03:00 [INF] Route matched with {action = "MasterFetch", controller = "Content"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] MasterFetch(NayifatAPI.Controllers.MasterFetchRequest) on controller NayifatAPI.Controllers.ContentController (NayifatAPI).
2025-02-05 00:26:59.823 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 00:26:59.830 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__request_Page_0='?' (Size = 450), @__request_KeyName_1='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[config_id], [m].[key_name], [m].[last_updated], [m].[page], [m].[value]
FROM [master_config] AS [m]
WHERE [m].[page] = @__request_Page_0 AND [m].[key_name] = @__request_KeyName_1
2025-02-05 00:26:59.836 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 00:26:59.838 +03:00 [INF] Executed action NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI) in 16.521ms
2025-02-05 00:26:59.839 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 00:26:59.840 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - 200 null application/json; charset=utf-8 32.2344ms
2025-02-05 00:27:00.643 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - application/json; charset=utf-8 38
2025-02-05 00:27:00.648 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 00:27:00.650 +03:00 [INF] Route matched with {action = "MasterFetch", controller = "Content"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] MasterFetch(NayifatAPI.Controllers.MasterFetchRequest) on controller NayifatAPI.Controllers.ContentController (NayifatAPI).
2025-02-05 00:27:00.658 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 00:27:00.666 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__request_Page_0='?' (Size = 450), @__request_KeyName_1='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[config_id], [m].[key_name], [m].[last_updated], [m].[page], [m].[value]
FROM [master_config] AS [m]
WHERE [m].[page] = @__request_Page_0 AND [m].[key_name] = @__request_KeyName_1
2025-02-05 00:27:00.671 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 00:27:00.674 +03:00 [INF] Executed action NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI) in 18.2249ms
2025-02-05 00:27:00.678 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 00:27:00.680 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - 200 null application/json; charset=utf-8 37.2564ms
2025-02-05 00:27:01.552 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - application/json; charset=utf-8 38
2025-02-05 00:27:01.556 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 00:27:01.558 +03:00 [INF] Route matched with {action = "MasterFetch", controller = "Content"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] MasterFetch(NayifatAPI.Controllers.MasterFetchRequest) on controller NayifatAPI.Controllers.ContentController (NayifatAPI).
2025-02-05 00:27:01.561 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 00:27:01.566 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__request_Page_0='?' (Size = 450), @__request_KeyName_1='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[config_id], [m].[key_name], [m].[last_updated], [m].[page], [m].[value]
FROM [master_config] AS [m]
WHERE [m].[page] = @__request_Page_0 AND [m].[key_name] = @__request_KeyName_1
2025-02-05 00:27:01.569 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 00:27:01.571 +03:00 [INF] Executed action NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI) in 10.6061ms
2025-02-05 00:27:01.575 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 00:27:01.578 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - 200 null application/json; charset=utf-8 25.598ms
2025-02-05 00:27:02.486 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - application/json; charset=utf-8 49
2025-02-05 00:27:02.493 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 00:27:02.495 +03:00 [INF] Route matched with {action = "MasterFetch", controller = "Content"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] MasterFetch(NayifatAPI.Controllers.MasterFetchRequest) on controller NayifatAPI.Controllers.ContentController (NayifatAPI).
2025-02-05 00:27:02.500 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 00:27:02.506 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__request_Page_0='?' (Size = 450), @__request_KeyName_1='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[config_id], [m].[key_name], [m].[last_updated], [m].[page], [m].[value]
FROM [master_config] AS [m]
WHERE [m].[page] = @__request_Page_0 AND [m].[key_name] = @__request_KeyName_1
2025-02-05 00:27:02.512 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 00:27:02.515 +03:00 [INF] Executed action NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI) in 17.1639ms
2025-02-05 00:27:02.520 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 00:27:02.521 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - 200 null application/json; charset=utf-8 35.0004ms
2025-02-05 00:27:03.392 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - application/json; charset=utf-8 49
2025-02-05 00:27:03.395 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 00:27:03.396 +03:00 [INF] Route matched with {action = "MasterFetch", controller = "Content"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] MasterFetch(NayifatAPI.Controllers.MasterFetchRequest) on controller NayifatAPI.Controllers.ContentController (NayifatAPI).
2025-02-05 00:27:03.400 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 00:27:03.408 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__request_Page_0='?' (Size = 450), @__request_KeyName_1='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[config_id], [m].[key_name], [m].[last_updated], [m].[page], [m].[value]
FROM [master_config] AS [m]
WHERE [m].[page] = @__request_Page_0 AND [m].[key_name] = @__request_KeyName_1
2025-02-05 00:27:03.413 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 00:27:03.415 +03:00 [INF] Executed action NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI) in 16.4786ms
2025-02-05 00:27:03.417 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 00:27:03.419 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - 200 null application/json; charset=utf-8 27.411ms
2025-02-05 00:27:04.236 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - application/json; charset=utf-8 49
2025-02-05 00:27:04.246 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 00:27:04.247 +03:00 [INF] Route matched with {action = "MasterFetch", controller = "Content"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] MasterFetch(NayifatAPI.Controllers.MasterFetchRequest) on controller NayifatAPI.Controllers.ContentController (NayifatAPI).
2025-02-05 00:27:04.253 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 00:27:04.260 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__request_Page_0='?' (Size = 450), @__request_KeyName_1='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[config_id], [m].[key_name], [m].[last_updated], [m].[page], [m].[value]
FROM [master_config] AS [m]
WHERE [m].[page] = @__request_Page_0 AND [m].[key_name] = @__request_KeyName_1
2025-02-05 00:27:04.264 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 00:27:04.267 +03:00 [INF] Executed action NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI) in 15.8419ms
2025-02-05 00:27:04.270 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 00:27:04.273 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - 200 null application/json; charset=utf-8 36.1899ms
2025-02-05 00:27:05.148 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - application/json; charset=utf-8 49
2025-02-05 00:27:05.150 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 00:27:05.151 +03:00 [INF] Route matched with {action = "MasterFetch", controller = "Content"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] MasterFetch(NayifatAPI.Controllers.MasterFetchRequest) on controller NayifatAPI.Controllers.ContentController (NayifatAPI).
2025-02-05 00:27:05.153 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 00:27:05.155 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__request_Page_0='?' (Size = 450), @__request_KeyName_1='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[config_id], [m].[key_name], [m].[last_updated], [m].[page], [m].[value]
FROM [master_config] AS [m]
WHERE [m].[page] = @__request_Page_0 AND [m].[key_name] = @__request_KeyName_1
2025-02-05 00:27:05.157 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 00:27:05.158 +03:00 [INF] Executed action NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI) in 6.1525ms
2025-02-05 00:27:05.159 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 00:27:05.160 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - 200 null application/json; charset=utf-8 11.8193ms
2025-02-05 00:27:06.077 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - application/json; charset=utf-8 36
2025-02-05 00:27:06.082 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 00:27:06.085 +03:00 [INF] Route matched with {action = "MasterFetch", controller = "Content"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] MasterFetch(NayifatAPI.Controllers.MasterFetchRequest) on controller NayifatAPI.Controllers.ContentController (NayifatAPI).
2025-02-05 00:27:06.090 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 00:27:06.096 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__request_Page_0='?' (Size = 450), @__request_KeyName_1='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[config_id], [m].[key_name], [m].[last_updated], [m].[page], [m].[value]
FROM [master_config] AS [m]
WHERE [m].[page] = @__request_Page_0 AND [m].[key_name] = @__request_KeyName_1
2025-02-05 00:27:06.099 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 00:27:06.101 +03:00 [INF] Executed action NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI) in 11.8134ms
2025-02-05 00:27:06.104 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 00:27:06.106 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - 200 null application/json; charset=utf-8 28.4974ms
2025-02-05 00:27:08.137 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - application/json; charset=utf-8 36
2025-02-05 00:27:08.144 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 00:27:08.146 +03:00 [INF] Route matched with {action = "MasterFetch", controller = "Content"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] MasterFetch(NayifatAPI.Controllers.MasterFetchRequest) on controller NayifatAPI.Controllers.ContentController (NayifatAPI).
2025-02-05 00:27:08.153 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 00:27:08.159 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__request_Page_0='?' (Size = 450), @__request_KeyName_1='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[config_id], [m].[key_name], [m].[last_updated], [m].[page], [m].[value]
FROM [master_config] AS [m]
WHERE [m].[page] = @__request_Page_0 AND [m].[key_name] = @__request_KeyName_1
2025-02-05 00:27:08.165 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 00:27:08.168 +03:00 [INF] Executed action NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI) in 16.8868ms
2025-02-05 00:27:08.171 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 00:27:08.175 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - 200 null application/json; charset=utf-8 38.0468ms
2025-02-05 00:30:34.201 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/list - application/json; charset=utf-8 45
2025-02-05 00:30:34.205 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI)'
2025-02-05 00:30:34.207 +03:00 [INF] Route matched with {action = "GetNotifications", controller = "Notifications"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetNotifications(NayifatAPI.Controllers.GetNotificationsRequest) on controller NayifatAPI.Controllers.NotificationsController (NayifatAPI).
2025-02-05 00:30:34.213 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 00:30:34.219 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[@__request_NationalId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[national_id], [u].[last_updated], [u].[notifications]
FROM [user_notifications] AS [u]
WHERE [u].[national_id] = @__request_NationalId_0
2025-02-05 00:30:34.223 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 00:30:34.225 +03:00 [INF] Executed action NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI) in 15.4852ms
2025-02-05 00:30:34.228 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI)'
2025-02-05 00:30:34.230 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/list - 200 null application/json; charset=utf-8 29.4302ms
2025-02-05 00:30:35.085 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/list - application/json; charset=utf-8 39
2025-02-05 00:30:35.091 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI)'
2025-02-05 00:30:35.094 +03:00 [INF] Route matched with {action = "GetNotifications", controller = "Notifications"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetNotifications(NayifatAPI.Controllers.GetNotificationsRequest) on controller NayifatAPI.Controllers.NotificationsController (NayifatAPI).
2025-02-05 00:30:35.108 +03:00 [INF] Executed DbCommand (9ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 00:30:35.117 +03:00 [INF] Executed DbCommand (5ms) [Parameters=[@__request_NationalId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[national_id], [u].[last_updated], [u].[notifications]
FROM [user_notifications] AS [u]
WHERE [u].[national_id] = @__request_NationalId_0
2025-02-05 00:30:35.128 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__Parse_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [n].[Id], [n].[additional_data], [n].[Body], [n].[body_ar], [n].[body_en], [n].[created_at], [n].[expiry_at], [n].[Route], [n].[target_criteria], [n].[Title], [n].[title_ar], [n].[title_en]
FROM [notification_templates] AS [n]
WHERE [n].[Id] = @__Parse_0
2025-02-05 00:30:35.137 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[@__Parse_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [n].[Id], [n].[additional_data], [n].[Body], [n].[body_ar], [n].[body_en], [n].[created_at], [n].[expiry_at], [n].[Route], [n].[target_criteria], [n].[Title], [n].[title_ar], [n].[title_en]
FROM [notification_templates] AS [n]
WHERE [n].[Id] = @__Parse_0
2025-02-05 00:30:35.149 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[@p0='?' (Size = 4000), @p1='?' (DbType = DateTime2), @p2='?' (Size = 4000), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (Size = 450), @p6='?' (Size = 4000), @p7='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [AuthLogs] ([AuthType], [CreatedAt], [DeviceId], [FailureReason], [IpAddress], [NationalId], [Status], [UserAgent])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7);
2025-02-05 00:30:35.159 +03:00 [ERR] An exception occurred in the database while saving changes for context type 'NayifatAPI.Data.ApplicationDbContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_AuthLogs_Customers_NationalId". The conflict occurred in database "NayifatApp", table "dbo.Customers", column 'NationalId'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:2f1879bc-4a17-43c4-898a-feeaf6815d79
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_AuthLogs_Customers_NationalId". The conflict occurred in database "NayifatApp", table "dbo.Customers", column 'NationalId'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:2f1879bc-4a17-43c4-898a-feeaf6815d79
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2025-02-05 00:30:35.183 +03:00 [ERR] Error logging audit event. NationalId: all, Action: notification_delivered, Details: {"notification_count":2,"notification_ids":[4,3],"timestamp":"2025-02-05T00:30:35.1246345"}
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_AuthLogs_Customers_NationalId". The conflict occurred in database "NayifatApp", table "dbo.Customers", column 'NationalId'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:2f1879bc-4a17-43c4-898a-feeaf6815d79
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at NayifatAPI.Services.AuditLogService.LogAsync(String nationalId, String action, Object details) in C:\Users\yamta\StudioProjects\nayifat_app_2025_new\nayifatapi\Services\AuditLogService.cs:line 36
2025-02-05 00:30:35.197 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 00:30:35.199 +03:00 [INF] Executed action NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI) in 99.7281ms
2025-02-05 00:30:35.200 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI)'
2025-02-05 00:30:35.201 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/list - 200 null application/json; charset=utf-8 116.287ms
2025-02-05 00:30:52.782 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/timestamps - application/json; charset=utf-8 2
2025-02-05 00:30:52.788 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.ContentController.GetTimestamps (NayifatAPI)'
2025-02-05 00:30:52.790 +03:00 [INF] Route matched with {action = "GetTimestamps", controller = "Content"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetTimestamps() on controller NayifatAPI.Controllers.ContentController (NayifatAPI).
2025-02-05 00:30:52.794 +03:00 [INF] TTT_
2025-02-05 00:30:52.795 +03:00 [INF] TTT_=== Getting Content Timestamps ===
2025-02-05 00:30:52.804 +03:00 [INF] Executed DbCommand (5ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 00:30:52.811 +03:00 [INF] TTT_Fetching timestamps from database
2025-02-05 00:30:52.817 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [m].[page] AS [Page], [m].[key_name] AS [KeyName], [m].[last_updated] AS [LastUpdated]
FROM [master_config] AS [m]
2025-02-05 00:30:52.820 +03:00 [INF] TTT_Found 18 content items
2025-02-05 00:30:52.823 +03:00 [INF] TTT_Page: home
2025-02-05 00:30:52.825 +03:00 [INF] TTT_  - slideshow_content: "2025-02-04T10:01:06.9430000"
2025-02-05 00:30:52.827 +03:00 [INF] TTT_  - slideshow_content_ar: "2025-02-04T10:01:06.9430000"
2025-02-05 00:30:52.830 +03:00 [INF] TTT_  - contact_details: "2025-02-04T10:01:06.9430000"
2025-02-05 00:30:52.831 +03:00 [INF] TTT_  - contact_details_ar: "2025-02-04T10:01:06.9430000"
2025-02-05 00:30:52.833 +03:00 [INF] TTT_  - termsEN1: "2025-02-03T14:23:58.0000000"
2025-02-05 00:30:52.836 +03:00 [INF] TTT_  - termsEN2: "2025-02-03T14:25:20.1730000"
2025-02-05 00:30:52.841 +03:00 [INF] TTT_  - privacyEN1: "2025-02-03T14:26:08.6130000"
2025-02-05 00:30:52.842 +03:00 [INF] TTT_  - privacyEN2: "2025-02-03T14:25:20.1730000"
2025-02-05 00:30:52.843 +03:00 [INF] TTT_  - termsAR1: "2025-02-03T14:23:58.0000000"
2025-02-05 00:30:52.843 +03:00 [INF] TTT_  - termsAR2: "2025-02-03T14:25:20.1730000"
2025-02-05 00:30:52.845 +03:00 [INF] TTT_  - privacyAR1: "2025-02-03T14:26:08.6130000"
2025-02-05 00:30:52.845 +03:00 [INF] TTT_  - privacyAR2: "2025-02-03T14:25:20.1730000"
2025-02-05 00:30:52.846 +03:00 [INF] TTT_  - terms&conditionsCC_AR: "2025-02-03T17:06:57.7700000"
2025-02-05 00:30:52.847 +03:00 [INF] TTT_  - terms&conditionsCC_EN: "2025-02-03T17:07:47.4900000"
2025-02-05 00:30:52.848 +03:00 [INF] TTT_  - terms&conditionsPF_AR: "2025-02-03T17:06:57.7700000"
2025-02-05 00:30:52.849 +03:00 [INF] TTT_  - terms&conditionsPF_EN: "2025-02-03T17:06:57.7700000"
2025-02-05 00:30:52.850 +03:00 [INF] TTT_Page: loans
2025-02-05 00:30:52.851 +03:00 [INF] TTT_  - loan_ad: "2025-02-04T10:01:06.9430000"
2025-02-05 00:30:52.852 +03:00 [INF] TTT_Page: cards
2025-02-05 00:30:52.852 +03:00 [INF] TTT_  - card_ad: "2025-02-04T10:01:06.9430000"
2025-02-05 00:30:52.853 +03:00 [INF] TTT_Successfully retrieved all timestamps
2025-02-05 00:30:52.854 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 00:30:52.855 +03:00 [INF] Executed action NayifatAPI.Controllers.ContentController.GetTimestamps (NayifatAPI) in 61.6705ms
2025-02-05 00:30:52.857 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.ContentController.GetTimestamps (NayifatAPI)'
2025-02-05 00:30:52.859 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/timestamps - 200 null application/json; charset=utf-8 76.4745ms
2025-02-05 00:30:53.768 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - application/json; charset=utf-8 45
2025-02-05 00:30:53.773 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 00:30:53.775 +03:00 [INF] Route matched with {action = "MasterFetch", controller = "Content"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] MasterFetch(NayifatAPI.Controllers.MasterFetchRequest) on controller NayifatAPI.Controllers.ContentController (NayifatAPI).
2025-02-05 00:30:53.779 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 00:30:53.785 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__request_Page_0='?' (Size = 450), @__request_KeyName_1='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[config_id], [m].[key_name], [m].[last_updated], [m].[page], [m].[value]
FROM [master_config] AS [m]
WHERE [m].[page] = @__request_Page_0 AND [m].[key_name] = @__request_KeyName_1
2025-02-05 00:30:53.787 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 00:30:53.788 +03:00 [INF] Executed action NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI) in 10.7315ms
2025-02-05 00:30:53.789 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 00:30:53.791 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - 200 null application/json; charset=utf-8 22.4336ms
2025-02-05 00:30:54.491 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/list - application/json; charset=utf-8 45
2025-02-05 00:30:54.497 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI)'
2025-02-05 00:30:54.502 +03:00 [INF] Route matched with {action = "GetNotifications", controller = "Notifications"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetNotifications(NayifatAPI.Controllers.GetNotificationsRequest) on controller NayifatAPI.Controllers.NotificationsController (NayifatAPI).
2025-02-05 00:30:54.508 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 00:30:54.513 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[@__request_NationalId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[national_id], [u].[last_updated], [u].[notifications]
FROM [user_notifications] AS [u]
WHERE [u].[national_id] = @__request_NationalId_0
2025-02-05 00:30:54.517 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 00:30:54.521 +03:00 [INF] Executed action NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI) in 14.3322ms
2025-02-05 00:30:54.522 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI)'
2025-02-05 00:30:54.524 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/list - 200 null application/json; charset=utf-8 32.5487ms
2025-02-05 00:30:55.401 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/list - application/json; charset=utf-8 39
2025-02-05 00:30:55.407 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI)'
2025-02-05 00:30:55.410 +03:00 [INF] Route matched with {action = "GetNotifications", controller = "Notifications"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetNotifications(NayifatAPI.Controllers.GetNotificationsRequest) on controller NayifatAPI.Controllers.NotificationsController (NayifatAPI).
2025-02-05 00:30:55.416 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 00:30:55.423 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__request_NationalId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[national_id], [u].[last_updated], [u].[notifications]
FROM [user_notifications] AS [u]
WHERE [u].[national_id] = @__request_NationalId_0
2025-02-05 00:30:55.432 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[@__Parse_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [n].[Id], [n].[additional_data], [n].[Body], [n].[body_ar], [n].[body_en], [n].[created_at], [n].[expiry_at], [n].[Route], [n].[target_criteria], [n].[Title], [n].[title_ar], [n].[title_en]
FROM [notification_templates] AS [n]
WHERE [n].[Id] = @__Parse_0
2025-02-05 00:30:55.441 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__Parse_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [n].[Id], [n].[additional_data], [n].[Body], [n].[body_ar], [n].[body_en], [n].[created_at], [n].[expiry_at], [n].[Route], [n].[target_criteria], [n].[Title], [n].[title_ar], [n].[title_en]
FROM [notification_templates] AS [n]
WHERE [n].[Id] = @__Parse_0
2025-02-05 00:30:55.452 +03:00 [INF] Executed DbCommand (5ms) [Parameters=[@p0='?' (Size = 4000), @p1='?' (DbType = DateTime2), @p2='?' (Size = 4000), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (Size = 450), @p6='?' (Size = 4000), @p7='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [AuthLogs] ([AuthType], [CreatedAt], [DeviceId], [FailureReason], [IpAddress], [NationalId], [Status], [UserAgent])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7);
2025-02-05 00:30:55.456 +03:00 [ERR] An exception occurred in the database while saving changes for context type 'NayifatAPI.Data.ApplicationDbContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_AuthLogs_Customers_NationalId". The conflict occurred in database "NayifatApp", table "dbo.Customers", column 'NationalId'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:2f1879bc-4a17-43c4-898a-feeaf6815d79
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_AuthLogs_Customers_NationalId". The conflict occurred in database "NayifatApp", table "dbo.Customers", column 'NationalId'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:2f1879bc-4a17-43c4-898a-feeaf6815d79
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2025-02-05 00:30:55.481 +03:00 [ERR] Error logging audit event. NationalId: all, Action: notification_delivered, Details: {"notification_count":2,"notification_ids":[4,3],"timestamp":"2025-02-05T00:30:55.4285981"}
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_AuthLogs_Customers_NationalId". The conflict occurred in database "NayifatApp", table "dbo.Customers", column 'NationalId'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:2f1879bc-4a17-43c4-898a-feeaf6815d79
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at NayifatAPI.Services.AuditLogService.LogAsync(String nationalId, String action, Object details) in C:\Users\yamta\StudioProjects\nayifat_app_2025_new\nayifatapi\Services\AuditLogService.cs:line 36
2025-02-05 00:30:55.493 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 00:30:55.495 +03:00 [INF] Executed action NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI) in 80.1336ms
2025-02-05 00:30:55.496 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI)'
2025-02-05 00:30:55.497 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/list - 200 null application/json; charset=utf-8 96.1976ms
2025-02-05 00:30:58.940 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - application/json; charset=utf-8 48
2025-02-05 00:30:58.942 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 00:30:58.943 +03:00 [INF] Route matched with {action = "MasterFetch", controller = "Content"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] MasterFetch(NayifatAPI.Controllers.MasterFetchRequest) on controller NayifatAPI.Controllers.ContentController (NayifatAPI).
2025-02-05 00:30:58.945 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 00:30:58.947 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__request_Page_0='?' (Size = 450), @__request_KeyName_1='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[config_id], [m].[key_name], [m].[last_updated], [m].[page], [m].[value]
FROM [master_config] AS [m]
WHERE [m].[page] = @__request_Page_0 AND [m].[key_name] = @__request_KeyName_1
2025-02-05 00:30:58.948 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 00:30:58.949 +03:00 [INF] Executed action NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI) in 5.2732ms
2025-02-05 00:30:58.950 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 00:30:58.951 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - 200 null application/json; charset=utf-8 11.024ms
2025-02-05 00:31:02.752 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - application/json; charset=utf-8 43
2025-02-05 00:31:02.754 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 00:31:02.755 +03:00 [INF] Route matched with {action = "MasterFetch", controller = "Content"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] MasterFetch(NayifatAPI.Controllers.MasterFetchRequest) on controller NayifatAPI.Controllers.ContentController (NayifatAPI).
2025-02-05 00:31:02.758 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 00:31:02.761 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__request_Page_0='?' (Size = 450), @__request_KeyName_1='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[config_id], [m].[key_name], [m].[last_updated], [m].[page], [m].[value]
FROM [master_config] AS [m]
WHERE [m].[page] = @__request_Page_0 AND [m].[key_name] = @__request_KeyName_1
2025-02-05 00:31:02.763 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 00:31:02.764 +03:00 [INF] Executed action NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI) in 7.2122ms
2025-02-05 00:31:02.767 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 00:31:02.768 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - 200 null application/json; charset=utf-8 15.8629ms
2025-02-05 00:31:03.690 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - application/json; charset=utf-8 46
2025-02-05 00:31:03.694 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 00:31:03.695 +03:00 [INF] Route matched with {action = "MasterFetch", controller = "Content"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] MasterFetch(NayifatAPI.Controllers.MasterFetchRequest) on controller NayifatAPI.Controllers.ContentController (NayifatAPI).
2025-02-05 00:31:03.697 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 00:31:03.700 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__request_Page_0='?' (Size = 450), @__request_KeyName_1='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[config_id], [m].[key_name], [m].[last_updated], [m].[page], [m].[value]
FROM [master_config] AS [m]
WHERE [m].[page] = @__request_Page_0 AND [m].[key_name] = @__request_KeyName_1
2025-02-05 00:31:03.702 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 00:31:03.703 +03:00 [INF] Executed action NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI) in 6.1261ms
2025-02-05 00:31:03.703 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 00:31:03.704 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - 200 null application/json; charset=utf-8 13.9057ms
2025-02-05 00:31:04.435 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - application/json; charset=utf-8 36
2025-02-05 00:31:04.436 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 00:31:04.437 +03:00 [INF] Route matched with {action = "MasterFetch", controller = "Content"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] MasterFetch(NayifatAPI.Controllers.MasterFetchRequest) on controller NayifatAPI.Controllers.ContentController (NayifatAPI).
2025-02-05 00:31:04.439 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 00:31:04.442 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__request_Page_0='?' (Size = 450), @__request_KeyName_1='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[config_id], [m].[key_name], [m].[last_updated], [m].[page], [m].[value]
FROM [master_config] AS [m]
WHERE [m].[page] = @__request_Page_0 AND [m].[key_name] = @__request_KeyName_1
2025-02-05 00:31:04.447 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 00:31:04.449 +03:00 [INF] Executed action NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI) in 11.2287ms
2025-02-05 00:31:04.451 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 00:31:04.452 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - 200 null application/json; charset=utf-8 16.8767ms
2025-02-05 00:31:05.112 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - application/json; charset=utf-8 36
2025-02-05 00:31:05.120 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 00:31:05.121 +03:00 [INF] Route matched with {action = "MasterFetch", controller = "Content"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] MasterFetch(NayifatAPI.Controllers.MasterFetchRequest) on controller NayifatAPI.Controllers.ContentController (NayifatAPI).
2025-02-05 00:31:05.126 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 00:31:05.131 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__request_Page_0='?' (Size = 450), @__request_KeyName_1='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[config_id], [m].[key_name], [m].[last_updated], [m].[page], [m].[value]
FROM [master_config] AS [m]
WHERE [m].[page] = @__request_Page_0 AND [m].[key_name] = @__request_KeyName_1
2025-02-05 00:31:05.133 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 00:31:05.134 +03:00 [INF] Executed action NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI) in 11.8223ms
2025-02-05 00:31:05.135 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 00:31:05.136 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - 200 null application/json; charset=utf-8 24.1085ms
2025-02-05 00:31:06.007 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - application/json; charset=utf-8 38
2025-02-05 00:31:06.012 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 00:31:06.013 +03:00 [INF] Route matched with {action = "MasterFetch", controller = "Content"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] MasterFetch(NayifatAPI.Controllers.MasterFetchRequest) on controller NayifatAPI.Controllers.ContentController (NayifatAPI).
2025-02-05 00:31:06.017 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 00:31:06.022 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__request_Page_0='?' (Size = 450), @__request_KeyName_1='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[config_id], [m].[key_name], [m].[last_updated], [m].[page], [m].[value]
FROM [master_config] AS [m]
WHERE [m].[page] = @__request_Page_0 AND [m].[key_name] = @__request_KeyName_1
2025-02-05 00:31:06.024 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 00:31:06.025 +03:00 [INF] Executed action NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI) in 10.6985ms
2025-02-05 00:31:06.026 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 00:31:06.027 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - 200 null application/json; charset=utf-8 19.5896ms
2025-02-05 00:31:06.928 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - application/json; charset=utf-8 38
2025-02-05 00:31:06.931 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 00:31:06.932 +03:00 [INF] Route matched with {action = "MasterFetch", controller = "Content"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] MasterFetch(NayifatAPI.Controllers.MasterFetchRequest) on controller NayifatAPI.Controllers.ContentController (NayifatAPI).
2025-02-05 00:31:06.935 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 00:31:06.939 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__request_Page_0='?' (Size = 450), @__request_KeyName_1='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[config_id], [m].[key_name], [m].[last_updated], [m].[page], [m].[value]
FROM [master_config] AS [m]
WHERE [m].[page] = @__request_Page_0 AND [m].[key_name] = @__request_KeyName_1
2025-02-05 00:31:06.940 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 00:31:06.941 +03:00 [INF] Executed action NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI) in 8.4224ms
2025-02-05 00:31:06.942 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 00:31:06.943 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - 200 null application/json; charset=utf-8 14.3297ms
2025-02-05 00:31:07.798 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - application/json; charset=utf-8 36
2025-02-05 00:31:07.803 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 00:31:07.804 +03:00 [INF] Route matched with {action = "MasterFetch", controller = "Content"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] MasterFetch(NayifatAPI.Controllers.MasterFetchRequest) on controller NayifatAPI.Controllers.ContentController (NayifatAPI).
2025-02-05 00:31:07.809 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 00:31:07.814 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__request_Page_0='?' (Size = 450), @__request_KeyName_1='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[config_id], [m].[key_name], [m].[last_updated], [m].[page], [m].[value]
FROM [master_config] AS [m]
WHERE [m].[page] = @__request_Page_0 AND [m].[key_name] = @__request_KeyName_1
2025-02-05 00:31:07.817 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 00:31:07.818 +03:00 [INF] Executed action NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI) in 12.986ms
2025-02-05 00:31:07.819 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 00:31:07.820 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - 200 null application/json; charset=utf-8 22.4094ms
2025-02-05 00:31:08.604 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - application/json; charset=utf-8 36
2025-02-05 00:31:08.613 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 00:31:08.614 +03:00 [INF] Route matched with {action = "MasterFetch", controller = "Content"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] MasterFetch(NayifatAPI.Controllers.MasterFetchRequest) on controller NayifatAPI.Controllers.ContentController (NayifatAPI).
2025-02-05 00:31:08.620 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 00:31:08.625 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[@__request_Page_0='?' (Size = 450), @__request_KeyName_1='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[config_id], [m].[key_name], [m].[last_updated], [m].[page], [m].[value]
FROM [master_config] AS [m]
WHERE [m].[page] = @__request_Page_0 AND [m].[key_name] = @__request_KeyName_1
2025-02-05 00:31:08.627 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 00:31:08.628 +03:00 [INF] Executed action NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI) in 12.4408ms
2025-02-05 00:31:08.629 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 00:31:08.630 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - 200 null application/json; charset=utf-8 26.4738ms
2025-02-05 00:31:09.565 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - application/json; charset=utf-8 38
2025-02-05 00:31:09.571 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 00:31:09.573 +03:00 [INF] Route matched with {action = "MasterFetch", controller = "Content"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] MasterFetch(NayifatAPI.Controllers.MasterFetchRequest) on controller NayifatAPI.Controllers.ContentController (NayifatAPI).
2025-02-05 00:31:09.581 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 00:31:09.593 +03:00 [INF] Executed DbCommand (4ms) [Parameters=[@__request_Page_0='?' (Size = 450), @__request_KeyName_1='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[config_id], [m].[key_name], [m].[last_updated], [m].[page], [m].[value]
FROM [master_config] AS [m]
WHERE [m].[page] = @__request_Page_0 AND [m].[key_name] = @__request_KeyName_1
2025-02-05 00:31:09.600 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 00:31:09.604 +03:00 [INF] Executed action NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI) in 27.5366ms
2025-02-05 00:31:09.608 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 00:31:09.611 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - 200 null application/json; charset=utf-8 46.2586ms
2025-02-05 00:31:10.432 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - application/json; charset=utf-8 38
2025-02-05 00:31:10.437 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 00:31:10.439 +03:00 [INF] Route matched with {action = "MasterFetch", controller = "Content"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] MasterFetch(NayifatAPI.Controllers.MasterFetchRequest) on controller NayifatAPI.Controllers.ContentController (NayifatAPI).
2025-02-05 00:31:10.449 +03:00 [INF] Executed DbCommand (5ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 00:31:10.455 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__request_Page_0='?' (Size = 450), @__request_KeyName_1='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[config_id], [m].[key_name], [m].[last_updated], [m].[page], [m].[value]
FROM [master_config] AS [m]
WHERE [m].[page] = @__request_Page_0 AND [m].[key_name] = @__request_KeyName_1
2025-02-05 00:31:10.457 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 00:31:10.458 +03:00 [INF] Executed action NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI) in 14.4726ms
2025-02-05 00:31:10.460 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 00:31:10.461 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - 200 null application/json; charset=utf-8 28.5915ms
2025-02-05 00:31:11.083 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - application/json; charset=utf-8 49
2025-02-05 00:31:11.090 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 00:31:11.092 +03:00 [INF] Route matched with {action = "MasterFetch", controller = "Content"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] MasterFetch(NayifatAPI.Controllers.MasterFetchRequest) on controller NayifatAPI.Controllers.ContentController (NayifatAPI).
2025-02-05 00:31:11.099 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 00:31:11.104 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__request_Page_0='?' (Size = 450), @__request_KeyName_1='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[config_id], [m].[key_name], [m].[last_updated], [m].[page], [m].[value]
FROM [master_config] AS [m]
WHERE [m].[page] = @__request_Page_0 AND [m].[key_name] = @__request_KeyName_1
2025-02-05 00:31:11.109 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 00:31:11.113 +03:00 [INF] Executed action NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI) in 15.751ms
2025-02-05 00:31:11.117 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 00:31:11.118 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - 200 null application/json; charset=utf-8 35.1451ms
2025-02-05 00:31:11.947 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - application/json; charset=utf-8 49
2025-02-05 00:31:11.950 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 00:31:11.952 +03:00 [INF] Route matched with {action = "MasterFetch", controller = "Content"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] MasterFetch(NayifatAPI.Controllers.MasterFetchRequest) on controller NayifatAPI.Controllers.ContentController (NayifatAPI).
2025-02-05 00:31:11.956 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 00:31:11.960 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__request_Page_0='?' (Size = 450), @__request_KeyName_1='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[config_id], [m].[key_name], [m].[last_updated], [m].[page], [m].[value]
FROM [master_config] AS [m]
WHERE [m].[page] = @__request_Page_0 AND [m].[key_name] = @__request_KeyName_1
2025-02-05 00:31:11.962 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 00:31:11.965 +03:00 [INF] Executed action NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI) in 11.1445ms
2025-02-05 00:31:11.968 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 00:31:11.969 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - 200 null application/json; charset=utf-8 22.8365ms
2025-02-05 00:31:12.972 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - application/json; charset=utf-8 49
2025-02-05 00:31:12.972 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/list - application/json; charset=utf-8 45
2025-02-05 00:31:12.976 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 00:31:12.978 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI)'
2025-02-05 00:31:12.979 +03:00 [INF] Route matched with {action = "MasterFetch", controller = "Content"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] MasterFetch(NayifatAPI.Controllers.MasterFetchRequest) on controller NayifatAPI.Controllers.ContentController (NayifatAPI).
2025-02-05 00:31:12.981 +03:00 [INF] Route matched with {action = "GetNotifications", controller = "Notifications"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetNotifications(NayifatAPI.Controllers.GetNotificationsRequest) on controller NayifatAPI.Controllers.NotificationsController (NayifatAPI).
2025-02-05 00:31:12.985 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 00:31:12.991 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__request_Page_0='?' (Size = 450), @__request_KeyName_1='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[config_id], [m].[key_name], [m].[last_updated], [m].[page], [m].[value]
FROM [master_config] AS [m]
WHERE [m].[page] = @__request_Page_0 AND [m].[key_name] = @__request_KeyName_1
2025-02-05 00:31:12.994 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 00:31:12.994 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 00:31:12.995 +03:00 [INF] Executed action NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI) in 11.9256ms
2025-02-05 00:31:12.998 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 00:31:12.999 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - 200 null application/json; charset=utf-8 26.9637ms
2025-02-05 00:31:13.000 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__request_NationalId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[national_id], [u].[last_updated], [u].[notifications]
FROM [user_notifications] AS [u]
WHERE [u].[national_id] = @__request_NationalId_0
2025-02-05 00:31:13.005 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 00:31:13.008 +03:00 [INF] Executed action NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI) in 22.1561ms
2025-02-05 00:31:13.010 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI)'
2025-02-05 00:31:13.011 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/list - 200 null application/json; charset=utf-8 38.3128ms
2025-02-05 00:31:14.093 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - application/json; charset=utf-8 49
2025-02-05 00:31:14.093 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/list - application/json; charset=utf-8 39
2025-02-05 00:31:14.099 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 00:31:14.107 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI)'
2025-02-05 00:31:14.108 +03:00 [INF] Route matched with {action = "MasterFetch", controller = "Content"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] MasterFetch(NayifatAPI.Controllers.MasterFetchRequest) on controller NayifatAPI.Controllers.ContentController (NayifatAPI).
2025-02-05 00:31:14.109 +03:00 [INF] Route matched with {action = "GetNotifications", controller = "Notifications"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetNotifications(NayifatAPI.Controllers.GetNotificationsRequest) on controller NayifatAPI.Controllers.NotificationsController (NayifatAPI).
2025-02-05 00:31:14.112 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 00:31:14.114 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 00:31:14.116 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__request_Page_0='?' (Size = 450), @__request_KeyName_1='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[config_id], [m].[key_name], [m].[last_updated], [m].[page], [m].[value]
FROM [master_config] AS [m]
WHERE [m].[page] = @__request_Page_0 AND [m].[key_name] = @__request_KeyName_1
2025-02-05 00:31:14.120 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__request_NationalId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[national_id], [u].[last_updated], [u].[notifications]
FROM [user_notifications] AS [u]
WHERE [u].[national_id] = @__request_NationalId_0
2025-02-05 00:31:14.121 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 00:31:14.123 +03:00 [INF] Executed action NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI) in 12.4848ms
2025-02-05 00:31:14.124 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__Parse_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [n].[Id], [n].[additional_data], [n].[Body], [n].[body_ar], [n].[body_en], [n].[created_at], [n].[expiry_at], [n].[Route], [n].[target_criteria], [n].[Title], [n].[title_ar], [n].[title_en]
FROM [notification_templates] AS [n]
WHERE [n].[Id] = @__Parse_0
2025-02-05 00:31:14.124 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 00:31:14.127 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - 200 null application/json; charset=utf-8 34.3265ms
2025-02-05 00:31:14.127 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__Parse_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [n].[Id], [n].[additional_data], [n].[Body], [n].[body_ar], [n].[body_en], [n].[created_at], [n].[expiry_at], [n].[Route], [n].[target_criteria], [n].[Title], [n].[title_ar], [n].[title_en]
FROM [notification_templates] AS [n]
WHERE [n].[Id] = @__Parse_0
2025-02-05 00:31:14.135 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[@p0='?' (Size = 4000), @p1='?' (DbType = DateTime2), @p2='?' (Size = 4000), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (Size = 450), @p6='?' (Size = 4000), @p7='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [AuthLogs] ([AuthType], [CreatedAt], [DeviceId], [FailureReason], [IpAddress], [NationalId], [Status], [UserAgent])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7);
2025-02-05 00:31:14.138 +03:00 [ERR] An exception occurred in the database while saving changes for context type 'NayifatAPI.Data.ApplicationDbContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_AuthLogs_Customers_NationalId". The conflict occurred in database "NayifatApp", table "dbo.Customers", column 'NationalId'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:2f1879bc-4a17-43c4-898a-feeaf6815d79
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_AuthLogs_Customers_NationalId". The conflict occurred in database "NayifatApp", table "dbo.Customers", column 'NationalId'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:2f1879bc-4a17-43c4-898a-feeaf6815d79
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2025-02-05 00:31:14.152 +03:00 [ERR] Error logging audit event. NationalId: all, Action: notification_delivered, Details: {"notification_count":2,"notification_ids":[4,3],"timestamp":"2025-02-05T00:31:14.1225044"}
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_AuthLogs_Customers_NationalId". The conflict occurred in database "NayifatApp", table "dbo.Customers", column 'NationalId'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:2f1879bc-4a17-43c4-898a-feeaf6815d79
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at NayifatAPI.Services.AuditLogService.LogAsync(String nationalId, String action, Object details) in C:\Users\yamta\StudioProjects\nayifat_app_2025_new\nayifatapi\Services\AuditLogService.cs:line 36
2025-02-05 00:31:14.163 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 00:31:14.164 +03:00 [INF] Executed action NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI) in 51.6772ms
2025-02-05 00:31:14.166 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI)'
2025-02-05 00:31:14.166 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/list - 200 null application/json; charset=utf-8 73.5536ms
2025-02-05 00:31:14.784 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - application/json; charset=utf-8 36
2025-02-05 00:31:14.788 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 00:31:14.790 +03:00 [INF] Route matched with {action = "MasterFetch", controller = "Content"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] MasterFetch(NayifatAPI.Controllers.MasterFetchRequest) on controller NayifatAPI.Controllers.ContentController (NayifatAPI).
2025-02-05 00:31:14.794 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 00:31:14.799 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__request_Page_0='?' (Size = 450), @__request_KeyName_1='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[config_id], [m].[key_name], [m].[last_updated], [m].[page], [m].[value]
FROM [master_config] AS [m]
WHERE [m].[page] = @__request_Page_0 AND [m].[key_name] = @__request_KeyName_1
2025-02-05 00:31:14.801 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 00:31:14.802 +03:00 [INF] Executed action NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI) in 9.7887ms
2025-02-05 00:31:14.803 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 00:31:14.804 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - 200 null application/json; charset=utf-8 19.9948ms
2025-02-05 00:31:16.367 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - application/json; charset=utf-8 36
2025-02-05 00:31:16.374 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 00:31:16.375 +03:00 [INF] Route matched with {action = "MasterFetch", controller = "Content"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] MasterFetch(NayifatAPI.Controllers.MasterFetchRequest) on controller NayifatAPI.Controllers.ContentController (NayifatAPI).
2025-02-05 00:31:16.378 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 00:31:16.382 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__request_Page_0='?' (Size = 450), @__request_KeyName_1='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[config_id], [m].[key_name], [m].[last_updated], [m].[page], [m].[value]
FROM [master_config] AS [m]
WHERE [m].[page] = @__request_Page_0 AND [m].[key_name] = @__request_KeyName_1
2025-02-05 00:31:16.384 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 00:31:16.385 +03:00 [INF] Executed action NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI) in 9.0102ms
2025-02-05 00:31:16.387 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 00:31:16.388 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - 200 null application/json; charset=utf-8 20.6915ms
2025-02-05 00:31:21.764 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/send - application/json 386
2025-02-05 00:31:21.768 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.NotificationsController.SendNotification (NayifatAPI)'
2025-02-05 00:31:21.774 +03:00 [INF] Route matched with {action = "SendNotification", controller = "Notifications"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] SendNotification(NayifatAPI.Controllers.SendNotificationRequest) on controller NayifatAPI.Controllers.NotificationsController (NayifatAPI).
2025-02-05 00:31:21.779 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 00:31:21.783 +03:00 [INF] Received notification request: {"Title":null,"TitleEn":"Test Notification English    11111","TitleAr":"اختبار الإشعار","Filters":null,"NationalId":"1064448614","NationalIds":null}
2025-02-05 00:31:21.790 +03:00 [INF] Starting GetTargetUsers with request type: Single User
2025-02-05 00:31:21.792 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__request_NationalId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[NationalId]
FROM [Customers] AS [c]
WHERE [c].[NationalId] = @__request_NationalId_0
2025-02-05 00:31:21.795 +03:00 [INF] Found 1 users matching national ID 1064448614
2025-02-05 00:31:21.797 +03:00 [INF] Target users query completed. Found 1 users
2025-02-05 00:31:21.802 +03:00 [INF] Found 1 target users for notification
2025-02-05 00:31:21.813 +03:00 [INF] Executed DbCommand (9ms) [Parameters=[@p0='?' (Size = 4000), @p1='?' (Size = 8000) (DbType = AnsiString), @p2='?' (Size = 4000), @p3='?' (Size = 8000) (DbType = AnsiString), @p4='?' (DbType = DateTime2), @p5='?' (DbType = DateTime2), @p6='?' (Size = 255), @p7='?' (Size = 4000), @p8='?' (Size = 255), @p9='?' (Size = 255), @p10='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [notification_templates] ([additional_data], [Body], [body_ar], [body_en], [created_at], [expiry_at], [Route], [target_criteria], [Title], [title_ar], [title_en])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10);
2025-02-05 00:31:21.816 +03:00 [INF] Created notification template with ID: 11
2025-02-05 00:31:21.819 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@p0='?' (Size = 4000), @p1='?' (DbType = DateTime2), @p2='?' (Size = 4000), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (Size = 450), @p6='?' (Size = 4000), @p7='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [AuthLogs] ([AuthType], [CreatedAt], [DeviceId], [FailureReason], [IpAddress], [NationalId], [Status], [UserAgent])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7);
2025-02-05 00:31:21.826 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__userId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[national_id], [u].[last_updated], [u].[notifications]
FROM [user_notifications] AS [u]
WHERE [u].[national_id] = @__userId_0
2025-02-05 00:31:21.828 +03:00 [INF] Processing notification for user 1064448614. Existing notification record: true
2025-02-05 00:31:21.830 +03:00 [INF] Current notifications count for user 1064448614: 6
2025-02-05 00:31:21.830 +03:00 [INF] Serialized new notifications for user 1064448614. Length: 1099
2025-02-05 00:31:21.837 +03:00 [INF] Executed DbCommand (5ms) [Parameters=[@p0='?' (Size = 4000), @p1='?' (DbType = DateTime2), @p2='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
UPDATE user_notifications SET notifications = @p0, last_updated = @p1 WHERE national_id = @p2
2025-02-05 00:31:21.839 +03:00 [INF] Updated existing UserNotification for user: 1064448614
2025-02-05 00:31:21.841 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@p0='?' (Size = 4000), @p1='?' (DbType = DateTime2), @p2='?' (Size = 4000), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (Size = 450), @p6='?' (Size = 4000), @p7='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [AuthLogs] ([AuthType], [CreatedAt], [DeviceId], [FailureReason], [IpAddress], [NationalId], [Status], [UserAgent])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7);
2025-02-05 00:31:21.842 +03:00 [INF] Successfully sent notifications. Template: 11, Success: 1, Total: 1
2025-02-05 00:31:21.843 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 00:31:21.845 +03:00 [INF] Executed action NayifatAPI.Controllers.NotificationsController.SendNotification (NayifatAPI) in 68.0208ms
2025-02-05 00:31:21.846 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.NotificationsController.SendNotification (NayifatAPI)'
2025-02-05 00:31:21.848 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/send - 200 null application/json; charset=utf-8 83.1955ms
2025-02-05 00:33:24.452 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/list - application/json; charset=utf-8 45
2025-02-05 00:33:24.453 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/list - application/json; charset=utf-8 45
2025-02-05 00:33:24.453 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/list - application/json; charset=utf-8 45
2025-02-05 00:33:24.453 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/list - application/json; charset=utf-8 45
2025-02-05 00:33:24.454 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/list - application/json; charset=utf-8 45
2025-02-05 00:33:24.454 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/list - application/json; charset=utf-8 45
2025-02-05 00:33:24.454 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/list - application/json; charset=utf-8 45
2025-02-05 00:33:24.454 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/list - application/json; charset=utf-8 45
2025-02-05 00:33:24.465 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI)'
2025-02-05 00:33:24.472 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI)'
2025-02-05 00:33:24.474 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI)'
2025-02-05 00:33:24.475 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI)'
2025-02-05 00:33:24.477 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI)'
2025-02-05 00:33:24.478 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI)'
2025-02-05 00:33:24.479 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI)'
2025-02-05 00:33:24.480 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI)'
2025-02-05 00:33:24.481 +03:00 [INF] Route matched with {action = "GetNotifications", controller = "Notifications"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetNotifications(NayifatAPI.Controllers.GetNotificationsRequest) on controller NayifatAPI.Controllers.NotificationsController (NayifatAPI).
2025-02-05 00:33:24.482 +03:00 [INF] Route matched with {action = "GetNotifications", controller = "Notifications"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetNotifications(NayifatAPI.Controllers.GetNotificationsRequest) on controller NayifatAPI.Controllers.NotificationsController (NayifatAPI).
2025-02-05 00:33:24.482 +03:00 [INF] Route matched with {action = "GetNotifications", controller = "Notifications"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetNotifications(NayifatAPI.Controllers.GetNotificationsRequest) on controller NayifatAPI.Controllers.NotificationsController (NayifatAPI).
2025-02-05 00:33:24.483 +03:00 [INF] Route matched with {action = "GetNotifications", controller = "Notifications"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetNotifications(NayifatAPI.Controllers.GetNotificationsRequest) on controller NayifatAPI.Controllers.NotificationsController (NayifatAPI).
2025-02-05 00:33:24.484 +03:00 [INF] Route matched with {action = "GetNotifications", controller = "Notifications"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetNotifications(NayifatAPI.Controllers.GetNotificationsRequest) on controller NayifatAPI.Controllers.NotificationsController (NayifatAPI).
2025-02-05 00:33:24.484 +03:00 [INF] Route matched with {action = "GetNotifications", controller = "Notifications"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetNotifications(NayifatAPI.Controllers.GetNotificationsRequest) on controller NayifatAPI.Controllers.NotificationsController (NayifatAPI).
2025-02-05 00:33:24.485 +03:00 [INF] Route matched with {action = "GetNotifications", controller = "Notifications"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetNotifications(NayifatAPI.Controllers.GetNotificationsRequest) on controller NayifatAPI.Controllers.NotificationsController (NayifatAPI).
2025-02-05 00:33:24.486 +03:00 [INF] Route matched with {action = "GetNotifications", controller = "Notifications"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetNotifications(NayifatAPI.Controllers.GetNotificationsRequest) on controller NayifatAPI.Controllers.NotificationsController (NayifatAPI).
2025-02-05 00:33:24.490 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 00:33:24.494 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 00:33:24.497 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 00:33:24.499 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 00:33:24.500 +03:00 [INF] Executed DbCommand (12ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 00:33:24.500 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 00:33:24.501 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 00:33:24.503 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__request_NationalId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[national_id], [u].[last_updated], [u].[notifications]
FROM [user_notifications] AS [u]
WHERE [u].[national_id] = @__request_NationalId_0
2025-02-05 00:33:24.503 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__request_NationalId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[national_id], [u].[last_updated], [u].[notifications]
FROM [user_notifications] AS [u]
WHERE [u].[national_id] = @__request_NationalId_0
2025-02-05 00:33:24.504 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 00:33:24.505 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__request_NationalId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[national_id], [u].[last_updated], [u].[notifications]
FROM [user_notifications] AS [u]
WHERE [u].[national_id] = @__request_NationalId_0
2025-02-05 00:33:24.506 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__request_NationalId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[national_id], [u].[last_updated], [u].[notifications]
FROM [user_notifications] AS [u]
WHERE [u].[national_id] = @__request_NationalId_0
2025-02-05 00:33:24.507 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 00:33:24.508 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__request_NationalId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[national_id], [u].[last_updated], [u].[notifications]
FROM [user_notifications] AS [u]
WHERE [u].[national_id] = @__request_NationalId_0
2025-02-05 00:33:24.508 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__request_NationalId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[national_id], [u].[last_updated], [u].[notifications]
FROM [user_notifications] AS [u]
WHERE [u].[national_id] = @__request_NationalId_0
2025-02-05 00:33:24.509 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 00:33:24.510 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__request_NationalId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[national_id], [u].[last_updated], [u].[notifications]
FROM [user_notifications] AS [u]
WHERE [u].[national_id] = @__request_NationalId_0
2025-02-05 00:33:24.511 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 00:33:24.511 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__request_NationalId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[national_id], [u].[last_updated], [u].[notifications]
FROM [user_notifications] AS [u]
WHERE [u].[national_id] = @__request_NationalId_0
2025-02-05 00:33:24.513 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 00:33:24.513 +03:00 [INF] Executed action NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI) in 25.0941ms
2025-02-05 00:33:24.515 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 00:33:24.516 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 00:33:24.517 +03:00 [INF] Executed action NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI) in 27.7016ms
2025-02-05 00:33:24.518 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 00:33:24.519 +03:00 [INF] Executed action NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI) in 24.6091ms
2025-02-05 00:33:24.520 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 00:33:24.521 +03:00 [INF] Executed action NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI) in 30.1946ms
2025-02-05 00:33:24.522 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI)'
2025-02-05 00:33:24.522 +03:00 [INF] Executed action NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI) in 29.0275ms
2025-02-05 00:33:24.523 +03:00 [INF] Executed action NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI) in 31.0038ms
2025-02-05 00:33:24.524 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI)'
2025-02-05 00:33:24.524 +03:00 [INF] Executed action NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI) in 28.6707ms
2025-02-05 00:33:24.525 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI)'
2025-02-05 00:33:24.526 +03:00 [INF] Executed action NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI) in 38.555ms
2025-02-05 00:33:24.526 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI)'
2025-02-05 00:33:24.527 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/list - 200 null application/json; charset=utf-8 74.1065ms
2025-02-05 00:33:24.528 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI)'
2025-02-05 00:33:24.528 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI)'
2025-02-05 00:33:24.529 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/list - 200 null application/json; charset=utf-8 75.7898ms
2025-02-05 00:33:24.529 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI)'
2025-02-05 00:33:24.530 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/list - 200 null application/json; charset=utf-8 75.9581ms
2025-02-05 00:33:24.531 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI)'
2025-02-05 00:33:24.531 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/list - 200 null application/json; charset=utf-8 78.1522ms
2025-02-05 00:33:24.534 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/list - 200 null application/json; charset=utf-8 79.7583ms
2025-02-05 00:33:24.534 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/list - 200 null application/json; charset=utf-8 80.8095ms
2025-02-05 00:33:24.537 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/list - 200 null application/json; charset=utf-8 82.8076ms
2025-02-05 00:33:24.540 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/list - 200 null application/json; charset=utf-8 87.1751ms
2025-02-05 00:42:30.202 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/list - application/json; charset=utf-8 45
2025-02-05 00:42:30.208 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI)'
2025-02-05 00:42:30.209 +03:00 [INF] Route matched with {action = "GetNotifications", controller = "Notifications"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetNotifications(NayifatAPI.Controllers.GetNotificationsRequest) on controller NayifatAPI.Controllers.NotificationsController (NayifatAPI).
2025-02-05 00:42:30.221 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 00:42:30.225 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__request_NationalId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[national_id], [u].[last_updated], [u].[notifications]
FROM [user_notifications] AS [u]
WHERE [u].[national_id] = @__request_NationalId_0
2025-02-05 00:42:30.228 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__Parse_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [n].[Id], [n].[additional_data], [n].[Body], [n].[body_ar], [n].[body_en], [n].[created_at], [n].[expiry_at], [n].[Route], [n].[target_criteria], [n].[Title], [n].[title_ar], [n].[title_en]
FROM [notification_templates] AS [n]
WHERE [n].[Id] = @__Parse_0
2025-02-05 00:42:30.305 +03:00 [INF] Executed DbCommand (76ms) [Parameters=[@p0='?' (Size = 4000), @p1='?' (DbType = DateTime2), @p2='?' (Size = 4000), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (Size = 450), @p6='?' (Size = 4000), @p7='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [AuthLogs] ([AuthType], [CreatedAt], [DeviceId], [FailureReason], [IpAddress], [NationalId], [Status], [UserAgent])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7);
2025-02-05 00:42:30.326 +03:00 [INF] Executed DbCommand (11ms) [Parameters=[@p0='?' (Size = 4000), @p1='?' (DbType = DateTime2), @p2='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
UPDATE user_notifications SET notifications = @p0, last_updated = @p1 WHERE national_id = @p2
2025-02-05 00:42:30.336 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@p0='?' (Size = 4000), @p1='?' (DbType = DateTime2), @p2='?' (Size = 4000), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (Size = 450), @p6='?' (Size = 4000), @p7='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [AuthLogs] ([AuthType], [CreatedAt], [DeviceId], [FailureReason], [IpAddress], [NationalId], [Status], [UserAgent])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7);
2025-02-05 00:42:30.339 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 00:42:30.340 +03:00 [INF] Executed action NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI) in 129.9777ms
2025-02-05 00:42:30.341 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI)'
2025-02-05 00:42:30.342 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/list - 200 null application/json; charset=utf-8 140.5234ms
2025-02-05 00:42:31.538 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/list - application/json; charset=utf-8 39
2025-02-05 00:42:31.547 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI)'
2025-02-05 00:42:31.548 +03:00 [INF] Route matched with {action = "GetNotifications", controller = "Notifications"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetNotifications(NayifatAPI.Controllers.GetNotificationsRequest) on controller NayifatAPI.Controllers.NotificationsController (NayifatAPI).
2025-02-05 00:42:31.553 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 00:42:31.557 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__request_NationalId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[national_id], [u].[last_updated], [u].[notifications]
FROM [user_notifications] AS [u]
WHERE [u].[national_id] = @__request_NationalId_0
2025-02-05 00:42:31.560 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__Parse_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [n].[Id], [n].[additional_data], [n].[Body], [n].[body_ar], [n].[body_en], [n].[created_at], [n].[expiry_at], [n].[Route], [n].[target_criteria], [n].[Title], [n].[title_ar], [n].[title_en]
FROM [notification_templates] AS [n]
WHERE [n].[Id] = @__Parse_0
2025-02-05 00:42:31.562 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__Parse_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [n].[Id], [n].[additional_data], [n].[Body], [n].[body_ar], [n].[body_en], [n].[created_at], [n].[expiry_at], [n].[Route], [n].[target_criteria], [n].[Title], [n].[title_ar], [n].[title_en]
FROM [notification_templates] AS [n]
WHERE [n].[Id] = @__Parse_0
2025-02-05 00:42:31.571 +03:00 [INF] Executed DbCommand (7ms) [Parameters=[@p0='?' (Size = 4000), @p1='?' (DbType = DateTime2), @p2='?' (Size = 4000), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (Size = 450), @p6='?' (Size = 4000), @p7='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [AuthLogs] ([AuthType], [CreatedAt], [DeviceId], [FailureReason], [IpAddress], [NationalId], [Status], [UserAgent])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7);
2025-02-05 00:42:31.573 +03:00 [ERR] An exception occurred in the database while saving changes for context type 'NayifatAPI.Data.ApplicationDbContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_AuthLogs_Customers_NationalId". The conflict occurred in database "NayifatApp", table "dbo.Customers", column 'NationalId'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:7c2e1ad9-645b-4789-a1ff-95d3f78f7563
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_AuthLogs_Customers_NationalId". The conflict occurred in database "NayifatApp", table "dbo.Customers", column 'NationalId'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:7c2e1ad9-645b-4789-a1ff-95d3f78f7563
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2025-02-05 00:42:31.581 +03:00 [ERR] Error logging audit event. NationalId: all, Action: notification_delivered, Details: {"notification_count":2,"notification_ids":[4,3],"timestamp":"2025-02-05T00:42:31.5591933"}
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_AuthLogs_Customers_NationalId". The conflict occurred in database "NayifatApp", table "dbo.Customers", column 'NationalId'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:7c2e1ad9-645b-4789-a1ff-95d3f78f7563
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at NayifatAPI.Services.AuditLogService.LogAsync(String nationalId, String action, Object details) in C:\Users\yamta\StudioProjects\nayifat_app_2025_new\nayifatapi\Services\AuditLogService.cs:line 36
2025-02-05 00:42:31.588 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 00:42:31.589 +03:00 [INF] Executed action NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI) in 38.2329ms
2025-02-05 00:42:31.590 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI)'
2025-02-05 00:42:31.591 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/list - 200 null application/json; charset=utf-8 52.7689ms
2025-02-05 00:42:45.431 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/timestamps - application/json; charset=utf-8 2
2025-02-05 00:42:45.440 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.ContentController.GetTimestamps (NayifatAPI)'
2025-02-05 00:42:45.441 +03:00 [INF] Route matched with {action = "GetTimestamps", controller = "Content"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetTimestamps() on controller NayifatAPI.Controllers.ContentController (NayifatAPI).
2025-02-05 00:42:45.442 +03:00 [INF] TTT_
2025-02-05 00:42:45.443 +03:00 [INF] TTT_=== Getting Content Timestamps ===
2025-02-05 00:42:45.447 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 00:42:45.448 +03:00 [INF] TTT_Fetching timestamps from database
2025-02-05 00:42:45.451 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [m].[page] AS [Page], [m].[key_name] AS [KeyName], [m].[last_updated] AS [LastUpdated]
FROM [master_config] AS [m]
2025-02-05 00:42:45.453 +03:00 [INF] TTT_Found 18 content items
2025-02-05 00:42:45.453 +03:00 [INF] TTT_Page: home
2025-02-05 00:42:45.454 +03:00 [INF] TTT_  - slideshow_content: "2025-02-04T10:01:06.9430000"
2025-02-05 00:42:45.455 +03:00 [INF] TTT_  - slideshow_content_ar: "2025-02-04T10:01:06.9430000"
2025-02-05 00:42:45.455 +03:00 [INF] TTT_  - contact_details: "2025-02-04T10:01:06.9430000"
2025-02-05 00:42:45.456 +03:00 [INF] TTT_  - contact_details_ar: "2025-02-04T10:01:06.9430000"
2025-02-05 00:42:45.456 +03:00 [INF] TTT_  - termsEN1: "2025-02-03T14:23:58.0000000"
2025-02-05 00:42:45.457 +03:00 [INF] TTT_  - termsEN2: "2025-02-03T14:25:20.1730000"
2025-02-05 00:42:45.458 +03:00 [INF] TTT_  - privacyEN1: "2025-02-03T14:26:08.6130000"
2025-02-05 00:42:45.458 +03:00 [INF] TTT_  - privacyEN2: "2025-02-03T14:25:20.1730000"
2025-02-05 00:42:45.459 +03:00 [INF] TTT_  - termsAR1: "2025-02-03T14:23:58.0000000"
2025-02-05 00:42:45.459 +03:00 [INF] TTT_  - termsAR2: "2025-02-03T14:25:20.1730000"
2025-02-05 00:42:45.460 +03:00 [INF] TTT_  - privacyAR1: "2025-02-03T14:26:08.6130000"
2025-02-05 00:42:45.461 +03:00 [INF] TTT_  - privacyAR2: "2025-02-03T14:25:20.1730000"
2025-02-05 00:42:45.461 +03:00 [INF] TTT_  - terms&conditionsCC_AR: "2025-02-03T17:06:57.7700000"
2025-02-05 00:42:45.462 +03:00 [INF] TTT_  - terms&conditionsCC_EN: "2025-02-03T17:07:47.4900000"
2025-02-05 00:42:45.462 +03:00 [INF] TTT_  - terms&conditionsPF_AR: "2025-02-03T17:06:57.7700000"
2025-02-05 00:42:45.463 +03:00 [INF] TTT_  - terms&conditionsPF_EN: "2025-02-03T17:06:57.7700000"
2025-02-05 00:42:45.464 +03:00 [INF] TTT_Page: loans
2025-02-05 00:42:45.464 +03:00 [INF] TTT_  - loan_ad: "2025-02-04T10:01:06.9430000"
2025-02-05 00:42:45.465 +03:00 [INF] TTT_Page: cards
2025-02-05 00:42:45.465 +03:00 [INF] TTT_  - card_ad: "2025-02-04T10:01:06.9430000"
2025-02-05 00:42:45.466 +03:00 [INF] TTT_Successfully retrieved all timestamps
2025-02-05 00:42:45.467 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 00:42:45.467 +03:00 [INF] Executed action NayifatAPI.Controllers.ContentController.GetTimestamps (NayifatAPI) in 25.0875ms
2025-02-05 00:42:45.468 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.ContentController.GetTimestamps (NayifatAPI)'
2025-02-05 00:42:45.469 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/timestamps - 200 null application/json; charset=utf-8 38.1519ms
2025-02-05 00:42:46.460 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - application/json; charset=utf-8 45
2025-02-05 00:42:46.467 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 00:42:46.468 +03:00 [INF] Route matched with {action = "MasterFetch", controller = "Content"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] MasterFetch(NayifatAPI.Controllers.MasterFetchRequest) on controller NayifatAPI.Controllers.ContentController (NayifatAPI).
2025-02-05 00:42:46.475 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 00:42:46.482 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[@__request_Page_0='?' (Size = 450), @__request_KeyName_1='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[config_id], [m].[key_name], [m].[last_updated], [m].[page], [m].[value]
FROM [master_config] AS [m]
WHERE [m].[page] = @__request_Page_0 AND [m].[key_name] = @__request_KeyName_1
2025-02-05 00:42:46.486 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 00:42:46.493 +03:00 [INF] Executed action NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI) in 21.5877ms
2025-02-05 00:42:46.499 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 00:42:46.501 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - 200 null application/json; charset=utf-8 40.9576ms
2025-02-05 00:42:50.842 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - application/json; charset=utf-8 48
2025-02-05 00:42:50.852 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 00:42:50.853 +03:00 [INF] Route matched with {action = "MasterFetch", controller = "Content"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] MasterFetch(NayifatAPI.Controllers.MasterFetchRequest) on controller NayifatAPI.Controllers.ContentController (NayifatAPI).
2025-02-05 00:42:50.858 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 00:42:50.863 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__request_Page_0='?' (Size = 450), @__request_KeyName_1='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[config_id], [m].[key_name], [m].[last_updated], [m].[page], [m].[value]
FROM [master_config] AS [m]
WHERE [m].[page] = @__request_Page_0 AND [m].[key_name] = @__request_KeyName_1
2025-02-05 00:42:50.864 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 00:42:50.865 +03:00 [INF] Executed action NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI) in 10.8986ms
2025-02-05 00:42:50.866 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 00:42:50.867 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - 200 null application/json; charset=utf-8 24.7966ms
2025-02-05 00:42:55.519 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/list - application/json; charset=utf-8 45
2025-02-05 00:42:55.521 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI)'
2025-02-05 00:42:55.522 +03:00 [INF] Route matched with {action = "GetNotifications", controller = "Notifications"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetNotifications(NayifatAPI.Controllers.GetNotificationsRequest) on controller NayifatAPI.Controllers.NotificationsController (NayifatAPI).
2025-02-05 00:42:55.525 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 00:42:55.529 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__request_NationalId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[national_id], [u].[last_updated], [u].[notifications]
FROM [user_notifications] AS [u]
WHERE [u].[national_id] = @__request_NationalId_0
2025-02-05 00:42:55.530 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 00:42:55.531 +03:00 [INF] Executed action NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI) in 8.3725ms
2025-02-05 00:42:55.532 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI)'
2025-02-05 00:42:55.533 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/list - 200 null application/json; charset=utf-8 13.6694ms
2025-02-05 00:42:56.772 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/list - application/json; charset=utf-8 39
2025-02-05 00:42:56.784 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI)'
2025-02-05 00:42:56.785 +03:00 [INF] Route matched with {action = "GetNotifications", controller = "Notifications"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetNotifications(NayifatAPI.Controllers.GetNotificationsRequest) on controller NayifatAPI.Controllers.NotificationsController (NayifatAPI).
2025-02-05 00:42:56.789 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 00:42:56.792 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__request_NationalId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[national_id], [u].[last_updated], [u].[notifications]
FROM [user_notifications] AS [u]
WHERE [u].[national_id] = @__request_NationalId_0
2025-02-05 00:42:56.796 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__Parse_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [n].[Id], [n].[additional_data], [n].[Body], [n].[body_ar], [n].[body_en], [n].[created_at], [n].[expiry_at], [n].[Route], [n].[target_criteria], [n].[Title], [n].[title_ar], [n].[title_en]
FROM [notification_templates] AS [n]
WHERE [n].[Id] = @__Parse_0
2025-02-05 00:42:56.800 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__Parse_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [n].[Id], [n].[additional_data], [n].[Body], [n].[body_ar], [n].[body_en], [n].[created_at], [n].[expiry_at], [n].[Route], [n].[target_criteria], [n].[Title], [n].[title_ar], [n].[title_en]
FROM [notification_templates] AS [n]
WHERE [n].[Id] = @__Parse_0
2025-02-05 00:42:56.805 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@p0='?' (Size = 4000), @p1='?' (DbType = DateTime2), @p2='?' (Size = 4000), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (Size = 450), @p6='?' (Size = 4000), @p7='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [AuthLogs] ([AuthType], [CreatedAt], [DeviceId], [FailureReason], [IpAddress], [NationalId], [Status], [UserAgent])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7);
2025-02-05 00:42:56.807 +03:00 [ERR] An exception occurred in the database while saving changes for context type 'NayifatAPI.Data.ApplicationDbContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_AuthLogs_Customers_NationalId". The conflict occurred in database "NayifatApp", table "dbo.Customers", column 'NationalId'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:7c2e1ad9-645b-4789-a1ff-95d3f78f7563
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_AuthLogs_Customers_NationalId". The conflict occurred in database "NayifatApp", table "dbo.Customers", column 'NationalId'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:7c2e1ad9-645b-4789-a1ff-95d3f78f7563
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2025-02-05 00:42:56.816 +03:00 [ERR] Error logging audit event. NationalId: all, Action: notification_delivered, Details: {"notification_count":2,"notification_ids":[4,3],"timestamp":"2025-02-05T00:42:56.7943918"}
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_AuthLogs_Customers_NationalId". The conflict occurred in database "NayifatApp", table "dbo.Customers", column 'NationalId'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:7c2e1ad9-645b-4789-a1ff-95d3f78f7563
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at NayifatAPI.Services.AuditLogService.LogAsync(String nationalId, String action, Object details) in C:\Users\yamta\StudioProjects\nayifat_app_2025_new\nayifatapi\Services\AuditLogService.cs:line 36
2025-02-05 00:42:56.823 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 00:42:56.823 +03:00 [INF] Executed action NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI) in 36.7419ms
2025-02-05 00:42:56.824 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI)'
2025-02-05 00:42:56.825 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/list - 200 null application/json; charset=utf-8 53.2965ms
2025-02-05 00:42:58.505 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/device/unregister - application/json; charset=utf-8 174
2025-02-05 00:42:58.510 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/device/unregister - 404 0 null 4.0695ms
2025-02-05 00:42:58.511 +03:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: POST http://45f9-51-252-155-185.ngrok-free.app/api/device/unregister, Response status code: 404
2025-02-05 00:42:58.665 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - application/json; charset=utf-8 43
2025-02-05 00:42:58.668 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 00:42:58.669 +03:00 [INF] Route matched with {action = "MasterFetch", controller = "Content"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] MasterFetch(NayifatAPI.Controllers.MasterFetchRequest) on controller NayifatAPI.Controllers.ContentController (NayifatAPI).
2025-02-05 00:42:58.676 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 00:42:58.686 +03:00 [INF] Executed DbCommand (7ms) [Parameters=[@__request_Page_0='?' (Size = 450), @__request_KeyName_1='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[config_id], [m].[key_name], [m].[last_updated], [m].[page], [m].[value]
FROM [master_config] AS [m]
WHERE [m].[page] = @__request_Page_0 AND [m].[key_name] = @__request_KeyName_1
2025-02-05 00:42:58.688 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 00:42:58.689 +03:00 [INF] Executed action NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI) in 16.8414ms
2025-02-05 00:42:58.690 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 00:42:58.691 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - 200 null application/json; charset=utf-8 26.0903ms
2025-02-05 00:43:00.574 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - application/json; charset=utf-8 46
2025-02-05 00:43:00.589 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 00:43:00.591 +03:00 [INF] Route matched with {action = "MasterFetch", controller = "Content"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] MasterFetch(NayifatAPI.Controllers.MasterFetchRequest) on controller NayifatAPI.Controllers.ContentController (NayifatAPI).
2025-02-05 00:43:00.597 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 00:43:00.603 +03:00 [INF] Executed DbCommand (5ms) [Parameters=[@__request_Page_0='?' (Size = 450), @__request_KeyName_1='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[config_id], [m].[key_name], [m].[last_updated], [m].[page], [m].[value]
FROM [master_config] AS [m]
WHERE [m].[page] = @__request_Page_0 AND [m].[key_name] = @__request_KeyName_1
2025-02-05 00:43:00.606 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 00:43:00.607 +03:00 [INF] Executed action NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI) in 13.541ms
2025-02-05 00:43:00.608 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 00:43:00.609 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - 200 null application/json; charset=utf-8 35.1222ms
2025-02-05 00:43:01.448 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - application/json; charset=utf-8 36
2025-02-05 00:43:01.452 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 00:43:01.453 +03:00 [INF] Route matched with {action = "MasterFetch", controller = "Content"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] MasterFetch(NayifatAPI.Controllers.MasterFetchRequest) on controller NayifatAPI.Controllers.ContentController (NayifatAPI).
2025-02-05 00:43:01.458 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 00:43:01.463 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__request_Page_0='?' (Size = 450), @__request_KeyName_1='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[config_id], [m].[key_name], [m].[last_updated], [m].[page], [m].[value]
FROM [master_config] AS [m]
WHERE [m].[page] = @__request_Page_0 AND [m].[key_name] = @__request_KeyName_1
2025-02-05 00:43:01.464 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 00:43:01.465 +03:00 [INF] Executed action NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI) in 10.5106ms
2025-02-05 00:43:01.467 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 00:43:01.468 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - 200 null application/json; charset=utf-8 19.9482ms
2025-02-05 00:43:02.506 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - application/json; charset=utf-8 36
2025-02-05 00:43:02.508 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 00:43:02.510 +03:00 [INF] Route matched with {action = "MasterFetch", controller = "Content"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] MasterFetch(NayifatAPI.Controllers.MasterFetchRequest) on controller NayifatAPI.Controllers.ContentController (NayifatAPI).
2025-02-05 00:43:02.515 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 00:43:02.519 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[@__request_Page_0='?' (Size = 450), @__request_KeyName_1='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[config_id], [m].[key_name], [m].[last_updated], [m].[page], [m].[value]
FROM [master_config] AS [m]
WHERE [m].[page] = @__request_Page_0 AND [m].[key_name] = @__request_KeyName_1
2025-02-05 00:43:02.521 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 00:43:02.522 +03:00 [INF] Executed action NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI) in 9.9754ms
2025-02-05 00:43:02.523 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 00:43:02.524 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - 200 null application/json; charset=utf-8 18.8644ms
2025-02-05 00:43:03.753 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - application/json; charset=utf-8 38
2025-02-05 00:43:03.761 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 00:43:03.762 +03:00 [INF] Route matched with {action = "MasterFetch", controller = "Content"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] MasterFetch(NayifatAPI.Controllers.MasterFetchRequest) on controller NayifatAPI.Controllers.ContentController (NayifatAPI).
2025-02-05 00:43:03.766 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 00:43:03.769 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__request_Page_0='?' (Size = 450), @__request_KeyName_1='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[config_id], [m].[key_name], [m].[last_updated], [m].[page], [m].[value]
FROM [master_config] AS [m]
WHERE [m].[page] = @__request_Page_0 AND [m].[key_name] = @__request_KeyName_1
2025-02-05 00:43:03.771 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 00:43:03.772 +03:00 [INF] Executed action NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI) in 8.7659ms
2025-02-05 00:43:03.773 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 00:43:03.774 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - 200 null application/json; charset=utf-8 20.4919ms
2025-02-05 00:43:04.478 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - application/json; charset=utf-8 38
2025-02-05 00:43:04.482 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 00:43:04.484 +03:00 [INF] Route matched with {action = "MasterFetch", controller = "Content"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] MasterFetch(NayifatAPI.Controllers.MasterFetchRequest) on controller NayifatAPI.Controllers.ContentController (NayifatAPI).
2025-02-05 00:43:04.490 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 00:43:04.495 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__request_Page_0='?' (Size = 450), @__request_KeyName_1='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[config_id], [m].[key_name], [m].[last_updated], [m].[page], [m].[value]
FROM [master_config] AS [m]
WHERE [m].[page] = @__request_Page_0 AND [m].[key_name] = @__request_KeyName_1
2025-02-05 00:43:04.498 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 00:43:04.499 +03:00 [INF] Executed action NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI) in 11.4505ms
2025-02-05 00:43:04.500 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 00:43:04.500 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - 200 null application/json; charset=utf-8 22.0541ms
2025-02-05 00:43:05.378 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - application/json; charset=utf-8 36
2025-02-05 00:43:05.388 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 00:43:05.389 +03:00 [INF] Route matched with {action = "MasterFetch", controller = "Content"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] MasterFetch(NayifatAPI.Controllers.MasterFetchRequest) on controller NayifatAPI.Controllers.ContentController (NayifatAPI).
2025-02-05 00:43:05.394 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 00:43:05.400 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[@__request_Page_0='?' (Size = 450), @__request_KeyName_1='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[config_id], [m].[key_name], [m].[last_updated], [m].[page], [m].[value]
FROM [master_config] AS [m]
WHERE [m].[page] = @__request_Page_0 AND [m].[key_name] = @__request_KeyName_1
2025-02-05 00:43:05.402 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 00:43:05.402 +03:00 [INF] Executed action NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI) in 11.6017ms
2025-02-05 00:43:05.403 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 00:43:05.404 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - 200 null application/json; charset=utf-8 25.603ms
2025-02-05 00:43:06.326 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - application/json; charset=utf-8 36
2025-02-05 00:43:06.335 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 00:43:06.336 +03:00 [INF] Route matched with {action = "MasterFetch", controller = "Content"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] MasterFetch(NayifatAPI.Controllers.MasterFetchRequest) on controller NayifatAPI.Controllers.ContentController (NayifatAPI).
2025-02-05 00:43:06.340 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 00:43:06.344 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__request_Page_0='?' (Size = 450), @__request_KeyName_1='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[config_id], [m].[key_name], [m].[last_updated], [m].[page], [m].[value]
FROM [master_config] AS [m]
WHERE [m].[page] = @__request_Page_0 AND [m].[key_name] = @__request_KeyName_1
2025-02-05 00:43:06.346 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 00:43:06.347 +03:00 [INF] Executed action NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI) in 9.3195ms
2025-02-05 00:43:06.348 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 00:43:06.348 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - 200 null application/json; charset=utf-8 22.2823ms
2025-02-05 00:43:07.272 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - application/json; charset=utf-8 38
2025-02-05 00:43:07.276 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 00:43:07.278 +03:00 [INF] Route matched with {action = "MasterFetch", controller = "Content"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] MasterFetch(NayifatAPI.Controllers.MasterFetchRequest) on controller NayifatAPI.Controllers.ContentController (NayifatAPI).
2025-02-05 00:43:07.285 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 00:43:07.289 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__request_Page_0='?' (Size = 450), @__request_KeyName_1='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[config_id], [m].[key_name], [m].[last_updated], [m].[page], [m].[value]
FROM [master_config] AS [m]
WHERE [m].[page] = @__request_Page_0 AND [m].[key_name] = @__request_KeyName_1
2025-02-05 00:43:07.291 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 00:43:07.293 +03:00 [INF] Executed action NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI) in 12.2411ms
2025-02-05 00:43:07.294 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 00:43:07.295 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - 200 null application/json; charset=utf-8 22.8256ms
2025-02-05 00:43:08.136 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - application/json; charset=utf-8 38
2025-02-05 00:43:08.139 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 00:43:08.140 +03:00 [INF] Route matched with {action = "MasterFetch", controller = "Content"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] MasterFetch(NayifatAPI.Controllers.MasterFetchRequest) on controller NayifatAPI.Controllers.ContentController (NayifatAPI).
2025-02-05 00:43:08.144 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 00:43:08.148 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__request_Page_0='?' (Size = 450), @__request_KeyName_1='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[config_id], [m].[key_name], [m].[last_updated], [m].[page], [m].[value]
FROM [master_config] AS [m]
WHERE [m].[page] = @__request_Page_0 AND [m].[key_name] = @__request_KeyName_1
2025-02-05 00:43:08.150 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 00:43:08.152 +03:00 [INF] Executed action NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI) in 10.2918ms
2025-02-05 00:43:08.154 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 00:43:08.155 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - 200 null application/json; charset=utf-8 18.1726ms
2025-02-05 00:43:08.950 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - application/json; charset=utf-8 49
2025-02-05 00:43:08.957 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 00:43:08.961 +03:00 [INF] Route matched with {action = "MasterFetch", controller = "Content"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] MasterFetch(NayifatAPI.Controllers.MasterFetchRequest) on controller NayifatAPI.Controllers.ContentController (NayifatAPI).
2025-02-05 00:43:08.969 +03:00 [INF] Executed DbCommand (4ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 00:43:08.979 +03:00 [INF] Executed DbCommand (4ms) [Parameters=[@__request_Page_0='?' (Size = 450), @__request_KeyName_1='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[config_id], [m].[key_name], [m].[last_updated], [m].[page], [m].[value]
FROM [master_config] AS [m]
WHERE [m].[page] = @__request_Page_0 AND [m].[key_name] = @__request_KeyName_1
2025-02-05 00:43:08.985 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 00:43:08.986 +03:00 [INF] Executed action NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI) in 22.0833ms
2025-02-05 00:43:08.988 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 00:43:08.991 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - 200 null application/json; charset=utf-8 41.1165ms
2025-02-05 00:43:09.885 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - application/json; charset=utf-8 49
2025-02-05 00:43:09.892 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 00:43:09.893 +03:00 [INF] Route matched with {action = "MasterFetch", controller = "Content"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] MasterFetch(NayifatAPI.Controllers.MasterFetchRequest) on controller NayifatAPI.Controllers.ContentController (NayifatAPI).
2025-02-05 00:43:09.899 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 00:43:09.903 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__request_Page_0='?' (Size = 450), @__request_KeyName_1='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[config_id], [m].[key_name], [m].[last_updated], [m].[page], [m].[value]
FROM [master_config] AS [m]
WHERE [m].[page] = @__request_Page_0 AND [m].[key_name] = @__request_KeyName_1
2025-02-05 00:43:09.907 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 00:43:09.910 +03:00 [INF] Executed action NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI) in 12.6208ms
2025-02-05 00:43:09.911 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 00:43:09.913 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - 200 null application/json; charset=utf-8 27.2524ms
2025-02-05 00:43:10.908 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - application/json; charset=utf-8 49
2025-02-05 00:43:10.916 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 00:43:10.918 +03:00 [INF] Route matched with {action = "MasterFetch", controller = "Content"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] MasterFetch(NayifatAPI.Controllers.MasterFetchRequest) on controller NayifatAPI.Controllers.ContentController (NayifatAPI).
2025-02-05 00:43:10.924 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 00:43:10.930 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__request_Page_0='?' (Size = 450), @__request_KeyName_1='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[config_id], [m].[key_name], [m].[last_updated], [m].[page], [m].[value]
FROM [master_config] AS [m]
WHERE [m].[page] = @__request_Page_0 AND [m].[key_name] = @__request_KeyName_1
2025-02-05 00:43:10.934 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 00:43:10.936 +03:00 [INF] Executed action NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI) in 12.9411ms
2025-02-05 00:43:10.937 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 00:43:10.940 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - 200 null application/json; charset=utf-8 31.7965ms
2025-02-05 00:43:11.810 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - application/json; charset=utf-8 49
2025-02-05 00:43:11.816 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 00:43:11.818 +03:00 [INF] Route matched with {action = "MasterFetch", controller = "Content"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] MasterFetch(NayifatAPI.Controllers.MasterFetchRequest) on controller NayifatAPI.Controllers.ContentController (NayifatAPI).
2025-02-05 00:43:11.823 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 00:43:11.828 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__request_Page_0='?' (Size = 450), @__request_KeyName_1='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[config_id], [m].[key_name], [m].[last_updated], [m].[page], [m].[value]
FROM [master_config] AS [m]
WHERE [m].[page] = @__request_Page_0 AND [m].[key_name] = @__request_KeyName_1
2025-02-05 00:43:11.833 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 00:43:11.834 +03:00 [INF] Executed action NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI) in 12.486ms
2025-02-05 00:43:11.835 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 00:43:11.836 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - 200 null application/json; charset=utf-8 25.3232ms
2025-02-05 00:43:12.752 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - application/json; charset=utf-8 36
2025-02-05 00:43:12.757 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 00:43:12.761 +03:00 [INF] Route matched with {action = "MasterFetch", controller = "Content"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] MasterFetch(NayifatAPI.Controllers.MasterFetchRequest) on controller NayifatAPI.Controllers.ContentController (NayifatAPI).
2025-02-05 00:43:12.768 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 00:43:12.776 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__request_Page_0='?' (Size = 450), @__request_KeyName_1='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[config_id], [m].[key_name], [m].[last_updated], [m].[page], [m].[value]
FROM [master_config] AS [m]
WHERE [m].[page] = @__request_Page_0 AND [m].[key_name] = @__request_KeyName_1
2025-02-05 00:43:12.782 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 00:43:12.786 +03:00 [INF] Executed action NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI) in 19.6366ms
2025-02-05 00:43:12.790 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 00:43:12.795 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - 200 null application/json; charset=utf-8 42.4989ms
2025-02-05 00:43:15.024 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - application/json; charset=utf-8 36
2025-02-05 00:43:15.026 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 00:43:15.027 +03:00 [INF] Route matched with {action = "MasterFetch", controller = "Content"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] MasterFetch(NayifatAPI.Controllers.MasterFetchRequest) on controller NayifatAPI.Controllers.ContentController (NayifatAPI).
2025-02-05 00:43:15.030 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 00:43:15.035 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[@__request_Page_0='?' (Size = 450), @__request_KeyName_1='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[config_id], [m].[key_name], [m].[last_updated], [m].[page], [m].[value]
FROM [master_config] AS [m]
WHERE [m].[page] = @__request_Page_0 AND [m].[key_name] = @__request_KeyName_1
2025-02-05 00:43:15.037 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 00:43:15.038 +03:00 [INF] Executed action NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI) in 10.1175ms
2025-02-05 00:43:15.039 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 00:43:15.040 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - 200 null application/json; charset=utf-8 15.1934ms
2025-02-05 00:47:18.352 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/timestamps - application/json; charset=utf-8 2
2025-02-05 00:47:18.363 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.ContentController.GetTimestamps (NayifatAPI)'
2025-02-05 00:47:18.364 +03:00 [INF] Route matched with {action = "GetTimestamps", controller = "Content"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetTimestamps() on controller NayifatAPI.Controllers.ContentController (NayifatAPI).
2025-02-05 00:47:18.367 +03:00 [INF] TTT_
2025-02-05 00:47:18.368 +03:00 [INF] TTT_=== Getting Content Timestamps ===
2025-02-05 00:47:18.371 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 00:47:18.372 +03:00 [INF] TTT_Fetching timestamps from database
2025-02-05 00:47:18.374 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [m].[page] AS [Page], [m].[key_name] AS [KeyName], [m].[last_updated] AS [LastUpdated]
FROM [master_config] AS [m]
2025-02-05 00:47:18.375 +03:00 [INF] TTT_Found 18 content items
2025-02-05 00:47:18.375 +03:00 [INF] TTT_Page: home
2025-02-05 00:47:18.376 +03:00 [INF] TTT_  - slideshow_content: "2025-02-04T10:01:06.9430000"
2025-02-05 00:47:18.376 +03:00 [INF] TTT_  - slideshow_content_ar: "2025-02-04T10:01:06.9430000"
2025-02-05 00:47:18.377 +03:00 [INF] TTT_  - contact_details: "2025-02-04T10:01:06.9430000"
2025-02-05 00:47:18.377 +03:00 [INF] TTT_  - contact_details_ar: "2025-02-04T10:01:06.9430000"
2025-02-05 00:47:18.378 +03:00 [INF] TTT_  - termsEN1: "2025-02-03T14:23:58.0000000"
2025-02-05 00:47:18.379 +03:00 [INF] TTT_  - termsEN2: "2025-02-03T14:25:20.1730000"
2025-02-05 00:47:18.379 +03:00 [INF] TTT_  - privacyEN1: "2025-02-03T14:26:08.6130000"
2025-02-05 00:47:18.380 +03:00 [INF] TTT_  - privacyEN2: "2025-02-03T14:25:20.1730000"
2025-02-05 00:47:18.381 +03:00 [INF] TTT_  - termsAR1: "2025-02-03T14:23:58.0000000"
2025-02-05 00:47:18.381 +03:00 [INF] TTT_  - termsAR2: "2025-02-03T14:25:20.1730000"
2025-02-05 00:47:18.382 +03:00 [INF] TTT_  - privacyAR1: "2025-02-03T14:26:08.6130000"
2025-02-05 00:47:18.383 +03:00 [INF] TTT_  - privacyAR2: "2025-02-03T14:25:20.1730000"
2025-02-05 00:47:18.383 +03:00 [INF] TTT_  - terms&conditionsCC_AR: "2025-02-03T17:06:57.7700000"
2025-02-05 00:47:18.384 +03:00 [INF] TTT_  - terms&conditionsCC_EN: "2025-02-03T17:07:47.4900000"
2025-02-05 00:47:18.384 +03:00 [INF] TTT_  - terms&conditionsPF_AR: "2025-02-03T17:06:57.7700000"
2025-02-05 00:47:18.385 +03:00 [INF] TTT_  - terms&conditionsPF_EN: "2025-02-03T17:06:57.7700000"
2025-02-05 00:47:18.386 +03:00 [INF] TTT_Page: loans
2025-02-05 00:47:18.386 +03:00 [INF] TTT_  - loan_ad: "2025-02-04T10:01:06.9430000"
2025-02-05 00:47:18.387 +03:00 [INF] TTT_Page: cards
2025-02-05 00:47:18.387 +03:00 [INF] TTT_  - card_ad: "2025-02-04T10:01:06.9430000"
2025-02-05 00:47:18.388 +03:00 [INF] TTT_Successfully retrieved all timestamps
2025-02-05 00:47:18.388 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 00:47:18.389 +03:00 [INF] Executed action NayifatAPI.Controllers.ContentController.GetTimestamps (NayifatAPI) in 22.1078ms
2025-02-05 00:47:18.390 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.ContentController.GetTimestamps (NayifatAPI)'
2025-02-05 00:47:18.390 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/timestamps - 200 null application/json; charset=utf-8 38.0628ms
2025-02-05 00:47:19.434 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - application/json; charset=utf-8 45
2025-02-05 00:47:19.445 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 00:47:19.445 +03:00 [INF] Route matched with {action = "MasterFetch", controller = "Content"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] MasterFetch(NayifatAPI.Controllers.MasterFetchRequest) on controller NayifatAPI.Controllers.ContentController (NayifatAPI).
2025-02-05 00:47:19.449 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 00:47:19.454 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__request_Page_0='?' (Size = 450), @__request_KeyName_1='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[config_id], [m].[key_name], [m].[last_updated], [m].[page], [m].[value]
FROM [master_config] AS [m]
WHERE [m].[page] = @__request_Page_0 AND [m].[key_name] = @__request_KeyName_1
2025-02-05 00:47:19.455 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 00:47:19.456 +03:00 [INF] Executed action NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI) in 7.9044ms
2025-02-05 00:47:19.457 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 00:47:19.458 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - 200 null application/json; charset=utf-8 24.13ms
2025-02-05 00:47:24.348 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - application/json; charset=utf-8 48
2025-02-05 00:47:24.355 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 00:47:24.357 +03:00 [INF] Route matched with {action = "MasterFetch", controller = "Content"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] MasterFetch(NayifatAPI.Controllers.MasterFetchRequest) on controller NayifatAPI.Controllers.ContentController (NayifatAPI).
2025-02-05 00:47:24.360 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 00:47:24.364 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__request_Page_0='?' (Size = 450), @__request_KeyName_1='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[config_id], [m].[key_name], [m].[last_updated], [m].[page], [m].[value]
FROM [master_config] AS [m]
WHERE [m].[page] = @__request_Page_0 AND [m].[key_name] = @__request_KeyName_1
2025-02-05 00:47:24.366 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 00:47:24.367 +03:00 [INF] Executed action NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI) in 7.4685ms
2025-02-05 00:47:24.368 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 00:47:24.368 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - 200 null application/json; charset=utf-8 19.7837ms
2025-02-05 00:47:28.233 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - application/json; charset=utf-8 43
2025-02-05 00:47:28.246 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 00:47:28.248 +03:00 [INF] Route matched with {action = "MasterFetch", controller = "Content"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] MasterFetch(NayifatAPI.Controllers.MasterFetchRequest) on controller NayifatAPI.Controllers.ContentController (NayifatAPI).
2025-02-05 00:47:28.251 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 00:47:28.253 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__request_Page_0='?' (Size = 450), @__request_KeyName_1='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[config_id], [m].[key_name], [m].[last_updated], [m].[page], [m].[value]
FROM [master_config] AS [m]
WHERE [m].[page] = @__request_Page_0 AND [m].[key_name] = @__request_KeyName_1
2025-02-05 00:47:28.254 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 00:47:28.256 +03:00 [INF] Executed action NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI) in 5.5066ms
2025-02-05 00:47:28.257 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 00:47:28.257 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - 200 null application/json; charset=utf-8 24.3725ms
2025-02-05 00:47:29.023 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - application/json; charset=utf-8 46
2025-02-05 00:47:29.034 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 00:47:29.036 +03:00 [INF] Route matched with {action = "MasterFetch", controller = "Content"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] MasterFetch(NayifatAPI.Controllers.MasterFetchRequest) on controller NayifatAPI.Controllers.ContentController (NayifatAPI).
2025-02-05 00:47:29.038 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 00:47:29.040 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__request_Page_0='?' (Size = 450), @__request_KeyName_1='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[config_id], [m].[key_name], [m].[last_updated], [m].[page], [m].[value]
FROM [master_config] AS [m]
WHERE [m].[page] = @__request_Page_0 AND [m].[key_name] = @__request_KeyName_1
2025-02-05 00:47:29.042 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 00:47:29.043 +03:00 [INF] Executed action NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI) in 5.9824ms
2025-02-05 00:47:29.044 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 00:47:29.045 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - 200 null application/json; charset=utf-8 21.6633ms
2025-02-05 00:47:30.038 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - application/json; charset=utf-8 36
2025-02-05 00:47:30.047 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 00:47:30.047 +03:00 [INF] Route matched with {action = "MasterFetch", controller = "Content"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] MasterFetch(NayifatAPI.Controllers.MasterFetchRequest) on controller NayifatAPI.Controllers.ContentController (NayifatAPI).
2025-02-05 00:47:30.050 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 00:47:30.054 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__request_Page_0='?' (Size = 450), @__request_KeyName_1='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[config_id], [m].[key_name], [m].[last_updated], [m].[page], [m].[value]
FROM [master_config] AS [m]
WHERE [m].[page] = @__request_Page_0 AND [m].[key_name] = @__request_KeyName_1
2025-02-05 00:47:30.055 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 00:47:30.056 +03:00 [INF] Executed action NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI) in 6.5097ms
2025-02-05 00:47:30.057 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 00:47:30.057 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - 200 null application/json; charset=utf-8 19.3487ms
2025-02-05 00:47:30.797 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - application/json; charset=utf-8 36
2025-02-05 00:47:30.801 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 00:47:30.802 +03:00 [INF] Route matched with {action = "MasterFetch", controller = "Content"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] MasterFetch(NayifatAPI.Controllers.MasterFetchRequest) on controller NayifatAPI.Controllers.ContentController (NayifatAPI).
2025-02-05 00:47:30.804 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 00:47:30.806 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__request_Page_0='?' (Size = 450), @__request_KeyName_1='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[config_id], [m].[key_name], [m].[last_updated], [m].[page], [m].[value]
FROM [master_config] AS [m]
WHERE [m].[page] = @__request_Page_0 AND [m].[key_name] = @__request_KeyName_1
2025-02-05 00:47:30.808 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 00:47:30.809 +03:00 [INF] Executed action NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI) in 5.3393ms
2025-02-05 00:47:30.809 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 00:47:30.810 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - 200 null application/json; charset=utf-8 13.171ms
2025-02-05 00:47:31.673 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - application/json; charset=utf-8 38
2025-02-05 00:47:31.809 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 00:47:31.809 +03:00 [INF] Route matched with {action = "MasterFetch", controller = "Content"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] MasterFetch(NayifatAPI.Controllers.MasterFetchRequest) on controller NayifatAPI.Controllers.ContentController (NayifatAPI).
2025-02-05 00:47:31.813 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 00:47:31.815 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__request_Page_0='?' (Size = 450), @__request_KeyName_1='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[config_id], [m].[key_name], [m].[last_updated], [m].[page], [m].[value]
FROM [master_config] AS [m]
WHERE [m].[page] = @__request_Page_0 AND [m].[key_name] = @__request_KeyName_1
2025-02-05 00:47:31.818 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 00:47:31.819 +03:00 [INF] Executed action NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI) in 7.8595ms
2025-02-05 00:47:31.820 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 00:47:31.821 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - 200 null application/json; charset=utf-8 147.3989ms
2025-02-05 00:47:32.802 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - application/json; charset=utf-8 38
2025-02-05 00:47:32.812 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 00:47:32.814 +03:00 [INF] Route matched with {action = "MasterFetch", controller = "Content"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] MasterFetch(NayifatAPI.Controllers.MasterFetchRequest) on controller NayifatAPI.Controllers.ContentController (NayifatAPI).
2025-02-05 00:47:32.817 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 00:47:32.821 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__request_Page_0='?' (Size = 450), @__request_KeyName_1='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[config_id], [m].[key_name], [m].[last_updated], [m].[page], [m].[value]
FROM [master_config] AS [m]
WHERE [m].[page] = @__request_Page_0 AND [m].[key_name] = @__request_KeyName_1
2025-02-05 00:47:32.822 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 00:47:32.823 +03:00 [INF] Executed action NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI) in 6.8516ms
2025-02-05 00:47:32.824 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 00:47:32.825 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - 200 null application/json; charset=utf-8 22.5833ms
2025-02-05 00:47:33.545 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - application/json; charset=utf-8 36
2025-02-05 00:47:33.549 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 00:47:33.550 +03:00 [INF] Route matched with {action = "MasterFetch", controller = "Content"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] MasterFetch(NayifatAPI.Controllers.MasterFetchRequest) on controller NayifatAPI.Controllers.ContentController (NayifatAPI).
2025-02-05 00:47:33.552 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 00:47:33.555 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__request_Page_0='?' (Size = 450), @__request_KeyName_1='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[config_id], [m].[key_name], [m].[last_updated], [m].[page], [m].[value]
FROM [master_config] AS [m]
WHERE [m].[page] = @__request_Page_0 AND [m].[key_name] = @__request_KeyName_1
2025-02-05 00:47:33.558 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 00:47:33.560 +03:00 [INF] Executed action NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI) in 9.0156ms
2025-02-05 00:47:33.561 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 00:47:33.563 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - 200 null application/json; charset=utf-8 18.2205ms
2025-02-05 00:47:34.402 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - application/json; charset=utf-8 36
2025-02-05 00:47:34.407 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 00:47:34.409 +03:00 [INF] Route matched with {action = "MasterFetch", controller = "Content"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] MasterFetch(NayifatAPI.Controllers.MasterFetchRequest) on controller NayifatAPI.Controllers.ContentController (NayifatAPI).
2025-02-05 00:47:34.411 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 00:47:34.414 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__request_Page_0='?' (Size = 450), @__request_KeyName_1='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[config_id], [m].[key_name], [m].[last_updated], [m].[page], [m].[value]
FROM [master_config] AS [m]
WHERE [m].[page] = @__request_Page_0 AND [m].[key_name] = @__request_KeyName_1
2025-02-05 00:47:34.415 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 00:47:34.416 +03:00 [INF] Executed action NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI) in 6.4675ms
2025-02-05 00:47:34.417 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 00:47:34.418 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - 200 null application/json; charset=utf-8 15.6851ms
2025-02-05 00:47:35.221 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - application/json; charset=utf-8 38
2025-02-05 00:47:35.232 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 00:47:35.233 +03:00 [INF] Route matched with {action = "MasterFetch", controller = "Content"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] MasterFetch(NayifatAPI.Controllers.MasterFetchRequest) on controller NayifatAPI.Controllers.ContentController (NayifatAPI).
2025-02-05 00:47:35.236 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 00:47:35.239 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__request_Page_0='?' (Size = 450), @__request_KeyName_1='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[config_id], [m].[key_name], [m].[last_updated], [m].[page], [m].[value]
FROM [master_config] AS [m]
WHERE [m].[page] = @__request_Page_0 AND [m].[key_name] = @__request_KeyName_1
2025-02-05 00:47:35.240 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 00:47:35.241 +03:00 [INF] Executed action NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI) in 6.5928ms
2025-02-05 00:47:35.243 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 00:47:35.244 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - 200 null application/json; charset=utf-8 22.9011ms
2025-02-05 00:47:36.083 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - application/json; charset=utf-8 38
2025-02-05 00:47:36.093 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 00:47:36.097 +03:00 [INF] Route matched with {action = "MasterFetch", controller = "Content"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] MasterFetch(NayifatAPI.Controllers.MasterFetchRequest) on controller NayifatAPI.Controllers.ContentController (NayifatAPI).
2025-02-05 00:47:36.100 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 00:47:36.102 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__request_Page_0='?' (Size = 450), @__request_KeyName_1='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[config_id], [m].[key_name], [m].[last_updated], [m].[page], [m].[value]
FROM [master_config] AS [m]
WHERE [m].[page] = @__request_Page_0 AND [m].[key_name] = @__request_KeyName_1
2025-02-05 00:47:36.103 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 00:47:36.104 +03:00 [INF] Executed action NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI) in 5.2605ms
2025-02-05 00:47:36.105 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 00:47:36.106 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - 200 null application/json; charset=utf-8 22.8838ms
2025-02-05 00:47:36.862 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - application/json; charset=utf-8 49
2025-02-05 00:47:36.876 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 00:47:36.879 +03:00 [INF] Route matched with {action = "MasterFetch", controller = "Content"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] MasterFetch(NayifatAPI.Controllers.MasterFetchRequest) on controller NayifatAPI.Controllers.ContentController (NayifatAPI).
2025-02-05 00:47:36.884 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 00:47:36.886 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__request_Page_0='?' (Size = 450), @__request_KeyName_1='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[config_id], [m].[key_name], [m].[last_updated], [m].[page], [m].[value]
FROM [master_config] AS [m]
WHERE [m].[page] = @__request_Page_0 AND [m].[key_name] = @__request_KeyName_1
2025-02-05 00:47:36.887 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 00:47:36.888 +03:00 [INF] Executed action NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI) in 4.6328ms
2025-02-05 00:47:36.889 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 00:47:36.889 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - 200 null application/json; charset=utf-8 27.6844ms
2025-02-05 00:47:37.614 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - application/json; charset=utf-8 49
2025-02-05 00:47:37.624 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 00:47:37.624 +03:00 [INF] Route matched with {action = "MasterFetch", controller = "Content"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] MasterFetch(NayifatAPI.Controllers.MasterFetchRequest) on controller NayifatAPI.Controllers.ContentController (NayifatAPI).
2025-02-05 00:47:37.628 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 00:47:37.631 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__request_Page_0='?' (Size = 450), @__request_KeyName_1='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[config_id], [m].[key_name], [m].[last_updated], [m].[page], [m].[value]
FROM [master_config] AS [m]
WHERE [m].[page] = @__request_Page_0 AND [m].[key_name] = @__request_KeyName_1
2025-02-05 00:47:37.633 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 00:47:37.634 +03:00 [INF] Executed action NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI) in 8.4334ms
2025-02-05 00:47:37.635 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 00:47:37.635 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - 200 null application/json; charset=utf-8 21.5926ms
2025-02-05 00:47:38.412 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - application/json; charset=utf-8 49
2025-02-05 00:47:38.416 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 00:47:38.419 +03:00 [INF] Route matched with {action = "MasterFetch", controller = "Content"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] MasterFetch(NayifatAPI.Controllers.MasterFetchRequest) on controller NayifatAPI.Controllers.ContentController (NayifatAPI).
2025-02-05 00:47:38.423 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 00:47:38.428 +03:00 [INF] Executed DbCommand (4ms) [Parameters=[@__request_Page_0='?' (Size = 450), @__request_KeyName_1='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[config_id], [m].[key_name], [m].[last_updated], [m].[page], [m].[value]
FROM [master_config] AS [m]
WHERE [m].[page] = @__request_Page_0 AND [m].[key_name] = @__request_KeyName_1
2025-02-05 00:47:38.432 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 00:47:38.433 +03:00 [INF] Executed action NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI) in 12.826ms
2025-02-05 00:47:38.434 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 00:47:38.434 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - 200 null application/json; charset=utf-8 21.7971ms
2025-02-05 00:47:39.320 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - application/json; charset=utf-8 49
2025-02-05 00:47:39.323 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 00:47:39.323 +03:00 [INF] Route matched with {action = "MasterFetch", controller = "Content"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] MasterFetch(NayifatAPI.Controllers.MasterFetchRequest) on controller NayifatAPI.Controllers.ContentController (NayifatAPI).
2025-02-05 00:47:39.328 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 00:47:39.331 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__request_Page_0='?' (Size = 450), @__request_KeyName_1='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[config_id], [m].[key_name], [m].[last_updated], [m].[page], [m].[value]
FROM [master_config] AS [m]
WHERE [m].[page] = @__request_Page_0 AND [m].[key_name] = @__request_KeyName_1
2025-02-05 00:47:39.333 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 00:47:39.333 +03:00 [INF] Executed action NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI) in 8.5101ms
2025-02-05 00:47:39.334 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 00:47:39.335 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - 200 null application/json; charset=utf-8 14.7937ms
2025-02-05 00:47:40.216 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - application/json; charset=utf-8 36
2025-02-05 00:47:40.223 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 00:47:40.224 +03:00 [INF] Route matched with {action = "MasterFetch", controller = "Content"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] MasterFetch(NayifatAPI.Controllers.MasterFetchRequest) on controller NayifatAPI.Controllers.ContentController (NayifatAPI).
2025-02-05 00:47:40.228 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 00:47:40.233 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[@__request_Page_0='?' (Size = 450), @__request_KeyName_1='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[config_id], [m].[key_name], [m].[last_updated], [m].[page], [m].[value]
FROM [master_config] AS [m]
WHERE [m].[page] = @__request_Page_0 AND [m].[key_name] = @__request_KeyName_1
2025-02-05 00:47:40.237 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 00:47:40.238 +03:00 [INF] Executed action NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI) in 12.7926ms
2025-02-05 00:47:40.239 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 00:47:40.240 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - 200 null application/json; charset=utf-8 23.5238ms
2025-02-05 00:47:42.140 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - application/json; charset=utf-8 36
2025-02-05 00:47:42.149 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 00:47:42.150 +03:00 [INF] Route matched with {action = "MasterFetch", controller = "Content"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] MasterFetch(NayifatAPI.Controllers.MasterFetchRequest) on controller NayifatAPI.Controllers.ContentController (NayifatAPI).
2025-02-05 00:47:42.155 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 00:47:42.160 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__request_Page_0='?' (Size = 450), @__request_KeyName_1='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[config_id], [m].[key_name], [m].[last_updated], [m].[page], [m].[value]
FROM [master_config] AS [m]
WHERE [m].[page] = @__request_Page_0 AND [m].[key_name] = @__request_KeyName_1
2025-02-05 00:47:42.162 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 00:47:42.163 +03:00 [INF] Executed action NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI) in 11.229ms
2025-02-05 00:47:42.164 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 00:47:42.165 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - 200 null application/json; charset=utf-8 24.9627ms
2025-02-05 00:47:59.130 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/timestamps - application/json; charset=utf-8 2
2025-02-05 00:47:59.138 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.ContentController.GetTimestamps (NayifatAPI)'
2025-02-05 00:47:59.140 +03:00 [INF] Route matched with {action = "GetTimestamps", controller = "Content"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetTimestamps() on controller NayifatAPI.Controllers.ContentController (NayifatAPI).
2025-02-05 00:47:59.141 +03:00 [INF] TTT_
2025-02-05 00:47:59.142 +03:00 [INF] TTT_=== Getting Content Timestamps ===
2025-02-05 00:47:59.143 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 00:47:59.145 +03:00 [INF] TTT_Fetching timestamps from database
2025-02-05 00:47:59.147 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [m].[page] AS [Page], [m].[key_name] AS [KeyName], [m].[last_updated] AS [LastUpdated]
FROM [master_config] AS [m]
2025-02-05 00:47:59.149 +03:00 [INF] TTT_Found 18 content items
2025-02-05 00:47:59.149 +03:00 [INF] TTT_Page: home
2025-02-05 00:47:59.150 +03:00 [INF] TTT_  - slideshow_content: "2025-02-04T10:01:06.9430000"
2025-02-05 00:47:59.151 +03:00 [INF] TTT_  - slideshow_content_ar: "2025-02-04T10:01:06.9430000"
2025-02-05 00:47:59.151 +03:00 [INF] TTT_  - contact_details: "2025-02-04T10:01:06.9430000"
2025-02-05 00:47:59.152 +03:00 [INF] TTT_  - contact_details_ar: "2025-02-04T10:01:06.9430000"
2025-02-05 00:47:59.152 +03:00 [INF] TTT_  - termsEN1: "2025-02-03T14:23:58.0000000"
2025-02-05 00:47:59.153 +03:00 [INF] TTT_  - termsEN2: "2025-02-03T14:25:20.1730000"
2025-02-05 00:47:59.154 +03:00 [INF] TTT_  - privacyEN1: "2025-02-03T14:26:08.6130000"
2025-02-05 00:47:59.154 +03:00 [INF] TTT_  - privacyEN2: "2025-02-03T14:25:20.1730000"
2025-02-05 00:47:59.155 +03:00 [INF] TTT_  - termsAR1: "2025-02-03T14:23:58.0000000"
2025-02-05 00:47:59.155 +03:00 [INF] TTT_  - termsAR2: "2025-02-03T14:25:20.1730000"
2025-02-05 00:47:59.156 +03:00 [INF] TTT_  - privacyAR1: "2025-02-03T14:26:08.6130000"
2025-02-05 00:47:59.157 +03:00 [INF] TTT_  - privacyAR2: "2025-02-03T14:25:20.1730000"
2025-02-05 00:47:59.157 +03:00 [INF] TTT_  - terms&conditionsCC_AR: "2025-02-03T17:06:57.7700000"
2025-02-05 00:47:59.158 +03:00 [INF] TTT_  - terms&conditionsCC_EN: "2025-02-03T17:07:47.4900000"
2025-02-05 00:47:59.159 +03:00 [INF] TTT_  - terms&conditionsPF_AR: "2025-02-03T17:06:57.7700000"
2025-02-05 00:47:59.160 +03:00 [INF] TTT_  - terms&conditionsPF_EN: "2025-02-03T17:06:57.7700000"
2025-02-05 00:47:59.160 +03:00 [INF] TTT_Page: loans
2025-02-05 00:47:59.161 +03:00 [INF] TTT_  - loan_ad: "2025-02-04T10:01:06.9430000"
2025-02-05 00:47:59.162 +03:00 [INF] TTT_Page: cards
2025-02-05 00:47:59.162 +03:00 [INF] TTT_  - card_ad: "2025-02-04T10:01:06.9430000"
2025-02-05 00:47:59.163 +03:00 [INF] TTT_Successfully retrieved all timestamps
2025-02-05 00:47:59.163 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 00:47:59.164 +03:00 [INF] Executed action NayifatAPI.Controllers.ContentController.GetTimestamps (NayifatAPI) in 22.5672ms
2025-02-05 00:47:59.164 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.ContentController.GetTimestamps (NayifatAPI)'
2025-02-05 00:47:59.165 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/timestamps - 200 null application/json; charset=utf-8 35.1832ms
2025-02-05 00:48:00.061 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - application/json; charset=utf-8 45
2025-02-05 00:48:00.070 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 00:48:00.070 +03:00 [INF] Route matched with {action = "MasterFetch", controller = "Content"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] MasterFetch(NayifatAPI.Controllers.MasterFetchRequest) on controller NayifatAPI.Controllers.ContentController (NayifatAPI).
2025-02-05 00:48:00.075 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 00:48:00.079 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__request_Page_0='?' (Size = 450), @__request_KeyName_1='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[config_id], [m].[key_name], [m].[last_updated], [m].[page], [m].[value]
FROM [master_config] AS [m]
WHERE [m].[page] = @__request_Page_0 AND [m].[key_name] = @__request_KeyName_1
2025-02-05 00:48:00.080 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 00:48:00.081 +03:00 [INF] Executed action NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI) in 7.5181ms
2025-02-05 00:48:00.082 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 00:48:00.082 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - 200 null application/json; charset=utf-8 22.1626ms
2025-02-05 00:48:04.076 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - application/json; charset=utf-8 48
2025-02-05 00:48:04.082 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 00:48:04.085 +03:00 [INF] Route matched with {action = "MasterFetch", controller = "Content"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] MasterFetch(NayifatAPI.Controllers.MasterFetchRequest) on controller NayifatAPI.Controllers.ContentController (NayifatAPI).
2025-02-05 00:48:04.092 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 00:48:04.098 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__request_Page_0='?' (Size = 450), @__request_KeyName_1='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[config_id], [m].[key_name], [m].[last_updated], [m].[page], [m].[value]
FROM [master_config] AS [m]
WHERE [m].[page] = @__request_Page_0 AND [m].[key_name] = @__request_KeyName_1
2025-02-05 00:48:04.102 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 00:48:04.105 +03:00 [INF] Executed action NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI) in 15.0527ms
2025-02-05 00:48:04.108 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 00:48:04.109 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - 200 null application/json; charset=utf-8 32.982ms
2025-02-05 00:48:08.179 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - application/json; charset=utf-8 43
2025-02-05 00:48:08.209 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 00:48:08.215 +03:00 [INF] Route matched with {action = "MasterFetch", controller = "Content"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] MasterFetch(NayifatAPI.Controllers.MasterFetchRequest) on controller NayifatAPI.Controllers.ContentController (NayifatAPI).
2025-02-05 00:48:08.221 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 00:48:08.226 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__request_Page_0='?' (Size = 450), @__request_KeyName_1='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[config_id], [m].[key_name], [m].[last_updated], [m].[page], [m].[value]
FROM [master_config] AS [m]
WHERE [m].[page] = @__request_Page_0 AND [m].[key_name] = @__request_KeyName_1
2025-02-05 00:48:08.231 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 00:48:08.236 +03:00 [INF] Executed action NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI) in 18.1017ms
2025-02-05 00:48:08.242 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 00:48:08.244 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - 200 null application/json; charset=utf-8 65.6523ms
2025-02-05 00:48:09.100 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - application/json; charset=utf-8 46
2025-02-05 00:48:09.105 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 00:48:09.107 +03:00 [INF] Route matched with {action = "MasterFetch", controller = "Content"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] MasterFetch(NayifatAPI.Controllers.MasterFetchRequest) on controller NayifatAPI.Controllers.ContentController (NayifatAPI).
2025-02-05 00:48:09.116 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 00:48:09.120 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__request_Page_0='?' (Size = 450), @__request_KeyName_1='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[config_id], [m].[key_name], [m].[last_updated], [m].[page], [m].[value]
FROM [master_config] AS [m]
WHERE [m].[page] = @__request_Page_0 AND [m].[key_name] = @__request_KeyName_1
2025-02-05 00:48:09.124 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 00:48:09.126 +03:00 [INF] Executed action NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI) in 13.8154ms
2025-02-05 00:48:09.129 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 00:48:09.133 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - 200 null application/json; charset=utf-8 33.8564ms
2025-02-05 00:48:10.077 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - application/json; charset=utf-8 36
2025-02-05 00:48:10.078 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 00:48:10.079 +03:00 [INF] Route matched with {action = "MasterFetch", controller = "Content"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] MasterFetch(NayifatAPI.Controllers.MasterFetchRequest) on controller NayifatAPI.Controllers.ContentController (NayifatAPI).
2025-02-05 00:48:10.082 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 00:48:10.085 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__request_Page_0='?' (Size = 450), @__request_KeyName_1='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[config_id], [m].[key_name], [m].[last_updated], [m].[page], [m].[value]
FROM [master_config] AS [m]
WHERE [m].[page] = @__request_Page_0 AND [m].[key_name] = @__request_KeyName_1
2025-02-05 00:48:10.087 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 00:48:10.088 +03:00 [INF] Executed action NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI) in 7.0012ms
2025-02-05 00:48:10.088 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 00:48:10.089 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - 200 null application/json; charset=utf-8 12.2845ms
2025-02-05 00:48:11.056 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - application/json; charset=utf-8 36
2025-02-05 00:48:11.060 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 00:48:11.062 +03:00 [INF] Route matched with {action = "MasterFetch", controller = "Content"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] MasterFetch(NayifatAPI.Controllers.MasterFetchRequest) on controller NayifatAPI.Controllers.ContentController (NayifatAPI).
2025-02-05 00:48:11.065 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 00:48:11.067 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__request_Page_0='?' (Size = 450), @__request_KeyName_1='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[config_id], [m].[key_name], [m].[last_updated], [m].[page], [m].[value]
FROM [master_config] AS [m]
WHERE [m].[page] = @__request_Page_0 AND [m].[key_name] = @__request_KeyName_1
2025-02-05 00:48:11.070 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 00:48:11.071 +03:00 [INF] Executed action NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI) in 8.2159ms
2025-02-05 00:48:11.073 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 00:48:11.074 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - 200 null application/json; charset=utf-8 18.2548ms
2025-02-05 00:48:11.884 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - application/json; charset=utf-8 38
2025-02-05 00:48:11.888 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 00:48:11.889 +03:00 [INF] Route matched with {action = "MasterFetch", controller = "Content"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] MasterFetch(NayifatAPI.Controllers.MasterFetchRequest) on controller NayifatAPI.Controllers.ContentController (NayifatAPI).
2025-02-05 00:48:11.892 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 00:48:11.895 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__request_Page_0='?' (Size = 450), @__request_KeyName_1='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[config_id], [m].[key_name], [m].[last_updated], [m].[page], [m].[value]
FROM [master_config] AS [m]
WHERE [m].[page] = @__request_Page_0 AND [m].[key_name] = @__request_KeyName_1
2025-02-05 00:48:11.896 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 00:48:11.898 +03:00 [INF] Executed action NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI) in 7.4151ms
2025-02-05 00:48:11.899 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 00:48:11.900 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - 200 null application/json; charset=utf-8 15.8601ms
2025-02-05 00:48:12.883 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - application/json; charset=utf-8 38
2025-02-05 00:48:12.889 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 00:48:12.890 +03:00 [INF] Route matched with {action = "MasterFetch", controller = "Content"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] MasterFetch(NayifatAPI.Controllers.MasterFetchRequest) on controller NayifatAPI.Controllers.ContentController (NayifatAPI).
2025-02-05 00:48:12.894 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 00:48:12.897 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__request_Page_0='?' (Size = 450), @__request_KeyName_1='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[config_id], [m].[key_name], [m].[last_updated], [m].[page], [m].[value]
FROM [master_config] AS [m]
WHERE [m].[page] = @__request_Page_0 AND [m].[key_name] = @__request_KeyName_1
2025-02-05 00:48:12.900 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 00:48:12.903 +03:00 [INF] Executed action NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI) in 11.3392ms
2025-02-05 00:48:12.906 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 00:48:12.907 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - 200 null application/json; charset=utf-8 23.4582ms
2025-02-05 00:48:13.653 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - application/json; charset=utf-8 36
2025-02-05 00:48:13.657 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 00:48:13.658 +03:00 [INF] Route matched with {action = "MasterFetch", controller = "Content"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] MasterFetch(NayifatAPI.Controllers.MasterFetchRequest) on controller NayifatAPI.Controllers.ContentController (NayifatAPI).
2025-02-05 00:48:13.660 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 00:48:13.664 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__request_Page_0='?' (Size = 450), @__request_KeyName_1='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[config_id], [m].[key_name], [m].[last_updated], [m].[page], [m].[value]
FROM [master_config] AS [m]
WHERE [m].[page] = @__request_Page_0 AND [m].[key_name] = @__request_KeyName_1
2025-02-05 00:48:13.665 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 00:48:13.670 +03:00 [INF] Executed action NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI) in 10.9339ms
2025-02-05 00:48:13.671 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 00:48:13.672 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - 200 null application/json; charset=utf-8 18.9968ms
2025-02-05 00:48:14.493 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - application/json; charset=utf-8 36
2025-02-05 00:48:14.497 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 00:48:14.497 +03:00 [INF] Route matched with {action = "MasterFetch", controller = "Content"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] MasterFetch(NayifatAPI.Controllers.MasterFetchRequest) on controller NayifatAPI.Controllers.ContentController (NayifatAPI).
2025-02-05 00:48:14.501 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 00:48:14.504 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__request_Page_0='?' (Size = 450), @__request_KeyName_1='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[config_id], [m].[key_name], [m].[last_updated], [m].[page], [m].[value]
FROM [master_config] AS [m]
WHERE [m].[page] = @__request_Page_0 AND [m].[key_name] = @__request_KeyName_1
2025-02-05 00:48:14.506 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 00:48:14.507 +03:00 [INF] Executed action NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI) in 7.5764ms
2025-02-05 00:48:14.509 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 00:48:14.510 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - 200 null application/json; charset=utf-8 16.6986ms
2025-02-05 00:48:15.404 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - application/json; charset=utf-8 38
2025-02-05 00:48:15.408 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 00:48:15.409 +03:00 [INF] Route matched with {action = "MasterFetch", controller = "Content"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] MasterFetch(NayifatAPI.Controllers.MasterFetchRequest) on controller NayifatAPI.Controllers.ContentController (NayifatAPI).
2025-02-05 00:48:15.412 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 00:48:15.415 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__request_Page_0='?' (Size = 450), @__request_KeyName_1='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[config_id], [m].[key_name], [m].[last_updated], [m].[page], [m].[value]
FROM [master_config] AS [m]
WHERE [m].[page] = @__request_Page_0 AND [m].[key_name] = @__request_KeyName_1
2025-02-05 00:48:15.417 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 00:48:15.419 +03:00 [INF] Executed action NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI) in 8.6181ms
2025-02-05 00:48:15.420 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 00:48:15.421 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - 200 null application/json; charset=utf-8 16.9129ms
2025-02-05 00:48:16.361 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - application/json; charset=utf-8 38
2025-02-05 00:48:16.364 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 00:48:16.365 +03:00 [INF] Route matched with {action = "MasterFetch", controller = "Content"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] MasterFetch(NayifatAPI.Controllers.MasterFetchRequest) on controller NayifatAPI.Controllers.ContentController (NayifatAPI).
2025-02-05 00:48:16.370 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 00:48:16.374 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__request_Page_0='?' (Size = 450), @__request_KeyName_1='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[config_id], [m].[key_name], [m].[last_updated], [m].[page], [m].[value]
FROM [master_config] AS [m]
WHERE [m].[page] = @__request_Page_0 AND [m].[key_name] = @__request_KeyName_1
2025-02-05 00:48:16.376 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 00:48:16.377 +03:00 [INF] Executed action NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI) in 8.6486ms
2025-02-05 00:48:16.379 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 00:48:16.382 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - 200 null application/json; charset=utf-8 20.8278ms
2025-02-05 00:48:17.020 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - application/json; charset=utf-8 49
2025-02-05 00:48:17.025 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 00:48:17.052 +03:00 [INF] Route matched with {action = "MasterFetch", controller = "Content"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] MasterFetch(NayifatAPI.Controllers.MasterFetchRequest) on controller NayifatAPI.Controllers.ContentController (NayifatAPI).
2025-02-05 00:48:17.057 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 00:48:17.062 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__request_Page_0='?' (Size = 450), @__request_KeyName_1='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[config_id], [m].[key_name], [m].[last_updated], [m].[page], [m].[value]
FROM [master_config] AS [m]
WHERE [m].[page] = @__request_Page_0 AND [m].[key_name] = @__request_KeyName_1
2025-02-05 00:48:17.066 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 00:48:17.068 +03:00 [INF] Executed action NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI) in 13.1781ms
2025-02-05 00:48:17.073 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 00:48:17.077 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - 200 null application/json; charset=utf-8 57.9352ms
2025-02-05 00:48:17.846 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - application/json; charset=utf-8 49
2025-02-05 00:48:17.859 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 00:48:17.863 +03:00 [INF] Route matched with {action = "MasterFetch", controller = "Content"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] MasterFetch(NayifatAPI.Controllers.MasterFetchRequest) on controller NayifatAPI.Controllers.ContentController (NayifatAPI).
2025-02-05 00:48:17.874 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 00:48:17.878 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__request_Page_0='?' (Size = 450), @__request_KeyName_1='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[config_id], [m].[key_name], [m].[last_updated], [m].[page], [m].[value]
FROM [master_config] AS [m]
WHERE [m].[page] = @__request_Page_0 AND [m].[key_name] = @__request_KeyName_1
2025-02-05 00:48:17.880 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 00:48:17.883 +03:00 [INF] Executed action NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI) in 13.9877ms
2025-02-05 00:48:17.890 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 00:48:17.892 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - 200 null application/json; charset=utf-8 46.0637ms
2025-02-05 00:48:18.622 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - application/json; charset=utf-8 49
2025-02-05 00:48:18.628 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 00:48:18.628 +03:00 [INF] Route matched with {action = "MasterFetch", controller = "Content"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] MasterFetch(NayifatAPI.Controllers.MasterFetchRequest) on controller NayifatAPI.Controllers.ContentController (NayifatAPI).
2025-02-05 00:48:18.632 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 00:48:18.635 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__request_Page_0='?' (Size = 450), @__request_KeyName_1='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[config_id], [m].[key_name], [m].[last_updated], [m].[page], [m].[value]
FROM [master_config] AS [m]
WHERE [m].[page] = @__request_Page_0 AND [m].[key_name] = @__request_KeyName_1
2025-02-05 00:48:18.636 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 00:48:18.638 +03:00 [INF] Executed action NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI) in 7.6957ms
2025-02-05 00:48:18.639 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 00:48:18.640 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - 200 null application/json; charset=utf-8 18.1222ms
2025-02-05 00:48:19.427 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - application/json; charset=utf-8 49
2025-02-05 00:48:19.430 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 00:48:19.430 +03:00 [INF] Route matched with {action = "MasterFetch", controller = "Content"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] MasterFetch(NayifatAPI.Controllers.MasterFetchRequest) on controller NayifatAPI.Controllers.ContentController (NayifatAPI).
2025-02-05 00:48:19.437 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 00:48:19.441 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__request_Page_0='?' (Size = 450), @__request_KeyName_1='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[config_id], [m].[key_name], [m].[last_updated], [m].[page], [m].[value]
FROM [master_config] AS [m]
WHERE [m].[page] = @__request_Page_0 AND [m].[key_name] = @__request_KeyName_1
2025-02-05 00:48:19.444 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 00:48:19.445 +03:00 [INF] Executed action NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI) in 9.3231ms
2025-02-05 00:48:19.446 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 00:48:19.452 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - 200 null application/json; charset=utf-8 21.8148ms
2025-02-05 00:48:20.368 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - application/json; charset=utf-8 36
2025-02-05 00:48:20.371 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 00:48:20.372 +03:00 [INF] Route matched with {action = "MasterFetch", controller = "Content"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] MasterFetch(NayifatAPI.Controllers.MasterFetchRequest) on controller NayifatAPI.Controllers.ContentController (NayifatAPI).
2025-02-05 00:48:20.375 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 00:48:20.388 +03:00 [INF] Executed DbCommand (6ms) [Parameters=[@__request_Page_0='?' (Size = 450), @__request_KeyName_1='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[config_id], [m].[key_name], [m].[last_updated], [m].[page], [m].[value]
FROM [master_config] AS [m]
WHERE [m].[page] = @__request_Page_0 AND [m].[key_name] = @__request_KeyName_1
2025-02-05 00:48:20.394 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 00:48:20.398 +03:00 [INF] Executed action NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI) in 25.2672ms
2025-02-05 00:48:20.408 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 00:48:20.411 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - 200 null application/json; charset=utf-8 42.6263ms
2025-02-05 00:48:22.154 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - application/json; charset=utf-8 36
2025-02-05 00:48:22.203 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 00:48:22.211 +03:00 [INF] Route matched with {action = "MasterFetch", controller = "Content"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] MasterFetch(NayifatAPI.Controllers.MasterFetchRequest) on controller NayifatAPI.Controllers.ContentController (NayifatAPI).
2025-02-05 00:48:22.221 +03:00 [INF] Executed DbCommand (5ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 00:48:22.277 +03:00 [INF] Executed DbCommand (11ms) [Parameters=[@__request_Page_0='?' (Size = 450), @__request_KeyName_1='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[config_id], [m].[key_name], [m].[last_updated], [m].[page], [m].[value]
FROM [master_config] AS [m]
WHERE [m].[page] = @__request_Page_0 AND [m].[key_name] = @__request_KeyName_1
2025-02-05 00:48:22.285 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 00:48:22.296 +03:00 [INF] Executed action NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI) in 80.502ms
2025-02-05 00:48:22.304 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 00:48:22.331 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - 200 null application/json; charset=utf-8 176.7011ms
2025-02-05 00:49:06.035 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/list - application/json; charset=utf-8 45
2025-02-05 00:49:06.077 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI)'
2025-02-05 00:49:06.080 +03:00 [INF] Route matched with {action = "GetNotifications", controller = "Notifications"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetNotifications(NayifatAPI.Controllers.GetNotificationsRequest) on controller NayifatAPI.Controllers.NotificationsController (NayifatAPI).
2025-02-05 00:49:06.130 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/list - application/json; charset=utf-8 45
2025-02-05 00:49:06.181 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI)'
2025-02-05 00:49:06.182 +03:00 [INF] Route matched with {action = "GetNotifications", controller = "Notifications"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetNotifications(NayifatAPI.Controllers.GetNotificationsRequest) on controller NayifatAPI.Controllers.NotificationsController (NayifatAPI).
2025-02-05 00:49:06.190 +03:00 [INF] Executed DbCommand (10ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 00:49:06.304 +03:00 [INF] Executed DbCommand (26ms) [Parameters=[@__request_NationalId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[national_id], [u].[last_updated], [u].[notifications]
FROM [user_notifications] AS [u]
WHERE [u].[national_id] = @__request_NationalId_0
2025-02-05 00:49:06.319 +03:00 [INF] Executed DbCommand (8ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 00:49:06.328 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 00:49:06.330 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__request_NationalId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[national_id], [u].[last_updated], [u].[notifications]
FROM [user_notifications] AS [u]
WHERE [u].[national_id] = @__request_NationalId_0
2025-02-05 00:49:06.333 +03:00 [INF] Executed action NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI) in 153.5815ms
2025-02-05 00:49:06.335 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 00:49:06.336 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI)'
2025-02-05 00:49:06.338 +03:00 [INF] Executed action NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI) in 153.3766ms
2025-02-05 00:49:06.339 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/list - 200 null application/json; charset=utf-8 303.4244ms
2025-02-05 00:49:06.340 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI)'
2025-02-05 00:49:06.344 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/list - 200 null application/json; charset=utf-8 213.6275ms
2025-02-05 00:49:28.646 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/list - application/json 39
2025-02-05 00:49:28.680 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI)'
2025-02-05 00:49:28.687 +03:00 [INF] Route matched with {action = "GetNotifications", controller = "Notifications"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetNotifications(NayifatAPI.Controllers.GetNotificationsRequest) on controller NayifatAPI.Controllers.NotificationsController (NayifatAPI).
2025-02-05 00:49:28.695 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 00:49:28.706 +03:00 [INF] Executed DbCommand (9ms) [Parameters=[@__request_NationalId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[national_id], [u].[last_updated], [u].[notifications]
FROM [user_notifications] AS [u]
WHERE [u].[national_id] = @__request_NationalId_0
2025-02-05 00:49:28.735 +03:00 [INF] Executed DbCommand (5ms) [Parameters=[@__Parse_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [n].[Id], [n].[additional_data], [n].[Body], [n].[body_ar], [n].[body_en], [n].[created_at], [n].[expiry_at], [n].[Route], [n].[target_criteria], [n].[Title], [n].[title_ar], [n].[title_en]
FROM [notification_templates] AS [n]
WHERE [n].[Id] = @__Parse_0
2025-02-05 00:49:28.741 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__Parse_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [n].[Id], [n].[additional_data], [n].[Body], [n].[body_ar], [n].[body_en], [n].[created_at], [n].[expiry_at], [n].[Route], [n].[target_criteria], [n].[Title], [n].[title_ar], [n].[title_en]
FROM [notification_templates] AS [n]
WHERE [n].[Id] = @__Parse_0
2025-02-05 00:49:28.750 +03:00 [INF] Executed DbCommand (6ms) [Parameters=[@p0='?' (Size = 4000), @p1='?' (DbType = DateTime2), @p2='?' (Size = 4000), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (Size = 450), @p6='?' (Size = 4000), @p7='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [AuthLogs] ([AuthType], [CreatedAt], [DeviceId], [FailureReason], [IpAddress], [NationalId], [Status], [UserAgent])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7);
2025-02-05 00:49:28.777 +03:00 [ERR] An exception occurred in the database while saving changes for context type 'NayifatAPI.Data.ApplicationDbContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_AuthLogs_Customers_NationalId". The conflict occurred in database "NayifatApp", table "dbo.Customers", column 'NationalId'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:832a8596-96b0-492a-9fef-54a3b30be4c7
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_AuthLogs_Customers_NationalId". The conflict occurred in database "NayifatApp", table "dbo.Customers", column 'NationalId'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:832a8596-96b0-492a-9fef-54a3b30be4c7
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2025-02-05 00:49:28.821 +03:00 [ERR] Error logging audit event. NationalId: all, Action: notification_delivered, Details: {"notification_count":2,"notification_ids":[5,3],"timestamp":"2025-02-05T00:49:28.730155"}
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_AuthLogs_Customers_NationalId". The conflict occurred in database "NayifatApp", table "dbo.Customers", column 'NationalId'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:832a8596-96b0-492a-9fef-54a3b30be4c7
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at NayifatAPI.Services.AuditLogService.LogAsync(String nationalId, String action, Object details) in C:\Users\yamta\StudioProjects\nayifat_app_2025_new\nayifatapi\Services\AuditLogService.cs:line 36
2025-02-05 00:49:28.838 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 00:49:28.839 +03:00 [INF] Executed action NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI) in 150.3242ms
2025-02-05 00:49:28.841 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI)'
2025-02-05 00:49:28.842 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/list - 200 null application/json; charset=utf-8 195.5018ms
2025-02-05 00:50:06.511 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/list - application/json 39
2025-02-05 00:50:06.518 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI)'
2025-02-05 00:50:06.520 +03:00 [INF] Route matched with {action = "GetNotifications", controller = "Notifications"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetNotifications(NayifatAPI.Controllers.GetNotificationsRequest) on controller NayifatAPI.Controllers.NotificationsController (NayifatAPI).
2025-02-05 00:50:06.531 +03:00 [INF] Executed DbCommand (5ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 00:50:06.540 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[@__request_NationalId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[national_id], [u].[last_updated], [u].[notifications]
FROM [user_notifications] AS [u]
WHERE [u].[national_id] = @__request_NationalId_0
2025-02-05 00:50:06.549 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[@__Parse_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [n].[Id], [n].[additional_data], [n].[Body], [n].[body_ar], [n].[body_en], [n].[created_at], [n].[expiry_at], [n].[Route], [n].[target_criteria], [n].[Title], [n].[title_ar], [n].[title_en]
FROM [notification_templates] AS [n]
WHERE [n].[Id] = @__Parse_0
2025-02-05 00:50:06.556 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__Parse_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [n].[Id], [n].[additional_data], [n].[Body], [n].[body_ar], [n].[body_en], [n].[created_at], [n].[expiry_at], [n].[Route], [n].[target_criteria], [n].[Title], [n].[title_ar], [n].[title_en]
FROM [notification_templates] AS [n]
WHERE [n].[Id] = @__Parse_0
2025-02-05 00:50:06.571 +03:00 [INF] Executed DbCommand (5ms) [Parameters=[@p0='?' (Size = 4000), @p1='?' (DbType = DateTime2), @p2='?' (Size = 4000), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (Size = 450), @p6='?' (Size = 4000), @p7='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [AuthLogs] ([AuthType], [CreatedAt], [DeviceId], [FailureReason], [IpAddress], [NationalId], [Status], [UserAgent])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7);
2025-02-05 00:50:06.578 +03:00 [ERR] An exception occurred in the database while saving changes for context type 'NayifatAPI.Data.ApplicationDbContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_AuthLogs_Customers_NationalId". The conflict occurred in database "NayifatApp", table "dbo.Customers", column 'NationalId'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:832a8596-96b0-492a-9fef-54a3b30be4c7
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_AuthLogs_Customers_NationalId". The conflict occurred in database "NayifatApp", table "dbo.Customers", column 'NationalId'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:832a8596-96b0-492a-9fef-54a3b30be4c7
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2025-02-05 00:50:06.614 +03:00 [ERR] Error logging audit event. NationalId: all, Action: notification_delivered, Details: {"notification_count":2,"notification_ids":[5,3],"timestamp":"2025-02-05T00:50:06.5459867"}
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_AuthLogs_Customers_NationalId". The conflict occurred in database "NayifatApp", table "dbo.Customers", column 'NationalId'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:832a8596-96b0-492a-9fef-54a3b30be4c7
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at NayifatAPI.Services.AuditLogService.LogAsync(String nationalId, String action, Object details) in C:\Users\yamta\StudioProjects\nayifat_app_2025_new\nayifatapi\Services\AuditLogService.cs:line 36
2025-02-05 00:50:06.645 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 00:50:06.647 +03:00 [INF] Executed action NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI) in 123.2435ms
2025-02-05 00:50:06.650 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI)'
2025-02-05 00:50:06.653 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/list - 200 null application/json; charset=utf-8 142.2248ms
2025-02-05 00:50:33.965 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/timestamps - application/json; charset=utf-8 2
2025-02-05 00:50:33.968 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.ContentController.GetTimestamps (NayifatAPI)'
2025-02-05 00:50:33.970 +03:00 [INF] Route matched with {action = "GetTimestamps", controller = "Content"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetTimestamps() on controller NayifatAPI.Controllers.ContentController (NayifatAPI).
2025-02-05 00:50:33.974 +03:00 [INF] TTT_
2025-02-05 00:50:33.976 +03:00 [INF] TTT_=== Getting Content Timestamps ===
2025-02-05 00:50:33.979 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 00:50:33.984 +03:00 [INF] TTT_Fetching timestamps from database
2025-02-05 00:50:33.988 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [m].[page] AS [Page], [m].[key_name] AS [KeyName], [m].[last_updated] AS [LastUpdated]
FROM [master_config] AS [m]
2025-02-05 00:50:33.991 +03:00 [INF] TTT_Found 18 content items
2025-02-05 00:50:33.993 +03:00 [INF] TTT_Page: home
2025-02-05 00:50:33.995 +03:00 [INF] TTT_  - slideshow_content: "2025-02-04T10:01:06.9430000"
2025-02-05 00:50:33.997 +03:00 [INF] TTT_  - slideshow_content_ar: "2025-02-04T10:01:06.9430000"
2025-02-05 00:50:34.000 +03:00 [INF] TTT_  - contact_details: "2025-02-04T10:01:06.9430000"
2025-02-05 00:50:34.002 +03:00 [INF] TTT_  - contact_details_ar: "2025-02-04T10:01:06.9430000"
2025-02-05 00:50:34.003 +03:00 [INF] TTT_  - termsEN1: "2025-02-03T14:23:58.0000000"
2025-02-05 00:50:34.004 +03:00 [INF] TTT_  - termsEN2: "2025-02-03T14:25:20.1730000"
2025-02-05 00:50:34.004 +03:00 [INF] TTT_  - privacyEN1: "2025-02-03T14:26:08.6130000"
2025-02-05 00:50:34.006 +03:00 [INF] TTT_  - privacyEN2: "2025-02-03T14:25:20.1730000"
2025-02-05 00:50:34.008 +03:00 [INF] TTT_  - termsAR1: "2025-02-03T14:23:58.0000000"
2025-02-05 00:50:34.009 +03:00 [INF] TTT_  - termsAR2: "2025-02-03T14:25:20.1730000"
2025-02-05 00:50:34.010 +03:00 [INF] TTT_  - privacyAR1: "2025-02-03T14:26:08.6130000"
2025-02-05 00:50:34.011 +03:00 [INF] TTT_  - privacyAR2: "2025-02-03T14:25:20.1730000"
2025-02-05 00:50:34.012 +03:00 [INF] TTT_  - terms&conditionsCC_AR: "2025-02-03T17:06:57.7700000"
2025-02-05 00:50:34.014 +03:00 [INF] TTT_  - terms&conditionsCC_EN: "2025-02-03T17:07:47.4900000"
2025-02-05 00:50:34.015 +03:00 [INF] TTT_  - terms&conditionsPF_AR: "2025-02-03T17:06:57.7700000"
2025-02-05 00:50:34.017 +03:00 [INF] TTT_  - terms&conditionsPF_EN: "2025-02-03T17:06:57.7700000"
2025-02-05 00:50:34.018 +03:00 [INF] TTT_Page: loans
2025-02-05 00:50:34.020 +03:00 [INF] TTT_  - loan_ad: "2025-02-04T10:01:06.9430000"
2025-02-05 00:50:34.021 +03:00 [INF] TTT_Page: cards
2025-02-05 00:50:34.021 +03:00 [INF] TTT_  - card_ad: "2025-02-04T10:01:06.9430000"
2025-02-05 00:50:34.022 +03:00 [INF] TTT_Successfully retrieved all timestamps
2025-02-05 00:50:34.023 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 00:50:34.024 +03:00 [INF] Executed action NayifatAPI.Controllers.ContentController.GetTimestamps (NayifatAPI) in 50.4228ms
2025-02-05 00:50:34.025 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.ContentController.GetTimestamps (NayifatAPI)'
2025-02-05 00:50:34.027 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/timestamps - 200 null application/json; charset=utf-8 61.8975ms
2025-02-05 00:50:35.503 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - application/json; charset=utf-8 45
2025-02-05 00:50:35.516 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 00:50:35.518 +03:00 [INF] Route matched with {action = "MasterFetch", controller = "Content"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] MasterFetch(NayifatAPI.Controllers.MasterFetchRequest) on controller NayifatAPI.Controllers.ContentController (NayifatAPI).
2025-02-05 00:50:35.521 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 00:50:35.524 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__request_Page_0='?' (Size = 450), @__request_KeyName_1='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[config_id], [m].[key_name], [m].[last_updated], [m].[page], [m].[value]
FROM [master_config] AS [m]
WHERE [m].[page] = @__request_Page_0 AND [m].[key_name] = @__request_KeyName_1
2025-02-05 00:50:35.527 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 00:50:35.527 +03:00 [INF] Executed action NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI) in 7.7327ms
2025-02-05 00:50:35.528 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 00:50:35.529 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - 200 null application/json; charset=utf-8 25.8297ms
2025-02-05 00:50:41.112 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - application/json; charset=utf-8 48
2025-02-05 00:50:41.121 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 00:50:41.122 +03:00 [INF] Route matched with {action = "MasterFetch", controller = "Content"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] MasterFetch(NayifatAPI.Controllers.MasterFetchRequest) on controller NayifatAPI.Controllers.ContentController (NayifatAPI).
2025-02-05 00:50:41.125 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 00:50:41.128 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__request_Page_0='?' (Size = 450), @__request_KeyName_1='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[config_id], [m].[key_name], [m].[last_updated], [m].[page], [m].[value]
FROM [master_config] AS [m]
WHERE [m].[page] = @__request_Page_0 AND [m].[key_name] = @__request_KeyName_1
2025-02-05 00:50:41.129 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 00:50:41.130 +03:00 [INF] Executed action NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI) in 6.364ms
2025-02-05 00:50:41.131 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 00:50:41.131 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - 200 null application/json; charset=utf-8 19.7884ms
2025-02-05 00:50:46.273 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - application/json; charset=utf-8 43
2025-02-05 00:50:46.287 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 00:50:46.292 +03:00 [INF] Route matched with {action = "MasterFetch", controller = "Content"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] MasterFetch(NayifatAPI.Controllers.MasterFetchRequest) on controller NayifatAPI.Controllers.ContentController (NayifatAPI).
2025-02-05 00:50:46.298 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 00:50:46.301 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__request_Page_0='?' (Size = 450), @__request_KeyName_1='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[config_id], [m].[key_name], [m].[last_updated], [m].[page], [m].[value]
FROM [master_config] AS [m]
WHERE [m].[page] = @__request_Page_0 AND [m].[key_name] = @__request_KeyName_1
2025-02-05 00:50:46.303 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 00:50:46.303 +03:00 [INF] Executed action NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI) in 6.0807ms
2025-02-05 00:50:46.304 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 00:50:46.305 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - 200 null application/json; charset=utf-8 31.8309ms
2025-02-05 00:50:47.290 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - application/json; charset=utf-8 46
2025-02-05 00:50:47.305 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 00:50:47.308 +03:00 [INF] Route matched with {action = "MasterFetch", controller = "Content"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] MasterFetch(NayifatAPI.Controllers.MasterFetchRequest) on controller NayifatAPI.Controllers.ContentController (NayifatAPI).
2025-02-05 00:50:47.312 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 00:50:47.314 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__request_Page_0='?' (Size = 450), @__request_KeyName_1='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[config_id], [m].[key_name], [m].[last_updated], [m].[page], [m].[value]
FROM [master_config] AS [m]
WHERE [m].[page] = @__request_Page_0 AND [m].[key_name] = @__request_KeyName_1
2025-02-05 00:50:47.316 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 00:50:47.317 +03:00 [INF] Executed action NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI) in 6.2062ms
2025-02-05 00:50:47.318 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 00:50:47.318 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - 200 null application/json; charset=utf-8 27.8904ms
2025-02-05 00:50:48.109 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - application/json; charset=utf-8 36
2025-02-05 00:50:48.115 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 00:50:48.116 +03:00 [INF] Route matched with {action = "MasterFetch", controller = "Content"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] MasterFetch(NayifatAPI.Controllers.MasterFetchRequest) on controller NayifatAPI.Controllers.ContentController (NayifatAPI).
2025-02-05 00:50:48.117 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 00:50:48.120 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__request_Page_0='?' (Size = 450), @__request_KeyName_1='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[config_id], [m].[key_name], [m].[last_updated], [m].[page], [m].[value]
FROM [master_config] AS [m]
WHERE [m].[page] = @__request_Page_0 AND [m].[key_name] = @__request_KeyName_1
2025-02-05 00:50:48.121 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 00:50:48.123 +03:00 [INF] Executed action NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI) in 6.348ms
2025-02-05 00:50:48.126 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 00:50:48.126 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - 200 null application/json; charset=utf-8 17.3585ms
2025-02-05 00:50:49.096 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - application/json; charset=utf-8 36
2025-02-05 00:50:49.108 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 00:50:49.109 +03:00 [INF] Route matched with {action = "MasterFetch", controller = "Content"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] MasterFetch(NayifatAPI.Controllers.MasterFetchRequest) on controller NayifatAPI.Controllers.ContentController (NayifatAPI).
2025-02-05 00:50:49.113 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 00:50:49.116 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__request_Page_0='?' (Size = 450), @__request_KeyName_1='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[config_id], [m].[key_name], [m].[last_updated], [m].[page], [m].[value]
FROM [master_config] AS [m]
WHERE [m].[page] = @__request_Page_0 AND [m].[key_name] = @__request_KeyName_1
2025-02-05 00:50:49.117 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 00:50:49.118 +03:00 [INF] Executed action NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI) in 5.7479ms
2025-02-05 00:50:49.119 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 00:50:49.119 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - 200 null application/json; charset=utf-8 23.8238ms
2025-02-05 00:50:50.093 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - application/json; charset=utf-8 38
2025-02-05 00:50:50.106 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 00:50:50.108 +03:00 [INF] Route matched with {action = "MasterFetch", controller = "Content"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] MasterFetch(NayifatAPI.Controllers.MasterFetchRequest) on controller NayifatAPI.Controllers.ContentController (NayifatAPI).
2025-02-05 00:50:50.112 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 00:50:50.114 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__request_Page_0='?' (Size = 450), @__request_KeyName_1='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[config_id], [m].[key_name], [m].[last_updated], [m].[page], [m].[value]
FROM [master_config] AS [m]
WHERE [m].[page] = @__request_Page_0 AND [m].[key_name] = @__request_KeyName_1
2025-02-05 00:50:50.116 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 00:50:50.117 +03:00 [INF] Executed action NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI) in 5.9969ms
2025-02-05 00:50:50.118 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 00:50:50.118 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - 200 null application/json; charset=utf-8 25.4781ms
2025-02-05 00:50:51.081 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - application/json; charset=utf-8 38
2025-02-05 00:50:51.094 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 00:50:51.099 +03:00 [INF] Route matched with {action = "MasterFetch", controller = "Content"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] MasterFetch(NayifatAPI.Controllers.MasterFetchRequest) on controller NayifatAPI.Controllers.ContentController (NayifatAPI).
2025-02-05 00:50:51.104 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 00:50:51.106 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__request_Page_0='?' (Size = 450), @__request_KeyName_1='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[config_id], [m].[key_name], [m].[last_updated], [m].[page], [m].[value]
FROM [master_config] AS [m]
WHERE [m].[page] = @__request_Page_0 AND [m].[key_name] = @__request_KeyName_1
2025-02-05 00:50:51.110 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 00:50:51.111 +03:00 [INF] Executed action NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI) in 8.2064ms
2025-02-05 00:50:51.112 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 00:50:51.112 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - 200 null application/json; charset=utf-8 30.9123ms
2025-02-05 00:50:51.990 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - application/json; charset=utf-8 36
2025-02-05 00:50:52.000 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 00:50:52.000 +03:00 [INF] Route matched with {action = "MasterFetch", controller = "Content"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] MasterFetch(NayifatAPI.Controllers.MasterFetchRequest) on controller NayifatAPI.Controllers.ContentController (NayifatAPI).
2025-02-05 00:50:52.004 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 00:50:52.006 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__request_Page_0='?' (Size = 450), @__request_KeyName_1='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[config_id], [m].[key_name], [m].[last_updated], [m].[page], [m].[value]
FROM [master_config] AS [m]
WHERE [m].[page] = @__request_Page_0 AND [m].[key_name] = @__request_KeyName_1
2025-02-05 00:50:52.008 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 00:50:52.009 +03:00 [INF] Executed action NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI) in 5.96ms
2025-02-05 00:50:52.009 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 00:50:52.010 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - 200 null application/json; charset=utf-8 19.7561ms
2025-02-05 00:50:52.921 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - application/json; charset=utf-8 36
2025-02-05 00:50:52.933 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 00:50:52.934 +03:00 [INF] Route matched with {action = "MasterFetch", controller = "Content"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] MasterFetch(NayifatAPI.Controllers.MasterFetchRequest) on controller NayifatAPI.Controllers.ContentController (NayifatAPI).
2025-02-05 00:50:52.939 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 00:50:52.942 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__request_Page_0='?' (Size = 450), @__request_KeyName_1='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[config_id], [m].[key_name], [m].[last_updated], [m].[page], [m].[value]
FROM [master_config] AS [m]
WHERE [m].[page] = @__request_Page_0 AND [m].[key_name] = @__request_KeyName_1
2025-02-05 00:50:52.943 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 00:50:52.944 +03:00 [INF] Executed action NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI) in 6.7546ms
2025-02-05 00:50:52.945 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 00:50:52.946 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - 200 null application/json; charset=utf-8 24.4193ms
2025-02-05 00:50:53.863 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - application/json; charset=utf-8 38
2025-02-05 00:50:53.877 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 00:50:53.881 +03:00 [INF] Route matched with {action = "MasterFetch", controller = "Content"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] MasterFetch(NayifatAPI.Controllers.MasterFetchRequest) on controller NayifatAPI.Controllers.ContentController (NayifatAPI).
2025-02-05 00:50:53.884 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 00:50:53.889 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__request_Page_0='?' (Size = 450), @__request_KeyName_1='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[config_id], [m].[key_name], [m].[last_updated], [m].[page], [m].[value]
FROM [master_config] AS [m]
WHERE [m].[page] = @__request_Page_0 AND [m].[key_name] = @__request_KeyName_1
2025-02-05 00:50:53.891 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 00:50:53.891 +03:00 [INF] Executed action NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI) in 8.4821ms
2025-02-05 00:50:53.892 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 00:50:53.893 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - 200 null application/json; charset=utf-8 29.8401ms
2025-02-05 00:50:54.815 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - application/json; charset=utf-8 38
2025-02-05 00:50:54.818 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 00:50:54.819 +03:00 [INF] Route matched with {action = "MasterFetch", controller = "Content"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] MasterFetch(NayifatAPI.Controllers.MasterFetchRequest) on controller NayifatAPI.Controllers.ContentController (NayifatAPI).
2025-02-05 00:50:54.828 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 00:50:54.833 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__request_Page_0='?' (Size = 450), @__request_KeyName_1='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[config_id], [m].[key_name], [m].[last_updated], [m].[page], [m].[value]
FROM [master_config] AS [m]
WHERE [m].[page] = @__request_Page_0 AND [m].[key_name] = @__request_KeyName_1
2025-02-05 00:50:54.836 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 00:50:54.837 +03:00 [INF] Executed action NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI) in 17.0399ms
2025-02-05 00:50:54.838 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 00:50:54.839 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - 200 null application/json; charset=utf-8 24.5461ms
2025-02-05 00:50:55.701 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - application/json; charset=utf-8 49
2025-02-05 00:50:55.704 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 00:50:55.705 +03:00 [INF] Route matched with {action = "MasterFetch", controller = "Content"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] MasterFetch(NayifatAPI.Controllers.MasterFetchRequest) on controller NayifatAPI.Controllers.ContentController (NayifatAPI).
2025-02-05 00:50:55.710 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 00:50:55.715 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__request_Page_0='?' (Size = 450), @__request_KeyName_1='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[config_id], [m].[key_name], [m].[last_updated], [m].[page], [m].[value]
FROM [master_config] AS [m]
WHERE [m].[page] = @__request_Page_0 AND [m].[key_name] = @__request_KeyName_1
2025-02-05 00:50:55.717 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 00:50:55.718 +03:00 [INF] Executed action NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI) in 11.4311ms
2025-02-05 00:50:55.719 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 00:50:55.720 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - 200 null application/json; charset=utf-8 19.7383ms
2025-02-05 00:50:56.549 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - application/json; charset=utf-8 49
2025-02-05 00:50:56.557 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 00:50:56.558 +03:00 [INF] Route matched with {action = "MasterFetch", controller = "Content"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] MasterFetch(NayifatAPI.Controllers.MasterFetchRequest) on controller NayifatAPI.Controllers.ContentController (NayifatAPI).
2025-02-05 00:50:56.562 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 00:50:56.569 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[@__request_Page_0='?' (Size = 450), @__request_KeyName_1='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[config_id], [m].[key_name], [m].[last_updated], [m].[page], [m].[value]
FROM [master_config] AS [m]
WHERE [m].[page] = @__request_Page_0 AND [m].[key_name] = @__request_KeyName_1
2025-02-05 00:50:56.571 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 00:50:56.572 +03:00 [INF] Executed action NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI) in 12.1193ms
2025-02-05 00:50:56.573 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 00:50:56.573 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - 200 null application/json; charset=utf-8 23.8489ms
2025-02-05 00:50:57.555 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - application/json; charset=utf-8 49
2025-02-05 00:50:57.563 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 00:50:57.564 +03:00 [INF] Route matched with {action = "MasterFetch", controller = "Content"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] MasterFetch(NayifatAPI.Controllers.MasterFetchRequest) on controller NayifatAPI.Controllers.ContentController (NayifatAPI).
2025-02-05 00:50:57.568 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 00:50:57.571 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__request_Page_0='?' (Size = 450), @__request_KeyName_1='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[config_id], [m].[key_name], [m].[last_updated], [m].[page], [m].[value]
FROM [master_config] AS [m]
WHERE [m].[page] = @__request_Page_0 AND [m].[key_name] = @__request_KeyName_1
2025-02-05 00:50:57.573 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 00:50:57.573 +03:00 [INF] Executed action NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI) in 7.8312ms
2025-02-05 00:50:57.574 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 00:50:57.575 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - 200 null application/json; charset=utf-8 20.3132ms
2025-02-05 00:50:58.474 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - application/json; charset=utf-8 49
2025-02-05 00:50:58.476 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 00:50:58.477 +03:00 [INF] Route matched with {action = "MasterFetch", controller = "Content"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] MasterFetch(NayifatAPI.Controllers.MasterFetchRequest) on controller NayifatAPI.Controllers.ContentController (NayifatAPI).
2025-02-05 00:50:58.483 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 00:50:58.487 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__request_Page_0='?' (Size = 450), @__request_KeyName_1='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[config_id], [m].[key_name], [m].[last_updated], [m].[page], [m].[value]
FROM [master_config] AS [m]
WHERE [m].[page] = @__request_Page_0 AND [m].[key_name] = @__request_KeyName_1
2025-02-05 00:50:58.488 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 00:50:58.489 +03:00 [INF] Executed action NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI) in 10.5491ms
2025-02-05 00:50:58.490 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 00:50:58.491 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - 200 null application/json; charset=utf-8 16.9943ms
2025-02-05 00:50:59.414 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - application/json; charset=utf-8 36
2025-02-05 00:50:59.423 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 00:50:59.424 +03:00 [INF] Route matched with {action = "MasterFetch", controller = "Content"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] MasterFetch(NayifatAPI.Controllers.MasterFetchRequest) on controller NayifatAPI.Controllers.ContentController (NayifatAPI).
2025-02-05 00:50:59.428 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 00:50:59.433 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__request_Page_0='?' (Size = 450), @__request_KeyName_1='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[config_id], [m].[key_name], [m].[last_updated], [m].[page], [m].[value]
FROM [master_config] AS [m]
WHERE [m].[page] = @__request_Page_0 AND [m].[key_name] = @__request_KeyName_1
2025-02-05 00:50:59.435 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 00:50:59.436 +03:00 [INF] Executed action NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI) in 10.3495ms
2025-02-05 00:50:59.436 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 00:50:59.437 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - 200 null application/json; charset=utf-8 23.1491ms
2025-02-05 00:51:01.570 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - application/json; charset=utf-8 36
2025-02-05 00:51:01.577 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 00:51:01.580 +03:00 [INF] Route matched with {action = "MasterFetch", controller = "Content"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] MasterFetch(NayifatAPI.Controllers.MasterFetchRequest) on controller NayifatAPI.Controllers.ContentController (NayifatAPI).
2025-02-05 00:51:01.590 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 00:51:01.600 +03:00 [INF] Executed DbCommand (4ms) [Parameters=[@__request_Page_0='?' (Size = 450), @__request_KeyName_1='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[config_id], [m].[key_name], [m].[last_updated], [m].[page], [m].[value]
FROM [master_config] AS [m]
WHERE [m].[page] = @__request_Page_0 AND [m].[key_name] = @__request_KeyName_1
2025-02-05 00:51:01.604 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 00:51:01.606 +03:00 [INF] Executed action NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI) in 22.2864ms
2025-02-05 00:51:01.608 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 00:51:01.611 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - 200 null application/json; charset=utf-8 40.7754ms
2025-02-05 00:58:47.339 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/list - application/json; charset=utf-8 45
2025-02-05 00:58:47.346 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI)'
2025-02-05 00:58:47.348 +03:00 [INF] Route matched with {action = "GetNotifications", controller = "Notifications"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetNotifications(NayifatAPI.Controllers.GetNotificationsRequest) on controller NayifatAPI.Controllers.NotificationsController (NayifatAPI).
2025-02-05 00:58:47.364 +03:00 [INF] Executed DbCommand (4ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 00:58:47.370 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[@__request_NationalId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[national_id], [u].[last_updated], [u].[notifications]
FROM [user_notifications] AS [u]
WHERE [u].[national_id] = @__request_NationalId_0
2025-02-05 00:58:47.373 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 00:58:47.374 +03:00 [INF] Executed action NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI) in 22.6145ms
2025-02-05 00:58:47.378 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI)'
2025-02-05 00:58:47.380 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/list - 200 null application/json; charset=utf-8 40.3745ms
2025-02-05 00:58:47.867 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/timestamps - application/json; charset=utf-8 2
2025-02-05 00:58:47.874 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.ContentController.GetTimestamps (NayifatAPI)'
2025-02-05 00:58:47.876 +03:00 [INF] Route matched with {action = "GetTimestamps", controller = "Content"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetTimestamps() on controller NayifatAPI.Controllers.ContentController (NayifatAPI).
2025-02-05 00:58:47.882 +03:00 [INF] TTT_
2025-02-05 00:58:47.883 +03:00 [INF] TTT_=== Getting Content Timestamps ===
2025-02-05 00:58:47.887 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 00:58:47.892 +03:00 [INF] TTT_Fetching timestamps from database
2025-02-05 00:58:47.896 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [m].[page] AS [Page], [m].[key_name] AS [KeyName], [m].[last_updated] AS [LastUpdated]
FROM [master_config] AS [m]
2025-02-05 00:58:47.899 +03:00 [INF] TTT_Found 18 content items
2025-02-05 00:58:47.901 +03:00 [INF] TTT_Page: home
2025-02-05 00:58:47.902 +03:00 [INF] TTT_  - slideshow_content: "2025-02-04T10:01:06.9430000"
2025-02-05 00:58:47.904 +03:00 [INF] TTT_  - slideshow_content_ar: "2025-02-04T10:01:06.9430000"
2025-02-05 00:58:47.906 +03:00 [INF] TTT_  - contact_details: "2025-02-04T10:01:06.9430000"
2025-02-05 00:58:47.908 +03:00 [INF] TTT_  - contact_details_ar: "2025-02-04T10:01:06.9430000"
2025-02-05 00:58:47.910 +03:00 [INF] TTT_  - termsEN1: "2025-02-03T14:23:58.0000000"
2025-02-05 00:58:47.912 +03:00 [INF] TTT_  - termsEN2: "2025-02-03T14:25:20.1730000"
2025-02-05 00:58:47.913 +03:00 [INF] TTT_  - privacyEN1: "2025-02-03T14:26:08.6130000"
2025-02-05 00:58:47.914 +03:00 [INF] TTT_  - privacyEN2: "2025-02-03T14:25:20.1730000"
2025-02-05 00:58:47.916 +03:00 [INF] TTT_  - termsAR1: "2025-02-03T14:23:58.0000000"
2025-02-05 00:58:47.917 +03:00 [INF] TTT_  - termsAR2: "2025-02-03T14:25:20.1730000"
2025-02-05 00:58:47.919 +03:00 [INF] TTT_  - privacyAR1: "2025-02-03T14:26:08.6130000"
2025-02-05 00:58:47.921 +03:00 [INF] TTT_  - privacyAR2: "2025-02-03T14:25:20.1730000"
2025-02-05 00:58:47.922 +03:00 [INF] TTT_  - terms&conditionsCC_AR: "2025-02-03T17:06:57.7700000"
2025-02-05 00:58:47.924 +03:00 [INF] TTT_  - terms&conditionsCC_EN: "2025-02-03T17:07:47.4900000"
2025-02-05 00:58:47.925 +03:00 [INF] TTT_  - terms&conditionsPF_AR: "2025-02-03T17:06:57.7700000"
2025-02-05 00:58:47.926 +03:00 [INF] TTT_  - terms&conditionsPF_EN: "2025-02-03T17:06:57.7700000"
2025-02-05 00:58:47.928 +03:00 [INF] TTT_Page: loans
2025-02-05 00:58:47.929 +03:00 [INF] TTT_  - loan_ad: "2025-02-04T10:01:06.9430000"
2025-02-05 00:58:47.931 +03:00 [INF] TTT_Page: cards
2025-02-05 00:58:47.932 +03:00 [INF] TTT_  - card_ad: "2025-02-04T10:01:06.9430000"
2025-02-05 00:58:47.933 +03:00 [INF] TTT_Successfully retrieved all timestamps
2025-02-05 00:58:47.935 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 00:58:47.936 +03:00 [INF] Executed action NayifatAPI.Controllers.ContentController.GetTimestamps (NayifatAPI) in 54.8698ms
2025-02-05 00:58:47.939 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.ContentController.GetTimestamps (NayifatAPI)'
2025-02-05 00:58:47.942 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/timestamps - 200 null application/json; charset=utf-8 75.0945ms
2025-02-05 00:58:48.773 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - application/json; charset=utf-8 45
2025-02-05 00:58:48.779 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 00:58:48.783 +03:00 [INF] Route matched with {action = "MasterFetch", controller = "Content"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] MasterFetch(NayifatAPI.Controllers.MasterFetchRequest) on controller NayifatAPI.Controllers.ContentController (NayifatAPI).
2025-02-05 00:58:48.789 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 00:58:48.799 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[@__request_Page_0='?' (Size = 450), @__request_KeyName_1='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[config_id], [m].[key_name], [m].[last_updated], [m].[page], [m].[value]
FROM [master_config] AS [m]
WHERE [m].[page] = @__request_Page_0 AND [m].[key_name] = @__request_KeyName_1
2025-02-05 00:58:48.804 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 00:58:48.806 +03:00 [INF] Executed action NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI) in 18.666ms
2025-02-05 00:58:48.809 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 00:58:48.810 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - 200 null application/json; charset=utf-8 37.7437ms
2025-02-05 00:58:53.954 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - application/json; charset=utf-8 48
2025-02-05 00:58:53.959 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 00:58:53.964 +03:00 [INF] Route matched with {action = "MasterFetch", controller = "Content"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] MasterFetch(NayifatAPI.Controllers.MasterFetchRequest) on controller NayifatAPI.Controllers.ContentController (NayifatAPI).
2025-02-05 00:58:53.969 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 00:58:53.973 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__request_Page_0='?' (Size = 450), @__request_KeyName_1='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[config_id], [m].[key_name], [m].[last_updated], [m].[page], [m].[value]
FROM [master_config] AS [m]
WHERE [m].[page] = @__request_Page_0 AND [m].[key_name] = @__request_KeyName_1
2025-02-05 00:58:53.978 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 00:58:53.980 +03:00 [INF] Executed action NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI) in 12.1152ms
2025-02-05 00:58:53.983 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 00:58:53.985 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - 200 null application/json; charset=utf-8 31.2999ms
2025-02-05 00:58:57.375 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - application/json; charset=utf-8 43
2025-02-05 00:58:57.380 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 00:58:57.381 +03:00 [INF] Route matched with {action = "MasterFetch", controller = "Content"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] MasterFetch(NayifatAPI.Controllers.MasterFetchRequest) on controller NayifatAPI.Controllers.ContentController (NayifatAPI).
2025-02-05 00:58:57.387 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 00:58:57.392 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__request_Page_0='?' (Size = 450), @__request_KeyName_1='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[config_id], [m].[key_name], [m].[last_updated], [m].[page], [m].[value]
FROM [master_config] AS [m]
WHERE [m].[page] = @__request_Page_0 AND [m].[key_name] = @__request_KeyName_1
2025-02-05 00:58:57.396 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 00:58:57.397 +03:00 [INF] Executed action NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI) in 11.724ms
2025-02-05 00:58:57.398 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 00:58:57.399 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - 200 null application/json; charset=utf-8 23.804ms
2025-02-05 00:58:58.033 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - application/json; charset=utf-8 46
2025-02-05 00:58:58.039 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 00:58:58.041 +03:00 [INF] Route matched with {action = "MasterFetch", controller = "Content"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] MasterFetch(NayifatAPI.Controllers.MasterFetchRequest) on controller NayifatAPI.Controllers.ContentController (NayifatAPI).
2025-02-05 00:58:58.048 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 00:58:58.053 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__request_Page_0='?' (Size = 450), @__request_KeyName_1='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[config_id], [m].[key_name], [m].[last_updated], [m].[page], [m].[value]
FROM [master_config] AS [m]
WHERE [m].[page] = @__request_Page_0 AND [m].[key_name] = @__request_KeyName_1
2025-02-05 00:58:58.057 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 00:58:58.060 +03:00 [INF] Executed action NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI) in 13.2123ms
2025-02-05 00:58:58.063 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 00:58:58.064 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - 200 null application/json; charset=utf-8 31.8789ms
2025-02-05 00:58:58.779 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - application/json; charset=utf-8 36
2025-02-05 00:58:58.786 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 00:58:58.788 +03:00 [INF] Route matched with {action = "MasterFetch", controller = "Content"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] MasterFetch(NayifatAPI.Controllers.MasterFetchRequest) on controller NayifatAPI.Controllers.ContentController (NayifatAPI).
2025-02-05 00:58:58.794 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 00:58:58.798 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__request_Page_0='?' (Size = 450), @__request_KeyName_1='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[config_id], [m].[key_name], [m].[last_updated], [m].[page], [m].[value]
FROM [master_config] AS [m]
WHERE [m].[page] = @__request_Page_0 AND [m].[key_name] = @__request_KeyName_1
2025-02-05 00:58:58.803 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 00:58:58.806 +03:00 [INF] Executed action NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI) in 13.3263ms
2025-02-05 00:58:58.810 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 00:58:58.812 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - 200 null application/json; charset=utf-8 33.1665ms
2025-02-05 00:58:59.523 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - application/json; charset=utf-8 36
2025-02-05 00:58:59.529 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 00:58:59.530 +03:00 [INF] Route matched with {action = "MasterFetch", controller = "Content"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] MasterFetch(NayifatAPI.Controllers.MasterFetchRequest) on controller NayifatAPI.Controllers.ContentController (NayifatAPI).
2025-02-05 00:58:59.534 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 00:58:59.538 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__request_Page_0='?' (Size = 450), @__request_KeyName_1='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[config_id], [m].[key_name], [m].[last_updated], [m].[page], [m].[value]
FROM [master_config] AS [m]
WHERE [m].[page] = @__request_Page_0 AND [m].[key_name] = @__request_KeyName_1
2025-02-05 00:58:59.542 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 00:58:59.545 +03:00 [INF] Executed action NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI) in 12.3996ms
2025-02-05 00:58:59.547 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 00:58:59.548 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - 200 null application/json; charset=utf-8 25.0497ms
2025-02-05 00:59:00.259 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - application/json; charset=utf-8 38
2025-02-05 00:59:00.264 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 00:59:00.265 +03:00 [INF] Route matched with {action = "MasterFetch", controller = "Content"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] MasterFetch(NayifatAPI.Controllers.MasterFetchRequest) on controller NayifatAPI.Controllers.ContentController (NayifatAPI).
2025-02-05 00:59:00.270 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 00:59:00.275 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__request_Page_0='?' (Size = 450), @__request_KeyName_1='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[config_id], [m].[key_name], [m].[last_updated], [m].[page], [m].[value]
FROM [master_config] AS [m]
WHERE [m].[page] = @__request_Page_0 AND [m].[key_name] = @__request_KeyName_1
2025-02-05 00:59:00.278 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 00:59:00.280 +03:00 [INF] Executed action NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI) in 11.7044ms
2025-02-05 00:59:00.283 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 00:59:00.285 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - 200 null application/json; charset=utf-8 26.0245ms
2025-02-05 00:59:00.907 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - application/json; charset=utf-8 38
2025-02-05 00:59:00.913 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 00:59:00.915 +03:00 [INF] Route matched with {action = "MasterFetch", controller = "Content"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] MasterFetch(NayifatAPI.Controllers.MasterFetchRequest) on controller NayifatAPI.Controllers.ContentController (NayifatAPI).
2025-02-05 00:59:00.922 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 00:59:00.929 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__request_Page_0='?' (Size = 450), @__request_KeyName_1='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[config_id], [m].[key_name], [m].[last_updated], [m].[page], [m].[value]
FROM [master_config] AS [m]
WHERE [m].[page] = @__request_Page_0 AND [m].[key_name] = @__request_KeyName_1
2025-02-05 00:59:00.936 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 00:59:00.939 +03:00 [INF] Executed action NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI) in 18.9866ms
2025-02-05 00:59:00.944 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 00:59:00.946 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - 200 null application/json; charset=utf-8 39.6205ms
2025-02-05 00:59:01.562 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - application/json; charset=utf-8 36
2025-02-05 00:59:01.569 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 00:59:01.571 +03:00 [INF] Route matched with {action = "MasterFetch", controller = "Content"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] MasterFetch(NayifatAPI.Controllers.MasterFetchRequest) on controller NayifatAPI.Controllers.ContentController (NayifatAPI).
2025-02-05 00:59:01.577 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 00:59:01.583 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__request_Page_0='?' (Size = 450), @__request_KeyName_1='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[config_id], [m].[key_name], [m].[last_updated], [m].[page], [m].[value]
FROM [master_config] AS [m]
WHERE [m].[page] = @__request_Page_0 AND [m].[key_name] = @__request_KeyName_1
2025-02-05 00:59:01.587 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 00:59:01.590 +03:00 [INF] Executed action NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI) in 14.553ms
2025-02-05 00:59:01.593 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 00:59:01.596 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - 200 null application/json; charset=utf-8 33.8334ms
2025-02-05 00:59:02.198 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - application/json; charset=utf-8 36
2025-02-05 00:59:02.202 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 00:59:02.204 +03:00 [INF] Route matched with {action = "MasterFetch", controller = "Content"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] MasterFetch(NayifatAPI.Controllers.MasterFetchRequest) on controller NayifatAPI.Controllers.ContentController (NayifatAPI).
2025-02-05 00:59:02.210 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 00:59:02.215 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__request_Page_0='?' (Size = 450), @__request_KeyName_1='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[config_id], [m].[key_name], [m].[last_updated], [m].[page], [m].[value]
FROM [master_config] AS [m]
WHERE [m].[page] = @__request_Page_0 AND [m].[key_name] = @__request_KeyName_1
2025-02-05 00:59:02.218 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 00:59:02.220 +03:00 [INF] Executed action NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI) in 11.0941ms
2025-02-05 00:59:02.222 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 00:59:02.223 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - 200 null application/json; charset=utf-8 25.1489ms
2025-02-05 00:59:02.861 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - application/json; charset=utf-8 38
2025-02-05 00:59:02.863 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 00:59:02.864 +03:00 [INF] Route matched with {action = "MasterFetch", controller = "Content"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] MasterFetch(NayifatAPI.Controllers.MasterFetchRequest) on controller NayifatAPI.Controllers.ContentController (NayifatAPI).
2025-02-05 00:59:02.867 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 00:59:02.870 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__request_Page_0='?' (Size = 450), @__request_KeyName_1='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[config_id], [m].[key_name], [m].[last_updated], [m].[page], [m].[value]
FROM [master_config] AS [m]
WHERE [m].[page] = @__request_Page_0 AND [m].[key_name] = @__request_KeyName_1
2025-02-05 00:59:02.871 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 00:59:02.873 +03:00 [INF] Executed action NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI) in 6.9976ms
2025-02-05 00:59:02.875 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 00:59:02.876 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - 200 null application/json; charset=utf-8 15.7583ms
2025-02-05 00:59:03.501 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - application/json; charset=utf-8 38
2025-02-05 00:59:03.507 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 00:59:03.510 +03:00 [INF] Route matched with {action = "MasterFetch", controller = "Content"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] MasterFetch(NayifatAPI.Controllers.MasterFetchRequest) on controller NayifatAPI.Controllers.ContentController (NayifatAPI).
2025-02-05 00:59:03.516 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 00:59:03.522 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__request_Page_0='?' (Size = 450), @__request_KeyName_1='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[config_id], [m].[key_name], [m].[last_updated], [m].[page], [m].[value]
FROM [master_config] AS [m]
WHERE [m].[page] = @__request_Page_0 AND [m].[key_name] = @__request_KeyName_1
2025-02-05 00:59:03.528 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 00:59:03.530 +03:00 [INF] Executed action NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI) in 15.6805ms
2025-02-05 00:59:03.532 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 00:59:03.533 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - 200 null application/json; charset=utf-8 32.5793ms
2025-02-05 00:59:04.241 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - application/json; charset=utf-8 49
2025-02-05 00:59:04.247 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 00:59:04.249 +03:00 [INF] Route matched with {action = "MasterFetch", controller = "Content"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] MasterFetch(NayifatAPI.Controllers.MasterFetchRequest) on controller NayifatAPI.Controllers.ContentController (NayifatAPI).
2025-02-05 00:59:04.256 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 00:59:04.262 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__request_Page_0='?' (Size = 450), @__request_KeyName_1='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[config_id], [m].[key_name], [m].[last_updated], [m].[page], [m].[value]
FROM [master_config] AS [m]
WHERE [m].[page] = @__request_Page_0 AND [m].[key_name] = @__request_KeyName_1
2025-02-05 00:59:04.266 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 00:59:04.268 +03:00 [INF] Executed action NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI) in 14.8798ms
2025-02-05 00:59:04.272 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 00:59:04.274 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - 200 null application/json; charset=utf-8 32.7787ms
2025-02-05 00:59:04.957 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - application/json; charset=utf-8 49
2025-02-05 00:59:04.963 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 00:59:04.964 +03:00 [INF] Route matched with {action = "MasterFetch", controller = "Content"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] MasterFetch(NayifatAPI.Controllers.MasterFetchRequest) on controller NayifatAPI.Controllers.ContentController (NayifatAPI).
2025-02-05 00:59:04.971 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 00:59:04.976 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__request_Page_0='?' (Size = 450), @__request_KeyName_1='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[config_id], [m].[key_name], [m].[last_updated], [m].[page], [m].[value]
FROM [master_config] AS [m]
WHERE [m].[page] = @__request_Page_0 AND [m].[key_name] = @__request_KeyName_1
2025-02-05 00:59:04.979 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 00:59:04.981 +03:00 [INF] Executed action NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI) in 12.3223ms
2025-02-05 00:59:04.987 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 00:59:04.988 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - 200 null application/json; charset=utf-8 31.8209ms
2025-02-05 00:59:05.619 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - application/json; charset=utf-8 49
2025-02-05 00:59:05.626 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 00:59:05.628 +03:00 [INF] Route matched with {action = "MasterFetch", controller = "Content"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] MasterFetch(NayifatAPI.Controllers.MasterFetchRequest) on controller NayifatAPI.Controllers.ContentController (NayifatAPI).
2025-02-05 00:59:05.636 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 00:59:05.642 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__request_Page_0='?' (Size = 450), @__request_KeyName_1='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[config_id], [m].[key_name], [m].[last_updated], [m].[page], [m].[value]
FROM [master_config] AS [m]
WHERE [m].[page] = @__request_Page_0 AND [m].[key_name] = @__request_KeyName_1
2025-02-05 00:59:05.647 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 00:59:05.650 +03:00 [INF] Executed action NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI) in 16.9709ms
2025-02-05 00:59:05.654 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 00:59:05.656 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - 200 null application/json; charset=utf-8 37.1814ms
2025-02-05 00:59:06.263 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - application/json; charset=utf-8 49
2025-02-05 00:59:06.268 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 00:59:06.270 +03:00 [INF] Route matched with {action = "MasterFetch", controller = "Content"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] MasterFetch(NayifatAPI.Controllers.MasterFetchRequest) on controller NayifatAPI.Controllers.ContentController (NayifatAPI).
2025-02-05 00:59:06.275 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 00:59:06.280 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__request_Page_0='?' (Size = 450), @__request_KeyName_1='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[config_id], [m].[key_name], [m].[last_updated], [m].[page], [m].[value]
FROM [master_config] AS [m]
WHERE [m].[page] = @__request_Page_0 AND [m].[key_name] = @__request_KeyName_1
2025-02-05 00:59:06.284 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 00:59:06.288 +03:00 [INF] Executed action NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI) in 14.5351ms
2025-02-05 00:59:06.290 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 00:59:06.293 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - 200 null application/json; charset=utf-8 29.5215ms
2025-02-05 00:59:06.884 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - application/json; charset=utf-8 36
2025-02-05 00:59:06.887 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 00:59:06.888 +03:00 [INF] Route matched with {action = "MasterFetch", controller = "Content"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] MasterFetch(NayifatAPI.Controllers.MasterFetchRequest) on controller NayifatAPI.Controllers.ContentController (NayifatAPI).
2025-02-05 00:59:06.894 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 00:59:06.900 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__request_Page_0='?' (Size = 450), @__request_KeyName_1='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[config_id], [m].[key_name], [m].[last_updated], [m].[page], [m].[value]
FROM [master_config] AS [m]
WHERE [m].[page] = @__request_Page_0 AND [m].[key_name] = @__request_KeyName_1
2025-02-05 00:59:06.902 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 00:59:06.903 +03:00 [INF] Executed action NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI) in 11.6754ms
2025-02-05 00:59:06.905 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 00:59:06.906 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - 200 null application/json; charset=utf-8 22.0989ms
2025-02-05 00:59:08.171 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - application/json; charset=utf-8 36
2025-02-05 00:59:08.178 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 00:59:08.180 +03:00 [INF] Route matched with {action = "MasterFetch", controller = "Content"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] MasterFetch(NayifatAPI.Controllers.MasterFetchRequest) on controller NayifatAPI.Controllers.ContentController (NayifatAPI).
2025-02-05 00:59:08.187 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 00:59:08.193 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__request_Page_0='?' (Size = 450), @__request_KeyName_1='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[config_id], [m].[key_name], [m].[last_updated], [m].[page], [m].[value]
FROM [master_config] AS [m]
WHERE [m].[page] = @__request_Page_0 AND [m].[key_name] = @__request_KeyName_1
2025-02-05 00:59:08.196 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 00:59:08.199 +03:00 [INF] Executed action NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI) in 14.0047ms
2025-02-05 00:59:08.203 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 00:59:08.204 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - 200 null application/json; charset=utf-8 32.945ms
2025-02-05 00:59:25.720 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/list - application/json; charset=utf-8 45
2025-02-05 00:59:25.727 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI)'
2025-02-05 00:59:25.729 +03:00 [INF] Route matched with {action = "GetNotifications", controller = "Notifications"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetNotifications(NayifatAPI.Controllers.GetNotificationsRequest) on controller NayifatAPI.Controllers.NotificationsController (NayifatAPI).
2025-02-05 00:59:25.734 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 00:59:25.739 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__request_NationalId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[national_id], [u].[last_updated], [u].[notifications]
FROM [user_notifications] AS [u]
WHERE [u].[national_id] = @__request_NationalId_0
2025-02-05 00:59:25.741 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 00:59:25.744 +03:00 [INF] Executed action NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI) in 10.271ms
2025-02-05 00:59:25.746 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI)'
2025-02-05 00:59:25.748 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/list - 200 null application/json; charset=utf-8 27.8471ms
2025-02-05 01:00:00.505 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/list - application/json 39
2025-02-05 01:00:00.512 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI)'
2025-02-05 01:00:00.514 +03:00 [INF] Route matched with {action = "GetNotifications", controller = "Notifications"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetNotifications(NayifatAPI.Controllers.GetNotificationsRequest) on controller NayifatAPI.Controllers.NotificationsController (NayifatAPI).
2025-02-05 01:00:00.596 +03:00 [INF] Executed DbCommand (78ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 01:00:00.604 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[@__request_NationalId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[national_id], [u].[last_updated], [u].[notifications]
FROM [user_notifications] AS [u]
WHERE [u].[national_id] = @__request_NationalId_0
2025-02-05 01:00:00.606 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/list - application/json 39
2025-02-05 01:00:00.614 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__Parse_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [n].[Id], [n].[additional_data], [n].[Body], [n].[body_ar], [n].[body_en], [n].[created_at], [n].[expiry_at], [n].[Route], [n].[target_criteria], [n].[Title], [n].[title_ar], [n].[title_en]
FROM [notification_templates] AS [n]
WHERE [n].[Id] = @__Parse_0
2025-02-05 01:00:00.616 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI)'
2025-02-05 01:00:00.622 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__Parse_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [n].[Id], [n].[additional_data], [n].[Body], [n].[body_ar], [n].[body_en], [n].[created_at], [n].[expiry_at], [n].[Route], [n].[target_criteria], [n].[Title], [n].[title_ar], [n].[title_en]
FROM [notification_templates] AS [n]
WHERE [n].[Id] = @__Parse_0
2025-02-05 01:00:00.623 +03:00 [INF] Route matched with {action = "GetNotifications", controller = "Notifications"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetNotifications(NayifatAPI.Controllers.GetNotificationsRequest) on controller NayifatAPI.Controllers.NotificationsController (NayifatAPI).
2025-02-05 01:00:00.636 +03:00 [INF] Executed DbCommand (7ms) [Parameters=[@p0='?' (Size = 4000), @p1='?' (DbType = DateTime2), @p2='?' (Size = 4000), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (Size = 450), @p6='?' (Size = 4000), @p7='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [AuthLogs] ([AuthType], [CreatedAt], [DeviceId], [FailureReason], [IpAddress], [NationalId], [Status], [UserAgent])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7);
2025-02-05 01:00:00.642 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 01:00:00.645 +03:00 [ERR] An exception occurred in the database while saving changes for context type 'NayifatAPI.Data.ApplicationDbContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_AuthLogs_Customers_NationalId". The conflict occurred in database "NayifatApp", table "dbo.Customers", column 'NationalId'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:f1f8995a-ad5e-4b92-bc52-453e5e80f624
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_AuthLogs_Customers_NationalId". The conflict occurred in database "NayifatApp", table "dbo.Customers", column 'NationalId'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:f1f8995a-ad5e-4b92-bc52-453e5e80f624
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2025-02-05 01:00:00.648 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__request_NationalId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[national_id], [u].[last_updated], [u].[notifications]
FROM [user_notifications] AS [u]
WHERE [u].[national_id] = @__request_NationalId_0
2025-02-05 01:00:00.671 +03:00 [ERR] Error logging audit event. NationalId: all, Action: notification_delivered, Details: {"notification_count":2,"notification_ids":[6,3],"timestamp":"2025-02-05T01:00:00.6115547"}
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_AuthLogs_Customers_NationalId". The conflict occurred in database "NayifatApp", table "dbo.Customers", column 'NationalId'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:f1f8995a-ad5e-4b92-bc52-453e5e80f624
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at NayifatAPI.Services.AuditLogService.LogAsync(String nationalId, String action, Object details) in C:\Users\yamta\StudioProjects\nayifat_app_2025_new\nayifatapi\Services\AuditLogService.cs:line 36
2025-02-05 01:00:00.674 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__Parse_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [n].[Id], [n].[additional_data], [n].[Body], [n].[body_ar], [n].[body_en], [n].[created_at], [n].[expiry_at], [n].[Route], [n].[target_criteria], [n].[Title], [n].[title_ar], [n].[title_en]
FROM [notification_templates] AS [n]
WHERE [n].[Id] = @__Parse_0
2025-02-05 01:00:00.687 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 01:00:00.688 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__Parse_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [n].[Id], [n].[additional_data], [n].[Body], [n].[body_ar], [n].[body_en], [n].[created_at], [n].[expiry_at], [n].[Route], [n].[target_criteria], [n].[Title], [n].[title_ar], [n].[title_en]
FROM [notification_templates] AS [n]
WHERE [n].[Id] = @__Parse_0
2025-02-05 01:00:00.688 +03:00 [INF] Executed action NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI) in 171.5181ms
2025-02-05 01:00:00.691 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI)'
2025-02-05 01:00:00.691 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@p0='?' (Size = 4000), @p1='?' (DbType = DateTime2), @p2='?' (Size = 4000), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (Size = 450), @p6='?' (Size = 4000), @p7='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [AuthLogs] ([AuthType], [CreatedAt], [DeviceId], [FailureReason], [IpAddress], [NationalId], [Status], [UserAgent])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7);
2025-02-05 01:00:00.692 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/list - 200 null application/json; charset=utf-8 186.56ms
2025-02-05 01:00:00.695 +03:00 [ERR] An exception occurred in the database while saving changes for context type 'NayifatAPI.Data.ApplicationDbContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_AuthLogs_Customers_NationalId". The conflict occurred in database "NayifatApp", table "dbo.Customers", column 'NationalId'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:e539819a-702c-49af-b106-aca314263622
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_AuthLogs_Customers_NationalId". The conflict occurred in database "NayifatApp", table "dbo.Customers", column 'NationalId'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:e539819a-702c-49af-b106-aca314263622
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2025-02-05 01:00:00.706 +03:00 [ERR] Error logging audit event. NationalId: all, Action: notification_delivered, Details: {"notification_count":2,"notification_ids":[6,3],"timestamp":"2025-02-05T01:00:00.6729898"}
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_AuthLogs_Customers_NationalId". The conflict occurred in database "NayifatApp", table "dbo.Customers", column 'NationalId'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:e539819a-702c-49af-b106-aca314263622
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at NayifatAPI.Services.AuditLogService.LogAsync(String nationalId, String action, Object details) in C:\Users\yamta\StudioProjects\nayifat_app_2025_new\nayifatapi\Services\AuditLogService.cs:line 36
2025-02-05 01:00:00.713 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 01:00:00.714 +03:00 [INF] Executed action NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI) in 81.1728ms
2025-02-05 01:00:00.715 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI)'
2025-02-05 01:00:00.716 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/list - 200 null application/json; charset=utf-8 109.7344ms
2025-02-05 01:00:02.753 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/list - application/json; charset=utf-8 45
2025-02-05 01:00:02.758 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI)'
2025-02-05 01:00:02.761 +03:00 [INF] Route matched with {action = "GetNotifications", controller = "Notifications"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetNotifications(NayifatAPI.Controllers.GetNotificationsRequest) on controller NayifatAPI.Controllers.NotificationsController (NayifatAPI).
2025-02-05 01:00:02.767 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 01:00:02.773 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__request_NationalId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[national_id], [u].[last_updated], [u].[notifications]
FROM [user_notifications] AS [u]
WHERE [u].[national_id] = @__request_NationalId_0
2025-02-05 01:00:02.777 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 01:00:02.780 +03:00 [INF] Executed action NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI) in 14.6829ms
2025-02-05 01:00:02.783 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI)'
2025-02-05 01:00:02.785 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/list - 200 null application/json; charset=utf-8 32.6518ms
2025-02-05 01:00:09.373 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/list - application/json; charset=utf-8 45
2025-02-05 01:00:09.379 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI)'
2025-02-05 01:00:09.381 +03:00 [INF] Route matched with {action = "GetNotifications", controller = "Notifications"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetNotifications(NayifatAPI.Controllers.GetNotificationsRequest) on controller NayifatAPI.Controllers.NotificationsController (NayifatAPI).
2025-02-05 01:00:09.391 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 01:00:09.396 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__request_NationalId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[national_id], [u].[last_updated], [u].[notifications]
FROM [user_notifications] AS [u]
WHERE [u].[national_id] = @__request_NationalId_0
2025-02-05 01:00:09.399 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 01:00:09.402 +03:00 [INF] Executed action NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI) in 16.6434ms
2025-02-05 01:00:09.405 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI)'
2025-02-05 01:00:09.407 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/list - 200 null application/json; charset=utf-8 34.3687ms
2025-02-05 01:00:13.822 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/list - application/json; charset=utf-8 45
2025-02-05 01:00:13.830 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI)'
2025-02-05 01:00:13.832 +03:00 [INF] Route matched with {action = "GetNotifications", controller = "Notifications"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetNotifications(NayifatAPI.Controllers.GetNotificationsRequest) on controller NayifatAPI.Controllers.NotificationsController (NayifatAPI).
2025-02-05 01:00:13.839 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 01:00:13.846 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__request_NationalId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[national_id], [u].[last_updated], [u].[notifications]
FROM [user_notifications] AS [u]
WHERE [u].[national_id] = @__request_NationalId_0
2025-02-05 01:00:13.849 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 01:00:13.850 +03:00 [INF] Executed action NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI) in 13.1426ms
2025-02-05 01:00:13.853 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI)'
2025-02-05 01:00:13.855 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/list - 200 null application/json; charset=utf-8 32.4948ms
2025-02-05 01:00:19.688 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/list - application/json; charset=utf-8 45
2025-02-05 01:00:19.693 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI)'
2025-02-05 01:00:19.694 +03:00 [INF] Route matched with {action = "GetNotifications", controller = "Notifications"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetNotifications(NayifatAPI.Controllers.GetNotificationsRequest) on controller NayifatAPI.Controllers.NotificationsController (NayifatAPI).
2025-02-05 01:00:19.700 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 01:00:19.704 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__request_NationalId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[national_id], [u].[last_updated], [u].[notifications]
FROM [user_notifications] AS [u]
WHERE [u].[national_id] = @__request_NationalId_0
2025-02-05 01:00:19.708 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 01:00:19.710 +03:00 [INF] Executed action NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI) in 11.6746ms
2025-02-05 01:00:19.715 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI)'
2025-02-05 01:00:19.718 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/list - 200 null application/json; charset=utf-8 30.6983ms
2025-02-05 01:00:29.527 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/list - application/json; charset=utf-8 45
2025-02-05 01:00:29.531 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI)'
2025-02-05 01:00:29.533 +03:00 [INF] Route matched with {action = "GetNotifications", controller = "Notifications"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetNotifications(NayifatAPI.Controllers.GetNotificationsRequest) on controller NayifatAPI.Controllers.NotificationsController (NayifatAPI).
2025-02-05 01:00:29.537 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 01:00:29.542 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__request_NationalId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[national_id], [u].[last_updated], [u].[notifications]
FROM [user_notifications] AS [u]
WHERE [u].[national_id] = @__request_NationalId_0
2025-02-05 01:00:29.546 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 01:00:29.548 +03:00 [INF] Executed action NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI) in 12.5136ms
2025-02-05 01:00:29.550 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI)'
2025-02-05 01:00:29.552 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/list - 200 null application/json; charset=utf-8 25.3369ms
2025-02-05 01:04:07.580 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/list - application/json; charset=utf-8 45
2025-02-05 01:04:07.586 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI)'
2025-02-05 01:04:07.589 +03:00 [INF] Route matched with {action = "GetNotifications", controller = "Notifications"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetNotifications(NayifatAPI.Controllers.GetNotificationsRequest) on controller NayifatAPI.Controllers.NotificationsController (NayifatAPI).
2025-02-05 01:04:07.607 +03:00 [INF] Executed DbCommand (5ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 01:04:07.617 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[@__request_NationalId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[national_id], [u].[last_updated], [u].[notifications]
FROM [user_notifications] AS [u]
WHERE [u].[national_id] = @__request_NationalId_0
2025-02-05 01:04:07.622 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 01:04:07.626 +03:00 [INF] Executed action NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI) in 31.7454ms
2025-02-05 01:04:07.630 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI)'
2025-02-05 01:04:07.633 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/list - 200 null application/json; charset=utf-8 52.3495ms
2025-02-05 01:04:08.073 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/list - application/json; charset=utf-8 45
2025-02-05 01:04:08.078 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI)'
2025-02-05 01:04:08.079 +03:00 [INF] Route matched with {action = "GetNotifications", controller = "Notifications"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetNotifications(NayifatAPI.Controllers.GetNotificationsRequest) on controller NayifatAPI.Controllers.NotificationsController (NayifatAPI).
2025-02-05 01:04:08.089 +03:00 [INF] Executed DbCommand (5ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 01:04:08.097 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__request_NationalId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[national_id], [u].[last_updated], [u].[notifications]
FROM [user_notifications] AS [u]
WHERE [u].[national_id] = @__request_NationalId_0
2025-02-05 01:04:08.100 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 01:04:08.102 +03:00 [INF] Executed action NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI) in 19.141ms
2025-02-05 01:04:08.104 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI)'
2025-02-05 01:04:08.107 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/list - 200 null application/json; charset=utf-8 34.3056ms
2025-02-05 01:16:12.168 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/list - application/json 39
2025-02-05 01:16:12.172 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI)'
2025-02-05 01:16:12.173 +03:00 [INF] Route matched with {action = "GetNotifications", controller = "Notifications"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetNotifications(NayifatAPI.Controllers.GetNotificationsRequest) on controller NayifatAPI.Controllers.NotificationsController (NayifatAPI).
2025-02-05 01:16:12.188 +03:00 [INF] Executed DbCommand (5ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 01:16:12.193 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__request_NationalId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[national_id], [u].[last_updated], [u].[notifications]
FROM [user_notifications] AS [u]
WHERE [u].[national_id] = @__request_NationalId_0
2025-02-05 01:16:12.196 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__Parse_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [n].[Id], [n].[additional_data], [n].[Body], [n].[body_ar], [n].[body_en], [n].[created_at], [n].[expiry_at], [n].[Route], [n].[target_criteria], [n].[Title], [n].[title_ar], [n].[title_en]
FROM [notification_templates] AS [n]
WHERE [n].[Id] = @__Parse_0
2025-02-05 01:16:12.199 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__Parse_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [n].[Id], [n].[additional_data], [n].[Body], [n].[body_ar], [n].[body_en], [n].[created_at], [n].[expiry_at], [n].[Route], [n].[target_criteria], [n].[Title], [n].[title_ar], [n].[title_en]
FROM [notification_templates] AS [n]
WHERE [n].[Id] = @__Parse_0
2025-02-05 01:16:12.206 +03:00 [INF] Executed DbCommand (5ms) [Parameters=[@p0='?' (Size = 4000), @p1='?' (DbType = DateTime2), @p2='?' (Size = 4000), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (Size = 450), @p6='?' (Size = 4000), @p7='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [AuthLogs] ([AuthType], [CreatedAt], [DeviceId], [FailureReason], [IpAddress], [NationalId], [Status], [UserAgent])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7);
2025-02-05 01:16:12.212 +03:00 [ERR] An exception occurred in the database while saving changes for context type 'NayifatAPI.Data.ApplicationDbContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_AuthLogs_Customers_NationalId". The conflict occurred in database "NayifatApp", table "dbo.Customers", column 'NationalId'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:33e46bdc-c47f-4574-8f0b-be6a68a8e245
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_AuthLogs_Customers_NationalId". The conflict occurred in database "NayifatApp", table "dbo.Customers", column 'NationalId'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:33e46bdc-c47f-4574-8f0b-be6a68a8e245
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2025-02-05 01:16:12.235 +03:00 [ERR] Error logging audit event. NationalId: all, Action: notification_delivered, Details: {"notification_count":2,"notification_ids":[6,3],"timestamp":"2025-02-05T01:16:12.1951671"}
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_AuthLogs_Customers_NationalId". The conflict occurred in database "NayifatApp", table "dbo.Customers", column 'NationalId'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:33e46bdc-c47f-4574-8f0b-be6a68a8e245
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at NayifatAPI.Services.AuditLogService.LogAsync(String nationalId, String action, Object details) in C:\Users\yamta\StudioProjects\nayifat_app_2025_new\nayifatapi\Services\AuditLogService.cs:line 36
2025-02-05 01:16:12.246 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 01:16:12.248 +03:00 [INF] Executed action NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI) in 70.8704ms
2025-02-05 01:16:12.249 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI)'
2025-02-05 01:16:12.250 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/list - 200 null application/json; charset=utf-8 82.689ms
2025-02-05 01:16:12.309 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/list - application/json 39
2025-02-05 01:16:12.312 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI)'
2025-02-05 01:16:12.313 +03:00 [INF] Route matched with {action = "GetNotifications", controller = "Notifications"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetNotifications(NayifatAPI.Controllers.GetNotificationsRequest) on controller NayifatAPI.Controllers.NotificationsController (NayifatAPI).
2025-02-05 01:16:12.316 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 01:16:12.323 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[@__request_NationalId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[national_id], [u].[last_updated], [u].[notifications]
FROM [user_notifications] AS [u]
WHERE [u].[national_id] = @__request_NationalId_0
2025-02-05 01:16:12.329 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__Parse_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [n].[Id], [n].[additional_data], [n].[Body], [n].[body_ar], [n].[body_en], [n].[created_at], [n].[expiry_at], [n].[Route], [n].[target_criteria], [n].[Title], [n].[title_ar], [n].[title_en]
FROM [notification_templates] AS [n]
WHERE [n].[Id] = @__Parse_0
2025-02-05 01:16:12.333 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__Parse_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [n].[Id], [n].[additional_data], [n].[Body], [n].[body_ar], [n].[body_en], [n].[created_at], [n].[expiry_at], [n].[Route], [n].[target_criteria], [n].[Title], [n].[title_ar], [n].[title_en]
FROM [notification_templates] AS [n]
WHERE [n].[Id] = @__Parse_0
2025-02-05 01:16:12.342 +03:00 [INF] Executed DbCommand (5ms) [Parameters=[@p0='?' (Size = 4000), @p1='?' (DbType = DateTime2), @p2='?' (Size = 4000), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (Size = 450), @p6='?' (Size = 4000), @p7='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [AuthLogs] ([AuthType], [CreatedAt], [DeviceId], [FailureReason], [IpAddress], [NationalId], [Status], [UserAgent])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7);
2025-02-05 01:16:12.347 +03:00 [ERR] An exception occurred in the database while saving changes for context type 'NayifatAPI.Data.ApplicationDbContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_AuthLogs_Customers_NationalId". The conflict occurred in database "NayifatApp", table "dbo.Customers", column 'NationalId'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:33e46bdc-c47f-4574-8f0b-be6a68a8e245
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_AuthLogs_Customers_NationalId". The conflict occurred in database "NayifatApp", table "dbo.Customers", column 'NationalId'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:33e46bdc-c47f-4574-8f0b-be6a68a8e245
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2025-02-05 01:16:12.362 +03:00 [ERR] Error logging audit event. NationalId: all, Action: notification_delivered, Details: {"notification_count":2,"notification_ids":[6,3],"timestamp":"2025-02-05T01:16:12.326476"}
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_AuthLogs_Customers_NationalId". The conflict occurred in database "NayifatApp", table "dbo.Customers", column 'NationalId'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:33e46bdc-c47f-4574-8f0b-be6a68a8e245
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at NayifatAPI.Services.AuditLogService.LogAsync(String nationalId, String action, Object details) in C:\Users\yamta\StudioProjects\nayifat_app_2025_new\nayifatapi\Services\AuditLogService.cs:line 36
2025-02-05 01:16:12.372 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 01:16:12.373 +03:00 [INF] Executed action NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI) in 58.7689ms
2025-02-05 01:16:12.374 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI)'
2025-02-05 01:16:12.375 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/list - 200 null application/json; charset=utf-8 65.7351ms
2025-02-05 01:54:26.672 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/list - application/json 39
2025-02-05 01:54:26.677 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI)'
2025-02-05 01:54:26.678 +03:00 [INF] Route matched with {action = "GetNotifications", controller = "Notifications"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetNotifications(NayifatAPI.Controllers.GetNotificationsRequest) on controller NayifatAPI.Controllers.NotificationsController (NayifatAPI).
2025-02-05 01:54:26.685 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/list - application/json 39
2025-02-05 01:54:26.689 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI)'
2025-02-05 01:54:26.691 +03:00 [INF] Route matched with {action = "GetNotifications", controller = "Notifications"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetNotifications(NayifatAPI.Controllers.GetNotificationsRequest) on controller NayifatAPI.Controllers.NotificationsController (NayifatAPI).
2025-02-05 01:54:26.693 +03:00 [INF] Executed DbCommand (4ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 01:54:26.701 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 01:54:26.702 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__request_NationalId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[national_id], [u].[last_updated], [u].[notifications]
FROM [user_notifications] AS [u]
WHERE [u].[national_id] = @__request_NationalId_0
2025-02-05 01:54:26.705 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__request_NationalId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[national_id], [u].[last_updated], [u].[notifications]
FROM [user_notifications] AS [u]
WHERE [u].[national_id] = @__request_NationalId_0
2025-02-05 01:54:26.710 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__Parse_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [n].[Id], [n].[additional_data], [n].[Body], [n].[body_ar], [n].[body_en], [n].[created_at], [n].[expiry_at], [n].[Route], [n].[target_criteria], [n].[Title], [n].[title_ar], [n].[title_en]
FROM [notification_templates] AS [n]
WHERE [n].[Id] = @__Parse_0
2025-02-05 01:54:26.715 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__Parse_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [n].[Id], [n].[additional_data], [n].[Body], [n].[body_ar], [n].[body_en], [n].[created_at], [n].[expiry_at], [n].[Route], [n].[target_criteria], [n].[Title], [n].[title_ar], [n].[title_en]
FROM [notification_templates] AS [n]
WHERE [n].[Id] = @__Parse_0
2025-02-05 01:54:26.718 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__Parse_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [n].[Id], [n].[additional_data], [n].[Body], [n].[body_ar], [n].[body_en], [n].[created_at], [n].[expiry_at], [n].[Route], [n].[target_criteria], [n].[Title], [n].[title_ar], [n].[title_en]
FROM [notification_templates] AS [n]
WHERE [n].[Id] = @__Parse_0
2025-02-05 01:54:26.721 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__Parse_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [n].[Id], [n].[additional_data], [n].[Body], [n].[body_ar], [n].[body_en], [n].[created_at], [n].[expiry_at], [n].[Route], [n].[target_criteria], [n].[Title], [n].[title_ar], [n].[title_en]
FROM [notification_templates] AS [n]
WHERE [n].[Id] = @__Parse_0
2025-02-05 01:54:26.728 +03:00 [INF] Executed DbCommand (4ms) [Parameters=[@p0='?' (Size = 4000), @p1='?' (DbType = DateTime2), @p2='?' (Size = 4000), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (Size = 450), @p6='?' (Size = 4000), @p7='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [AuthLogs] ([AuthType], [CreatedAt], [DeviceId], [FailureReason], [IpAddress], [NationalId], [Status], [UserAgent])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7);
2025-02-05 01:54:26.729 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@p0='?' (Size = 4000), @p1='?' (DbType = DateTime2), @p2='?' (Size = 4000), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (Size = 450), @p6='?' (Size = 4000), @p7='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [AuthLogs] ([AuthType], [CreatedAt], [DeviceId], [FailureReason], [IpAddress], [NationalId], [Status], [UserAgent])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7);
2025-02-05 01:54:26.731 +03:00 [ERR] An exception occurred in the database while saving changes for context type 'NayifatAPI.Data.ApplicationDbContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_AuthLogs_Customers_NationalId". The conflict occurred in database "NayifatApp", table "dbo.Customers", column 'NationalId'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:8f275576-8b93-477f-8ef0-554620086400
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_AuthLogs_Customers_NationalId". The conflict occurred in database "NayifatApp", table "dbo.Customers", column 'NationalId'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:8f275576-8b93-477f-8ef0-554620086400
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2025-02-05 01:54:26.733 +03:00 [ERR] An exception occurred in the database while saving changes for context type 'NayifatAPI.Data.ApplicationDbContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_AuthLogs_Customers_NationalId". The conflict occurred in database "NayifatApp", table "dbo.Customers", column 'NationalId'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:ee77c3e4-fee0-4066-8e8f-8c1838a71e49
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_AuthLogs_Customers_NationalId". The conflict occurred in database "NayifatApp", table "dbo.Customers", column 'NationalId'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:ee77c3e4-fee0-4066-8e8f-8c1838a71e49
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2025-02-05 01:54:26.743 +03:00 [ERR] Error logging audit event. NationalId: all, Action: notification_delivered, Details: {"notification_count":2,"notification_ids":[6,3],"timestamp":"2025-02-05T01:54:26.708567"}
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_AuthLogs_Customers_NationalId". The conflict occurred in database "NayifatApp", table "dbo.Customers", column 'NationalId'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:8f275576-8b93-477f-8ef0-554620086400
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at NayifatAPI.Services.AuditLogService.LogAsync(String nationalId, String action, Object details) in C:\Users\yamta\StudioProjects\nayifat_app_2025_new\nayifatapi\Services\AuditLogService.cs:line 36
2025-02-05 01:54:26.751 +03:00 [ERR] Error logging audit event. NationalId: all, Action: notification_delivered, Details: {"notification_count":2,"notification_ids":[6,3],"timestamp":"2025-02-05T01:54:26.7130613"}
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_AuthLogs_Customers_NationalId". The conflict occurred in database "NayifatApp", table "dbo.Customers", column 'NationalId'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:ee77c3e4-fee0-4066-8e8f-8c1838a71e49
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at NayifatAPI.Services.AuditLogService.LogAsync(String nationalId, String action, Object details) in C:\Users\yamta\StudioProjects\nayifat_app_2025_new\nayifatapi\Services\AuditLogService.cs:line 36
2025-02-05 01:54:26.757 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 01:54:26.764 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 01:54:26.764 +03:00 [INF] Executed action NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI) in 83.8937ms
2025-02-05 01:54:26.765 +03:00 [INF] Executed action NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI) in 71.3528ms
2025-02-05 01:54:26.766 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI)'
2025-02-05 01:54:26.767 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI)'
2025-02-05 01:54:26.768 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/list - 200 null application/json; charset=utf-8 95.8249ms
2025-02-05 01:54:26.769 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/list - 200 null application/json; charset=utf-8 84.2152ms
2025-02-05 05:06:41.802 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/list - application/json 39
2025-02-05 05:06:41.806 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI)'
2025-02-05 05:06:41.809 +03:00 [INF] Route matched with {action = "GetNotifications", controller = "Notifications"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetNotifications(NayifatAPI.Controllers.GetNotificationsRequest) on controller NayifatAPI.Controllers.NotificationsController (NayifatAPI).
2025-02-05 05:06:41.902 +03:00 [INF] Executed DbCommand (81ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 05:06:41.911 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[@__request_NationalId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[national_id], [u].[last_updated], [u].[notifications]
FROM [user_notifications] AS [u]
WHERE [u].[national_id] = @__request_NationalId_0
2025-02-05 05:06:41.919 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[@__Parse_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [n].[Id], [n].[additional_data], [n].[Body], [n].[body_ar], [n].[body_en], [n].[created_at], [n].[expiry_at], [n].[Route], [n].[target_criteria], [n].[Title], [n].[title_ar], [n].[title_en]
FROM [notification_templates] AS [n]
WHERE [n].[Id] = @__Parse_0
2025-02-05 05:06:41.926 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__Parse_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [n].[Id], [n].[additional_data], [n].[Body], [n].[body_ar], [n].[body_en], [n].[created_at], [n].[expiry_at], [n].[Route], [n].[target_criteria], [n].[Title], [n].[title_ar], [n].[title_en]
FROM [notification_templates] AS [n]
WHERE [n].[Id] = @__Parse_0
2025-02-05 05:06:41.938 +03:00 [INF] Executed DbCommand (6ms) [Parameters=[@p0='?' (Size = 4000), @p1='?' (DbType = DateTime2), @p2='?' (Size = 4000), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (Size = 450), @p6='?' (Size = 4000), @p7='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [AuthLogs] ([AuthType], [CreatedAt], [DeviceId], [FailureReason], [IpAddress], [NationalId], [Status], [UserAgent])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7);
2025-02-05 05:06:41.945 +03:00 [ERR] An exception occurred in the database while saving changes for context type 'NayifatAPI.Data.ApplicationDbContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_AuthLogs_Customers_NationalId". The conflict occurred in database "NayifatApp", table "dbo.Customers", column 'NationalId'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:80fda102-91f9-4c69-b65f-e2e99a302dc6
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_AuthLogs_Customers_NationalId". The conflict occurred in database "NayifatApp", table "dbo.Customers", column 'NationalId'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:80fda102-91f9-4c69-b65f-e2e99a302dc6
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2025-02-05 05:06:41.965 +03:00 [ERR] Error logging audit event. NationalId: all, Action: notification_delivered, Details: {"notification_count":2,"notification_ids":[6,3],"timestamp":"2025-02-05T05:06:41.9161655"}
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_AuthLogs_Customers_NationalId". The conflict occurred in database "NayifatApp", table "dbo.Customers", column 'NationalId'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:80fda102-91f9-4c69-b65f-e2e99a302dc6
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at NayifatAPI.Services.AuditLogService.LogAsync(String nationalId, String action, Object details) in C:\Users\yamta\StudioProjects\nayifat_app_2025_new\nayifatapi\Services\AuditLogService.cs:line 36
2025-02-05 05:06:41.978 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 05:06:41.979 +03:00 [INF] Executed action NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI) in 165.4673ms
2025-02-05 05:06:41.980 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI)'
2025-02-05 05:06:41.981 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/list - 200 null application/json; charset=utf-8 179.1661ms
2025-02-05 05:06:42.149 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/list - application/json 39
2025-02-05 05:06:42.154 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI)'
2025-02-05 05:06:42.156 +03:00 [INF] Route matched with {action = "GetNotifications", controller = "Notifications"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetNotifications(NayifatAPI.Controllers.GetNotificationsRequest) on controller NayifatAPI.Controllers.NotificationsController (NayifatAPI).
2025-02-05 05:06:42.162 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 05:06:42.167 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__request_NationalId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[national_id], [u].[last_updated], [u].[notifications]
FROM [user_notifications] AS [u]
WHERE [u].[national_id] = @__request_NationalId_0
2025-02-05 05:06:42.170 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__Parse_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [n].[Id], [n].[additional_data], [n].[Body], [n].[body_ar], [n].[body_en], [n].[created_at], [n].[expiry_at], [n].[Route], [n].[target_criteria], [n].[Title], [n].[title_ar], [n].[title_en]
FROM [notification_templates] AS [n]
WHERE [n].[Id] = @__Parse_0
2025-02-05 05:06:42.174 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__Parse_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [n].[Id], [n].[additional_data], [n].[Body], [n].[body_ar], [n].[body_en], [n].[created_at], [n].[expiry_at], [n].[Route], [n].[target_criteria], [n].[Title], [n].[title_ar], [n].[title_en]
FROM [notification_templates] AS [n]
WHERE [n].[Id] = @__Parse_0
2025-02-05 05:06:42.179 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@p0='?' (Size = 4000), @p1='?' (DbType = DateTime2), @p2='?' (Size = 4000), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (Size = 450), @p6='?' (Size = 4000), @p7='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [AuthLogs] ([AuthType], [CreatedAt], [DeviceId], [FailureReason], [IpAddress], [NationalId], [Status], [UserAgent])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7);
2025-02-05 05:06:42.184 +03:00 [ERR] An exception occurred in the database while saving changes for context type 'NayifatAPI.Data.ApplicationDbContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_AuthLogs_Customers_NationalId". The conflict occurred in database "NayifatApp", table "dbo.Customers", column 'NationalId'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:80fda102-91f9-4c69-b65f-e2e99a302dc6
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_AuthLogs_Customers_NationalId". The conflict occurred in database "NayifatApp", table "dbo.Customers", column 'NationalId'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:80fda102-91f9-4c69-b65f-e2e99a302dc6
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2025-02-05 05:06:42.197 +03:00 [ERR] Error logging audit event. NationalId: all, Action: notification_delivered, Details: {"notification_count":2,"notification_ids":[6,3],"timestamp":"2025-02-05T05:06:42.1699681"}
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_AuthLogs_Customers_NationalId". The conflict occurred in database "NayifatApp", table "dbo.Customers", column 'NationalId'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:80fda102-91f9-4c69-b65f-e2e99a302dc6
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at NayifatAPI.Services.AuditLogService.LogAsync(String nationalId, String action, Object details) in C:\Users\yamta\StudioProjects\nayifat_app_2025_new\nayifatapi\Services\AuditLogService.cs:line 36
2025-02-05 05:06:42.206 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 05:06:42.207 +03:00 [INF] Executed action NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI) in 47.2957ms
2025-02-05 05:06:42.208 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI)'
2025-02-05 05:06:42.209 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/list - 200 null application/json; charset=utf-8 60.2775ms
2025-02-05 06:28:42.174 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/list - application/json 39
2025-02-05 06:28:42.177 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI)'
2025-02-05 06:28:42.179 +03:00 [INF] Route matched with {action = "GetNotifications", controller = "Notifications"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetNotifications(NayifatAPI.Controllers.GetNotificationsRequest) on controller NayifatAPI.Controllers.NotificationsController (NayifatAPI).
2025-02-05 06:28:42.188 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/list - application/json 39
2025-02-05 06:28:42.189 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI)'
2025-02-05 06:28:42.191 +03:00 [INF] Route matched with {action = "GetNotifications", controller = "Notifications"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetNotifications(NayifatAPI.Controllers.GetNotificationsRequest) on controller NayifatAPI.Controllers.NotificationsController (NayifatAPI).
2025-02-05 06:28:42.198 +03:00 [INF] Executed DbCommand (9ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 06:28:42.198 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 06:28:42.202 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__request_NationalId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[national_id], [u].[last_updated], [u].[notifications]
FROM [user_notifications] AS [u]
WHERE [u].[national_id] = @__request_NationalId_0
2025-02-05 06:28:42.203 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__request_NationalId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[national_id], [u].[last_updated], [u].[notifications]
FROM [user_notifications] AS [u]
WHERE [u].[national_id] = @__request_NationalId_0
2025-02-05 06:28:42.207 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__Parse_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [n].[Id], [n].[additional_data], [n].[Body], [n].[body_ar], [n].[body_en], [n].[created_at], [n].[expiry_at], [n].[Route], [n].[target_criteria], [n].[Title], [n].[title_ar], [n].[title_en]
FROM [notification_templates] AS [n]
WHERE [n].[Id] = @__Parse_0
2025-02-05 06:28:42.208 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__Parse_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [n].[Id], [n].[additional_data], [n].[Body], [n].[body_ar], [n].[body_en], [n].[created_at], [n].[expiry_at], [n].[Route], [n].[target_criteria], [n].[Title], [n].[title_ar], [n].[title_en]
FROM [notification_templates] AS [n]
WHERE [n].[Id] = @__Parse_0
2025-02-05 06:28:42.211 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__Parse_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [n].[Id], [n].[additional_data], [n].[Body], [n].[body_ar], [n].[body_en], [n].[created_at], [n].[expiry_at], [n].[Route], [n].[target_criteria], [n].[Title], [n].[title_ar], [n].[title_en]
FROM [notification_templates] AS [n]
WHERE [n].[Id] = @__Parse_0
2025-02-05 06:28:42.218 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__Parse_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [n].[Id], [n].[additional_data], [n].[Body], [n].[body_ar], [n].[body_en], [n].[created_at], [n].[expiry_at], [n].[Route], [n].[target_criteria], [n].[Title], [n].[title_ar], [n].[title_en]
FROM [notification_templates] AS [n]
WHERE [n].[Id] = @__Parse_0
2025-02-05 06:28:42.225 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[@p0='?' (Size = 4000), @p1='?' (DbType = DateTime2), @p2='?' (Size = 4000), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (Size = 450), @p6='?' (Size = 4000), @p7='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [AuthLogs] ([AuthType], [CreatedAt], [DeviceId], [FailureReason], [IpAddress], [NationalId], [Status], [UserAgent])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7);
2025-02-05 06:28:42.225 +03:00 [INF] Executed DbCommand (5ms) [Parameters=[@p0='?' (Size = 4000), @p1='?' (DbType = DateTime2), @p2='?' (Size = 4000), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (Size = 450), @p6='?' (Size = 4000), @p7='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [AuthLogs] ([AuthType], [CreatedAt], [DeviceId], [FailureReason], [IpAddress], [NationalId], [Status], [UserAgent])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7);
2025-02-05 06:28:42.228 +03:00 [ERR] An exception occurred in the database while saving changes for context type 'NayifatAPI.Data.ApplicationDbContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_AuthLogs_Customers_NationalId". The conflict occurred in database "NayifatApp", table "dbo.Customers", column 'NationalId'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:08475607-9181-4ca4-87c5-5eff6dccff4d
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_AuthLogs_Customers_NationalId". The conflict occurred in database "NayifatApp", table "dbo.Customers", column 'NationalId'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:08475607-9181-4ca4-87c5-5eff6dccff4d
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2025-02-05 06:28:42.231 +03:00 [ERR] An exception occurred in the database while saving changes for context type 'NayifatAPI.Data.ApplicationDbContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_AuthLogs_Customers_NationalId". The conflict occurred in database "NayifatApp", table "dbo.Customers", column 'NationalId'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:509c40a1-d0db-4334-b60a-e8db7fd7f638
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_AuthLogs_Customers_NationalId". The conflict occurred in database "NayifatApp", table "dbo.Customers", column 'NationalId'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:509c40a1-d0db-4334-b60a-e8db7fd7f638
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2025-02-05 06:28:42.248 +03:00 [ERR] Error logging audit event. NationalId: all, Action: notification_delivered, Details: {"notification_count":2,"notification_ids":[6,3],"timestamp":"2025-02-05T06:28:42.2078137"}
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_AuthLogs_Customers_NationalId". The conflict occurred in database "NayifatApp", table "dbo.Customers", column 'NationalId'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:08475607-9181-4ca4-87c5-5eff6dccff4d
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at NayifatAPI.Services.AuditLogService.LogAsync(String nationalId, String action, Object details) in C:\Users\yamta\StudioProjects\nayifat_app_2025_new\nayifatapi\Services\AuditLogService.cs:line 36
2025-02-05 06:28:42.257 +03:00 [ERR] Error logging audit event. NationalId: all, Action: notification_delivered, Details: {"notification_count":2,"notification_ids":[6,3],"timestamp":"2025-02-05T06:28:42.2056372"}
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_AuthLogs_Customers_NationalId". The conflict occurred in database "NayifatApp", table "dbo.Customers", column 'NationalId'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:509c40a1-d0db-4334-b60a-e8db7fd7f638
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at NayifatAPI.Services.AuditLogService.LogAsync(String nationalId, String action, Object details) in C:\Users\yamta\StudioProjects\nayifat_app_2025_new\nayifatapi\Services\AuditLogService.cs:line 36
2025-02-05 06:28:42.267 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 06:28:42.277 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 06:28:42.277 +03:00 [INF] Executed action NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI) in 83.8851ms
2025-02-05 06:28:42.278 +03:00 [INF] Executed action NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI) in 96.0911ms
2025-02-05 06:28:42.279 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI)'
2025-02-05 06:28:42.280 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI)'
2025-02-05 06:28:42.281 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/list - 200 null application/json; charset=utf-8 93.755ms
2025-02-05 06:28:42.282 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/list - 200 null application/json; charset=utf-8 108.3325ms
2025-02-05 06:28:43.678 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/timestamps - application/json; charset=utf-8 2
2025-02-05 06:28:43.683 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.ContentController.GetTimestamps (NayifatAPI)'
2025-02-05 06:28:43.685 +03:00 [INF] Route matched with {action = "GetTimestamps", controller = "Content"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetTimestamps() on controller NayifatAPI.Controllers.ContentController (NayifatAPI).
2025-02-05 06:28:43.689 +03:00 [INF] TTT_
2025-02-05 06:28:43.691 +03:00 [INF] TTT_=== Getting Content Timestamps ===
2025-02-05 06:28:43.695 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 06:28:43.699 +03:00 [INF] TTT_Fetching timestamps from database
2025-02-05 06:28:43.704 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [m].[page] AS [Page], [m].[key_name] AS [KeyName], [m].[last_updated] AS [LastUpdated]
FROM [master_config] AS [m]
2025-02-05 06:28:43.706 +03:00 [INF] TTT_Found 18 content items
2025-02-05 06:28:43.708 +03:00 [INF] TTT_Page: home
2025-02-05 06:28:43.710 +03:00 [INF] TTT_  - slideshow_content: "2025-02-04T10:01:06.9430000"
2025-02-05 06:28:43.711 +03:00 [INF] TTT_  - slideshow_content_ar: "2025-02-04T10:01:06.9430000"
2025-02-05 06:28:43.713 +03:00 [INF] TTT_  - contact_details: "2025-02-04T10:01:06.9430000"
2025-02-05 06:28:43.714 +03:00 [INF] TTT_  - contact_details_ar: "2025-02-04T10:01:06.9430000"
2025-02-05 06:28:43.715 +03:00 [INF] TTT_  - termsEN1: "2025-02-03T14:23:58.0000000"
2025-02-05 06:28:43.717 +03:00 [INF] TTT_  - termsEN2: "2025-02-03T14:25:20.1730000"
2025-02-05 06:28:43.718 +03:00 [INF] TTT_  - privacyEN1: "2025-02-03T14:26:08.6130000"
2025-02-05 06:28:43.720 +03:00 [INF] TTT_  - privacyEN2: "2025-02-03T14:25:20.1730000"
2025-02-05 06:28:43.721 +03:00 [INF] TTT_  - termsAR1: "2025-02-03T14:23:58.0000000"
2025-02-05 06:28:43.721 +03:00 [INF] TTT_  - termsAR2: "2025-02-03T14:25:20.1730000"
2025-02-05 06:28:43.722 +03:00 [INF] TTT_  - privacyAR1: "2025-02-03T14:26:08.6130000"
2025-02-05 06:28:43.723 +03:00 [INF] TTT_  - privacyAR2: "2025-02-03T14:25:20.1730000"
2025-02-05 06:28:43.724 +03:00 [INF] TTT_  - terms&conditionsCC_AR: "2025-02-03T17:06:57.7700000"
2025-02-05 06:28:43.726 +03:00 [INF] TTT_  - terms&conditionsCC_EN: "2025-02-03T17:07:47.4900000"
2025-02-05 06:28:43.726 +03:00 [INF] TTT_  - terms&conditionsPF_AR: "2025-02-03T17:06:57.7700000"
2025-02-05 06:28:43.727 +03:00 [INF] TTT_  - terms&conditionsPF_EN: "2025-02-03T17:06:57.7700000"
2025-02-05 06:28:43.728 +03:00 [INF] TTT_Page: loans
2025-02-05 06:28:43.729 +03:00 [INF] TTT_  - loan_ad: "2025-02-04T10:01:06.9430000"
2025-02-05 06:28:43.730 +03:00 [INF] TTT_Page: cards
2025-02-05 06:28:43.732 +03:00 [INF] TTT_  - card_ad: "2025-02-04T10:01:06.9430000"
2025-02-05 06:28:43.734 +03:00 [INF] TTT_Successfully retrieved all timestamps
2025-02-05 06:28:43.736 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 06:28:43.737 +03:00 [INF] Executed action NayifatAPI.Controllers.ContentController.GetTimestamps (NayifatAPI) in 48.1273ms
2025-02-05 06:28:43.742 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.ContentController.GetTimestamps (NayifatAPI)'
2025-02-05 06:28:43.743 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/timestamps - 200 null application/json; charset=utf-8 65.3146ms
2025-02-05 06:28:44.400 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - application/json; charset=utf-8 45
2025-02-05 06:28:44.403 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 06:28:44.404 +03:00 [INF] Route matched with {action = "MasterFetch", controller = "Content"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] MasterFetch(NayifatAPI.Controllers.MasterFetchRequest) on controller NayifatAPI.Controllers.ContentController (NayifatAPI).
2025-02-05 06:28:44.409 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 06:28:44.415 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[@__request_Page_0='?' (Size = 450), @__request_KeyName_1='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[config_id], [m].[key_name], [m].[last_updated], [m].[page], [m].[value]
FROM [master_config] AS [m]
WHERE [m].[page] = @__request_Page_0 AND [m].[key_name] = @__request_KeyName_1
2025-02-05 06:28:44.419 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 06:28:44.421 +03:00 [INF] Executed action NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI) in 14.236ms
2025-02-05 06:28:44.422 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 06:28:44.423 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - 200 null application/json; charset=utf-8 23.7702ms
2025-02-05 06:28:50.803 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - application/json; charset=utf-8 48
2025-02-05 06:28:50.809 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 06:28:50.811 +03:00 [INF] Route matched with {action = "MasterFetch", controller = "Content"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] MasterFetch(NayifatAPI.Controllers.MasterFetchRequest) on controller NayifatAPI.Controllers.ContentController (NayifatAPI).
2025-02-05 06:28:50.816 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 06:28:50.821 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__request_Page_0='?' (Size = 450), @__request_KeyName_1='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[config_id], [m].[key_name], [m].[last_updated], [m].[page], [m].[value]
FROM [master_config] AS [m]
WHERE [m].[page] = @__request_Page_0 AND [m].[key_name] = @__request_KeyName_1
2025-02-05 06:28:50.824 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 06:28:50.825 +03:00 [INF] Executed action NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI) in 10.3942ms
2025-02-05 06:28:50.828 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 06:28:50.830 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - 200 null application/json; charset=utf-8 26.9865ms
2025-02-05 06:28:55.860 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - application/json; charset=utf-8 43
2025-02-05 06:28:55.866 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 06:28:55.867 +03:00 [INF] Route matched with {action = "MasterFetch", controller = "Content"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] MasterFetch(NayifatAPI.Controllers.MasterFetchRequest) on controller NayifatAPI.Controllers.ContentController (NayifatAPI).
2025-02-05 06:28:55.870 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 06:28:55.873 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__request_Page_0='?' (Size = 450), @__request_KeyName_1='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[config_id], [m].[key_name], [m].[last_updated], [m].[page], [m].[value]
FROM [master_config] AS [m]
WHERE [m].[page] = @__request_Page_0 AND [m].[key_name] = @__request_KeyName_1
2025-02-05 06:28:55.875 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 06:28:55.876 +03:00 [INF] Executed action NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI) in 7.1831ms
2025-02-05 06:28:55.877 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 06:28:55.877 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - 200 null application/json; charset=utf-8 17.5432ms
2025-02-05 06:28:56.921 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - application/json; charset=utf-8 46
2025-02-05 06:28:56.924 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 06:28:56.925 +03:00 [INF] Route matched with {action = "MasterFetch", controller = "Content"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] MasterFetch(NayifatAPI.Controllers.MasterFetchRequest) on controller NayifatAPI.Controllers.ContentController (NayifatAPI).
2025-02-05 06:28:56.927 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 06:28:56.930 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__request_Page_0='?' (Size = 450), @__request_KeyName_1='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[config_id], [m].[key_name], [m].[last_updated], [m].[page], [m].[value]
FROM [master_config] AS [m]
WHERE [m].[page] = @__request_Page_0 AND [m].[key_name] = @__request_KeyName_1
2025-02-05 06:28:56.933 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 06:28:56.934 +03:00 [INF] Executed action NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI) in 7.435ms
2025-02-05 06:28:56.934 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 06:28:56.935 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - 200 null application/json; charset=utf-8 13.7676ms
2025-02-05 06:28:57.834 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - application/json; charset=utf-8 36
2025-02-05 06:28:57.846 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 06:28:57.852 +03:00 [INF] Route matched with {action = "MasterFetch", controller = "Content"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] MasterFetch(NayifatAPI.Controllers.MasterFetchRequest) on controller NayifatAPI.Controllers.ContentController (NayifatAPI).
2025-02-05 06:28:57.859 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 06:28:57.863 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__request_Page_0='?' (Size = 450), @__request_KeyName_1='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[config_id], [m].[key_name], [m].[last_updated], [m].[page], [m].[value]
FROM [master_config] AS [m]
WHERE [m].[page] = @__request_Page_0 AND [m].[key_name] = @__request_KeyName_1
2025-02-05 06:28:57.865 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 06:28:57.866 +03:00 [INF] Executed action NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI) in 8.8805ms
2025-02-05 06:28:57.867 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 06:28:57.868 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - 200 null application/json; charset=utf-8 33.5516ms
2025-02-05 06:28:58.764 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - application/json; charset=utf-8 36
2025-02-05 06:28:58.767 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 06:28:58.768 +03:00 [INF] Route matched with {action = "MasterFetch", controller = "Content"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] MasterFetch(NayifatAPI.Controllers.MasterFetchRequest) on controller NayifatAPI.Controllers.ContentController (NayifatAPI).
2025-02-05 06:28:58.770 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 06:28:58.773 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__request_Page_0='?' (Size = 450), @__request_KeyName_1='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[config_id], [m].[key_name], [m].[last_updated], [m].[page], [m].[value]
FROM [master_config] AS [m]
WHERE [m].[page] = @__request_Page_0 AND [m].[key_name] = @__request_KeyName_1
2025-02-05 06:28:58.774 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 06:28:58.775 +03:00 [INF] Executed action NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI) in 5.9585ms
2025-02-05 06:28:58.776 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 06:28:58.777 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - 200 null application/json; charset=utf-8 12.691ms
2025-02-05 06:28:59.828 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - application/json; charset=utf-8 38
2025-02-05 06:28:59.833 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 06:28:59.835 +03:00 [INF] Route matched with {action = "MasterFetch", controller = "Content"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] MasterFetch(NayifatAPI.Controllers.MasterFetchRequest) on controller NayifatAPI.Controllers.ContentController (NayifatAPI).
2025-02-05 06:28:59.839 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 06:28:59.845 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__request_Page_0='?' (Size = 450), @__request_KeyName_1='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[config_id], [m].[key_name], [m].[last_updated], [m].[page], [m].[value]
FROM [master_config] AS [m]
WHERE [m].[page] = @__request_Page_0 AND [m].[key_name] = @__request_KeyName_1
2025-02-05 06:28:59.849 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 06:28:59.851 +03:00 [INF] Executed action NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI) in 13.383ms
2025-02-05 06:28:59.853 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 06:28:59.855 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - 200 null application/json; charset=utf-8 26.5079ms
2025-02-05 06:29:00.683 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - application/json; charset=utf-8 38
2025-02-05 06:29:00.832 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 06:29:00.835 +03:00 [INF] Route matched with {action = "MasterFetch", controller = "Content"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] MasterFetch(NayifatAPI.Controllers.MasterFetchRequest) on controller NayifatAPI.Controllers.ContentController (NayifatAPI).
2025-02-05 06:29:00.993 +03:00 [INF] Executed DbCommand (152ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 06:29:01.509 +03:00 [INF] Executed DbCommand (16ms) [Parameters=[@__request_Page_0='?' (Size = 450), @__request_KeyName_1='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[config_id], [m].[key_name], [m].[last_updated], [m].[page], [m].[value]
FROM [master_config] AS [m]
WHERE [m].[page] = @__request_Page_0 AND [m].[key_name] = @__request_KeyName_1
2025-02-05 06:29:01.799 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 06:29:01.804 +03:00 [INF] Executed action NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI) in 964.1762ms
2025-02-05 06:29:01.807 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 06:29:01.809 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - 200 null application/json; charset=utf-8 1125.5852ms
2025-02-05 06:29:02.633 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - application/json; charset=utf-8 36
2025-02-05 06:29:02.636 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 06:29:02.637 +03:00 [INF] Route matched with {action = "MasterFetch", controller = "Content"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] MasterFetch(NayifatAPI.Controllers.MasterFetchRequest) on controller NayifatAPI.Controllers.ContentController (NayifatAPI).
2025-02-05 06:29:02.640 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 06:29:02.642 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__request_Page_0='?' (Size = 450), @__request_KeyName_1='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[config_id], [m].[key_name], [m].[last_updated], [m].[page], [m].[value]
FROM [master_config] AS [m]
WHERE [m].[page] = @__request_Page_0 AND [m].[key_name] = @__request_KeyName_1
2025-02-05 06:29:02.644 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 06:29:02.645 +03:00 [INF] Executed action NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI) in 7.1277ms
2025-02-05 06:29:02.646 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 06:29:02.647 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - 200 null application/json; charset=utf-8 13.3993ms
2025-02-05 06:29:03.954 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - application/json; charset=utf-8 36
2025-02-05 06:29:03.957 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 06:29:03.958 +03:00 [INF] Route matched with {action = "MasterFetch", controller = "Content"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] MasterFetch(NayifatAPI.Controllers.MasterFetchRequest) on controller NayifatAPI.Controllers.ContentController (NayifatAPI).
2025-02-05 06:29:03.961 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 06:29:03.965 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__request_Page_0='?' (Size = 450), @__request_KeyName_1='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[config_id], [m].[key_name], [m].[last_updated], [m].[page], [m].[value]
FROM [master_config] AS [m]
WHERE [m].[page] = @__request_Page_0 AND [m].[key_name] = @__request_KeyName_1
2025-02-05 06:29:03.968 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 06:29:03.969 +03:00 [INF] Executed action NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI) in 8.7074ms
2025-02-05 06:29:03.971 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 06:29:03.972 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - 200 null application/json; charset=utf-8 18.5554ms
2025-02-05 06:29:05.756 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - application/json; charset=utf-8 38
2025-02-05 06:29:05.760 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 06:29:05.761 +03:00 [INF] Route matched with {action = "MasterFetch", controller = "Content"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] MasterFetch(NayifatAPI.Controllers.MasterFetchRequest) on controller NayifatAPI.Controllers.ContentController (NayifatAPI).
2025-02-05 06:29:05.764 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 06:29:05.768 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__request_Page_0='?' (Size = 450), @__request_KeyName_1='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[config_id], [m].[key_name], [m].[last_updated], [m].[page], [m].[value]
FROM [master_config] AS [m]
WHERE [m].[page] = @__request_Page_0 AND [m].[key_name] = @__request_KeyName_1
2025-02-05 06:29:05.773 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 06:29:05.774 +03:00 [INF] Executed action NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI) in 10.6725ms
2025-02-05 06:29:05.775 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 06:29:05.776 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - 200 null application/json; charset=utf-8 20.7066ms
2025-02-05 06:29:06.767 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - application/json; charset=utf-8 38
2025-02-05 06:29:06.770 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 06:29:06.771 +03:00 [INF] Route matched with {action = "MasterFetch", controller = "Content"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] MasterFetch(NayifatAPI.Controllers.MasterFetchRequest) on controller NayifatAPI.Controllers.ContentController (NayifatAPI).
2025-02-05 06:29:06.774 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 06:29:06.777 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__request_Page_0='?' (Size = 450), @__request_KeyName_1='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[config_id], [m].[key_name], [m].[last_updated], [m].[page], [m].[value]
FROM [master_config] AS [m]
WHERE [m].[page] = @__request_Page_0 AND [m].[key_name] = @__request_KeyName_1
2025-02-05 06:29:06.779 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 06:29:06.781 +03:00 [INF] Executed action NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI) in 7.6453ms
2025-02-05 06:29:06.785 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 06:29:06.788 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - 200 null application/json; charset=utf-8 20.5749ms
2025-02-05 06:29:07.518 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - application/json; charset=utf-8 49
2025-02-05 06:29:07.521 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 06:29:07.522 +03:00 [INF] Route matched with {action = "MasterFetch", controller = "Content"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] MasterFetch(NayifatAPI.Controllers.MasterFetchRequest) on controller NayifatAPI.Controllers.ContentController (NayifatAPI).
2025-02-05 06:29:07.525 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 06:29:07.530 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__request_Page_0='?' (Size = 450), @__request_KeyName_1='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[config_id], [m].[key_name], [m].[last_updated], [m].[page], [m].[value]
FROM [master_config] AS [m]
WHERE [m].[page] = @__request_Page_0 AND [m].[key_name] = @__request_KeyName_1
2025-02-05 06:29:07.533 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 06:29:07.534 +03:00 [INF] Executed action NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI) in 10.6342ms
2025-02-05 06:29:07.535 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 06:29:07.536 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - 200 null application/json; charset=utf-8 17.4595ms
2025-02-05 06:29:08.328 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - application/json; charset=utf-8 49
2025-02-05 06:29:08.329 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 06:29:08.330 +03:00 [INF] Route matched with {action = "MasterFetch", controller = "Content"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] MasterFetch(NayifatAPI.Controllers.MasterFetchRequest) on controller NayifatAPI.Controllers.ContentController (NayifatAPI).
2025-02-05 06:29:08.333 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 06:29:08.334 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__request_Page_0='?' (Size = 450), @__request_KeyName_1='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[config_id], [m].[key_name], [m].[last_updated], [m].[page], [m].[value]
FROM [master_config] AS [m]
WHERE [m].[page] = @__request_Page_0 AND [m].[key_name] = @__request_KeyName_1
2025-02-05 06:29:08.336 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 06:29:08.336 +03:00 [INF] Executed action NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI) in 4.985ms
2025-02-05 06:29:08.337 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 06:29:08.338 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - 200 null application/json; charset=utf-8 10.2382ms
2025-02-05 06:29:09.179 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - application/json; charset=utf-8 49
2025-02-05 06:29:09.181 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 06:29:09.182 +03:00 [INF] Route matched with {action = "MasterFetch", controller = "Content"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] MasterFetch(NayifatAPI.Controllers.MasterFetchRequest) on controller NayifatAPI.Controllers.ContentController (NayifatAPI).
2025-02-05 06:29:09.184 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 06:29:09.187 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__request_Page_0='?' (Size = 450), @__request_KeyName_1='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[config_id], [m].[key_name], [m].[last_updated], [m].[page], [m].[value]
FROM [master_config] AS [m]
WHERE [m].[page] = @__request_Page_0 AND [m].[key_name] = @__request_KeyName_1
2025-02-05 06:29:09.189 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 06:29:09.190 +03:00 [INF] Executed action NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI) in 6.995ms
2025-02-05 06:29:09.191 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 06:29:09.193 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - 200 null application/json; charset=utf-8 13.7882ms
2025-02-05 06:29:10.062 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - application/json; charset=utf-8 49
2025-02-05 06:29:10.064 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 06:29:10.065 +03:00 [INF] Route matched with {action = "MasterFetch", controller = "Content"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] MasterFetch(NayifatAPI.Controllers.MasterFetchRequest) on controller NayifatAPI.Controllers.ContentController (NayifatAPI).
2025-02-05 06:29:10.067 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 06:29:10.069 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__request_Page_0='?' (Size = 450), @__request_KeyName_1='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[config_id], [m].[key_name], [m].[last_updated], [m].[page], [m].[value]
FROM [master_config] AS [m]
WHERE [m].[page] = @__request_Page_0 AND [m].[key_name] = @__request_KeyName_1
2025-02-05 06:29:10.071 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 06:29:10.072 +03:00 [INF] Executed action NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI) in 5.1724ms
2025-02-05 06:29:10.072 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 06:29:10.073 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - 200 null application/json; charset=utf-8 11.1285ms
2025-02-05 06:29:10.772 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - application/json; charset=utf-8 36
2025-02-05 06:29:10.776 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 06:29:10.777 +03:00 [INF] Route matched with {action = "MasterFetch", controller = "Content"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] MasterFetch(NayifatAPI.Controllers.MasterFetchRequest) on controller NayifatAPI.Controllers.ContentController (NayifatAPI).
2025-02-05 06:29:10.780 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 06:29:10.784 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__request_Page_0='?' (Size = 450), @__request_KeyName_1='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[config_id], [m].[key_name], [m].[last_updated], [m].[page], [m].[value]
FROM [master_config] AS [m]
WHERE [m].[page] = @__request_Page_0 AND [m].[key_name] = @__request_KeyName_1
2025-02-05 06:29:10.786 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 06:29:10.787 +03:00 [INF] Executed action NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI) in 7.9345ms
2025-02-05 06:29:10.788 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 06:29:10.789 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - 200 null application/json; charset=utf-8 17.3084ms
2025-02-05 06:29:13.112 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - application/json; charset=utf-8 36
2025-02-05 06:29:13.115 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 06:29:13.116 +03:00 [INF] Route matched with {action = "MasterFetch", controller = "Content"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] MasterFetch(NayifatAPI.Controllers.MasterFetchRequest) on controller NayifatAPI.Controllers.ContentController (NayifatAPI).
2025-02-05 06:29:13.120 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 06:29:13.125 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[@__request_Page_0='?' (Size = 450), @__request_KeyName_1='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[config_id], [m].[key_name], [m].[last_updated], [m].[page], [m].[value]
FROM [master_config] AS [m]
WHERE [m].[page] = @__request_Page_0 AND [m].[key_name] = @__request_KeyName_1
2025-02-05 06:29:13.127 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 06:29:13.129 +03:00 [INF] Executed action NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI) in 12.3827ms
2025-02-05 06:29:13.130 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 06:29:13.131 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - 200 null application/json; charset=utf-8 18.6742ms
2025-02-05 06:37:49.135 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/send - application/json 539
2025-02-05 06:37:49.140 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.NotificationsController.SendNotification (NayifatAPI)'
2025-02-05 06:37:49.141 +03:00 [INF] Route matched with {action = "SendNotification", controller = "Notifications"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] SendNotification(NayifatAPI.Controllers.SendNotificationRequest) on controller NayifatAPI.Controllers.NotificationsController (NayifatAPI).
2025-02-05 06:37:49.157 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 06:37:49.167 +03:00 [INF] Received notification request: {"Title":null,"TitleEn":"Test Notification English    11111","TitleAr":"اختبار الإشعار","Filters":{"Customers.national_id":{"ValueKind":"Object","$type":"JsonElement"}},"NationalId":null,"NationalIds":null}
2025-02-05 06:37:49.175 +03:00 [INF] Starting GetTargetUsers with request type: Filtered Users
2025-02-05 06:37:49.178 +03:00 [INF] Processing filter for table: customers, field: national_id
2025-02-05 06:37:49.180 +03:00 [INF] Processing filter: national_id = all
2025-02-05 06:37:49.186 +03:00 [INF] Applied national_id string filter: = all
2025-02-05 06:37:49.188 +03:00 [INF] Added filter group for customers.national_id
2025-02-05 06:37:49.190 +03:00 [INF] Executing filter query with operation: AND
2025-02-05 06:37:49.234 +03:00 [ERR] Error in SendNotification
System.InvalidOperationException: Translation of 'EF.Property<string>(StructuralTypeShaperExpression: 
    NayifatAPI.Models.Customer
    ValueBufferExpression: 
        ProjectionBindingExpression: EmptyProjectionMember
    IsNullable: False
, "national_id")' failed. Either the query source is not an entity type, or the specified property does not exist on the entity type.
   at Microsoft.EntityFrameworkCore.Query.RelationalSqlTranslatingExpressionVisitor.VisitMethodCall(MethodCallExpression methodCallExpression)
   at Microsoft.EntityFrameworkCore.SqlServer.Query.Internal.SqlServerSqlTranslatingExpressionVisitor.VisitMethodCall(MethodCallExpression methodCallExpression)
   at Microsoft.EntityFrameworkCore.Query.RelationalSqlTranslatingExpressionVisitor.VisitBinary(BinaryExpression binaryExpression)
   at Microsoft.EntityFrameworkCore.SqlServer.Query.Internal.SqlServerSqlTranslatingExpressionVisitor.VisitBinary(BinaryExpression binaryExpression)
   at Microsoft.EntityFrameworkCore.Query.RelationalSqlTranslatingExpressionVisitor.TranslateInternal(Expression expression, Boolean applyDefaultTypeMapping)
   at Microsoft.EntityFrameworkCore.Query.RelationalSqlTranslatingExpressionVisitor.Translate(Expression expression, Boolean applyDefaultTypeMapping)
   at Microsoft.EntityFrameworkCore.Query.RelationalQueryableMethodTranslatingExpressionVisitor.TranslateExpression(Expression expression, Boolean applyDefaultTypeMapping)
   at Microsoft.EntityFrameworkCore.Query.RelationalQueryableMethodTranslatingExpressionVisitor.TranslateLambdaExpression(ShapedQueryExpression shapedQueryExpression, LambdaExpression lambdaExpression)
   at Microsoft.EntityFrameworkCore.Query.RelationalQueryableMethodTranslatingExpressionVisitor.TranslateWhere(ShapedQueryExpression source, LambdaExpression predicate)
   at Microsoft.EntityFrameworkCore.Query.QueryableMethodTranslatingExpressionVisitor.VisitMethodCall(MethodCallExpression methodCallExpression)
   at Microsoft.EntityFrameworkCore.Query.RelationalQueryableMethodTranslatingExpressionVisitor.VisitMethodCall(MethodCallExpression methodCallExpression)
   at Microsoft.EntityFrameworkCore.Query.QueryableMethodTranslatingExpressionVisitor.VisitMethodCall(MethodCallExpression methodCallExpression)
   at Microsoft.EntityFrameworkCore.Query.RelationalQueryableMethodTranslatingExpressionVisitor.VisitMethodCall(MethodCallExpression methodCallExpression)
   at Microsoft.EntityFrameworkCore.Query.QueryableMethodTranslatingExpressionVisitor.Translate(Expression expression)
   at Microsoft.EntityFrameworkCore.Query.RelationalQueryableMethodTranslatingExpressionVisitor.Translate(Expression expression)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutor[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Storage.Database.CompileQuery[TResult](Expression query, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.CompileQueryCore[TResult](IDatabase database, Expression query, IModel model, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.<>c__DisplayClass12_0`1.<ExecuteAsync>b__0()
   at Microsoft.EntityFrameworkCore.Query.Internal.CompiledQueryCache.GetOrAddQuery[TResult](Object cacheKey, Func`1 compiler)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteAsync[TResult](Expression query, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryable`1.GetAsyncEnumerator(CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.ConfiguredCancelableAsyncEnumerable`1.GetAsyncEnumerator()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at NayifatAPI.Controllers.NotificationsController.GetTargetUsers(SendNotificationRequest request) in C:\Users\yamta\StudioProjects\nayifat_app_2025_new\nayifatapi\Controllers\NotificationsController.cs:line 846
   at NayifatAPI.Controllers.NotificationsController.SendNotification(SendNotificationRequest request) in C:\Users\yamta\StudioProjects\nayifat_app_2025_new\nayifatapi\Controllers\NotificationsController.cs:line 203
2025-02-05 06:37:49.252 +03:00 [INF] Executing ObjectResult, writing value of type '<>f__AnonymousType12`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 06:37:49.254 +03:00 [INF] Executed action NayifatAPI.Controllers.NotificationsController.SendNotification (NayifatAPI) in 110.3699ms
2025-02-05 06:37:49.255 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.NotificationsController.SendNotification (NayifatAPI)'
2025-02-05 06:37:49.257 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/send - 500 null application/json; charset=utf-8 121.8309ms
2025-02-05 06:49:31.214 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/list - application/json 39
2025-02-05 06:49:31.214 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/list - application/json 39
2025-02-05 06:49:31.216 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI)'
2025-02-05 06:49:31.218 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI)'
2025-02-05 06:49:31.218 +03:00 [INF] Route matched with {action = "GetNotifications", controller = "Notifications"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetNotifications(NayifatAPI.Controllers.GetNotificationsRequest) on controller NayifatAPI.Controllers.NotificationsController (NayifatAPI).
2025-02-05 06:49:31.219 +03:00 [INF] Route matched with {action = "GetNotifications", controller = "Notifications"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetNotifications(NayifatAPI.Controllers.GetNotificationsRequest) on controller NayifatAPI.Controllers.NotificationsController (NayifatAPI).
2025-02-05 06:49:31.254 +03:00 [INF] Executed DbCommand (19ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 06:49:31.478 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__request_NationalId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[national_id], [u].[last_updated], [u].[notifications]
FROM [user_notifications] AS [u]
WHERE [u].[national_id] = @__request_NationalId_0
2025-02-05 06:49:31.479 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 06:49:31.569 +03:00 [INF] Executed DbCommand (87ms) [Parameters=[@__request_NationalId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[national_id], [u].[last_updated], [u].[notifications]
FROM [user_notifications] AS [u]
WHERE [u].[national_id] = @__request_NationalId_0
2025-02-05 06:49:31.709 +03:00 [INF] Executed DbCommand (227ms) [Parameters=[@__Parse_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [n].[Id], [n].[additional_data], [n].[Body], [n].[body_ar], [n].[body_en], [n].[created_at], [n].[expiry_at], [n].[Route], [n].[target_criteria], [n].[Title], [n].[title_ar], [n].[title_en]
FROM [notification_templates] AS [n]
WHERE [n].[Id] = @__Parse_0
2025-02-05 06:49:31.729 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__Parse_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [n].[Id], [n].[additional_data], [n].[Body], [n].[body_ar], [n].[body_en], [n].[created_at], [n].[expiry_at], [n].[Route], [n].[target_criteria], [n].[Title], [n].[title_ar], [n].[title_en]
FROM [notification_templates] AS [n]
WHERE [n].[Id] = @__Parse_0
2025-02-05 06:49:31.730 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__Parse_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [n].[Id], [n].[additional_data], [n].[Body], [n].[body_ar], [n].[body_en], [n].[created_at], [n].[expiry_at], [n].[Route], [n].[target_criteria], [n].[Title], [n].[title_ar], [n].[title_en]
FROM [notification_templates] AS [n]
WHERE [n].[Id] = @__Parse_0
2025-02-05 06:49:31.732 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__Parse_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [n].[Id], [n].[additional_data], [n].[Body], [n].[body_ar], [n].[body_en], [n].[created_at], [n].[expiry_at], [n].[Route], [n].[target_criteria], [n].[Title], [n].[title_ar], [n].[title_en]
FROM [notification_templates] AS [n]
WHERE [n].[Id] = @__Parse_0
2025-02-05 06:49:31.741 +03:00 [INF] Executed DbCommand (5ms) [Parameters=[@p0='?' (Size = 4000), @p1='?' (DbType = DateTime2), @p2='?' (Size = 4000), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (Size = 450), @p6='?' (Size = 4000), @p7='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [AuthLogs] ([AuthType], [CreatedAt], [DeviceId], [FailureReason], [IpAddress], [NationalId], [Status], [UserAgent])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7);
2025-02-05 06:49:31.741 +03:00 [INF] Executed DbCommand (7ms) [Parameters=[@p0='?' (Size = 4000), @p1='?' (DbType = DateTime2), @p2='?' (Size = 4000), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (Size = 450), @p6='?' (Size = 4000), @p7='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [AuthLogs] ([AuthType], [CreatedAt], [DeviceId], [FailureReason], [IpAddress], [NationalId], [Status], [UserAgent])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7);
2025-02-05 06:49:31.744 +03:00 [ERR] An exception occurred in the database while saving changes for context type 'NayifatAPI.Data.ApplicationDbContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_AuthLogs_Customers_NationalId". The conflict occurred in database "NayifatApp", table "dbo.Customers", column 'NationalId'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:d1b80ce1-73b0-476a-84b7-ddb643912114
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_AuthLogs_Customers_NationalId". The conflict occurred in database "NayifatApp", table "dbo.Customers", column 'NationalId'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:d1b80ce1-73b0-476a-84b7-ddb643912114
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2025-02-05 06:49:31.761 +03:00 [ERR] Error logging audit event. NationalId: all, Action: notification_delivered, Details: {"notification_count":2,"notification_ids":[6,3],"timestamp":"2025-02-05T06:49:31.7285577"}
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_AuthLogs_Customers_NationalId". The conflict occurred in database "NayifatApp", table "dbo.Customers", column 'NationalId'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:d1b80ce1-73b0-476a-84b7-ddb643912114
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at NayifatAPI.Services.AuditLogService.LogAsync(String nationalId, String action, Object details) in C:\Users\yamta\StudioProjects\nayifat_app_2025_new\nayifatapi\Services\AuditLogService.cs:line 36
2025-02-05 06:49:31.779 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 06:49:31.745 +03:00 [ERR] An exception occurred in the database while saving changes for context type 'NayifatAPI.Data.ApplicationDbContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_AuthLogs_Customers_NationalId". The conflict occurred in database "NayifatApp", table "dbo.Customers", column 'NationalId'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:6fc78f2d-7313-48f6-aa68-aca1a3647d04
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_AuthLogs_Customers_NationalId". The conflict occurred in database "NayifatApp", table "dbo.Customers", column 'NationalId'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:6fc78f2d-7313-48f6-aa68-aca1a3647d04
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2025-02-05 06:49:31.780 +03:00 [INF] Executed action NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI) in 305.9597ms
2025-02-05 06:49:32.162 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI)'
2025-02-05 06:49:32.162 +03:00 [ERR] Error logging audit event. NationalId: all, Action: notification_delivered, Details: {"notification_count":2,"notification_ids":[6,3],"timestamp":"2025-02-05T06:49:31.4811542"}
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_AuthLogs_Customers_NationalId". The conflict occurred in database "NayifatApp", table "dbo.Customers", column 'NationalId'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:6fc78f2d-7313-48f6-aa68-aca1a3647d04
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at NayifatAPI.Services.AuditLogService.LogAsync(String nationalId, String action, Object details) in C:\Users\yamta\StudioProjects\nayifat_app_2025_new\nayifatapi\Services\AuditLogService.cs:line 36
2025-02-05 06:49:32.162 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/list - 200 null application/json; charset=utf-8 948.2469ms
2025-02-05 06:49:32.171 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 06:49:32.173 +03:00 [INF] Executed action NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI) in 952.5654ms
2025-02-05 06:49:32.174 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI)'
2025-02-05 06:49:32.175 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/list - 200 null application/json; charset=utf-8 961.3085ms
2025-02-05 08:07:19.843 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/send - application/json 539
2025-02-05 08:07:19.848 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.NotificationsController.SendNotification (NayifatAPI)'
2025-02-05 08:07:19.849 +03:00 [INF] Route matched with {action = "SendNotification", controller = "Notifications"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] SendNotification(NayifatAPI.Controllers.SendNotificationRequest) on controller NayifatAPI.Controllers.NotificationsController (NayifatAPI).
2025-02-05 08:07:19.883 +03:00 [INF] Executed DbCommand (15ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 08:07:19.886 +03:00 [INF] Received notification request: {"Title":null,"TitleEn":"Test Notification English    11111","TitleAr":"اختبار الإشعار","Filters":{"Customers.national_id":{"ValueKind":"Object","$type":"JsonElement"}},"NationalId":null,"NationalIds":null}
2025-02-05 08:07:19.895 +03:00 [INF] Starting GetTargetUsers with request type: Filtered Users
2025-02-05 08:07:19.897 +03:00 [INF] Processing filter for table: customers, field: national_id
2025-02-05 08:07:19.898 +03:00 [INF] Processing filter: national_id = all
2025-02-05 08:07:19.900 +03:00 [INF] Applied national_id string filter: = all
2025-02-05 08:07:19.901 +03:00 [INF] Added filter group for customers.national_id
2025-02-05 08:07:19.902 +03:00 [INF] Executing filter query with operation: AND
2025-02-05 08:07:19.908 +03:00 [ERR] Error in SendNotification
System.InvalidOperationException: Translation of 'EF.Property<string>(StructuralTypeShaperExpression: 
    NayifatAPI.Models.Customer
    ValueBufferExpression: 
        ProjectionBindingExpression: EmptyProjectionMember
    IsNullable: False
, "national_id")' failed. Either the query source is not an entity type, or the specified property does not exist on the entity type.
   at Microsoft.EntityFrameworkCore.Query.RelationalSqlTranslatingExpressionVisitor.VisitMethodCall(MethodCallExpression methodCallExpression)
   at Microsoft.EntityFrameworkCore.SqlServer.Query.Internal.SqlServerSqlTranslatingExpressionVisitor.VisitMethodCall(MethodCallExpression methodCallExpression)
   at Microsoft.EntityFrameworkCore.Query.RelationalSqlTranslatingExpressionVisitor.VisitBinary(BinaryExpression binaryExpression)
   at Microsoft.EntityFrameworkCore.SqlServer.Query.Internal.SqlServerSqlTranslatingExpressionVisitor.VisitBinary(BinaryExpression binaryExpression)
   at Microsoft.EntityFrameworkCore.Query.RelationalSqlTranslatingExpressionVisitor.TranslateInternal(Expression expression, Boolean applyDefaultTypeMapping)
   at Microsoft.EntityFrameworkCore.Query.RelationalSqlTranslatingExpressionVisitor.Translate(Expression expression, Boolean applyDefaultTypeMapping)
   at Microsoft.EntityFrameworkCore.Query.RelationalQueryableMethodTranslatingExpressionVisitor.TranslateExpression(Expression expression, Boolean applyDefaultTypeMapping)
   at Microsoft.EntityFrameworkCore.Query.RelationalQueryableMethodTranslatingExpressionVisitor.TranslateLambdaExpression(ShapedQueryExpression shapedQueryExpression, LambdaExpression lambdaExpression)
   at Microsoft.EntityFrameworkCore.Query.RelationalQueryableMethodTranslatingExpressionVisitor.TranslateWhere(ShapedQueryExpression source, LambdaExpression predicate)
   at Microsoft.EntityFrameworkCore.Query.QueryableMethodTranslatingExpressionVisitor.VisitMethodCall(MethodCallExpression methodCallExpression)
   at Microsoft.EntityFrameworkCore.Query.RelationalQueryableMethodTranslatingExpressionVisitor.VisitMethodCall(MethodCallExpression methodCallExpression)
   at Microsoft.EntityFrameworkCore.Query.QueryableMethodTranslatingExpressionVisitor.VisitMethodCall(MethodCallExpression methodCallExpression)
   at Microsoft.EntityFrameworkCore.Query.RelationalQueryableMethodTranslatingExpressionVisitor.VisitMethodCall(MethodCallExpression methodCallExpression)
   at Microsoft.EntityFrameworkCore.Query.QueryableMethodTranslatingExpressionVisitor.Translate(Expression expression)
   at Microsoft.EntityFrameworkCore.Query.RelationalQueryableMethodTranslatingExpressionVisitor.Translate(Expression expression)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutor[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Storage.Database.CompileQuery[TResult](Expression query, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.CompileQueryCore[TResult](IDatabase database, Expression query, IModel model, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.<>c__DisplayClass12_0`1.<ExecuteAsync>b__0()
   at Microsoft.EntityFrameworkCore.Query.Internal.CompiledQueryCache.GetOrAddQuery[TResult](Object cacheKey, Func`1 compiler)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteAsync[TResult](Expression query, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryable`1.GetAsyncEnumerator(CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.ConfiguredCancelableAsyncEnumerable`1.GetAsyncEnumerator()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at NayifatAPI.Controllers.NotificationsController.GetTargetUsers(SendNotificationRequest request) in C:\Users\yamta\StudioProjects\nayifat_app_2025_new\nayifatapi\Controllers\NotificationsController.cs:line 846
   at NayifatAPI.Controllers.NotificationsController.SendNotification(SendNotificationRequest request) in C:\Users\yamta\StudioProjects\nayifat_app_2025_new\nayifatapi\Controllers\NotificationsController.cs:line 203
2025-02-05 08:07:19.919 +03:00 [INF] Executing ObjectResult, writing value of type '<>f__AnonymousType12`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 08:07:19.923 +03:00 [INF] Executed action NayifatAPI.Controllers.NotificationsController.SendNotification (NayifatAPI) in 71.9391ms
2025-02-05 08:07:19.926 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.NotificationsController.SendNotification (NayifatAPI)'
2025-02-05 08:07:19.927 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/send - 500 null application/json; charset=utf-8 83.7033ms
2025-02-05 08:07:26.854 +03:00 [INF] Application is shutting down...
2025-02-05 08:07:46.376 +03:00 [INF] Starting web application
2025-02-05 08:07:46.461 +03:00 [INF] Now listening on: http://localhost:5264
2025-02-05 08:07:46.466 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2025-02-05 08:07:46.467 +03:00 [INF] Hosting environment: Development
2025-02-05 08:07:46.467 +03:00 [INF] Content root path: C:\Users\yamta\StudioProjects\nayifat_app_2025_new\nayifatapi
2025-02-05 08:08:08.711 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/send - application/json 539
2025-02-05 08:08:08.752 +03:00 [WRN] Failed to determine the https port for redirect.
2025-02-05 08:08:08.756 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.NotificationsController.SendNotification (NayifatAPI)'
2025-02-05 08:08:08.779 +03:00 [INF] Route matched with {action = "SendNotification", controller = "Notifications"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] SendNotification(NayifatAPI.Controllers.SendNotificationRequest) on controller NayifatAPI.Controllers.NotificationsController (NayifatAPI).
2025-02-05 08:08:10.529 +03:00 [INF] Executed DbCommand (26ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 08:08:10.631 +03:00 [INF] Received notification request: {"Title":null,"TitleEn":"Test Notification English    11111","TitleAr":"اختبار الإشعار","Filters":{"Customers.national_id":{"ValueKind":"Object","$type":"JsonElement"}},"NationalId":null,"NationalIds":null}
2025-02-05 08:08:10.648 +03:00 [INF] Starting GetTargetUsers with request type: Filtered Users
2025-02-05 08:08:10.656 +03:00 [INF] Special case: Fetching all users
2025-02-05 08:08:10.730 +03:00 [INF] Executed DbCommand (32ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[NationalId]
FROM [Customers] AS [c]
2025-02-05 08:08:10.754 +03:00 [INF] Target users query completed. Found 11 users
2025-02-05 08:08:10.756 +03:00 [INF] Found 11 target users for notification
2025-02-05 08:08:11.202 +03:00 [INF] Executed DbCommand (253ms) [Parameters=[@p0='?' (Size = 4000), @p1='?' (Size = 8000) (DbType = AnsiString), @p2='?' (Size = 4000), @p3='?' (Size = 8000) (DbType = AnsiString), @p4='?' (DbType = DateTime2), @p5='?' (DbType = DateTime2), @p6='?' (Size = 255), @p7='?' (Size = 4000), @p8='?' (Size = 255), @p9='?' (Size = 255), @p10='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [notification_templates] ([additional_data], [Body], [body_ar], [body_en], [created_at], [expiry_at], [Route], [target_criteria], [Title], [title_ar], [title_en])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10);
2025-02-05 08:08:11.241 +03:00 [INF] Created notification template with ID: 12
2025-02-05 08:08:11.340 +03:00 [INF] Executed DbCommand (12ms) [Parameters=[@p0='?' (Size = 4000), @p1='?' (DbType = DateTime2), @p2='?' (Size = 4000), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (Size = 450), @p6='?' (Size = 4000), @p7='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [AuthLogs] ([AuthType], [CreatedAt], [DeviceId], [FailureReason], [IpAddress], [NationalId], [Status], [UserAgent])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7);
2025-02-05 08:08:11.364 +03:00 [INF] Executed DbCommand (4ms) [Parameters=[@__userId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[national_id], [u].[last_updated], [u].[notifications]
FROM [user_notifications] AS [u]
WHERE [u].[national_id] = @__userId_0
2025-02-05 08:08:11.368 +03:00 [INF] Processing notification for user 1012345678. Existing notification record: false
2025-02-05 08:08:11.369 +03:00 [INF] Current notifications count for user 1012345678: 0
2025-02-05 08:08:11.387 +03:00 [INF] Serialized new notifications for user 1012345678. Length: 138
2025-02-05 08:08:11.416 +03:00 [INF] Executed DbCommand (19ms) [Parameters=[@p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
INSERT INTO user_notifications (national_id, notifications, last_updated) VALUES (@p0, @p1, @p2)
2025-02-05 08:08:11.420 +03:00 [INF] Created new UserNotification entry for user: 1012345678
2025-02-05 08:08:11.424 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[national_id], [u].[last_updated], [u].[notifications]
FROM [user_notifications] AS [u]
WHERE [u].[national_id] = @__userId_0
2025-02-05 08:08:11.441 +03:00 [INF] Processing notification for user 1023456789. Existing notification record: true
2025-02-05 08:08:11.444 +03:00 [INF] Current notifications count for user 1023456789: 3
2025-02-05 08:08:11.445 +03:00 [INF] Serialized new notifications for user 1023456789. Length: 599
2025-02-05 08:08:11.457 +03:00 [INF] Executed DbCommand (10ms) [Parameters=[@p0='?' (Size = 4000), @p1='?' (DbType = DateTime2), @p2='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
UPDATE user_notifications SET notifications = @p0, last_updated = @p1 WHERE national_id = @p2
2025-02-05 08:08:11.460 +03:00 [INF] Updated existing UserNotification for user: 1023456789
2025-02-05 08:08:11.464 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[national_id], [u].[last_updated], [u].[notifications]
FROM [user_notifications] AS [u]
WHERE [u].[national_id] = @__userId_0
2025-02-05 08:08:11.467 +03:00 [INF] Processing notification for user 1034567890. Existing notification record: false
2025-02-05 08:08:11.468 +03:00 [INF] Current notifications count for user 1034567890: 0
2025-02-05 08:08:11.469 +03:00 [INF] Serialized new notifications for user 1034567890. Length: 138
2025-02-05 08:08:11.472 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
INSERT INTO user_notifications (national_id, notifications, last_updated) VALUES (@p0, @p1, @p2)
2025-02-05 08:08:11.474 +03:00 [INF] Created new UserNotification entry for user: 1034567890
2025-02-05 08:08:11.478 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[national_id], [u].[last_updated], [u].[notifications]
FROM [user_notifications] AS [u]
WHERE [u].[national_id] = @__userId_0
2025-02-05 08:08:11.480 +03:00 [INF] Processing notification for user 1045678901. Existing notification record: false
2025-02-05 08:08:11.482 +03:00 [INF] Current notifications count for user 1045678901: 0
2025-02-05 08:08:11.485 +03:00 [INF] Serialized new notifications for user 1045678901. Length: 138
2025-02-05 08:08:11.488 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
INSERT INTO user_notifications (national_id, notifications, last_updated) VALUES (@p0, @p1, @p2)
2025-02-05 08:08:11.490 +03:00 [INF] Created new UserNotification entry for user: 1045678901
2025-02-05 08:08:11.493 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[national_id], [u].[last_updated], [u].[notifications]
FROM [user_notifications] AS [u]
WHERE [u].[national_id] = @__userId_0
2025-02-05 08:08:11.496 +03:00 [INF] Processing notification for user 1056789012. Existing notification record: false
2025-02-05 08:08:11.497 +03:00 [INF] Current notifications count for user 1056789012: 0
2025-02-05 08:08:11.497 +03:00 [INF] Serialized new notifications for user 1056789012. Length: 138
2025-02-05 08:08:11.501 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
INSERT INTO user_notifications (national_id, notifications, last_updated) VALUES (@p0, @p1, @p2)
2025-02-05 08:08:11.502 +03:00 [INF] Created new UserNotification entry for user: 1056789012
2025-02-05 08:08:11.504 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[national_id], [u].[last_updated], [u].[notifications]
FROM [user_notifications] AS [u]
WHERE [u].[national_id] = @__userId_0
2025-02-05 08:08:11.506 +03:00 [INF] Processing notification for user 1064448614. Existing notification record: true
2025-02-05 08:08:11.507 +03:00 [INF] Current notifications count for user 1064448614: 7
2025-02-05 08:08:11.510 +03:00 [INF] Serialized new notifications for user 1064448614. Length: 1259
2025-02-05 08:08:11.513 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@p0='?' (Size = 4000), @p1='?' (DbType = DateTime2), @p2='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
UPDATE user_notifications SET notifications = @p0, last_updated = @p1 WHERE national_id = @p2
2025-02-05 08:08:11.515 +03:00 [INF] Updated existing UserNotification for user: 1064448614
2025-02-05 08:08:11.518 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[national_id], [u].[last_updated], [u].[notifications]
FROM [user_notifications] AS [u]
WHERE [u].[national_id] = @__userId_0
2025-02-05 08:08:11.519 +03:00 [INF] Processing notification for user 1112345678. Existing notification record: false
2025-02-05 08:08:11.520 +03:00 [INF] Current notifications count for user 1112345678: 0
2025-02-05 08:08:11.521 +03:00 [INF] Serialized new notifications for user 1112345678. Length: 138
2025-02-05 08:08:11.523 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
INSERT INTO user_notifications (national_id, notifications, last_updated) VALUES (@p0, @p1, @p2)
2025-02-05 08:08:11.525 +03:00 [INF] Created new UserNotification entry for user: 1112345678
2025-02-05 08:08:11.528 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[national_id], [u].[last_updated], [u].[notifications]
FROM [user_notifications] AS [u]
WHERE [u].[national_id] = @__userId_0
2025-02-05 08:08:11.530 +03:00 [INF] Processing notification for user 1112345679. Existing notification record: true
2025-02-05 08:08:11.532 +03:00 [INF] Current notifications count for user 1112345679: 1
2025-02-05 08:08:11.534 +03:00 [INF] Serialized new notifications for user 1112345679. Length: 298
2025-02-05 08:08:11.537 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@p0='?' (Size = 4000), @p1='?' (DbType = DateTime2), @p2='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
UPDATE user_notifications SET notifications = @p0, last_updated = @p1 WHERE national_id = @p2
2025-02-05 08:08:11.539 +03:00 [INF] Updated existing UserNotification for user: 1112345679
2025-02-05 08:08:11.540 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[national_id], [u].[last_updated], [u].[notifications]
FROM [user_notifications] AS [u]
WHERE [u].[national_id] = @__userId_0
2025-02-05 08:08:11.545 +03:00 [INF] Processing notification for user 1112345680. Existing notification record: false
2025-02-05 08:08:11.546 +03:00 [INF] Current notifications count for user 1112345680: 0
2025-02-05 08:08:11.547 +03:00 [INF] Serialized new notifications for user 1112345680. Length: 138
2025-02-05 08:08:11.551 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
INSERT INTO user_notifications (national_id, notifications, last_updated) VALUES (@p0, @p1, @p2)
2025-02-05 08:08:11.553 +03:00 [INF] Created new UserNotification entry for user: 1112345680
2025-02-05 08:08:11.554 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[national_id], [u].[last_updated], [u].[notifications]
FROM [user_notifications] AS [u]
WHERE [u].[national_id] = @__userId_0
2025-02-05 08:08:11.556 +03:00 [INF] Processing notification for user 1112345681. Existing notification record: false
2025-02-05 08:08:11.557 +03:00 [INF] Current notifications count for user 1112345681: 0
2025-02-05 08:08:11.558 +03:00 [INF] Serialized new notifications for user 1112345681. Length: 138
2025-02-05 08:08:11.562 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
INSERT INTO user_notifications (national_id, notifications, last_updated) VALUES (@p0, @p1, @p2)
2025-02-05 08:08:11.564 +03:00 [INF] Created new UserNotification entry for user: 1112345681
2025-02-05 08:08:11.568 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[national_id], [u].[last_updated], [u].[notifications]
FROM [user_notifications] AS [u]
WHERE [u].[national_id] = @__userId_0
2025-02-05 08:08:11.570 +03:00 [INF] Processing notification for user 1234567890. Existing notification record: false
2025-02-05 08:08:11.571 +03:00 [INF] Current notifications count for user 1234567890: 0
2025-02-05 08:08:11.571 +03:00 [INF] Serialized new notifications for user 1234567890. Length: 138
2025-02-05 08:08:11.576 +03:00 [INF] Executed DbCommand (4ms) [Parameters=[@p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
INSERT INTO user_notifications (national_id, notifications, last_updated) VALUES (@p0, @p1, @p2)
2025-02-05 08:08:11.578 +03:00 [INF] Created new UserNotification entry for user: 1234567890
2025-02-05 08:08:11.590 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@p0='?' (Size = 4000), @p1='?' (DbType = DateTime2), @p2='?' (Size = 4000), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (Size = 450), @p6='?' (Size = 4000), @p7='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [AuthLogs] ([AuthType], [CreatedAt], [DeviceId], [FailureReason], [IpAddress], [NationalId], [Status], [UserAgent])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7);
2025-02-05 08:08:11.594 +03:00 [INF] Successfully sent notifications. Template: 12, Success: 11, Total: 11
2025-02-05 08:08:11.606 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 08:08:11.631 +03:00 [INF] Executed action NayifatAPI.Controllers.NotificationsController.SendNotification (NayifatAPI) in 2844.9675ms
2025-02-05 08:08:11.635 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.NotificationsController.SendNotification (NayifatAPI)'
2025-02-05 08:08:11.651 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/send - 200 null application/json; charset=utf-8 2941.2025ms
2025-02-05 08:16:59.519 +03:00 [INF] Application is shutting down...
2025-02-05 08:17:10.668 +03:00 [INF] Starting web application
2025-02-05 08:17:10.814 +03:00 [INF] Now listening on: http://localhost:5264
2025-02-05 08:17:10.820 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2025-02-05 08:17:10.822 +03:00 [INF] Hosting environment: Development
2025-02-05 08:17:10.823 +03:00 [INF] Content root path: C:\Users\yamta\StudioProjects\nayifat_app_2025_new\nayifatapi
2025-02-05 08:17:48.163 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/send - application/json 544
2025-02-05 08:17:48.223 +03:00 [WRN] Failed to determine the https port for redirect.
2025-02-05 08:17:48.228 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.NotificationsController.SendNotification (NayifatAPI)'
2025-02-05 08:17:48.263 +03:00 [INF] Route matched with {action = "SendNotification", controller = "Notifications"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] SendNotification(NayifatAPI.Controllers.SendNotificationRequest) on controller NayifatAPI.Controllers.NotificationsController (NayifatAPI).
2025-02-05 08:17:50.055 +03:00 [INF] Executed DbCommand (108ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 08:17:50.171 +03:00 [INF] Received notification request: {"Title":null,"TitleEn":"Test Notification English    9999","TitleAr":"اختبار الإشعار  9999","Filters":{"Customers.national_id":{"ValueKind":"Object","$type":"JsonElement"}},"NationalId":null,"NationalIds":null}
2025-02-05 08:17:50.190 +03:00 [INF] Starting GetTargetUsers with request type: Filtered Users
2025-02-05 08:17:50.198 +03:00 [INF] Special case: Using 'all' as target without fetching IDs
2025-02-05 08:17:50.201 +03:00 [INF] Target users query completed. Found 1 users
2025-02-05 08:17:50.208 +03:00 [INF] Processing notification for all users
2025-02-05 08:17:50.414 +03:00 [INF] Executed DbCommand (24ms) [Parameters=[@p0='?' (Size = 4000), @p1='?' (Size = 8000) (DbType = AnsiString), @p2='?' (Size = 4000), @p3='?' (Size = 8000) (DbType = AnsiString), @p4='?' (DbType = DateTime2), @p5='?' (DbType = DateTime2), @p6='?' (Size = 255), @p7='?' (Size = 4000), @p8='?' (Size = 255), @p9='?' (Size = 255), @p10='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [notification_templates] ([additional_data], [Body], [body_ar], [body_en], [created_at], [expiry_at], [Route], [target_criteria], [Title], [title_ar], [title_en])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10);
2025-02-05 08:17:50.478 +03:00 [INF] Created notification template with ID: 13
2025-02-05 08:17:50.548 +03:00 [INF] Executed DbCommand (15ms) [Parameters=[@p0='?' (Size = 4000), @p1='?' (DbType = DateTime2), @p2='?' (Size = 4000), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (Size = 450), @p6='?' (Size = 4000), @p7='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [AuthLogs] ([AuthType], [CreatedAt], [DeviceId], [FailureReason], [IpAddress], [NationalId], [Status], [UserAgent])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7);
2025-02-05 08:17:50.579 +03:00 [ERR] An exception occurred in the database while saving changes for context type 'NayifatAPI.Data.ApplicationDbContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_AuthLogs_Customers_NationalId". The conflict occurred in database "NayifatApp", table "dbo.Customers", column 'NationalId'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:eb882655-8a0b-43ce-85ea-acf8082656fd
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_AuthLogs_Customers_NationalId". The conflict occurred in database "NayifatApp", table "dbo.Customers", column 'NationalId'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:eb882655-8a0b-43ce-85ea-acf8082656fd
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2025-02-05 08:17:50.608 +03:00 [ERR] Error logging audit event. NationalId: system, Action: notification_sent, Details: {"template_id":13,"recipient_count":-1,"target_criteria":{"Customers.national_id":{"operator":"=","value":"all"}},"timestamp":"2025-02-05T08:17:50.2119948"}
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_AuthLogs_Customers_NationalId". The conflict occurred in database "NayifatApp", table "dbo.Customers", column 'NationalId'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:eb882655-8a0b-43ce-85ea-acf8082656fd
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at NayifatAPI.Services.AuditLogService.LogAsync(String nationalId, String action, Object details) in C:\Users\yamta\StudioProjects\nayifat_app_2025_new\nayifatapi\Services\AuditLogService.cs:line 36
2025-02-05 08:17:50.646 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 08:17:50.667 +03:00 [INF] Executed action NayifatAPI.Controllers.NotificationsController.SendNotification (NayifatAPI) in 2395.8118ms
2025-02-05 08:17:50.672 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.NotificationsController.SendNotification (NayifatAPI)'
2025-02-05 08:17:50.686 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/send - 200 null application/json; charset=utf-8 2525.0545ms
2025-02-05 08:18:45.177 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/send - application/json 544
2025-02-05 08:18:45.187 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.NotificationsController.SendNotification (NayifatAPI)'
2025-02-05 08:18:45.428 +03:00 [INF] Route matched with {action = "SendNotification", controller = "Notifications"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] SendNotification(NayifatAPI.Controllers.SendNotificationRequest) on controller NayifatAPI.Controllers.NotificationsController (NayifatAPI).
2025-02-05 08:18:45.732 +03:00 [INF] Executed DbCommand (131ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 08:18:45.876 +03:00 [INF] Received notification request: {"Title":null,"TitleEn":"Test Notification English    9999","TitleAr":"اختبار الإشعار  9999","Filters":{"Customers.national_id":{"ValueKind":"Object","$type":"JsonElement"}},"NationalId":null,"NationalIds":null}
2025-02-05 08:18:46.215 +03:00 [INF] Starting GetTargetUsers with request type: Filtered Users
2025-02-05 08:18:46.216 +03:00 [INF] Special case: Using 'all' as target without fetching IDs
2025-02-05 08:18:46.216 +03:00 [INF] Target users query completed. Found 1 users
2025-02-05 08:18:46.217 +03:00 [INF] Processing notification for all users
2025-02-05 08:18:46.231 +03:00 [INF] Executed DbCommand (11ms) [Parameters=[@p0='?' (Size = 4000), @p1='?' (Size = 8000) (DbType = AnsiString), @p2='?' (Size = 4000), @p3='?' (Size = 8000) (DbType = AnsiString), @p4='?' (DbType = DateTime2), @p5='?' (DbType = DateTime2), @p6='?' (Size = 255), @p7='?' (Size = 4000), @p8='?' (Size = 255), @p9='?' (Size = 255), @p10='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [notification_templates] ([additional_data], [Body], [body_ar], [body_en], [created_at], [expiry_at], [Route], [target_criteria], [Title], [title_ar], [title_en])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10);
2025-02-05 08:18:46.235 +03:00 [INF] Created notification template with ID: 14
2025-02-05 08:18:46.598 +03:00 [INF] Executed DbCommand (36ms) [Parameters=[@p0='?' (Size = 4000), @p1='?' (DbType = DateTime2), @p2='?' (Size = 4000), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (Size = 450), @p6='?' (Size = 4000), @p7='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [AuthLogs] ([AuthType], [CreatedAt], [DeviceId], [FailureReason], [IpAddress], [NationalId], [Status], [UserAgent])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7);
2025-02-05 08:18:46.609 +03:00 [ERR] An exception occurred in the database while saving changes for context type 'NayifatAPI.Data.ApplicationDbContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_AuthLogs_Customers_NationalId". The conflict occurred in database "NayifatApp", table "dbo.Customers", column 'NationalId'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:eb882655-8a0b-43ce-85ea-acf8082656fd
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_AuthLogs_Customers_NationalId". The conflict occurred in database "NayifatApp", table "dbo.Customers", column 'NationalId'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:eb882655-8a0b-43ce-85ea-acf8082656fd
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2025-02-05 08:18:46.626 +03:00 [ERR] Error logging audit event. NationalId: system, Action: notification_sent, Details: {"template_id":14,"recipient_count":-1,"target_criteria":{"Customers.national_id":{"operator":"=","value":"all"}},"timestamp":"2025-02-05T08:18:46.2183631"}
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_AuthLogs_Customers_NationalId". The conflict occurred in database "NayifatApp", table "dbo.Customers", column 'NationalId'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:eb882655-8a0b-43ce-85ea-acf8082656fd
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at NayifatAPI.Services.AuditLogService.LogAsync(String nationalId, String action, Object details) in C:\Users\yamta\StudioProjects\nayifat_app_2025_new\nayifatapi\Services\AuditLogService.cs:line 36
2025-02-05 08:18:46.641 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 08:18:46.644 +03:00 [INF] Executed action NayifatAPI.Controllers.NotificationsController.SendNotification (NayifatAPI) in 1100.5883ms
2025-02-05 08:18:46.646 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.NotificationsController.SendNotification (NayifatAPI)'
2025-02-05 08:18:46.649 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/send - 200 null application/json; charset=utf-8 1471.386ms
2025-02-05 08:19:26.143 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/list - application/json 39
2025-02-05 08:19:26.146 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/list - application/json 39
2025-02-05 08:19:26.148 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI)'
2025-02-05 08:19:26.150 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI)'
2025-02-05 08:19:26.161 +03:00 [INF] Route matched with {action = "GetNotifications", controller = "Notifications"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetNotifications(NayifatAPI.Controllers.GetNotificationsRequest) on controller NayifatAPI.Controllers.NotificationsController (NayifatAPI).
2025-02-05 08:19:26.161 +03:00 [INF] Route matched with {action = "GetNotifications", controller = "Notifications"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetNotifications(NayifatAPI.Controllers.GetNotificationsRequest) on controller NayifatAPI.Controllers.NotificationsController (NayifatAPI).
2025-02-05 08:19:26.227 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 08:19:26.229 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 08:19:26.244 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__request_NationalId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[national_id], [u].[last_updated], [u].[notifications]
FROM [user_notifications] AS [u]
WHERE [u].[national_id] = @__request_NationalId_0
2025-02-05 08:19:26.244 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[@__request_NationalId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[national_id], [u].[last_updated], [u].[notifications]
FROM [user_notifications] AS [u]
WHERE [u].[national_id] = @__request_NationalId_0
2025-02-05 08:19:26.250 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 08:19:26.250 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 08:19:26.252 +03:00 [INF] Executed action NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI) in 87.1408ms
2025-02-05 08:19:26.252 +03:00 [INF] Executed action NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI) in 88.203ms
2025-02-05 08:19:26.253 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI)'
2025-02-05 08:19:26.257 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI)'
2025-02-05 08:19:26.258 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/list - 200 null application/json; charset=utf-8 114.5114ms
2025-02-05 08:19:26.258 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/list - 200 null application/json; charset=utf-8 112.3696ms
2025-02-05 08:21:12.481 +03:00 [INF] Application is shutting down...
2025-02-05 08:21:24.683 +03:00 [INF] Starting web application
2025-02-05 08:21:24.840 +03:00 [INF] Now listening on: http://localhost:5264
2025-02-05 08:21:24.847 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2025-02-05 08:21:24.848 +03:00 [INF] Hosting environment: Development
2025-02-05 08:21:24.849 +03:00 [INF] Content root path: C:\Users\yamta\StudioProjects\nayifat_app_2025_new\nayifatapi
2025-02-05 08:21:35.990 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/send - application/json 544
2025-02-05 08:21:36.044 +03:00 [WRN] Failed to determine the https port for redirect.
2025-02-05 08:21:36.055 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.NotificationsController.SendNotification (NayifatAPI)'
2025-02-05 08:21:36.088 +03:00 [INF] Route matched with {action = "SendNotification", controller = "Notifications"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] SendNotification(NayifatAPI.Controllers.SendNotificationRequest) on controller NayifatAPI.Controllers.NotificationsController (NayifatAPI).
2025-02-05 08:21:38.357 +03:00 [INF] Executed DbCommand (48ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 08:21:38.553 +03:00 [INF] Received notification request: {"Title":null,"TitleEn":"Test Notification English    9999","TitleAr":"اختبار الإشعار  9999","Filters":{"Customers.national_id":{"ValueKind":"Object","$type":"JsonElement"}},"NationalId":null,"NationalIds":null}
2025-02-05 08:21:38.578 +03:00 [INF] Starting GetTargetUsers with request type: Filtered Users
2025-02-05 08:21:38.593 +03:00 [INF] Special case: Using 'all' as target without fetching IDs
2025-02-05 08:21:38.594 +03:00 [INF] Target users query completed. Found 1 users
2025-02-05 08:21:38.595 +03:00 [INF] Processing notification for all users
2025-02-05 08:21:38.843 +03:00 [INF] Executed DbCommand (34ms) [Parameters=[@p0='?' (Size = 4000), @p1='?' (Size = 8000) (DbType = AnsiString), @p2='?' (Size = 4000), @p3='?' (Size = 8000) (DbType = AnsiString), @p4='?' (DbType = DateTime2), @p5='?' (DbType = DateTime2), @p6='?' (Size = 255), @p7='?' (Size = 4000), @p8='?' (Size = 255), @p9='?' (Size = 255), @p10='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [notification_templates] ([additional_data], [Body], [body_ar], [body_en], [created_at], [expiry_at], [Route], [target_criteria], [Title], [title_ar], [title_en])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10);
2025-02-05 08:21:38.908 +03:00 [INF] Created notification template with ID: 15
2025-02-05 08:21:38.915 +03:00 [WRN] The query uses the 'First'/'FirstOrDefault' operator without 'OrderBy' and filter operators. This may lead to unpredictable results.
2025-02-05 08:21:38.959 +03:00 [INF] Executed DbCommand (15ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[NationalId], [c].[AddNo], [c].[BuildingNo], [c].[City], [c].[Consent], [c].[ConsentDate], [c].[DateOfBirth], [c].[Dependents], [c].[District], [c].[Email], [c].[Employer], [c].[FamilyNameAr], [c].[FamilyNameEn], [c].[FirstNameAr], [c].[FirstNameEn], [c].[Iban], [c].[IdExpiryDate], [c].[Los], [c].[Mpin], [c].[MpinEnabled], [c].[NafathStatus], [c].[NafathTimestamp], [c].[Password], [c].[Phone], [c].[RegistrationDate], [c].[SalaryCustomer], [c].[SalaryDakhli], [c].[SecondNameAr], [c].[SecondNameEn], [c].[Sector], [c].[Street], [c].[ThirdNameAr], [c].[ThirdNameEn], [c].[Zipcode]
FROM [Customers] AS [c]
2025-02-05 08:21:39.291 +03:00 [INF] Executed DbCommand (13ms) [Parameters=[@p0='?' (Size = 4000), @p1='?' (DbType = DateTime2), @p2='?' (Size = 4000), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (Size = 450), @p6='?' (Size = 4000), @p7='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [AuthLogs] ([AuthType], [CreatedAt], [DeviceId], [FailureReason], [IpAddress], [NationalId], [Status], [UserAgent])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7);
2025-02-05 08:21:39.319 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 08:21:39.353 +03:00 [INF] Executed action NayifatAPI.Controllers.NotificationsController.SendNotification (NayifatAPI) in 3253.8008ms
2025-02-05 08:21:39.356 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.NotificationsController.SendNotification (NayifatAPI)'
2025-02-05 08:21:39.370 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/send - 200 null application/json; charset=utf-8 3382.1742ms
2025-02-05 08:23:41.173 +03:00 [INF] Application is shutting down...
2025-02-05 08:23:52.500 +03:00 [INF] Starting web application
2025-02-05 08:23:52.616 +03:00 [INF] Now listening on: http://localhost:5264
2025-02-05 08:23:52.619 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2025-02-05 08:23:52.620 +03:00 [INF] Hosting environment: Development
2025-02-05 08:23:52.621 +03:00 [INF] Content root path: C:\Users\yamta\StudioProjects\nayifat_app_2025_new\nayifatapi
2025-02-05 08:23:58.672 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/send - application/json 544
2025-02-05 08:23:58.722 +03:00 [WRN] Failed to determine the https port for redirect.
2025-02-05 08:23:58.727 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.NotificationsController.SendNotification (NayifatAPI)'
2025-02-05 08:23:58.757 +03:00 [INF] Route matched with {action = "SendNotification", controller = "Notifications"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] SendNotification(NayifatAPI.Controllers.SendNotificationRequest) on controller NayifatAPI.Controllers.NotificationsController (NayifatAPI).
2025-02-05 08:24:00.165 +03:00 [INF] Executed DbCommand (27ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 08:24:00.252 +03:00 [INF] Received notification request: {"Title":null,"TitleEn":"Test Notification English    9999","TitleAr":"اختبار الإشعار  9999","Filters":{"Customers.national_id":{"ValueKind":"Object","$type":"JsonElement"}},"NationalId":null,"NationalIds":null}
2025-02-05 08:24:00.266 +03:00 [INF] Starting GetTargetUsers with request type: Filtered Users
2025-02-05 08:24:00.274 +03:00 [INF] Special case: Using 'all' as target without fetching IDs
2025-02-05 08:24:00.275 +03:00 [INF] Target users query completed. Found 1 users
2025-02-05 08:24:00.276 +03:00 [INF] Processing notification for all users
2025-02-05 08:24:00.522 +03:00 [INF] Executed DbCommand (88ms) [Parameters=[@p0='?' (Size = 4000), @p1='?' (Size = 8000) (DbType = AnsiString), @p2='?' (Size = 4000), @p3='?' (Size = 8000) (DbType = AnsiString), @p4='?' (DbType = DateTime2), @p5='?' (DbType = DateTime2), @p6='?' (Size = 255), @p7='?' (Size = 4000), @p8='?' (Size = 255), @p9='?' (Size = 255), @p10='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [notification_templates] ([additional_data], [Body], [body_ar], [body_en], [created_at], [expiry_at], [Route], [target_criteria], [Title], [title_ar], [title_en])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10);
2025-02-05 08:24:00.554 +03:00 [INF] Created notification template with ID: 16
2025-02-05 08:24:00.558 +03:00 [WRN] The query uses the 'First'/'FirstOrDefault' operator without 'OrderBy' and filter operators. This may lead to unpredictable results.
2025-02-05 08:24:00.590 +03:00 [INF] Executed DbCommand (12ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[NationalId], [c].[AddNo], [c].[BuildingNo], [c].[City], [c].[Consent], [c].[ConsentDate], [c].[DateOfBirth], [c].[Dependents], [c].[District], [c].[Email], [c].[Employer], [c].[FamilyNameAr], [c].[FamilyNameEn], [c].[FirstNameAr], [c].[FirstNameEn], [c].[Iban], [c].[IdExpiryDate], [c].[Los], [c].[Mpin], [c].[MpinEnabled], [c].[NafathStatus], [c].[NafathTimestamp], [c].[Password], [c].[Phone], [c].[RegistrationDate], [c].[SalaryCustomer], [c].[SalaryDakhli], [c].[SecondNameAr], [c].[SecondNameEn], [c].[Sector], [c].[Street], [c].[ThirdNameAr], [c].[ThirdNameEn], [c].[Zipcode]
FROM [Customers] AS [c]
2025-02-05 08:24:00.766 +03:00 [INF] Executed DbCommand (12ms) [Parameters=[@p0='?' (Size = 4000), @p1='?' (DbType = DateTime2), @p2='?' (Size = 4000), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (Size = 450), @p6='?' (Size = 4000), @p7='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [AuthLogs] ([AuthType], [CreatedAt], [DeviceId], [FailureReason], [IpAddress], [NationalId], [Status], [UserAgent])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7);
2025-02-05 08:24:00.776 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 08:24:00.795 +03:00 [INF] Executed action NayifatAPI.Controllers.NotificationsController.SendNotification (NayifatAPI) in 2032.9689ms
2025-02-05 08:24:00.801 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.NotificationsController.SendNotification (NayifatAPI)'
2025-02-05 08:24:00.819 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/send - 200 null application/json; charset=utf-8 2142.8494ms
2025-02-05 08:25:02.411 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/send - application/json 544
2025-02-05 08:25:02.418 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.NotificationsController.SendNotification (NayifatAPI)'
2025-02-05 08:25:02.419 +03:00 [INF] Route matched with {action = "SendNotification", controller = "Notifications"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] SendNotification(NayifatAPI.Controllers.SendNotificationRequest) on controller NayifatAPI.Controllers.NotificationsController (NayifatAPI).
2025-02-05 08:25:02.466 +03:00 [INF] Executed DbCommand (4ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 08:25:02.474 +03:00 [INF] Received notification request: {"Title":null,"TitleEn":"Test Notification English    9999","TitleAr":"اختبار الإشعار  9999","Filters":{"Customers.national_id":{"ValueKind":"Object","$type":"JsonElement"}},"NationalId":null,"NationalIds":null}
2025-02-05 08:25:02.480 +03:00 [INF] Starting GetTargetUsers with request type: Filtered Users
2025-02-05 08:25:02.481 +03:00 [INF] Special case: Using 'all' as target without fetching IDs
2025-02-05 08:25:02.482 +03:00 [INF] Target users query completed. Found 1 users
2025-02-05 08:25:02.484 +03:00 [INF] Processing notification for all users
2025-02-05 08:25:02.496 +03:00 [INF] Executed DbCommand (8ms) [Parameters=[@p0='?' (Size = 4000), @p1='?' (Size = 8000) (DbType = AnsiString), @p2='?' (Size = 4000), @p3='?' (Size = 8000) (DbType = AnsiString), @p4='?' (DbType = DateTime2), @p5='?' (DbType = DateTime2), @p6='?' (Size = 255), @p7='?' (Size = 4000), @p8='?' (Size = 255), @p9='?' (Size = 255), @p10='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [notification_templates] ([additional_data], [Body], [body_ar], [body_en], [created_at], [expiry_at], [Route], [target_criteria], [Title], [title_ar], [title_en])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10);
2025-02-05 08:25:02.501 +03:00 [INF] Created notification template with ID: 17
2025-02-05 08:25:02.509 +03:00 [INF] Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[NationalId], [c].[AddNo], [c].[BuildingNo], [c].[City], [c].[Consent], [c].[ConsentDate], [c].[DateOfBirth], [c].[Dependents], [c].[District], [c].[Email], [c].[Employer], [c].[FamilyNameAr], [c].[FamilyNameEn], [c].[FirstNameAr], [c].[FirstNameEn], [c].[Iban], [c].[IdExpiryDate], [c].[Los], [c].[Mpin], [c].[MpinEnabled], [c].[NafathStatus], [c].[NafathTimestamp], [c].[Password], [c].[Phone], [c].[RegistrationDate], [c].[SalaryCustomer], [c].[SalaryDakhli], [c].[SecondNameAr], [c].[SecondNameEn], [c].[Sector], [c].[Street], [c].[ThirdNameAr], [c].[ThirdNameEn], [c].[Zipcode]
FROM [Customers] AS [c]
2025-02-05 08:25:02.521 +03:00 [INF] Executed DbCommand (8ms) [Parameters=[@p0='?' (Size = 4000), @p1='?' (DbType = DateTime2), @p2='?' (Size = 4000), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (Size = 450), @p6='?' (Size = 4000), @p7='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [AuthLogs] ([AuthType], [CreatedAt], [DeviceId], [FailureReason], [IpAddress], [NationalId], [Status], [UserAgent])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7);
2025-02-05 08:25:02.525 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 08:25:02.527 +03:00 [INF] Executed action NayifatAPI.Controllers.NotificationsController.SendNotification (NayifatAPI) in 105.3963ms
2025-02-05 08:25:02.528 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.NotificationsController.SendNotification (NayifatAPI)'
2025-02-05 08:25:02.530 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/send - 200 null application/json; charset=utf-8 119.3349ms
2025-02-05 08:25:57.837 +03:00 [INF] Application is shutting down...
2025-02-05 08:27:08.968 +03:00 [INF] Starting web application
2025-02-05 08:27:09.068 +03:00 [INF] Now listening on: http://localhost:5264
2025-02-05 08:27:09.072 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2025-02-05 08:27:09.073 +03:00 [INF] Hosting environment: Development
2025-02-05 08:27:09.074 +03:00 [INF] Content root path: C:\Users\yamta\StudioProjects\nayifat_app_2025_new\nayifatapi
2025-02-05 08:27:14.664 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/send - application/json 544
2025-02-05 08:27:14.708 +03:00 [WRN] Failed to determine the https port for redirect.
2025-02-05 08:27:14.713 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.NotificationsController.SendNotification (NayifatAPI)'
2025-02-05 08:27:14.745 +03:00 [INF] Route matched with {action = "SendNotification", controller = "Notifications"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] SendNotification(NayifatAPI.Controllers.SendNotificationRequest) on controller NayifatAPI.Controllers.NotificationsController (NayifatAPI).
2025-02-05 08:27:16.180 +03:00 [INF] Executed DbCommand (27ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 08:27:16.276 +03:00 [INF] Received notification request: {"Title":null,"TitleEn":"Test Notification English    9999","TitleAr":"اختبار الإشعار  9999","Filters":{"Customers.national_id":{"ValueKind":"Object","$type":"JsonElement"}},"NationalId":null,"NationalIds":null}
2025-02-05 08:27:16.291 +03:00 [INF] Starting GetTargetUsers with request type: Filtered Users
2025-02-05 08:27:16.296 +03:00 [INF] Special case: Using 'all' as target without fetching IDs
2025-02-05 08:27:16.297 +03:00 [INF] Target users query completed. Found 1 users
2025-02-05 08:27:16.298 +03:00 [INF] Processing notification for all users
2025-02-05 08:27:16.550 +03:00 [INF] Executed DbCommand (86ms) [Parameters=[@p0='?' (Size = 4000), @p1='?' (Size = 8000) (DbType = AnsiString), @p2='?' (Size = 4000), @p3='?' (Size = 8000) (DbType = AnsiString), @p4='?' (DbType = DateTime2), @p5='?' (DbType = DateTime2), @p6='?' (Size = 255), @p7='?' (Size = 4000), @p8='?' (Size = 255), @p9='?' (Size = 255), @p10='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [notification_templates] ([additional_data], [Body], [body_ar], [body_en], [created_at], [expiry_at], [Route], [target_criteria], [Title], [title_ar], [title_en])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10);
2025-02-05 08:27:16.635 +03:00 [INF] Created notification template with ID: 18
2025-02-05 08:27:16.649 +03:00 [WRN] The query uses the 'First'/'FirstOrDefault' operator without 'OrderBy' and filter operators. This may lead to unpredictable results.
2025-02-05 08:27:16.771 +03:00 [INF] Executed DbCommand (76ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[NationalId], [c].[AddNo], [c].[BuildingNo], [c].[City], [c].[Consent], [c].[ConsentDate], [c].[DateOfBirth], [c].[Dependents], [c].[District], [c].[Email], [c].[Employer], [c].[FamilyNameAr], [c].[FamilyNameEn], [c].[FirstNameAr], [c].[FirstNameEn], [c].[Iban], [c].[IdExpiryDate], [c].[Los], [c].[Mpin], [c].[MpinEnabled], [c].[NafathStatus], [c].[NafathTimestamp], [c].[Password], [c].[Phone], [c].[RegistrationDate], [c].[SalaryCustomer], [c].[SalaryDakhli], [c].[SecondNameAr], [c].[SecondNameEn], [c].[Sector], [c].[Street], [c].[ThirdNameAr], [c].[ThirdNameEn], [c].[Zipcode]
FROM [Customers] AS [c]
2025-02-05 08:27:17.182 +03:00 [INF] Executed DbCommand (59ms) [Parameters=[@p0='?' (Size = 4000), @p1='?' (DbType = DateTime2), @p2='?' (Size = 4000), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (Size = 450), @p6='?' (Size = 4000), @p7='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [AuthLogs] ([AuthType], [CreatedAt], [DeviceId], [FailureReason], [IpAddress], [NationalId], [Status], [UserAgent])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7);
2025-02-05 08:27:17.244 +03:00 [INF] Executed DbCommand (31ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[national_id], [u].[last_updated], [u].[notifications]
FROM [user_notifications] AS [u]
WHERE [u].[national_id] = N'all'
2025-02-05 08:27:17.426 +03:00 [INF] Executed DbCommand (55ms) [Parameters=[@p0='?' (Size = 4000), @p1='?' (DbType = DateTime2), @p2='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
UPDATE user_notifications SET notifications = @p0, last_updated = @p1 WHERE national_id = @p2
2025-02-05 08:27:17.712 +03:00 [INF] Updated existing UserNotification for all users
2025-02-05 08:27:17.724 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 08:27:18.160 +03:00 [INF] Executed action NayifatAPI.Controllers.NotificationsController.SendNotification (NayifatAPI) in 3407.1564ms
2025-02-05 08:27:18.296 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.NotificationsController.SendNotification (NayifatAPI)'
2025-02-05 08:27:18.483 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/send - 200 null application/json; charset=utf-8 3818.4897ms
2025-02-05 08:28:05.348 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/send - application/json 551
2025-02-05 08:28:05.355 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.NotificationsController.SendNotification (NayifatAPI)'
2025-02-05 08:28:05.357 +03:00 [INF] Route matched with {action = "SendNotification", controller = "Notifications"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] SendNotification(NayifatAPI.Controllers.SendNotificationRequest) on controller NayifatAPI.Controllers.NotificationsController (NayifatAPI).
2025-02-05 08:28:05.404 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 08:28:05.413 +03:00 [INF] Received notification request: {"Title":null,"TitleEn":"Test Notification English    9999","TitleAr":"اختبار الإشعار  9999","Filters":{"Customers.national_id":{"ValueKind":"Object","$type":"JsonElement"}},"NationalId":null,"NationalIds":null}
2025-02-05 08:28:05.418 +03:00 [INF] Starting GetTargetUsers with request type: Filtered Users
2025-02-05 08:28:05.421 +03:00 [INF] Processing filter for table: customers, field: national_id
2025-02-05 08:28:05.424 +03:00 [INF] Processing filter: national_id = 1064448614
2025-02-05 08:28:05.432 +03:00 [INF] Applied national_id numeric filter: = 1064448614
2025-02-05 08:28:05.435 +03:00 [INF] Added filter group for customers.national_id
2025-02-05 08:28:05.437 +03:00 [INF] Executing filter query with operation: AND
2025-02-05 08:28:05.478 +03:00 [ERR] Error in SendNotification
System.InvalidOperationException: Translation of 'EF.Property<decimal>(StructuralTypeShaperExpression: 
    NayifatAPI.Models.Customer
    ValueBufferExpression: 
        ProjectionBindingExpression: EmptyProjectionMember
    IsNullable: False
, "national_id")' failed. Either the query source is not an entity type, or the specified property does not exist on the entity type.
   at Microsoft.EntityFrameworkCore.Query.RelationalSqlTranslatingExpressionVisitor.VisitMethodCall(MethodCallExpression methodCallExpression)
   at Microsoft.EntityFrameworkCore.SqlServer.Query.Internal.SqlServerSqlTranslatingExpressionVisitor.VisitMethodCall(MethodCallExpression methodCallExpression)
   at Microsoft.EntityFrameworkCore.Query.RelationalSqlTranslatingExpressionVisitor.VisitBinary(BinaryExpression binaryExpression)
   at Microsoft.EntityFrameworkCore.SqlServer.Query.Internal.SqlServerSqlTranslatingExpressionVisitor.VisitBinary(BinaryExpression binaryExpression)
   at Microsoft.EntityFrameworkCore.Query.RelationalSqlTranslatingExpressionVisitor.TranslateInternal(Expression expression, Boolean applyDefaultTypeMapping)
   at Microsoft.EntityFrameworkCore.Query.RelationalSqlTranslatingExpressionVisitor.Translate(Expression expression, Boolean applyDefaultTypeMapping)
   at Microsoft.EntityFrameworkCore.Query.RelationalQueryableMethodTranslatingExpressionVisitor.TranslateExpression(Expression expression, Boolean applyDefaultTypeMapping)
   at Microsoft.EntityFrameworkCore.Query.RelationalQueryableMethodTranslatingExpressionVisitor.TranslateLambdaExpression(ShapedQueryExpression shapedQueryExpression, LambdaExpression lambdaExpression)
   at Microsoft.EntityFrameworkCore.Query.RelationalQueryableMethodTranslatingExpressionVisitor.TranslateWhere(ShapedQueryExpression source, LambdaExpression predicate)
   at Microsoft.EntityFrameworkCore.Query.QueryableMethodTranslatingExpressionVisitor.VisitMethodCall(MethodCallExpression methodCallExpression)
   at Microsoft.EntityFrameworkCore.Query.RelationalQueryableMethodTranslatingExpressionVisitor.VisitMethodCall(MethodCallExpression methodCallExpression)
   at Microsoft.EntityFrameworkCore.Query.QueryableMethodTranslatingExpressionVisitor.VisitMethodCall(MethodCallExpression methodCallExpression)
   at Microsoft.EntityFrameworkCore.Query.RelationalQueryableMethodTranslatingExpressionVisitor.VisitMethodCall(MethodCallExpression methodCallExpression)
   at Microsoft.EntityFrameworkCore.Query.QueryableMethodTranslatingExpressionVisitor.Translate(Expression expression)
   at Microsoft.EntityFrameworkCore.Query.RelationalQueryableMethodTranslatingExpressionVisitor.Translate(Expression expression)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutor[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Storage.Database.CompileQuery[TResult](Expression query, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.CompileQueryCore[TResult](IDatabase database, Expression query, IModel model, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.<>c__DisplayClass12_0`1.<ExecuteAsync>b__0()
   at Microsoft.EntityFrameworkCore.Query.Internal.CompiledQueryCache.GetOrAddQuery[TResult](Object cacheKey, Func`1 compiler)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteAsync[TResult](Expression query, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryProvider.ExecuteAsync[TResult](Expression expression, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryable`1.GetAsyncEnumerator(CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.ConfiguredCancelableAsyncEnumerable`1.GetAsyncEnumerator()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at NayifatAPI.Controllers.NotificationsController.GetTargetUsers(SendNotificationRequest request) in C:\Users\yamta\StudioProjects\nayifat_app_2025_new\nayifatapi\Controllers\NotificationsController.cs:line 954
   at NayifatAPI.Controllers.NotificationsController.SendNotification(SendNotificationRequest request) in C:\Users\yamta\StudioProjects\nayifat_app_2025_new\nayifatapi\Controllers\NotificationsController.cs:line 203
2025-02-05 08:28:05.532 +03:00 [INF] Executing ObjectResult, writing value of type '<>f__AnonymousType12`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 08:28:05.543 +03:00 [INF] Executed action NayifatAPI.Controllers.NotificationsController.SendNotification (NayifatAPI) in 183.9611ms
2025-02-05 08:28:05.547 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.NotificationsController.SendNotification (NayifatAPI)'
2025-02-05 08:28:05.550 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/send - 500 null application/json; charset=utf-8 201.8909ms
2025-02-05 08:28:28.838 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/send - application/json 551
2025-02-05 08:28:28.843 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.NotificationsController.SendNotification (NayifatAPI)'
2025-02-05 08:28:28.845 +03:00 [INF] Route matched with {action = "SendNotification", controller = "Notifications"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] SendNotification(NayifatAPI.Controllers.SendNotificationRequest) on controller NayifatAPI.Controllers.NotificationsController (NayifatAPI).
2025-02-05 08:28:28.960 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 08:28:28.962 +03:00 [INF] Received notification request: {"Title":null,"TitleEn":"Test Notification English    9999","TitleAr":"اختبار الإشعار  9999","Filters":{"Customers.national_id":{"ValueKind":"Object","$type":"JsonElement"}},"NationalId":null,"NationalIds":null}
2025-02-05 08:28:28.969 +03:00 [INF] Starting GetTargetUsers with request type: Filtered Users
2025-02-05 08:28:28.970 +03:00 [INF] Processing filter for table: customers, field: national_id
2025-02-05 08:28:28.971 +03:00 [INF] Processing filter: national_id = 1064448614
2025-02-05 08:28:28.972 +03:00 [INF] Applied national_id numeric filter: = 1064448614
2025-02-05 08:28:28.973 +03:00 [INF] Added filter group for customers.national_id
2025-02-05 08:28:28.974 +03:00 [INF] Executing filter query with operation: AND
2025-02-05 08:28:28.976 +03:00 [ERR] Error in SendNotification
System.InvalidOperationException: Translation of 'EF.Property<decimal>(StructuralTypeShaperExpression: 
    NayifatAPI.Models.Customer
    ValueBufferExpression: 
        ProjectionBindingExpression: EmptyProjectionMember
    IsNullable: False
, "national_id")' failed. Either the query source is not an entity type, or the specified property does not exist on the entity type.
   at Microsoft.EntityFrameworkCore.Query.RelationalSqlTranslatingExpressionVisitor.VisitMethodCall(MethodCallExpression methodCallExpression)
   at Microsoft.EntityFrameworkCore.SqlServer.Query.Internal.SqlServerSqlTranslatingExpressionVisitor.VisitMethodCall(MethodCallExpression methodCallExpression)
   at Microsoft.EntityFrameworkCore.Query.RelationalSqlTranslatingExpressionVisitor.VisitBinary(BinaryExpression binaryExpression)
   at Microsoft.EntityFrameworkCore.SqlServer.Query.Internal.SqlServerSqlTranslatingExpressionVisitor.VisitBinary(BinaryExpression binaryExpression)
   at Microsoft.EntityFrameworkCore.Query.RelationalSqlTranslatingExpressionVisitor.TranslateInternal(Expression expression, Boolean applyDefaultTypeMapping)
   at Microsoft.EntityFrameworkCore.Query.RelationalSqlTranslatingExpressionVisitor.Translate(Expression expression, Boolean applyDefaultTypeMapping)
   at Microsoft.EntityFrameworkCore.Query.RelationalQueryableMethodTranslatingExpressionVisitor.TranslateExpression(Expression expression, Boolean applyDefaultTypeMapping)
   at Microsoft.EntityFrameworkCore.Query.RelationalQueryableMethodTranslatingExpressionVisitor.TranslateLambdaExpression(ShapedQueryExpression shapedQueryExpression, LambdaExpression lambdaExpression)
   at Microsoft.EntityFrameworkCore.Query.RelationalQueryableMethodTranslatingExpressionVisitor.TranslateWhere(ShapedQueryExpression source, LambdaExpression predicate)
   at Microsoft.EntityFrameworkCore.Query.QueryableMethodTranslatingExpressionVisitor.VisitMethodCall(MethodCallExpression methodCallExpression)
   at Microsoft.EntityFrameworkCore.Query.RelationalQueryableMethodTranslatingExpressionVisitor.VisitMethodCall(MethodCallExpression methodCallExpression)
   at Microsoft.EntityFrameworkCore.Query.QueryableMethodTranslatingExpressionVisitor.VisitMethodCall(MethodCallExpression methodCallExpression)
   at Microsoft.EntityFrameworkCore.Query.RelationalQueryableMethodTranslatingExpressionVisitor.VisitMethodCall(MethodCallExpression methodCallExpression)
   at Microsoft.EntityFrameworkCore.Query.QueryableMethodTranslatingExpressionVisitor.Translate(Expression expression)
   at Microsoft.EntityFrameworkCore.Query.RelationalQueryableMethodTranslatingExpressionVisitor.Translate(Expression expression)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutor[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Storage.Database.CompileQuery[TResult](Expression query, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.CompileQueryCore[TResult](IDatabase database, Expression query, IModel model, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.<>c__DisplayClass12_0`1.<ExecuteAsync>b__0()
   at Microsoft.EntityFrameworkCore.Query.Internal.CompiledQueryCache.GetOrAddQuery[TResult](Object cacheKey, Func`1 compiler)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteAsync[TResult](Expression query, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryProvider.ExecuteAsync[TResult](Expression expression, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryable`1.GetAsyncEnumerator(CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.ConfiguredCancelableAsyncEnumerable`1.GetAsyncEnumerator()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at NayifatAPI.Controllers.NotificationsController.GetTargetUsers(SendNotificationRequest request) in C:\Users\yamta\StudioProjects\nayifat_app_2025_new\nayifatapi\Controllers\NotificationsController.cs:line 954
   at NayifatAPI.Controllers.NotificationsController.SendNotification(SendNotificationRequest request) in C:\Users\yamta\StudioProjects\nayifat_app_2025_new\nayifatapi\Controllers\NotificationsController.cs:line 203
2025-02-05 08:28:28.987 +03:00 [INF] Executing ObjectResult, writing value of type '<>f__AnonymousType12`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 08:28:28.988 +03:00 [INF] Executed action NayifatAPI.Controllers.NotificationsController.SendNotification (NayifatAPI) in 139.7266ms
2025-02-05 08:28:28.990 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.NotificationsController.SendNotification (NayifatAPI)'
2025-02-05 08:28:28.992 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/send - 500 null application/json; charset=utf-8 153.5703ms
2025-02-05 08:31:28.048 +03:00 [INF] Application is shutting down...
2025-02-05 08:31:38.566 +03:00 [INF] Starting web application
2025-02-05 08:31:38.688 +03:00 [INF] Now listening on: http://localhost:5264
2025-02-05 08:31:38.693 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2025-02-05 08:31:38.694 +03:00 [INF] Hosting environment: Development
2025-02-05 08:31:38.695 +03:00 [INF] Content root path: C:\Users\yamta\StudioProjects\nayifat_app_2025_new\nayifatapi
2025-02-05 08:31:45.078 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/send - application/json 551
2025-02-05 08:31:45.276 +03:00 [WRN] Failed to determine the https port for redirect.
2025-02-05 08:31:45.444 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.NotificationsController.SendNotification (NayifatAPI)'
2025-02-05 08:31:45.517 +03:00 [INF] Route matched with {action = "SendNotification", controller = "Notifications"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] SendNotification(NayifatAPI.Controllers.SendNotificationRequest) on controller NayifatAPI.Controllers.NotificationsController (NayifatAPI).
2025-02-05 08:31:47.328 +03:00 [INF] Executed DbCommand (33ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 08:31:47.420 +03:00 [INF] Received notification request: {"Title":null,"TitleEn":"Test Notification English    9999","TitleAr":"اختبار الإشعار  9999","Filters":{"Customers.national_id":{"ValueKind":"Object","$type":"JsonElement"}},"NationalId":null,"NationalIds":null}
2025-02-05 08:31:47.434 +03:00 [INF] Starting GetTargetUsers with request type: Filtered Users
2025-02-05 08:31:47.443 +03:00 [INF] Processing filter for table: customers, field: national_id
2025-02-05 08:31:47.444 +03:00 [INF] Processing filter: national_id = 1064448614
2025-02-05 08:31:47.457 +03:00 [INF] Applied national_id numeric filter: = 1064448614
2025-02-05 08:31:47.463 +03:00 [INF] Added filter group for customers.national_id
2025-02-05 08:31:47.466 +03:00 [INF] Executing filter query with operation: AND
2025-02-05 08:31:47.527 +03:00 [ERR] Error in SendNotification
System.InvalidOperationException: Translation of 'EF.Property<decimal>(StructuralTypeShaperExpression: 
    NayifatAPI.Models.Customer
    ValueBufferExpression: 
        ProjectionBindingExpression: EmptyProjectionMember
    IsNullable: False
, "national_id")' failed. Either the query source is not an entity type, or the specified property does not exist on the entity type.
   at Microsoft.EntityFrameworkCore.Query.RelationalSqlTranslatingExpressionVisitor.VisitMethodCall(MethodCallExpression methodCallExpression)
   at Microsoft.EntityFrameworkCore.SqlServer.Query.Internal.SqlServerSqlTranslatingExpressionVisitor.VisitMethodCall(MethodCallExpression methodCallExpression)
   at Microsoft.EntityFrameworkCore.Query.RelationalSqlTranslatingExpressionVisitor.VisitBinary(BinaryExpression binaryExpression)
   at Microsoft.EntityFrameworkCore.SqlServer.Query.Internal.SqlServerSqlTranslatingExpressionVisitor.VisitBinary(BinaryExpression binaryExpression)
   at Microsoft.EntityFrameworkCore.Query.RelationalSqlTranslatingExpressionVisitor.TranslateInternal(Expression expression, Boolean applyDefaultTypeMapping)
   at Microsoft.EntityFrameworkCore.Query.RelationalSqlTranslatingExpressionVisitor.Translate(Expression expression, Boolean applyDefaultTypeMapping)
   at Microsoft.EntityFrameworkCore.Query.RelationalQueryableMethodTranslatingExpressionVisitor.TranslateExpression(Expression expression, Boolean applyDefaultTypeMapping)
   at Microsoft.EntityFrameworkCore.Query.RelationalQueryableMethodTranslatingExpressionVisitor.TranslateLambdaExpression(ShapedQueryExpression shapedQueryExpression, LambdaExpression lambdaExpression)
   at Microsoft.EntityFrameworkCore.Query.RelationalQueryableMethodTranslatingExpressionVisitor.TranslateWhere(ShapedQueryExpression source, LambdaExpression predicate)
   at Microsoft.EntityFrameworkCore.Query.QueryableMethodTranslatingExpressionVisitor.VisitMethodCall(MethodCallExpression methodCallExpression)
   at Microsoft.EntityFrameworkCore.Query.RelationalQueryableMethodTranslatingExpressionVisitor.VisitMethodCall(MethodCallExpression methodCallExpression)
   at Microsoft.EntityFrameworkCore.Query.QueryableMethodTranslatingExpressionVisitor.VisitMethodCall(MethodCallExpression methodCallExpression)
   at Microsoft.EntityFrameworkCore.Query.RelationalQueryableMethodTranslatingExpressionVisitor.VisitMethodCall(MethodCallExpression methodCallExpression)
   at Microsoft.EntityFrameworkCore.Query.QueryableMethodTranslatingExpressionVisitor.Translate(Expression expression)
   at Microsoft.EntityFrameworkCore.Query.RelationalQueryableMethodTranslatingExpressionVisitor.Translate(Expression expression)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutor[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Storage.Database.CompileQuery[TResult](Expression query, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.CompileQueryCore[TResult](IDatabase database, Expression query, IModel model, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.<>c__DisplayClass12_0`1.<ExecuteAsync>b__0()
   at Microsoft.EntityFrameworkCore.Query.Internal.CompiledQueryCache.GetOrAddQuery[TResult](Object cacheKey, Func`1 compiler)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteAsync[TResult](Expression query, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryProvider.ExecuteAsync[TResult](Expression expression, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryable`1.GetAsyncEnumerator(CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.ConfiguredCancelableAsyncEnumerable`1.GetAsyncEnumerator()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at NayifatAPI.Controllers.NotificationsController.GetTargetUsers(SendNotificationRequest request) in C:\Users\yamta\StudioProjects\nayifat_app_2025_new\nayifatapi\Controllers\NotificationsController.cs:line 997
   at NayifatAPI.Controllers.NotificationsController.SendNotification(SendNotificationRequest request) in C:\Users\yamta\StudioProjects\nayifat_app_2025_new\nayifatapi\Controllers\NotificationsController.cs:line 203
2025-02-05 08:31:47.600 +03:00 [INF] Executing ObjectResult, writing value of type '<>f__AnonymousType12`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 08:31:47.628 +03:00 [INF] Executed action NayifatAPI.Controllers.NotificationsController.SendNotification (NayifatAPI) in 1864.3219ms
2025-02-05 08:31:47.630 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.NotificationsController.SendNotification (NayifatAPI)'
2025-02-05 08:31:47.650 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/send - 500 null application/json; charset=utf-8 2585.5364ms
2025-02-05 08:32:05.210 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/send - application/json 544
2025-02-05 08:32:05.220 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.NotificationsController.SendNotification (NayifatAPI)'
2025-02-05 08:32:05.222 +03:00 [INF] Route matched with {action = "SendNotification", controller = "Notifications"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] SendNotification(NayifatAPI.Controllers.SendNotificationRequest) on controller NayifatAPI.Controllers.NotificationsController (NayifatAPI).
2025-02-05 08:32:05.268 +03:00 [INF] Executed DbCommand (4ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 08:32:05.274 +03:00 [INF] Received notification request: {"Title":null,"TitleEn":"Test Notification English    9999","TitleAr":"اختبار الإشعار  9999","Filters":{"Customers.national_id":{"ValueKind":"Object","$type":"JsonElement"}},"NationalId":null,"NationalIds":null}
2025-02-05 08:32:05.283 +03:00 [INF] Starting GetTargetUsers with request type: Filtered Users
2025-02-05 08:32:05.284 +03:00 [INF] Special case: Using 'all' as target without fetching IDs
2025-02-05 08:32:05.285 +03:00 [INF] Target users query completed. Found 1 users
2025-02-05 08:32:05.287 +03:00 [INF] Processing notification for all users
2025-02-05 08:32:05.672 +03:00 [INF] Executed DbCommand (99ms) [Parameters=[@p0='?' (Size = 4000), @p1='?' (Size = 8000) (DbType = AnsiString), @p2='?' (Size = 4000), @p3='?' (Size = 8000) (DbType = AnsiString), @p4='?' (DbType = DateTime2), @p5='?' (DbType = DateTime2), @p6='?' (Size = 255), @p7='?' (Size = 4000), @p8='?' (Size = 255), @p9='?' (Size = 255), @p10='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [notification_templates] ([additional_data], [Body], [body_ar], [body_en], [created_at], [expiry_at], [Route], [target_criteria], [Title], [title_ar], [title_en])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10);
2025-02-05 08:32:05.728 +03:00 [INF] Created notification template with ID: 19
2025-02-05 08:32:05.739 +03:00 [WRN] The query uses the 'First'/'FirstOrDefault' operator without 'OrderBy' and filter operators. This may lead to unpredictable results.
2025-02-05 08:32:05.784 +03:00 [INF] Executed DbCommand (15ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[NationalId], [c].[AddNo], [c].[BuildingNo], [c].[City], [c].[Consent], [c].[ConsentDate], [c].[DateOfBirth], [c].[Dependents], [c].[District], [c].[Email], [c].[Employer], [c].[FamilyNameAr], [c].[FamilyNameEn], [c].[FirstNameAr], [c].[FirstNameEn], [c].[Iban], [c].[IdExpiryDate], [c].[Los], [c].[Mpin], [c].[MpinEnabled], [c].[NafathStatus], [c].[NafathTimestamp], [c].[Password], [c].[Phone], [c].[RegistrationDate], [c].[SalaryCustomer], [c].[SalaryDakhli], [c].[SecondNameAr], [c].[SecondNameEn], [c].[Sector], [c].[Street], [c].[ThirdNameAr], [c].[ThirdNameEn], [c].[Zipcode]
FROM [Customers] AS [c]
2025-02-05 08:32:06.042 +03:00 [INF] Executed DbCommand (13ms) [Parameters=[@p0='?' (Size = 4000), @p1='?' (DbType = DateTime2), @p2='?' (Size = 4000), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (Size = 450), @p6='?' (Size = 4000), @p7='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [AuthLogs] ([AuthType], [CreatedAt], [DeviceId], [FailureReason], [IpAddress], [NationalId], [Status], [UserAgent])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7);
2025-02-05 08:32:06.065 +03:00 [INF] Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[national_id], [u].[last_updated], [u].[notifications]
FROM [user_notifications] AS [u]
WHERE [u].[national_id] = N'all'
2025-02-05 08:32:06.148 +03:00 [INF] Executed DbCommand (30ms) [Parameters=[@p0='?' (Size = 4000), @p1='?' (DbType = DateTime2), @p2='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
UPDATE user_notifications SET notifications = @p0, last_updated = @p1 WHERE national_id = @p2
2025-02-05 08:32:06.154 +03:00 [INF] Updated existing UserNotification for all users
2025-02-05 08:32:06.160 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 08:32:06.174 +03:00 [INF] Executed action NayifatAPI.Controllers.NotificationsController.SendNotification (NayifatAPI) in 949.7449ms
2025-02-05 08:32:06.181 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.NotificationsController.SendNotification (NayifatAPI)'
2025-02-05 08:32:06.189 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/send - 200 null application/json; charset=utf-8 977.9331ms
2025-02-05 08:33:04.642 +03:00 [INF] Application is shutting down...
2025-02-05 08:33:13.750 +03:00 [INF] Starting web application
2025-02-05 08:33:13.869 +03:00 [INF] Now listening on: http://localhost:5264
2025-02-05 08:33:13.874 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2025-02-05 08:33:13.875 +03:00 [INF] Hosting environment: Development
2025-02-05 08:33:13.876 +03:00 [INF] Content root path: C:\Users\yamta\StudioProjects\nayifat_app_2025_new\nayifatapi
2025-02-05 08:33:34.550 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/timestamps - application/json; charset=utf-8 2
2025-02-05 08:33:34.610 +03:00 [WRN] Failed to determine the https port for redirect.
2025-02-05 08:33:34.620 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.ContentController.GetTimestamps (NayifatAPI)'
2025-02-05 08:33:34.659 +03:00 [INF] Route matched with {action = "GetTimestamps", controller = "Content"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetTimestamps() on controller NayifatAPI.Controllers.ContentController (NayifatAPI).
2025-02-05 08:33:34.865 +03:00 [INF] TTT_
2025-02-05 08:33:34.867 +03:00 [INF] TTT_=== Getting Content Timestamps ===
2025-02-05 08:33:36.741 +03:00 [INF] Executed DbCommand (264ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 08:33:36.855 +03:00 [INF] TTT_Fetching timestamps from database
2025-02-05 08:33:36.915 +03:00 [INF] Executed DbCommand (23ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [m].[page] AS [Page], [m].[key_name] AS [KeyName], [m].[last_updated] AS [LastUpdated]
FROM [master_config] AS [m]
2025-02-05 08:33:36.929 +03:00 [INF] TTT_Found 18 content items
2025-02-05 08:33:36.933 +03:00 [INF] TTT_Page: home
2025-02-05 08:33:36.934 +03:00 [INF] TTT_  - slideshow_content: "2025-02-04T10:01:06.9430000"
2025-02-05 08:33:36.937 +03:00 [INF] TTT_  - slideshow_content_ar: "2025-02-04T10:01:06.9430000"
2025-02-05 08:33:36.938 +03:00 [INF] TTT_  - contact_details: "2025-02-04T10:01:06.9430000"
2025-02-05 08:33:36.939 +03:00 [INF] TTT_  - contact_details_ar: "2025-02-04T10:01:06.9430000"
2025-02-05 08:33:36.940 +03:00 [INF] TTT_  - termsEN1: "2025-02-03T14:23:58.0000000"
2025-02-05 08:33:36.942 +03:00 [INF] TTT_  - termsEN2: "2025-02-03T14:25:20.1730000"
2025-02-05 08:33:36.944 +03:00 [INF] TTT_  - privacyEN1: "2025-02-03T14:26:08.6130000"
2025-02-05 08:33:36.945 +03:00 [INF] TTT_  - privacyEN2: "2025-02-03T14:25:20.1730000"
2025-02-05 08:33:36.947 +03:00 [INF] TTT_  - termsAR1: "2025-02-03T14:23:58.0000000"
2025-02-05 08:33:36.948 +03:00 [INF] TTT_  - termsAR2: "2025-02-03T14:25:20.1730000"
2025-02-05 08:33:36.949 +03:00 [INF] TTT_  - privacyAR1: "2025-02-03T14:26:08.6130000"
2025-02-05 08:33:36.950 +03:00 [INF] TTT_  - privacyAR2: "2025-02-03T14:25:20.1730000"
2025-02-05 08:33:36.951 +03:00 [INF] TTT_  - terms&conditionsCC_AR: "2025-02-03T17:06:57.7700000"
2025-02-05 08:33:36.953 +03:00 [INF] TTT_  - terms&conditionsCC_EN: "2025-02-03T17:07:47.4900000"
2025-02-05 08:33:36.954 +03:00 [INF] TTT_  - terms&conditionsPF_AR: "2025-02-03T17:06:57.7700000"
2025-02-05 08:33:36.955 +03:00 [INF] TTT_  - terms&conditionsPF_EN: "2025-02-03T17:06:57.7700000"
2025-02-05 08:33:36.957 +03:00 [INF] TTT_Page: loans
2025-02-05 08:33:36.958 +03:00 [INF] TTT_  - loan_ad: "2025-02-04T10:01:06.9430000"
2025-02-05 08:33:36.959 +03:00 [INF] TTT_Page: cards
2025-02-05 08:33:36.960 +03:00 [INF] TTT_  - card_ad: "2025-02-04T10:01:06.9430000"
2025-02-05 08:33:36.961 +03:00 [INF] TTT_Successfully retrieved all timestamps
2025-02-05 08:33:36.971 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 08:33:37.033 +03:00 [INF] Executed action NayifatAPI.Controllers.ContentController.GetTimestamps (NayifatAPI) in 2360.5588ms
2025-02-05 08:33:37.039 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.ContentController.GetTimestamps (NayifatAPI)'
2025-02-05 08:33:37.056 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/timestamps - 200 null application/json; charset=utf-8 2508.2733ms
2025-02-05 08:33:37.499 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - application/json; charset=utf-8 45
2025-02-05 08:33:37.509 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 08:33:37.523 +03:00 [INF] Route matched with {action = "MasterFetch", controller = "Content"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] MasterFetch(NayifatAPI.Controllers.MasterFetchRequest) on controller NayifatAPI.Controllers.ContentController (NayifatAPI).
2025-02-05 08:33:37.593 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 08:33:37.615 +03:00 [INF] Executed DbCommand (10ms) [Parameters=[@__request_Page_0='?' (Size = 450), @__request_KeyName_1='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[config_id], [m].[key_name], [m].[last_updated], [m].[page], [m].[value]
FROM [master_config] AS [m]
WHERE [m].[page] = @__request_Page_0 AND [m].[key_name] = @__request_KeyName_1
2025-02-05 08:33:37.660 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 08:33:37.666 +03:00 [INF] Executed action NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI) in 139.137ms
2025-02-05 08:33:37.668 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 08:33:37.671 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - 200 null application/json; charset=utf-8 171.0515ms
2025-02-05 08:33:45.963 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/send - application/json 544
2025-02-05 08:33:45.968 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.NotificationsController.SendNotification (NayifatAPI)'
2025-02-05 08:33:45.973 +03:00 [INF] Route matched with {action = "SendNotification", controller = "Notifications"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] SendNotification(NayifatAPI.Controllers.SendNotificationRequest) on controller NayifatAPI.Controllers.NotificationsController (NayifatAPI).
2025-02-05 08:33:46.187 +03:00 [INF] Executed DbCommand (6ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 08:33:46.204 +03:00 [INF] Received notification request: {"Title":null,"TitleEn":"Test Notification English    9999","TitleAr":"اختبار الإشعار  9999","Filters":{"Customers.national_id":{"ValueKind":"Object","$type":"JsonElement"}},"NationalId":null,"NationalIds":null}
2025-02-05 08:33:46.238 +03:00 [INF] Starting GetTargetUsers with request type: Filtered Users
2025-02-05 08:33:46.244 +03:00 [INF] Special case: Using 'all' as target without fetching IDs
2025-02-05 08:33:46.245 +03:00 [INF] Target users query completed. Found 1 users
2025-02-05 08:33:46.247 +03:00 [INF] Processing notification for all users
2025-02-05 08:33:46.521 +03:00 [INF] Executed DbCommand (11ms) [Parameters=[@p0='?' (Size = 4000), @p1='?' (Size = 8000) (DbType = AnsiString), @p2='?' (Size = 4000), @p3='?' (Size = 8000) (DbType = AnsiString), @p4='?' (DbType = DateTime2), @p5='?' (DbType = DateTime2), @p6='?' (Size = 255), @p7='?' (Size = 4000), @p8='?' (Size = 255), @p9='?' (Size = 255), @p10='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [notification_templates] ([additional_data], [Body], [body_ar], [body_en], [created_at], [expiry_at], [Route], [target_criteria], [Title], [title_ar], [title_en])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10);
2025-02-05 08:33:46.580 +03:00 [INF] Created notification template with ID: 20
2025-02-05 08:33:46.585 +03:00 [WRN] The query uses the 'First'/'FirstOrDefault' operator without 'OrderBy' and filter operators. This may lead to unpredictable results.
2025-02-05 08:33:46.614 +03:00 [INF] Executed DbCommand (11ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[NationalId], [c].[AddNo], [c].[BuildingNo], [c].[City], [c].[Consent], [c].[ConsentDate], [c].[DateOfBirth], [c].[Dependents], [c].[District], [c].[Email], [c].[Employer], [c].[FamilyNameAr], [c].[FamilyNameEn], [c].[FirstNameAr], [c].[FirstNameEn], [c].[Iban], [c].[IdExpiryDate], [c].[Los], [c].[Mpin], [c].[MpinEnabled], [c].[NafathStatus], [c].[NafathTimestamp], [c].[Password], [c].[Phone], [c].[RegistrationDate], [c].[SalaryCustomer], [c].[SalaryDakhli], [c].[SecondNameAr], [c].[SecondNameEn], [c].[Sector], [c].[Street], [c].[ThirdNameAr], [c].[ThirdNameEn], [c].[Zipcode]
FROM [Customers] AS [c]
2025-02-05 08:33:46.905 +03:00 [INF] Executed DbCommand (11ms) [Parameters=[@p0='?' (Size = 4000), @p1='?' (DbType = DateTime2), @p2='?' (Size = 4000), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (Size = 450), @p6='?' (Size = 4000), @p7='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [AuthLogs] ([AuthType], [CreatedAt], [DeviceId], [FailureReason], [IpAddress], [NationalId], [Status], [UserAgent])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7);
2025-02-05 08:33:46.935 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[national_id], [u].[last_updated], [u].[notifications]
FROM [user_notifications] AS [u]
WHERE [u].[national_id] = N'all'
2025-02-05 08:33:47.012 +03:00 [INF] Executed DbCommand (27ms) [Parameters=[@p0='?' (Size = 4000), @p1='?' (DbType = DateTime2), @p2='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
UPDATE user_notifications SET notifications = @p0, last_updated = @p1 WHERE national_id = @p2
2025-02-05 08:33:47.016 +03:00 [INF] Updated existing UserNotification for all users
2025-02-05 08:33:47.019 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 08:33:47.027 +03:00 [INF] Executed action NayifatAPI.Controllers.NotificationsController.SendNotification (NayifatAPI) in 1051.6495ms
2025-02-05 08:33:47.030 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.NotificationsController.SendNotification (NayifatAPI)'
2025-02-05 08:33:47.031 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/send - 200 null application/json; charset=utf-8 1068.1337ms
2025-02-05 08:33:48.799 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - application/json; charset=utf-8 48
2025-02-05 08:33:48.803 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 08:33:48.804 +03:00 [INF] Route matched with {action = "MasterFetch", controller = "Content"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] MasterFetch(NayifatAPI.Controllers.MasterFetchRequest) on controller NayifatAPI.Controllers.ContentController (NayifatAPI).
2025-02-05 08:33:48.810 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 08:33:48.816 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[@__request_Page_0='?' (Size = 450), @__request_KeyName_1='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[config_id], [m].[key_name], [m].[last_updated], [m].[page], [m].[value]
FROM [master_config] AS [m]
WHERE [m].[page] = @__request_Page_0 AND [m].[key_name] = @__request_KeyName_1
2025-02-05 08:33:48.821 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 08:33:48.823 +03:00 [INF] Executed action NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI) in 15.4345ms
2025-02-05 08:33:48.825 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 08:33:48.826 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - 200 null application/json; charset=utf-8 26.1969ms
2025-02-05 08:33:54.264 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/send - application/json 551
2025-02-05 08:33:54.268 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.NotificationsController.SendNotification (NayifatAPI)'
2025-02-05 08:33:54.269 +03:00 [INF] Route matched with {action = "SendNotification", controller = "Notifications"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] SendNotification(NayifatAPI.Controllers.SendNotificationRequest) on controller NayifatAPI.Controllers.NotificationsController (NayifatAPI).
2025-02-05 08:33:54.274 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 08:33:54.278 +03:00 [INF] Received notification request: {"Title":null,"TitleEn":"Test Notification English    9999","TitleAr":"اختبار الإشعار  9999","Filters":{"Customers.national_id":{"ValueKind":"Object","$type":"JsonElement"}},"NationalId":null,"NationalIds":null}
2025-02-05 08:33:54.284 +03:00 [INF] Starting GetTargetUsers with request type: Filtered Users
2025-02-05 08:33:54.286 +03:00 [INF] Processing filter for table: customers, field: national_id
2025-02-05 08:33:54.287 +03:00 [INF] Processing filter: national_id = 1064448614
2025-02-05 08:33:54.288 +03:00 [INF] Applied national_id filter: = 1064448614
2025-02-05 08:33:54.289 +03:00 [INF] Added filter group for customers.national_id
2025-02-05 08:33:54.291 +03:00 [INF] Executing filter query with operation: AND
2025-02-05 08:33:54.308 +03:00 [INF] Executed DbCommand (7ms) [Parameters=[@__val_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[NationalId]
FROM [Customers] AS [c]
WHERE [c].[NationalId] = @__val_0
2025-02-05 08:33:54.310 +03:00 [INF] Found 1 users after applying filters
2025-02-05 08:33:54.311 +03:00 [INF] Target users query completed. Found 1 users
2025-02-05 08:33:54.313 +03:00 [INF] Found 1 target users for notification
2025-02-05 08:33:54.324 +03:00 [INF] Executed DbCommand (6ms) [Parameters=[@p0='?' (Size = 4000), @p1='?' (Size = 8000) (DbType = AnsiString), @p2='?' (Size = 4000), @p3='?' (Size = 8000) (DbType = AnsiString), @p4='?' (DbType = DateTime2), @p5='?' (DbType = DateTime2), @p6='?' (Size = 255), @p7='?' (Size = 4000), @p8='?' (Size = 255), @p9='?' (Size = 255), @p10='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [notification_templates] ([additional_data], [Body], [body_ar], [body_en], [created_at], [expiry_at], [Route], [target_criteria], [Title], [title_ar], [title_en])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10);
2025-02-05 08:33:54.327 +03:00 [INF] Created notification template with ID: 21
2025-02-05 08:33:54.334 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__userId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[national_id], [u].[last_updated], [u].[notifications]
FROM [user_notifications] AS [u]
WHERE [u].[national_id] = @__userId_0
2025-02-05 08:33:54.336 +03:00 [INF] Processing notification for user 1064448614. Existing notification record: true
2025-02-05 08:33:54.339 +03:00 [INF] Current notifications count for user 1064448614: 8
2025-02-05 08:33:54.343 +03:00 [INF] Serialized new notifications for user 1064448614. Length: 1397
2025-02-05 08:33:54.362 +03:00 [INF] Executed DbCommand (15ms) [Parameters=[@p0='?' (Size = 4000), @p1='?' (DbType = DateTime2), @p2='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
UPDATE user_notifications SET notifications = @p0, last_updated = @p1 WHERE national_id = @p2
2025-02-05 08:33:54.364 +03:00 [INF] Updated existing UserNotification for user: 1064448614
2025-02-05 08:33:54.370 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@p0='?' (Size = 4000), @p1='?' (DbType = DateTime2), @p2='?' (Size = 4000), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (Size = 450), @p6='?' (Size = 4000), @p7='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [AuthLogs] ([AuthType], [CreatedAt], [DeviceId], [FailureReason], [IpAddress], [NationalId], [Status], [UserAgent])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7);
2025-02-05 08:33:54.375 +03:00 [INF] Successfully sent notifications. Template: 21, Success: 1, Total: 1
2025-02-05 08:33:54.376 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 08:33:54.381 +03:00 [INF] Executed action NayifatAPI.Controllers.NotificationsController.SendNotification (NayifatAPI) in 110.4799ms
2025-02-05 08:33:54.383 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.NotificationsController.SendNotification (NayifatAPI)'
2025-02-05 08:33:54.385 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/send - 200 null application/json; charset=utf-8 121.314ms
2025-02-05 08:33:57.219 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - application/json; charset=utf-8 43
2025-02-05 08:33:57.264 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 08:33:57.267 +03:00 [INF] Route matched with {action = "MasterFetch", controller = "Content"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] MasterFetch(NayifatAPI.Controllers.MasterFetchRequest) on controller NayifatAPI.Controllers.ContentController (NayifatAPI).
2025-02-05 08:33:57.341 +03:00 [INF] Executed DbCommand (7ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 08:33:57.366 +03:00 [INF] Executed DbCommand (22ms) [Parameters=[@__request_Page_0='?' (Size = 450), @__request_KeyName_1='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[config_id], [m].[key_name], [m].[last_updated], [m].[page], [m].[value]
FROM [master_config] AS [m]
WHERE [m].[page] = @__request_Page_0 AND [m].[key_name] = @__request_KeyName_1
2025-02-05 08:33:57.413 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 08:33:57.473 +03:00 [INF] Executed action NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI) in 142.4975ms
2025-02-05 08:33:57.475 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 08:33:57.476 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - 200 null application/json; charset=utf-8 258.378ms
2025-02-05 08:33:58.943 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - application/json; charset=utf-8 46
2025-02-05 08:33:58.959 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 08:33:58.960 +03:00 [INF] Route matched with {action = "MasterFetch", controller = "Content"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] MasterFetch(NayifatAPI.Controllers.MasterFetchRequest) on controller NayifatAPI.Controllers.ContentController (NayifatAPI).
2025-02-05 08:33:58.964 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 08:33:59.012 +03:00 [INF] Executed DbCommand (45ms) [Parameters=[@__request_Page_0='?' (Size = 450), @__request_KeyName_1='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[config_id], [m].[key_name], [m].[last_updated], [m].[page], [m].[value]
FROM [master_config] AS [m]
WHERE [m].[page] = @__request_Page_0 AND [m].[key_name] = @__request_KeyName_1
2025-02-05 08:33:59.023 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 08:33:59.024 +03:00 [INF] Executed action NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI) in 62.0188ms
2025-02-05 08:33:59.025 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 08:33:59.027 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - 200 null application/json; charset=utf-8 83.6016ms
2025-02-05 08:33:59.345 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - application/json; charset=utf-8 36
2025-02-05 08:33:59.349 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 08:33:59.351 +03:00 [INF] Route matched with {action = "MasterFetch", controller = "Content"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] MasterFetch(NayifatAPI.Controllers.MasterFetchRequest) on controller NayifatAPI.Controllers.ContentController (NayifatAPI).
2025-02-05 08:33:59.357 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 08:33:59.361 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__request_Page_0='?' (Size = 450), @__request_KeyName_1='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[config_id], [m].[key_name], [m].[last_updated], [m].[page], [m].[value]
FROM [master_config] AS [m]
WHERE [m].[page] = @__request_Page_0 AND [m].[key_name] = @__request_KeyName_1
2025-02-05 08:33:59.364 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 08:33:59.366 +03:00 [INF] Executed action NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI) in 12.3271ms
2025-02-05 08:33:59.368 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 08:33:59.370 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - 200 null application/json; charset=utf-8 24.713ms
2025-02-05 08:33:59.686 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - application/json; charset=utf-8 36
2025-02-05 08:33:59.689 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 08:33:59.690 +03:00 [INF] Route matched with {action = "MasterFetch", controller = "Content"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] MasterFetch(NayifatAPI.Controllers.MasterFetchRequest) on controller NayifatAPI.Controllers.ContentController (NayifatAPI).
2025-02-05 08:33:59.694 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 08:33:59.699 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__request_Page_0='?' (Size = 450), @__request_KeyName_1='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[config_id], [m].[key_name], [m].[last_updated], [m].[page], [m].[value]
FROM [master_config] AS [m]
WHERE [m].[page] = @__request_Page_0 AND [m].[key_name] = @__request_KeyName_1
2025-02-05 08:33:59.702 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 08:33:59.704 +03:00 [INF] Executed action NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI) in 12.3282ms
2025-02-05 08:33:59.705 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 08:33:59.707 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - 200 null application/json; charset=utf-8 20.3474ms
2025-02-05 08:34:00.008 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - application/json; charset=utf-8 38
2025-02-05 08:34:00.020 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 08:34:00.024 +03:00 [INF] Route matched with {action = "MasterFetch", controller = "Content"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] MasterFetch(NayifatAPI.Controllers.MasterFetchRequest) on controller NayifatAPI.Controllers.ContentController (NayifatAPI).
2025-02-05 08:34:00.031 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 08:34:00.035 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__request_Page_0='?' (Size = 450), @__request_KeyName_1='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[config_id], [m].[key_name], [m].[last_updated], [m].[page], [m].[value]
FROM [master_config] AS [m]
WHERE [m].[page] = @__request_Page_0 AND [m].[key_name] = @__request_KeyName_1
2025-02-05 08:34:00.038 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 08:34:00.041 +03:00 [INF] Executed action NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI) in 12.7052ms
2025-02-05 08:34:00.044 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 08:34:00.046 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - 200 null application/json; charset=utf-8 38.5047ms
2025-02-05 08:34:00.336 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - application/json; charset=utf-8 38
2025-02-05 08:34:00.339 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 08:34:00.341 +03:00 [INF] Route matched with {action = "MasterFetch", controller = "Content"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] MasterFetch(NayifatAPI.Controllers.MasterFetchRequest) on controller NayifatAPI.Controllers.ContentController (NayifatAPI).
2025-02-05 08:34:00.347 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 08:34:00.355 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__request_Page_0='?' (Size = 450), @__request_KeyName_1='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[config_id], [m].[key_name], [m].[last_updated], [m].[page], [m].[value]
FROM [master_config] AS [m]
WHERE [m].[page] = @__request_Page_0 AND [m].[key_name] = @__request_KeyName_1
2025-02-05 08:34:00.359 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 08:34:00.360 +03:00 [INF] Executed action NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI) in 15.5449ms
2025-02-05 08:34:00.361 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 08:34:00.362 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - 200 null application/json; charset=utf-8 26.7666ms
2025-02-05 08:34:00.651 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - application/json; charset=utf-8 36
2025-02-05 08:34:00.655 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 08:34:00.655 +03:00 [INF] Route matched with {action = "MasterFetch", controller = "Content"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] MasterFetch(NayifatAPI.Controllers.MasterFetchRequest) on controller NayifatAPI.Controllers.ContentController (NayifatAPI).
2025-02-05 08:34:00.661 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 08:34:00.667 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__request_Page_0='?' (Size = 450), @__request_KeyName_1='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[config_id], [m].[key_name], [m].[last_updated], [m].[page], [m].[value]
FROM [master_config] AS [m]
WHERE [m].[page] = @__request_Page_0 AND [m].[key_name] = @__request_KeyName_1
2025-02-05 08:34:00.669 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 08:34:00.671 +03:00 [INF] Executed action NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI) in 13.3221ms
2025-02-05 08:34:00.673 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 08:34:00.675 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - 200 null application/json; charset=utf-8 24.1553ms
2025-02-05 08:34:00.962 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - application/json; charset=utf-8 36
2025-02-05 08:34:00.965 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 08:34:00.966 +03:00 [INF] Route matched with {action = "MasterFetch", controller = "Content"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] MasterFetch(NayifatAPI.Controllers.MasterFetchRequest) on controller NayifatAPI.Controllers.ContentController (NayifatAPI).
2025-02-05 08:34:00.969 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 08:34:00.974 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__request_Page_0='?' (Size = 450), @__request_KeyName_1='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[config_id], [m].[key_name], [m].[last_updated], [m].[page], [m].[value]
FROM [master_config] AS [m]
WHERE [m].[page] = @__request_Page_0 AND [m].[key_name] = @__request_KeyName_1
2025-02-05 08:34:00.978 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 08:34:00.979 +03:00 [INF] Executed action NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI) in 11.7709ms
2025-02-05 08:34:00.980 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 08:34:00.981 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - 200 null application/json; charset=utf-8 19.1293ms
2025-02-05 08:34:01.314 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - application/json; charset=utf-8 38
2025-02-05 08:34:01.320 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 08:34:01.323 +03:00 [INF] Route matched with {action = "MasterFetch", controller = "Content"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] MasterFetch(NayifatAPI.Controllers.MasterFetchRequest) on controller NayifatAPI.Controllers.ContentController (NayifatAPI).
2025-02-05 08:34:01.330 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 08:34:01.334 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__request_Page_0='?' (Size = 450), @__request_KeyName_1='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[config_id], [m].[key_name], [m].[last_updated], [m].[page], [m].[value]
FROM [master_config] AS [m]
WHERE [m].[page] = @__request_Page_0 AND [m].[key_name] = @__request_KeyName_1
2025-02-05 08:34:01.336 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 08:34:01.338 +03:00 [INF] Executed action NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI) in 10.0896ms
2025-02-05 08:34:01.339 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 08:34:01.341 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - 200 null application/json; charset=utf-8 26.1345ms
2025-02-05 08:34:01.653 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - application/json; charset=utf-8 38
2025-02-05 08:34:01.658 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 08:34:01.660 +03:00 [INF] Route matched with {action = "MasterFetch", controller = "Content"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] MasterFetch(NayifatAPI.Controllers.MasterFetchRequest) on controller NayifatAPI.Controllers.ContentController (NayifatAPI).
2025-02-05 08:34:01.666 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 08:34:01.672 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__request_Page_0='?' (Size = 450), @__request_KeyName_1='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[config_id], [m].[key_name], [m].[last_updated], [m].[page], [m].[value]
FROM [master_config] AS [m]
WHERE [m].[page] = @__request_Page_0 AND [m].[key_name] = @__request_KeyName_1
2025-02-05 08:34:01.675 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 08:34:01.676 +03:00 [INF] Executed action NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI) in 12.3879ms
2025-02-05 08:34:01.677 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 08:34:01.679 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - 200 null application/json; charset=utf-8 25.2392ms
2025-02-05 08:34:01.974 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - application/json; charset=utf-8 49
2025-02-05 08:34:01.978 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 08:34:01.979 +03:00 [INF] Route matched with {action = "MasterFetch", controller = "Content"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] MasterFetch(NayifatAPI.Controllers.MasterFetchRequest) on controller NayifatAPI.Controllers.ContentController (NayifatAPI).
2025-02-05 08:34:01.983 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 08:34:01.986 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__request_Page_0='?' (Size = 450), @__request_KeyName_1='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[config_id], [m].[key_name], [m].[last_updated], [m].[page], [m].[value]
FROM [master_config] AS [m]
WHERE [m].[page] = @__request_Page_0 AND [m].[key_name] = @__request_KeyName_1
2025-02-05 08:34:01.988 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 08:34:01.991 +03:00 [INF] Executed action NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI) in 9.4365ms
2025-02-05 08:34:01.992 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 08:34:01.994 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - 200 null application/json; charset=utf-8 19.5939ms
2025-02-05 08:34:02.323 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - application/json; charset=utf-8 49
2025-02-05 08:34:02.325 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 08:34:02.326 +03:00 [INF] Route matched with {action = "MasterFetch", controller = "Content"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] MasterFetch(NayifatAPI.Controllers.MasterFetchRequest) on controller NayifatAPI.Controllers.ContentController (NayifatAPI).
2025-02-05 08:34:02.329 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 08:34:02.331 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__request_Page_0='?' (Size = 450), @__request_KeyName_1='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[config_id], [m].[key_name], [m].[last_updated], [m].[page], [m].[value]
FROM [master_config] AS [m]
WHERE [m].[page] = @__request_Page_0 AND [m].[key_name] = @__request_KeyName_1
2025-02-05 08:34:02.333 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 08:34:02.334 +03:00 [INF] Executed action NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI) in 6.9736ms
2025-02-05 08:34:02.335 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 08:34:02.337 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - 200 null application/json; charset=utf-8 13.9622ms
2025-02-05 08:34:02.628 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - application/json; charset=utf-8 49
2025-02-05 08:34:02.632 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 08:34:02.634 +03:00 [INF] Route matched with {action = "MasterFetch", controller = "Content"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] MasterFetch(NayifatAPI.Controllers.MasterFetchRequest) on controller NayifatAPI.Controllers.ContentController (NayifatAPI).
2025-02-05 08:34:02.640 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 08:34:02.645 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__request_Page_0='?' (Size = 450), @__request_KeyName_1='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[config_id], [m].[key_name], [m].[last_updated], [m].[page], [m].[value]
FROM [master_config] AS [m]
WHERE [m].[page] = @__request_Page_0 AND [m].[key_name] = @__request_KeyName_1
2025-02-05 08:34:02.650 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 08:34:02.652 +03:00 [INF] Executed action NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI) in 14.6088ms
2025-02-05 08:34:02.654 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 08:34:02.656 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - 200 null application/json; charset=utf-8 27.7247ms
2025-02-05 08:34:02.979 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - application/json; charset=utf-8 49
2025-02-05 08:34:02.982 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 08:34:02.983 +03:00 [INF] Route matched with {action = "MasterFetch", controller = "Content"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] MasterFetch(NayifatAPI.Controllers.MasterFetchRequest) on controller NayifatAPI.Controllers.ContentController (NayifatAPI).
2025-02-05 08:34:02.986 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 08:34:02.988 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__request_Page_0='?' (Size = 450), @__request_KeyName_1='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[config_id], [m].[key_name], [m].[last_updated], [m].[page], [m].[value]
FROM [master_config] AS [m]
WHERE [m].[page] = @__request_Page_0 AND [m].[key_name] = @__request_KeyName_1
2025-02-05 08:34:02.990 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 08:34:02.991 +03:00 [INF] Executed action NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI) in 7.3439ms
2025-02-05 08:34:02.992 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 08:34:02.993 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - 200 null application/json; charset=utf-8 14.2977ms
2025-02-05 08:34:03.306 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - application/json; charset=utf-8 36
2025-02-05 08:34:03.312 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 08:34:03.313 +03:00 [INF] Route matched with {action = "MasterFetch", controller = "Content"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] MasterFetch(NayifatAPI.Controllers.MasterFetchRequest) on controller NayifatAPI.Controllers.ContentController (NayifatAPI).
2025-02-05 08:34:03.318 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 08:34:03.325 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__request_Page_0='?' (Size = 450), @__request_KeyName_1='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[config_id], [m].[key_name], [m].[last_updated], [m].[page], [m].[value]
FROM [master_config] AS [m]
WHERE [m].[page] = @__request_Page_0 AND [m].[key_name] = @__request_KeyName_1
2025-02-05 08:34:03.331 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 08:34:03.334 +03:00 [INF] Executed action NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI) in 19.3636ms
2025-02-05 08:34:03.341 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 08:34:03.342 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - 200 null application/json; charset=utf-8 35.8988ms
2025-02-05 08:34:05.698 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - application/json; charset=utf-8 36
2025-02-05 08:34:05.702 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 08:34:05.704 +03:00 [INF] Route matched with {action = "MasterFetch", controller = "Content"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] MasterFetch(NayifatAPI.Controllers.MasterFetchRequest) on controller NayifatAPI.Controllers.ContentController (NayifatAPI).
2025-02-05 08:34:05.709 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 08:34:05.712 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__request_Page_0='?' (Size = 450), @__request_KeyName_1='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[config_id], [m].[key_name], [m].[last_updated], [m].[page], [m].[value]
FROM [master_config] AS [m]
WHERE [m].[page] = @__request_Page_0 AND [m].[key_name] = @__request_KeyName_1
2025-02-05 08:34:05.716 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 08:34:05.718 +03:00 [INF] Executed action NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI) in 11.8103ms
2025-02-05 08:34:05.722 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 08:34:05.723 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - 200 null application/json; charset=utf-8 25.336ms
2025-02-05 08:35:59.916 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/list - application/json 39
2025-02-05 08:35:59.917 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/list - application/json 39
2025-02-05 08:36:00.126 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI)'
2025-02-05 08:36:00.302 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI)'
2025-02-05 08:36:00.311 +03:00 [INF] Route matched with {action = "GetNotifications", controller = "Notifications"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetNotifications(NayifatAPI.Controllers.GetNotificationsRequest) on controller NayifatAPI.Controllers.NotificationsController (NayifatAPI).
2025-02-05 08:36:00.355 +03:00 [INF] Route matched with {action = "GetNotifications", controller = "Notifications"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetNotifications(NayifatAPI.Controllers.GetNotificationsRequest) on controller NayifatAPI.Controllers.NotificationsController (NayifatAPI).
2025-02-05 08:36:00.469 +03:00 [INF] Executed DbCommand (21ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 08:36:00.520 +03:00 [INF] Executed DbCommand (16ms) [Parameters=[@__request_NationalId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[national_id], [u].[last_updated], [u].[notifications]
FROM [user_notifications] AS [u]
WHERE [u].[national_id] = @__request_NationalId_0
2025-02-05 08:36:00.588 +03:00 [INF] Executed DbCommand (6ms) [Parameters=[@__Parse_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [n].[Id], [n].[additional_data], [n].[Body], [n].[body_ar], [n].[body_en], [n].[created_at], [n].[expiry_at], [n].[Route], [n].[target_criteria], [n].[Title], [n].[title_ar], [n].[title_en]
FROM [notification_templates] AS [n]
WHERE [n].[Id] = @__Parse_0
2025-02-05 08:36:00.597 +03:00 [INF] Executed DbCommand (6ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 08:36:00.672 +03:00 [INF] Executed DbCommand (38ms) [Parameters=[@__request_NationalId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[national_id], [u].[last_updated], [u].[notifications]
FROM [user_notifications] AS [u]
WHERE [u].[national_id] = @__request_NationalId_0
2025-02-05 08:36:00.678 +03:00 [INF] Executed DbCommand (44ms) [Parameters=[@__Parse_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [n].[Id], [n].[additional_data], [n].[Body], [n].[body_ar], [n].[body_en], [n].[created_at], [n].[expiry_at], [n].[Route], [n].[target_criteria], [n].[Title], [n].[title_ar], [n].[title_en]
FROM [notification_templates] AS [n]
WHERE [n].[Id] = @__Parse_0
2025-02-05 08:36:00.829 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__Parse_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [n].[Id], [n].[additional_data], [n].[Body], [n].[body_ar], [n].[body_en], [n].[created_at], [n].[expiry_at], [n].[Route], [n].[target_criteria], [n].[Title], [n].[title_ar], [n].[title_en]
FROM [notification_templates] AS [n]
WHERE [n].[Id] = @__Parse_0
2025-02-05 08:36:01.021 +03:00 [INF] Executed DbCommand (16ms) [Parameters=[@__Parse_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [n].[Id], [n].[additional_data], [n].[Body], [n].[body_ar], [n].[body_en], [n].[created_at], [n].[expiry_at], [n].[Route], [n].[target_criteria], [n].[Title], [n].[title_ar], [n].[title_en]
FROM [notification_templates] AS [n]
WHERE [n].[Id] = @__Parse_0
2025-02-05 08:36:01.575 +03:00 [INF] Executed DbCommand (575ms) [Parameters=[@__Parse_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [n].[Id], [n].[additional_data], [n].[Body], [n].[body_ar], [n].[body_en], [n].[created_at], [n].[expiry_at], [n].[Route], [n].[target_criteria], [n].[Title], [n].[title_ar], [n].[title_en]
FROM [notification_templates] AS [n]
WHERE [n].[Id] = @__Parse_0
2025-02-05 08:36:01.578 +03:00 [INF] Executed DbCommand (14ms) [Parameters=[@__Parse_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [n].[Id], [n].[additional_data], [n].[Body], [n].[body_ar], [n].[body_en], [n].[created_at], [n].[expiry_at], [n].[Route], [n].[target_criteria], [n].[Title], [n].[title_ar], [n].[title_en]
FROM [notification_templates] AS [n]
WHERE [n].[Id] = @__Parse_0
2025-02-05 08:36:01.601 +03:00 [INF] Executed DbCommand (12ms) [Parameters=[@__Parse_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [n].[Id], [n].[additional_data], [n].[Body], [n].[body_ar], [n].[body_en], [n].[created_at], [n].[expiry_at], [n].[Route], [n].[target_criteria], [n].[Title], [n].[title_ar], [n].[title_en]
FROM [notification_templates] AS [n]
WHERE [n].[Id] = @__Parse_0
2025-02-05 08:36:01.625 +03:00 [INF] Executed DbCommand (16ms) [Parameters=[@__Parse_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [n].[Id], [n].[additional_data], [n].[Body], [n].[body_ar], [n].[body_en], [n].[created_at], [n].[expiry_at], [n].[Route], [n].[target_criteria], [n].[Title], [n].[title_ar], [n].[title_en]
FROM [notification_templates] AS [n]
WHERE [n].[Id] = @__Parse_0
2025-02-05 08:36:01.770 +03:00 [INF] Executed DbCommand (23ms) [Parameters=[@p0='?' (Size = 4000), @p1='?' (DbType = DateTime2), @p2='?' (Size = 4000), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (Size = 450), @p6='?' (Size = 4000), @p7='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [AuthLogs] ([AuthType], [CreatedAt], [DeviceId], [FailureReason], [IpAddress], [NationalId], [Status], [UserAgent])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7);
2025-02-05 08:36:01.771 +03:00 [INF] Executed DbCommand (24ms) [Parameters=[@p0='?' (Size = 4000), @p1='?' (DbType = DateTime2), @p2='?' (Size = 4000), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (Size = 450), @p6='?' (Size = 4000), @p7='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [AuthLogs] ([AuthType], [CreatedAt], [DeviceId], [FailureReason], [IpAddress], [NationalId], [Status], [UserAgent])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7);
2025-02-05 08:36:01.850 +03:00 [ERR] An exception occurred in the database while saving changes for context type 'NayifatAPI.Data.ApplicationDbContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_AuthLogs_Customers_NationalId". The conflict occurred in database "NayifatApp", table "dbo.Customers", column 'NationalId'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:2e0181e6-8929-4dff-9e90-8bce31743464
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_AuthLogs_Customers_NationalId". The conflict occurred in database "NayifatApp", table "dbo.Customers", column 'NationalId'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:2e0181e6-8929-4dff-9e90-8bce31743464
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2025-02-05 08:36:01.866 +03:00 [ERR] An exception occurred in the database while saving changes for context type 'NayifatAPI.Data.ApplicationDbContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_AuthLogs_Customers_NationalId". The conflict occurred in database "NayifatApp", table "dbo.Customers", column 'NationalId'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:d0f2ef4c-15c5-40f4-8893-a8f664a66d84
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_AuthLogs_Customers_NationalId". The conflict occurred in database "NayifatApp", table "dbo.Customers", column 'NationalId'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:d0f2ef4c-15c5-40f4-8893-a8f664a66d84
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2025-02-05 08:36:01.905 +03:00 [ERR] Error logging audit event. NationalId: all, Action: notification_delivered, Details: {"notification_count":4,"notification_ids":[20,19,18,12],"timestamp":"2025-02-05T08:36:00.8266073"}
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_AuthLogs_Customers_NationalId". The conflict occurred in database "NayifatApp", table "dbo.Customers", column 'NationalId'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:2e0181e6-8929-4dff-9e90-8bce31743464
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at NayifatAPI.Services.AuditLogService.LogAsync(String nationalId, String action, Object details) in C:\Users\yamta\StudioProjects\nayifat_app_2025_new\nayifatapi\Services\AuditLogService.cs:line 36
2025-02-05 08:36:02.023 +03:00 [ERR] Error logging audit event. NationalId: all, Action: notification_delivered, Details: {"notification_count":4,"notification_ids":[20,19,18,12],"timestamp":"2025-02-05T08:36:00.5571417"}
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_AuthLogs_Customers_NationalId". The conflict occurred in database "NayifatApp", table "dbo.Customers", column 'NationalId'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:d0f2ef4c-15c5-40f4-8893-a8f664a66d84
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at NayifatAPI.Services.AuditLogService.LogAsync(String nationalId, String action, Object details) in C:\Users\yamta\StudioProjects\nayifat_app_2025_new\nayifatapi\Services\AuditLogService.cs:line 36
2025-02-05 08:36:02.063 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 08:36:02.194 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 08:36:02.199 +03:00 [INF] Executed action NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI) in 1747.9559ms
2025-02-05 08:36:02.201 +03:00 [INF] Executed action NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI) in 1779.2482ms
2025-02-05 08:36:02.206 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI)'
2025-02-05 08:36:02.208 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI)'
2025-02-05 08:36:02.227 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/list - 200 null application/json; charset=utf-8 2309.7626ms
2025-02-05 08:36:02.227 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/list - 200 null application/json; charset=utf-8 2310.5184ms
2025-02-05 08:51:03.832 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/list - application/json 39
2025-02-05 08:51:03.839 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI)'
2025-02-05 08:51:03.840 +03:00 [INF] Route matched with {action = "GetNotifications", controller = "Notifications"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetNotifications(NayifatAPI.Controllers.GetNotificationsRequest) on controller NayifatAPI.Controllers.NotificationsController (NayifatAPI).
2025-02-05 08:51:03.923 +03:00 [INF] Executed DbCommand (77ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 08:51:03.928 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[@__request_NationalId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[national_id], [u].[last_updated], [u].[notifications]
FROM [user_notifications] AS [u]
WHERE [u].[national_id] = @__request_NationalId_0
2025-02-05 08:51:03.933 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__Parse_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [n].[Id], [n].[additional_data], [n].[Body], [n].[body_ar], [n].[body_en], [n].[created_at], [n].[expiry_at], [n].[Route], [n].[target_criteria], [n].[Title], [n].[title_ar], [n].[title_en]
FROM [notification_templates] AS [n]
WHERE [n].[Id] = @__Parse_0
2025-02-05 08:51:03.938 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__Parse_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [n].[Id], [n].[additional_data], [n].[Body], [n].[body_ar], [n].[body_en], [n].[created_at], [n].[expiry_at], [n].[Route], [n].[target_criteria], [n].[Title], [n].[title_ar], [n].[title_en]
FROM [notification_templates] AS [n]
WHERE [n].[Id] = @__Parse_0
2025-02-05 08:51:03.941 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__Parse_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [n].[Id], [n].[additional_data], [n].[Body], [n].[body_ar], [n].[body_en], [n].[created_at], [n].[expiry_at], [n].[Route], [n].[target_criteria], [n].[Title], [n].[title_ar], [n].[title_en]
FROM [notification_templates] AS [n]
WHERE [n].[Id] = @__Parse_0
2025-02-05 08:51:03.943 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__Parse_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [n].[Id], [n].[additional_data], [n].[Body], [n].[body_ar], [n].[body_en], [n].[created_at], [n].[expiry_at], [n].[Route], [n].[target_criteria], [n].[Title], [n].[title_ar], [n].[title_en]
FROM [notification_templates] AS [n]
WHERE [n].[Id] = @__Parse_0
2025-02-05 08:51:04.447 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/list - application/json 39
2025-02-05 08:51:04.451 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI)'
2025-02-05 08:51:04.452 +03:00 [INF] Route matched with {action = "GetNotifications", controller = "Notifications"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetNotifications(NayifatAPI.Controllers.GetNotificationsRequest) on controller NayifatAPI.Controllers.NotificationsController (NayifatAPI).
2025-02-05 08:51:04.459 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 08:51:04.461 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__request_NationalId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[national_id], [u].[last_updated], [u].[notifications]
FROM [user_notifications] AS [u]
WHERE [u].[national_id] = @__request_NationalId_0
2025-02-05 08:51:04.466 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__Parse_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [n].[Id], [n].[additional_data], [n].[Body], [n].[body_ar], [n].[body_en], [n].[created_at], [n].[expiry_at], [n].[Route], [n].[target_criteria], [n].[Title], [n].[title_ar], [n].[title_en]
FROM [notification_templates] AS [n]
WHERE [n].[Id] = @__Parse_0
2025-02-05 08:51:04.468 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__Parse_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [n].[Id], [n].[additional_data], [n].[Body], [n].[body_ar], [n].[body_en], [n].[created_at], [n].[expiry_at], [n].[Route], [n].[target_criteria], [n].[Title], [n].[title_ar], [n].[title_en]
FROM [notification_templates] AS [n]
WHERE [n].[Id] = @__Parse_0
2025-02-05 08:51:04.471 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__Parse_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [n].[Id], [n].[additional_data], [n].[Body], [n].[body_ar], [n].[body_en], [n].[created_at], [n].[expiry_at], [n].[Route], [n].[target_criteria], [n].[Title], [n].[title_ar], [n].[title_en]
FROM [notification_templates] AS [n]
WHERE [n].[Id] = @__Parse_0
2025-02-05 08:51:04.474 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__Parse_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [n].[Id], [n].[additional_data], [n].[Body], [n].[body_ar], [n].[body_en], [n].[created_at], [n].[expiry_at], [n].[Route], [n].[target_criteria], [n].[Title], [n].[title_ar], [n].[title_en]
FROM [notification_templates] AS [n]
WHERE [n].[Id] = @__Parse_0
2025-02-05 08:51:05.667 +03:00 [INF] Executed DbCommand (1,190ms) [Parameters=[@p0='?' (Size = 4000), @p1='?' (DbType = DateTime2), @p2='?' (Size = 4000), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (Size = 450), @p6='?' (Size = 4000), @p7='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [AuthLogs] ([AuthType], [CreatedAt], [DeviceId], [FailureReason], [IpAddress], [NationalId], [Status], [UserAgent])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7);
2025-02-05 08:51:05.667 +03:00 [INF] Executed DbCommand (1,722ms) [Parameters=[@p0='?' (Size = 4000), @p1='?' (DbType = DateTime2), @p2='?' (Size = 4000), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (Size = 450), @p6='?' (Size = 4000), @p7='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [AuthLogs] ([AuthType], [CreatedAt], [DeviceId], [FailureReason], [IpAddress], [NationalId], [Status], [UserAgent])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7);
2025-02-05 08:51:05.672 +03:00 [ERR] An exception occurred in the database while saving changes for context type 'NayifatAPI.Data.ApplicationDbContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_AuthLogs_Customers_NationalId". The conflict occurred in database "NayifatApp", table "dbo.Customers", column 'NationalId'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:70b8b94e-743c-4e8d-b783-6e8d910a1a11
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_AuthLogs_Customers_NationalId". The conflict occurred in database "NayifatApp", table "dbo.Customers", column 'NationalId'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:70b8b94e-743c-4e8d-b783-6e8d910a1a11
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2025-02-05 08:51:05.675 +03:00 [ERR] An exception occurred in the database while saving changes for context type 'NayifatAPI.Data.ApplicationDbContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_AuthLogs_Customers_NationalId". The conflict occurred in database "NayifatApp", table "dbo.Customers", column 'NationalId'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:d89375dd-3bac-4fca-aa24-047b1593abf4
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_AuthLogs_Customers_NationalId". The conflict occurred in database "NayifatApp", table "dbo.Customers", column 'NationalId'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:d89375dd-3bac-4fca-aa24-047b1593abf4
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2025-02-05 08:51:05.727 +03:00 [ERR] Error logging audit event. NationalId: all, Action: notification_delivered, Details: {"notification_count":4,"notification_ids":[20,19,18,12],"timestamp":"2025-02-05T08:51:04.4651699"}
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_AuthLogs_Customers_NationalId". The conflict occurred in database "NayifatApp", table "dbo.Customers", column 'NationalId'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:70b8b94e-743c-4e8d-b783-6e8d910a1a11
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at NayifatAPI.Services.AuditLogService.LogAsync(String nationalId, String action, Object details) in C:\Users\yamta\StudioProjects\nayifat_app_2025_new\nayifatapi\Services\AuditLogService.cs:line 36
2025-02-05 08:51:06.097 +03:00 [ERR] Error logging audit event. NationalId: all, Action: notification_delivered, Details: {"notification_count":4,"notification_ids":[20,19,18,12],"timestamp":"2025-02-05T08:51:03.9308192"}
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_AuthLogs_Customers_NationalId". The conflict occurred in database "NayifatApp", table "dbo.Customers", column 'NationalId'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:d89375dd-3bac-4fca-aa24-047b1593abf4
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at NayifatAPI.Services.AuditLogService.LogAsync(String nationalId, String action, Object details) in C:\Users\yamta\StudioProjects\nayifat_app_2025_new\nayifatapi\Services\AuditLogService.cs:line 36
2025-02-05 08:51:06.717 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 08:51:06.730 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 08:51:06.730 +03:00 [INF] Executed action NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI) in 2276.731ms
2025-02-05 08:51:06.732 +03:00 [INF] Executed action NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI) in 2890.8086ms
2025-02-05 08:51:06.734 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI)'
2025-02-05 08:51:06.736 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI)'
2025-02-05 08:51:06.946 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/list - 200 null application/json; charset=utf-8 3114.6477ms
2025-02-05 08:51:06.943 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/list - 200 null application/json; charset=utf-8 2495.4362ms
2025-02-05 08:59:33.017 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/list - application/json 39
2025-02-05 08:59:33.019 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI)'
2025-02-05 08:59:33.020 +03:00 [INF] Route matched with {action = "GetNotifications", controller = "Notifications"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetNotifications(NayifatAPI.Controllers.GetNotificationsRequest) on controller NayifatAPI.Controllers.NotificationsController (NayifatAPI).
2025-02-05 08:59:33.031 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 08:59:33.036 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[@__request_NationalId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[national_id], [u].[last_updated], [u].[notifications]
FROM [user_notifications] AS [u]
WHERE [u].[national_id] = @__request_NationalId_0
2025-02-05 08:59:33.042 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__Parse_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [n].[Id], [n].[additional_data], [n].[Body], [n].[body_ar], [n].[body_en], [n].[created_at], [n].[expiry_at], [n].[Route], [n].[target_criteria], [n].[Title], [n].[title_ar], [n].[title_en]
FROM [notification_templates] AS [n]
WHERE [n].[Id] = @__Parse_0
2025-02-05 08:59:33.044 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__Parse_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [n].[Id], [n].[additional_data], [n].[Body], [n].[body_ar], [n].[body_en], [n].[created_at], [n].[expiry_at], [n].[Route], [n].[target_criteria], [n].[Title], [n].[title_ar], [n].[title_en]
FROM [notification_templates] AS [n]
WHERE [n].[Id] = @__Parse_0
2025-02-05 08:59:33.047 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__Parse_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [n].[Id], [n].[additional_data], [n].[Body], [n].[body_ar], [n].[body_en], [n].[created_at], [n].[expiry_at], [n].[Route], [n].[target_criteria], [n].[Title], [n].[title_ar], [n].[title_en]
FROM [notification_templates] AS [n]
WHERE [n].[Id] = @__Parse_0
2025-02-05 08:59:33.050 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__Parse_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [n].[Id], [n].[additional_data], [n].[Body], [n].[body_ar], [n].[body_en], [n].[created_at], [n].[expiry_at], [n].[Route], [n].[target_criteria], [n].[Title], [n].[title_ar], [n].[title_en]
FROM [notification_templates] AS [n]
WHERE [n].[Id] = @__Parse_0
2025-02-05 08:59:33.134 +03:00 [INF] Executed DbCommand (81ms) [Parameters=[@p0='?' (Size = 4000), @p1='?' (DbType = DateTime2), @p2='?' (Size = 4000), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (Size = 450), @p6='?' (Size = 4000), @p7='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [AuthLogs] ([AuthType], [CreatedAt], [DeviceId], [FailureReason], [IpAddress], [NationalId], [Status], [UserAgent])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7);
2025-02-05 08:59:33.138 +03:00 [ERR] An exception occurred in the database while saving changes for context type 'NayifatAPI.Data.ApplicationDbContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_AuthLogs_Customers_NationalId". The conflict occurred in database "NayifatApp", table "dbo.Customers", column 'NationalId'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:235a0498-9d69-4961-ad89-57970fa6ec67
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_AuthLogs_Customers_NationalId". The conflict occurred in database "NayifatApp", table "dbo.Customers", column 'NationalId'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:235a0498-9d69-4961-ad89-57970fa6ec67
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2025-02-05 08:59:33.153 +03:00 [ERR] Error logging audit event. NationalId: all, Action: notification_delivered, Details: {"notification_count":4,"notification_ids":[20,19,18,12],"timestamp":"2025-02-05T08:59:33.0395131"}
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_AuthLogs_Customers_NationalId". The conflict occurred in database "NayifatApp", table "dbo.Customers", column 'NationalId'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:235a0498-9d69-4961-ad89-57970fa6ec67
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at NayifatAPI.Services.AuditLogService.LogAsync(String nationalId, String action, Object details) in C:\Users\yamta\StudioProjects\nayifat_app_2025_new\nayifatapi\Services\AuditLogService.cs:line 36
2025-02-05 08:59:33.165 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 08:59:33.166 +03:00 [INF] Executed action NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI) in 145.3849ms
2025-02-05 08:59:33.168 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI)'
2025-02-05 08:59:33.169 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/list - 200 null application/json; charset=utf-8 152.5387ms
2025-02-05 09:02:26.870 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/timestamps - application/json; charset=utf-8 2
2025-02-05 09:02:26.874 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.ContentController.GetTimestamps (NayifatAPI)'
2025-02-05 09:02:26.875 +03:00 [INF] Route matched with {action = "GetTimestamps", controller = "Content"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetTimestamps() on controller NayifatAPI.Controllers.ContentController (NayifatAPI).
2025-02-05 09:02:26.877 +03:00 [INF] TTT_
2025-02-05 09:02:26.878 +03:00 [INF] TTT_=== Getting Content Timestamps ===
2025-02-05 09:02:26.958 +03:00 [INF] Executed DbCommand (79ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 09:02:26.960 +03:00 [INF] TTT_Fetching timestamps from database
2025-02-05 09:02:26.966 +03:00 [INF] Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [m].[page] AS [Page], [m].[key_name] AS [KeyName], [m].[last_updated] AS [LastUpdated]
FROM [master_config] AS [m]
2025-02-05 09:02:26.968 +03:00 [INF] TTT_Found 18 content items
2025-02-05 09:02:26.968 +03:00 [INF] TTT_Page: home
2025-02-05 09:02:26.969 +03:00 [INF] TTT_  - slideshow_content: "2025-02-04T10:01:06.9430000"
2025-02-05 09:02:26.969 +03:00 [INF] TTT_  - slideshow_content_ar: "2025-02-04T10:01:06.9430000"
2025-02-05 09:02:26.970 +03:00 [INF] TTT_  - contact_details: "2025-02-04T10:01:06.9430000"
2025-02-05 09:02:26.971 +03:00 [INF] TTT_  - contact_details_ar: "2025-02-04T10:01:06.9430000"
2025-02-05 09:02:26.971 +03:00 [INF] TTT_  - termsEN1: "2025-02-03T14:23:58.0000000"
2025-02-05 09:02:26.972 +03:00 [INF] TTT_  - termsEN2: "2025-02-03T14:25:20.1730000"
2025-02-05 09:02:26.972 +03:00 [INF] TTT_  - privacyEN1: "2025-02-03T14:26:08.6130000"
2025-02-05 09:02:26.973 +03:00 [INF] TTT_  - privacyEN2: "2025-02-03T14:25:20.1730000"
2025-02-05 09:02:26.974 +03:00 [INF] TTT_  - termsAR1: "2025-02-03T14:23:58.0000000"
2025-02-05 09:02:26.975 +03:00 [INF] TTT_  - termsAR2: "2025-02-03T14:25:20.1730000"
2025-02-05 09:02:26.975 +03:00 [INF] TTT_  - privacyAR1: "2025-02-03T14:26:08.6130000"
2025-02-05 09:02:26.976 +03:00 [INF] TTT_  - privacyAR2: "2025-02-03T14:25:20.1730000"
2025-02-05 09:02:26.977 +03:00 [INF] TTT_  - terms&conditionsCC_AR: "2025-02-03T17:06:57.7700000"
2025-02-05 09:02:26.977 +03:00 [INF] TTT_  - terms&conditionsCC_EN: "2025-02-03T17:07:47.4900000"
2025-02-05 09:02:26.978 +03:00 [INF] TTT_  - terms&conditionsPF_AR: "2025-02-03T17:06:57.7700000"
2025-02-05 09:02:26.980 +03:00 [INF] TTT_  - terms&conditionsPF_EN: "2025-02-03T17:06:57.7700000"
2025-02-05 09:02:26.981 +03:00 [INF] TTT_Page: loans
2025-02-05 09:02:26.981 +03:00 [INF] TTT_  - loan_ad: "2025-02-04T10:01:06.9430000"
2025-02-05 09:02:26.982 +03:00 [INF] TTT_Page: cards
2025-02-05 09:02:26.983 +03:00 [INF] TTT_  - card_ad: "2025-02-04T10:01:06.9430000"
2025-02-05 09:02:26.983 +03:00 [INF] TTT_Successfully retrieved all timestamps
2025-02-05 09:02:26.984 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 09:02:26.986 +03:00 [INF] Executed action NayifatAPI.Controllers.ContentController.GetTimestamps (NayifatAPI) in 109.2ms
2025-02-05 09:02:26.989 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.ContentController.GetTimestamps (NayifatAPI)'
2025-02-05 09:02:26.990 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/timestamps - 200 null application/json; charset=utf-8 119.3902ms
2025-02-05 09:02:27.496 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - application/json; charset=utf-8 45
2025-02-05 09:02:27.499 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 09:02:27.500 +03:00 [INF] Route matched with {action = "MasterFetch", controller = "Content"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] MasterFetch(NayifatAPI.Controllers.MasterFetchRequest) on controller NayifatAPI.Controllers.ContentController (NayifatAPI).
2025-02-05 09:02:27.502 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 09:02:27.512 +03:00 [INF] Executed DbCommand (8ms) [Parameters=[@__request_Page_0='?' (Size = 450), @__request_KeyName_1='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[config_id], [m].[key_name], [m].[last_updated], [m].[page], [m].[value]
FROM [master_config] AS [m]
WHERE [m].[page] = @__request_Page_0 AND [m].[key_name] = @__request_KeyName_1
2025-02-05 09:02:27.514 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 09:02:27.515 +03:00 [INF] Executed action NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI) in 14.6944ms
2025-02-05 09:02:27.516 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 09:02:27.517 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - 200 null application/json; charset=utf-8 20.6114ms
2025-02-05 09:02:30.515 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - application/json; charset=utf-8 48
2025-02-05 09:02:30.517 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 09:02:30.518 +03:00 [INF] Route matched with {action = "MasterFetch", controller = "Content"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] MasterFetch(NayifatAPI.Controllers.MasterFetchRequest) on controller NayifatAPI.Controllers.ContentController (NayifatAPI).
2025-02-05 09:02:30.521 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 09:02:30.524 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__request_Page_0='?' (Size = 450), @__request_KeyName_1='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[config_id], [m].[key_name], [m].[last_updated], [m].[page], [m].[value]
FROM [master_config] AS [m]
WHERE [m].[page] = @__request_Page_0 AND [m].[key_name] = @__request_KeyName_1
2025-02-05 09:02:30.525 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 09:02:30.526 +03:00 [INF] Executed action NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI) in 6.424ms
2025-02-05 09:02:30.527 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 09:02:30.528 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - 200 null application/json; charset=utf-8 13.0665ms
2025-02-05 09:02:32.394 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - application/json; charset=utf-8 43
2025-02-05 09:02:32.397 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 09:02:32.399 +03:00 [INF] Route matched with {action = "MasterFetch", controller = "Content"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] MasterFetch(NayifatAPI.Controllers.MasterFetchRequest) on controller NayifatAPI.Controllers.ContentController (NayifatAPI).
2025-02-05 09:02:32.402 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 09:02:32.404 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__request_Page_0='?' (Size = 450), @__request_KeyName_1='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[config_id], [m].[key_name], [m].[last_updated], [m].[page], [m].[value]
FROM [master_config] AS [m]
WHERE [m].[page] = @__request_Page_0 AND [m].[key_name] = @__request_KeyName_1
2025-02-05 09:02:32.406 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 09:02:32.407 +03:00 [INF] Executed action NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI) in 6.1833ms
2025-02-05 09:02:32.409 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 09:02:32.409 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - 200 null application/json; charset=utf-8 14.9106ms
2025-02-05 09:02:32.685 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - application/json; charset=utf-8 46
2025-02-05 09:02:32.689 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 09:02:32.690 +03:00 [INF] Route matched with {action = "MasterFetch", controller = "Content"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] MasterFetch(NayifatAPI.Controllers.MasterFetchRequest) on controller NayifatAPI.Controllers.ContentController (NayifatAPI).
2025-02-05 09:02:32.692 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 09:02:32.695 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__request_Page_0='?' (Size = 450), @__request_KeyName_1='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[config_id], [m].[key_name], [m].[last_updated], [m].[page], [m].[value]
FROM [master_config] AS [m]
WHERE [m].[page] = @__request_Page_0 AND [m].[key_name] = @__request_KeyName_1
2025-02-05 09:02:32.697 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 09:02:32.698 +03:00 [INF] Executed action NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI) in 7.264ms
2025-02-05 09:02:32.699 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 09:02:32.701 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - 200 null application/json; charset=utf-8 16.0614ms
2025-02-05 09:02:32.974 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - application/json; charset=utf-8 36
2025-02-05 09:02:32.977 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 09:02:32.978 +03:00 [INF] Route matched with {action = "MasterFetch", controller = "Content"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] MasterFetch(NayifatAPI.Controllers.MasterFetchRequest) on controller NayifatAPI.Controllers.ContentController (NayifatAPI).
2025-02-05 09:02:32.980 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 09:02:32.984 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__request_Page_0='?' (Size = 450), @__request_KeyName_1='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[config_id], [m].[key_name], [m].[last_updated], [m].[page], [m].[value]
FROM [master_config] AS [m]
WHERE [m].[page] = @__request_Page_0 AND [m].[key_name] = @__request_KeyName_1
2025-02-05 09:02:32.986 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 09:02:32.987 +03:00 [INF] Executed action NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI) in 8.0461ms
2025-02-05 09:02:32.989 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 09:02:32.990 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - 200 null application/json; charset=utf-8 15.7052ms
2025-02-05 09:02:33.585 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - application/json; charset=utf-8 36
2025-02-05 09:02:33.590 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 09:02:33.591 +03:00 [INF] Route matched with {action = "MasterFetch", controller = "Content"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] MasterFetch(NayifatAPI.Controllers.MasterFetchRequest) on controller NayifatAPI.Controllers.ContentController (NayifatAPI).
2025-02-05 09:02:33.593 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 09:02:33.596 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__request_Page_0='?' (Size = 450), @__request_KeyName_1='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[config_id], [m].[key_name], [m].[last_updated], [m].[page], [m].[value]
FROM [master_config] AS [m]
WHERE [m].[page] = @__request_Page_0 AND [m].[key_name] = @__request_KeyName_1
2025-02-05 09:02:33.597 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 09:02:33.598 +03:00 [INF] Executed action NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI) in 6.2031ms
2025-02-05 09:02:33.599 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 09:02:33.600 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - 200 null application/json; charset=utf-8 14.6637ms
2025-02-05 09:02:33.878 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - application/json; charset=utf-8 38
2025-02-05 09:02:33.882 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 09:02:33.883 +03:00 [INF] Route matched with {action = "MasterFetch", controller = "Content"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] MasterFetch(NayifatAPI.Controllers.MasterFetchRequest) on controller NayifatAPI.Controllers.ContentController (NayifatAPI).
2025-02-05 09:02:33.887 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 09:02:33.890 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__request_Page_0='?' (Size = 450), @__request_KeyName_1='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[config_id], [m].[key_name], [m].[last_updated], [m].[page], [m].[value]
FROM [master_config] AS [m]
WHERE [m].[page] = @__request_Page_0 AND [m].[key_name] = @__request_KeyName_1
2025-02-05 09:02:33.896 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 09:02:33.899 +03:00 [INF] Executed action NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI) in 13.9994ms
2025-02-05 09:02:33.900 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 09:02:33.901 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - 200 null application/json; charset=utf-8 22.9277ms
2025-02-05 09:02:34.195 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - application/json; charset=utf-8 38
2025-02-05 09:02:34.198 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 09:02:34.199 +03:00 [INF] Route matched with {action = "MasterFetch", controller = "Content"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] MasterFetch(NayifatAPI.Controllers.MasterFetchRequest) on controller NayifatAPI.Controllers.ContentController (NayifatAPI).
2025-02-05 09:02:34.201 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 09:02:34.204 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__request_Page_0='?' (Size = 450), @__request_KeyName_1='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[config_id], [m].[key_name], [m].[last_updated], [m].[page], [m].[value]
FROM [master_config] AS [m]
WHERE [m].[page] = @__request_Page_0 AND [m].[key_name] = @__request_KeyName_1
2025-02-05 09:02:34.206 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 09:02:34.207 +03:00 [INF] Executed action NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI) in 6.5697ms
2025-02-05 09:02:34.208 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 09:02:34.210 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - 200 null application/json; charset=utf-8 14.2858ms
2025-02-05 09:02:34.505 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - application/json; charset=utf-8 36
2025-02-05 09:02:34.508 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 09:02:34.510 +03:00 [INF] Route matched with {action = "MasterFetch", controller = "Content"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] MasterFetch(NayifatAPI.Controllers.MasterFetchRequest) on controller NayifatAPI.Controllers.ContentController (NayifatAPI).
2025-02-05 09:02:34.512 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 09:02:34.515 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__request_Page_0='?' (Size = 450), @__request_KeyName_1='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[config_id], [m].[key_name], [m].[last_updated], [m].[page], [m].[value]
FROM [master_config] AS [m]
WHERE [m].[page] = @__request_Page_0 AND [m].[key_name] = @__request_KeyName_1
2025-02-05 09:02:34.516 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 09:02:34.517 +03:00 [INF] Executed action NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI) in 6.3518ms
2025-02-05 09:02:34.519 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 09:02:34.520 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - 200 null application/json; charset=utf-8 14.203ms
2025-02-05 09:02:34.971 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - application/json; charset=utf-8 36
2025-02-05 09:02:34.974 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 09:02:34.975 +03:00 [INF] Route matched with {action = "MasterFetch", controller = "Content"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] MasterFetch(NayifatAPI.Controllers.MasterFetchRequest) on controller NayifatAPI.Controllers.ContentController (NayifatAPI).
2025-02-05 09:02:34.977 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 09:02:34.979 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__request_Page_0='?' (Size = 450), @__request_KeyName_1='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[config_id], [m].[key_name], [m].[last_updated], [m].[page], [m].[value]
FROM [master_config] AS [m]
WHERE [m].[page] = @__request_Page_0 AND [m].[key_name] = @__request_KeyName_1
2025-02-05 09:02:34.981 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 09:02:34.982 +03:00 [INF] Executed action NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI) in 5.787ms
2025-02-05 09:02:34.984 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 09:02:34.985 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - 200 null application/json; charset=utf-8 14.1155ms
2025-02-05 09:02:36.043 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - application/json; charset=utf-8 38
2025-02-05 09:02:36.045 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 09:02:36.046 +03:00 [INF] Route matched with {action = "MasterFetch", controller = "Content"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] MasterFetch(NayifatAPI.Controllers.MasterFetchRequest) on controller NayifatAPI.Controllers.ContentController (NayifatAPI).
2025-02-05 09:02:36.049 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 09:02:36.051 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__request_Page_0='?' (Size = 450), @__request_KeyName_1='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[config_id], [m].[key_name], [m].[last_updated], [m].[page], [m].[value]
FROM [master_config] AS [m]
WHERE [m].[page] = @__request_Page_0 AND [m].[key_name] = @__request_KeyName_1
2025-02-05 09:02:36.053 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 09:02:36.054 +03:00 [INF] Executed action NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI) in 6.4302ms
2025-02-05 09:02:36.056 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 09:02:36.058 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - 200 null application/json; charset=utf-8 14.9692ms
2025-02-05 09:02:36.334 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - application/json; charset=utf-8 38
2025-02-05 09:02:36.338 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 09:02:36.338 +03:00 [INF] Route matched with {action = "MasterFetch", controller = "Content"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] MasterFetch(NayifatAPI.Controllers.MasterFetchRequest) on controller NayifatAPI.Controllers.ContentController (NayifatAPI).
2025-02-05 09:02:36.341 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 09:02:36.343 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__request_Page_0='?' (Size = 450), @__request_KeyName_1='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[config_id], [m].[key_name], [m].[last_updated], [m].[page], [m].[value]
FROM [master_config] AS [m]
WHERE [m].[page] = @__request_Page_0 AND [m].[key_name] = @__request_KeyName_1
2025-02-05 09:02:36.345 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 09:02:36.346 +03:00 [INF] Executed action NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI) in 6.076ms
2025-02-05 09:02:36.347 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 09:02:36.347 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - 200 null application/json; charset=utf-8 12.7703ms
2025-02-05 09:02:36.875 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - application/json; charset=utf-8 49
2025-02-05 09:02:36.878 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 09:02:36.879 +03:00 [INF] Route matched with {action = "MasterFetch", controller = "Content"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] MasterFetch(NayifatAPI.Controllers.MasterFetchRequest) on controller NayifatAPI.Controllers.ContentController (NayifatAPI).
2025-02-05 09:02:36.884 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 09:02:36.887 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__request_Page_0='?' (Size = 450), @__request_KeyName_1='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[config_id], [m].[key_name], [m].[last_updated], [m].[page], [m].[value]
FROM [master_config] AS [m]
WHERE [m].[page] = @__request_Page_0 AND [m].[key_name] = @__request_KeyName_1
2025-02-05 09:02:36.890 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 09:02:36.920 +03:00 [INF] Executed action NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI) in 37.5627ms
2025-02-05 09:02:37.003 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 09:02:37.005 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - 200 null application/json; charset=utf-8 130.33ms
2025-02-05 09:02:37.273 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - application/json; charset=utf-8 49
2025-02-05 09:02:37.347 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 09:02:37.530 +03:00 [INF] Route matched with {action = "MasterFetch", controller = "Content"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] MasterFetch(NayifatAPI.Controllers.MasterFetchRequest) on controller NayifatAPI.Controllers.ContentController (NayifatAPI).
2025-02-05 09:02:37.533 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 09:02:37.535 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__request_Page_0='?' (Size = 450), @__request_KeyName_1='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[config_id], [m].[key_name], [m].[last_updated], [m].[page], [m].[value]
FROM [master_config] AS [m]
WHERE [m].[page] = @__request_Page_0 AND [m].[key_name] = @__request_KeyName_1
2025-02-05 09:02:37.543 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 09:02:37.547 +03:00 [INF] Executed action NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI) in 15.735ms
2025-02-05 09:02:37.548 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 09:02:37.549 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - 200 null application/json; charset=utf-8 276.2004ms
2025-02-05 09:02:38.559 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - application/json; charset=utf-8 49
2025-02-05 09:02:38.624 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 09:02:38.625 +03:00 [INF] Route matched with {action = "MasterFetch", controller = "Content"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] MasterFetch(NayifatAPI.Controllers.MasterFetchRequest) on controller NayifatAPI.Controllers.ContentController (NayifatAPI).
2025-02-05 09:02:38.629 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 09:02:38.730 +03:00 [INF] Executed DbCommand (28ms) [Parameters=[@__request_Page_0='?' (Size = 450), @__request_KeyName_1='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[config_id], [m].[key_name], [m].[last_updated], [m].[page], [m].[value]
FROM [master_config] AS [m]
WHERE [m].[page] = @__request_Page_0 AND [m].[key_name] = @__request_KeyName_1
2025-02-05 09:02:38.947 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 09:02:38.949 +03:00 [INF] Executed action NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI) in 321.5476ms
2025-02-05 09:02:38.950 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 09:02:38.950 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - 200 null application/json; charset=utf-8 391.8442ms
2025-02-05 09:02:39.316 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - application/json; charset=utf-8 49
2025-02-05 09:02:39.510 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 09:02:39.511 +03:00 [INF] Route matched with {action = "MasterFetch", controller = "Content"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] MasterFetch(NayifatAPI.Controllers.MasterFetchRequest) on controller NayifatAPI.Controllers.ContentController (NayifatAPI).
2025-02-05 09:02:39.513 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 09:02:39.530 +03:00 [INF] Executed DbCommand (14ms) [Parameters=[@__request_Page_0='?' (Size = 450), @__request_KeyName_1='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[config_id], [m].[key_name], [m].[last_updated], [m].[page], [m].[value]
FROM [master_config] AS [m]
WHERE [m].[page] = @__request_Page_0 AND [m].[key_name] = @__request_KeyName_1
2025-02-05 09:02:39.538 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 09:02:39.539 +03:00 [INF] Executed action NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI) in 26.5269ms
2025-02-05 09:02:39.540 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 09:02:39.542 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - 200 null application/json; charset=utf-8 225.882ms
2025-02-05 09:02:39.898 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - application/json; charset=utf-8 36
2025-02-05 09:02:39.903 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 09:02:39.907 +03:00 [INF] Route matched with {action = "MasterFetch", controller = "Content"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] MasterFetch(NayifatAPI.Controllers.MasterFetchRequest) on controller NayifatAPI.Controllers.ContentController (NayifatAPI).
2025-02-05 09:02:39.914 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 09:02:39.917 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__request_Page_0='?' (Size = 450), @__request_KeyName_1='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[config_id], [m].[key_name], [m].[last_updated], [m].[page], [m].[value]
FROM [master_config] AS [m]
WHERE [m].[page] = @__request_Page_0 AND [m].[key_name] = @__request_KeyName_1
2025-02-05 09:02:39.919 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 09:02:39.920 +03:00 [INF] Executed action NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI) in 9.1768ms
2025-02-05 09:02:39.922 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 09:02:39.923 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - 200 null application/json; charset=utf-8 24.7611ms
2025-02-05 09:02:41.815 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - application/json; charset=utf-8 36
2025-02-05 09:02:41.818 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 09:02:41.820 +03:00 [INF] Route matched with {action = "MasterFetch", controller = "Content"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] MasterFetch(NayifatAPI.Controllers.MasterFetchRequest) on controller NayifatAPI.Controllers.ContentController (NayifatAPI).
2025-02-05 09:02:41.822 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 09:02:41.824 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__request_Page_0='?' (Size = 450), @__request_KeyName_1='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[config_id], [m].[key_name], [m].[last_updated], [m].[page], [m].[value]
FROM [master_config] AS [m]
WHERE [m].[page] = @__request_Page_0 AND [m].[key_name] = @__request_KeyName_1
2025-02-05 09:02:41.826 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 09:02:41.827 +03:00 [INF] Executed action NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI) in 6.5193ms
2025-02-05 09:02:41.828 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 09:02:41.829 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - 200 null application/json; charset=utf-8 14.1265ms
2025-02-05 09:02:47.005 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/auth/signin - application/json; charset=utf-8 78
2025-02-05 09:02:47.008 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.AuthController.SignIn (NayifatAPI)'
2025-02-05 09:02:47.012 +03:00 [INF] Route matched with {action = "SignIn", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] SignIn(NayifatAPI.Controllers.SignInRequest) on controller NayifatAPI.Controllers.AuthController (NayifatAPI).
2025-02-05 09:02:47.024 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 09:02:47.110 +03:00 [INF] Executed DbCommand (78ms) [Parameters=[@__request_NationalId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[NationalId], [c].[AddNo], [c].[BuildingNo], [c].[City], [c].[Consent], [c].[ConsentDate], [c].[DateOfBirth], [c].[Dependents], [c].[District], [c].[Email], [c].[Employer], [c].[FamilyNameAr], [c].[FamilyNameEn], [c].[FirstNameAr], [c].[FirstNameEn], [c].[Iban], [c].[IdExpiryDate], [c].[Los], [c].[Mpin], [c].[MpinEnabled], [c].[NafathStatus], [c].[NafathTimestamp], [c].[Password], [c].[Phone], [c].[RegistrationDate], [c].[SalaryCustomer], [c].[SalaryDakhli], [c].[SecondNameAr], [c].[SecondNameEn], [c].[Sector], [c].[Street], [c].[ThirdNameAr], [c].[ThirdNameEn], [c].[Zipcode]
FROM [Customers] AS [c]
WHERE [c].[NationalId] = @__request_NationalId_0
2025-02-05 09:02:47.114 +03:00 [INF] Starting password verification for NationalId: 1064448614
2025-02-05 09:02:47.505 +03:00 [INF] Password verification result for NationalId 1064448614: Success
2025-02-05 09:02:49.677 +03:00 [INF] Executed DbCommand (2,163ms) [Parameters=[@p0='?' (Size = 4000), @p1='?' (DbType = DateTime2), @p2='?' (Size = 4000), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (Size = 450), @p6='?' (Size = 4000), @p7='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [AuthLogs] ([AuthType], [CreatedAt], [DeviceId], [FailureReason], [IpAddress], [NationalId], [Status], [UserAgent])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7);
2025-02-05 09:02:49.681 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 09:02:49.683 +03:00 [INF] Executed action NayifatAPI.Controllers.AuthController.SignIn (NayifatAPI) in 2670.0766ms
2025-02-05 09:02:49.685 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.AuthController.SignIn (NayifatAPI)'
2025-02-05 09:02:49.686 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/auth/signin - 200 null application/json; charset=utf-8 2681.0166ms
2025-02-05 09:02:50.320 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/proxy/forward?url=https://icreditdept.com/api/testasp/test_local_generate_otp.php - application/json; charset=utf-8 84
2025-02-05 09:02:50.325 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.ProxyController.ForwardRequest (NayifatAPI)'
2025-02-05 09:02:50.347 +03:00 [INF] Route matched with {action = "ForwardRequest", controller = "Proxy"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] ForwardRequest() on controller NayifatAPI.Controllers.ProxyController (NayifatAPI).
2025-02-05 09:02:50.401 +03:00 [INF] Start processing HTTP request POST https://icreditdept.com/api/testasp/test_local_generate_otp.php
2025-02-05 09:02:50.412 +03:00 [INF] Sending HTTP request POST https://icreditdept.com/api/testasp/test_local_generate_otp.php
2025-02-05 09:02:51.366 +03:00 [INF] Received HTTP response headers after 950.082ms - 200
2025-02-05 09:02:51.436 +03:00 [INF] End processing HTTP request after 1037.2707ms - 200
2025-02-05 09:02:51.448 +03:00 [INF] Raw response length: 200
2025-02-05 09:02:51.448 +03:00 [INF] Response content: {"success":true,"errors":[],"result":{"nationalId":"1064448614","otp":129851,"expiryDate":"2025-02-05 09:07:51","successMsg":"Success","errCode":0,"errMsg":null},"type":"N","message":null,"code":null}
2025-02-05 09:02:51.451 +03:00 [INF] Executing ContentResult with HTTP Response ContentType of application/json
2025-02-05 09:02:51.454 +03:00 [INF] Executed action NayifatAPI.Controllers.ProxyController.ForwardRequest (NayifatAPI) in 1077.9945ms
2025-02-05 09:02:51.455 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.ProxyController.ForwardRequest (NayifatAPI)'
2025-02-05 09:02:51.456 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/proxy/forward?url=https://icreditdept.com/api/testasp/test_local_generate_otp.php - 200 200 application/json 1136.5548ms
2025-02-05 09:03:03.817 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/proxy/forward?url=https://icreditdept.com/api/testasp/test_local_verify_otp.php - application/json; charset=utf-8 53
2025-02-05 09:03:03.882 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.ProxyController.ForwardRequest (NayifatAPI)'
2025-02-05 09:03:03.900 +03:00 [INF] Route matched with {action = "ForwardRequest", controller = "Proxy"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] ForwardRequest() on controller NayifatAPI.Controllers.ProxyController (NayifatAPI).
2025-02-05 09:03:03.976 +03:00 [INF] Start processing HTTP request POST https://icreditdept.com/api/testasp/test_local_verify_otp.php
2025-02-05 09:03:03.978 +03:00 [INF] Sending HTTP request POST https://icreditdept.com/api/testasp/test_local_verify_otp.php
2025-02-05 09:03:04.468 +03:00 [INF] Received HTTP response headers after 465.1197ms - 200
2025-02-05 09:03:04.583 +03:00 [INF] End processing HTTP request after 607.1471ms - 200
2025-02-05 09:03:04.683 +03:00 [INF] Raw response length: 202
2025-02-05 09:03:04.684 +03:00 [INF] Response content: {"success":true,"errors":[],"result":{"nationalId":"1064448614","otp":"129851","verifiedFlag":true,"successMsg":"Verified successfully.","errCode":0,"errMsg":null},"type":"N","message":null,"code":null}
2025-02-05 09:03:04.686 +03:00 [INF] Executing ContentResult with HTTP Response ContentType of application/json
2025-02-05 09:03:04.687 +03:00 [INF] Executed action NayifatAPI.Controllers.ProxyController.ForwardRequest (NayifatAPI) in 712.6789ms
2025-02-05 09:03:04.689 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.ProxyController.ForwardRequest (NayifatAPI)'
2025-02-05 09:03:04.690 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/proxy/forward?url=https://icreditdept.com/api/testasp/test_local_verify_otp.php - 200 202 application/json 873.0388ms
2025-02-05 09:03:13.600 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/list - application/json; charset=utf-8 45
2025-02-05 09:03:13.604 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI)'
2025-02-05 09:03:13.605 +03:00 [INF] Route matched with {action = "GetNotifications", controller = "Notifications"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetNotifications(NayifatAPI.Controllers.GetNotificationsRequest) on controller NayifatAPI.Controllers.NotificationsController (NayifatAPI).
2025-02-05 09:03:13.608 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 09:03:13.612 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__request_NationalId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[national_id], [u].[last_updated], [u].[notifications]
FROM [user_notifications] AS [u]
WHERE [u].[national_id] = @__request_NationalId_0
2025-02-05 09:03:13.620 +03:00 [INF] Executed DbCommand (5ms) [Parameters=[@__Parse_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [n].[Id], [n].[additional_data], [n].[Body], [n].[body_ar], [n].[body_en], [n].[created_at], [n].[expiry_at], [n].[Route], [n].[target_criteria], [n].[Title], [n].[title_ar], [n].[title_en]
FROM [notification_templates] AS [n]
WHERE [n].[Id] = @__Parse_0
2025-02-05 09:03:13.623 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__Parse_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [n].[Id], [n].[additional_data], [n].[Body], [n].[body_ar], [n].[body_en], [n].[created_at], [n].[expiry_at], [n].[Route], [n].[target_criteria], [n].[Title], [n].[title_ar], [n].[title_en]
FROM [notification_templates] AS [n]
WHERE [n].[Id] = @__Parse_0
2025-02-05 09:03:13.698 +03:00 [INF] Executed DbCommand (73ms) [Parameters=[@p0='?' (Size = 4000), @p1='?' (DbType = DateTime2), @p2='?' (Size = 4000), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (Size = 450), @p6='?' (Size = 4000), @p7='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [AuthLogs] ([AuthType], [CreatedAt], [DeviceId], [FailureReason], [IpAddress], [NationalId], [Status], [UserAgent])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7);
2025-02-05 09:03:13.717 +03:00 [INF] Executed DbCommand (8ms) [Parameters=[@p0='?' (Size = 4000), @p1='?' (DbType = DateTime2), @p2='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
UPDATE user_notifications SET notifications = @p0, last_updated = @p1 WHERE national_id = @p2
2025-02-05 09:03:13.721 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@p0='?' (Size = 4000), @p1='?' (DbType = DateTime2), @p2='?' (Size = 4000), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (Size = 450), @p6='?' (Size = 4000), @p7='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [AuthLogs] ([AuthType], [CreatedAt], [DeviceId], [FailureReason], [IpAddress], [NationalId], [Status], [UserAgent])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7);
2025-02-05 09:03:13.723 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 09:03:13.724 +03:00 [INF] Executed action NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI) in 117.5313ms
2025-02-05 09:03:13.725 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI)'
2025-02-05 09:03:13.726 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/list - 200 null application/json; charset=utf-8 125.3554ms
2025-02-05 09:03:14.011 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/list - application/json; charset=utf-8 39
2025-02-05 09:03:14.016 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI)'
2025-02-05 09:03:14.016 +03:00 [INF] Route matched with {action = "GetNotifications", controller = "Notifications"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetNotifications(NayifatAPI.Controllers.GetNotificationsRequest) on controller NayifatAPI.Controllers.NotificationsController (NayifatAPI).
2025-02-05 09:03:14.020 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 09:03:14.023 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__request_NationalId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[national_id], [u].[last_updated], [u].[notifications]
FROM [user_notifications] AS [u]
WHERE [u].[national_id] = @__request_NationalId_0
2025-02-05 09:03:14.029 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__Parse_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [n].[Id], [n].[additional_data], [n].[Body], [n].[body_ar], [n].[body_en], [n].[created_at], [n].[expiry_at], [n].[Route], [n].[target_criteria], [n].[Title], [n].[title_ar], [n].[title_en]
FROM [notification_templates] AS [n]
WHERE [n].[Id] = @__Parse_0
2025-02-05 09:03:14.034 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__Parse_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [n].[Id], [n].[additional_data], [n].[Body], [n].[body_ar], [n].[body_en], [n].[created_at], [n].[expiry_at], [n].[Route], [n].[target_criteria], [n].[Title], [n].[title_ar], [n].[title_en]
FROM [notification_templates] AS [n]
WHERE [n].[Id] = @__Parse_0
2025-02-05 09:03:14.037 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__Parse_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [n].[Id], [n].[additional_data], [n].[Body], [n].[body_ar], [n].[body_en], [n].[created_at], [n].[expiry_at], [n].[Route], [n].[target_criteria], [n].[Title], [n].[title_ar], [n].[title_en]
FROM [notification_templates] AS [n]
WHERE [n].[Id] = @__Parse_0
2025-02-05 09:03:14.041 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__Parse_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [n].[Id], [n].[additional_data], [n].[Body], [n].[body_ar], [n].[body_en], [n].[created_at], [n].[expiry_at], [n].[Route], [n].[target_criteria], [n].[Title], [n].[title_ar], [n].[title_en]
FROM [notification_templates] AS [n]
WHERE [n].[Id] = @__Parse_0
2025-02-05 09:03:14.046 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@p0='?' (Size = 4000), @p1='?' (DbType = DateTime2), @p2='?' (Size = 4000), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (Size = 450), @p6='?' (Size = 4000), @p7='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [AuthLogs] ([AuthType], [CreatedAt], [DeviceId], [FailureReason], [IpAddress], [NationalId], [Status], [UserAgent])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7);
2025-02-05 09:03:14.051 +03:00 [ERR] An exception occurred in the database while saving changes for context type 'NayifatAPI.Data.ApplicationDbContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_AuthLogs_Customers_NationalId". The conflict occurred in database "NayifatApp", table "dbo.Customers", column 'NationalId'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:235a0498-9d69-4961-ad89-57970fa6ec67
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_AuthLogs_Customers_NationalId". The conflict occurred in database "NayifatApp", table "dbo.Customers", column 'NationalId'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:235a0498-9d69-4961-ad89-57970fa6ec67
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2025-02-05 09:03:14.064 +03:00 [ERR] Error logging audit event. NationalId: all, Action: notification_delivered, Details: {"notification_count":4,"notification_ids":[20,19,18,12],"timestamp":"2025-02-05T09:03:14.0278248"}
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_AuthLogs_Customers_NationalId". The conflict occurred in database "NayifatApp", table "dbo.Customers", column 'NationalId'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:235a0498-9d69-4961-ad89-57970fa6ec67
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at NayifatAPI.Services.AuditLogService.LogAsync(String nationalId, String action, Object details) in C:\Users\yamta\StudioProjects\nayifat_app_2025_new\nayifatapi\Services\AuditLogService.cs:line 36
2025-02-05 09:03:14.074 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 09:03:14.075 +03:00 [INF] Executed action NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI) in 56.6384ms
2025-02-05 09:03:14.077 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI)'
2025-02-05 09:03:14.078 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/list - 200 null application/json; charset=utf-8 66.8747ms
2025-02-05 09:03:30.645 +03:00 [INF] Application is shutting down...
2025-02-05 09:03:58.328 +03:00 [INF] Starting web application
2025-02-05 09:03:59.021 +03:00 [INF] Now listening on: http://localhost:5264
2025-02-05 09:03:59.755 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2025-02-05 09:03:59.784 +03:00 [INF] Hosting environment: Development
2025-02-05 09:03:59.818 +03:00 [INF] Content root path: C:\Users\yamta\StudioProjects\nayifat_app_2025_new\nayifatapi
2025-02-05 09:04:43.598 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/list - application/json; charset=utf-8 45
2025-02-05 09:04:43.655 +03:00 [WRN] Failed to determine the https port for redirect.
2025-02-05 09:04:43.659 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI)'
2025-02-05 09:04:43.682 +03:00 [INF] Route matched with {action = "GetNotifications", controller = "Notifications"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetNotifications(NayifatAPI.Controllers.GetNotificationsRequest) on controller NayifatAPI.Controllers.NotificationsController (NayifatAPI).
2025-02-05 09:04:45.291 +03:00 [INF] Executed DbCommand (26ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 09:04:45.451 +03:00 [INF] Executed DbCommand (20ms) [Parameters=[@__request_NationalId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[national_id], [u].[last_updated], [u].[notifications]
FROM [user_notifications] AS [u]
WHERE [u].[national_id] = @__request_NationalId_0
2025-02-05 09:04:45.511 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 09:04:45.526 +03:00 [INF] Executed action NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI) in 1837.9339ms
2025-02-05 09:04:45.529 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI)'
2025-02-05 09:04:45.540 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/list - 200 null application/json; charset=utf-8 1943.81ms
2025-02-05 09:04:45.887 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/list - application/json; charset=utf-8 39
2025-02-05 09:04:45.895 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI)'
2025-02-05 09:04:45.897 +03:00 [INF] Route matched with {action = "GetNotifications", controller = "Notifications"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetNotifications(NayifatAPI.Controllers.GetNotificationsRequest) on controller NayifatAPI.Controllers.NotificationsController (NayifatAPI).
2025-02-05 09:04:45.927 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 09:04:45.936 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__request_NationalId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[national_id], [u].[last_updated], [u].[notifications]
FROM [user_notifications] AS [u]
WHERE [u].[national_id] = @__request_NationalId_0
2025-02-05 09:04:45.957 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[@__Parse_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [n].[Id], [n].[additional_data], [n].[Body], [n].[body_ar], [n].[body_en], [n].[created_at], [n].[expiry_at], [n].[Route], [n].[target_criteria], [n].[Title], [n].[title_ar], [n].[title_en]
FROM [notification_templates] AS [n]
WHERE [n].[Id] = @__Parse_0
2025-02-05 09:04:46.000 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__Parse_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [n].[Id], [n].[additional_data], [n].[Body], [n].[body_ar], [n].[body_en], [n].[created_at], [n].[expiry_at], [n].[Route], [n].[target_criteria], [n].[Title], [n].[title_ar], [n].[title_en]
FROM [notification_templates] AS [n]
WHERE [n].[Id] = @__Parse_0
2025-02-05 09:04:46.004 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__Parse_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [n].[Id], [n].[additional_data], [n].[Body], [n].[body_ar], [n].[body_en], [n].[created_at], [n].[expiry_at], [n].[Route], [n].[target_criteria], [n].[Title], [n].[title_ar], [n].[title_en]
FROM [notification_templates] AS [n]
WHERE [n].[Id] = @__Parse_0
2025-02-05 09:04:46.010 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__Parse_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [n].[Id], [n].[additional_data], [n].[Body], [n].[body_ar], [n].[body_en], [n].[created_at], [n].[expiry_at], [n].[Route], [n].[target_criteria], [n].[Title], [n].[title_ar], [n].[title_en]
FROM [notification_templates] AS [n]
WHERE [n].[Id] = @__Parse_0
2025-02-05 09:04:46.240 +03:00 [INF] Executed DbCommand (6ms) [Parameters=[@p0='?' (Size = 4000), @p1='?' (DbType = DateTime2), @p2='?' (Size = 4000), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (Size = 450), @p6='?' (Size = 4000), @p7='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [AuthLogs] ([AuthType], [CreatedAt], [DeviceId], [FailureReason], [IpAddress], [NationalId], [Status], [UserAgent])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7);
2025-02-05 09:04:46.283 +03:00 [ERR] An exception occurred in the database while saving changes for context type 'NayifatAPI.Data.ApplicationDbContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_AuthLogs_Customers_NationalId". The conflict occurred in database "NayifatApp", table "dbo.Customers", column 'NationalId'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:b6270b92-44b6-402b-a7bc-ce23f62f08fd
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_AuthLogs_Customers_NationalId". The conflict occurred in database "NayifatApp", table "dbo.Customers", column 'NationalId'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:b6270b92-44b6-402b-a7bc-ce23f62f08fd
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2025-02-05 09:04:46.322 +03:00 [ERR] Error logging audit event. NationalId: all, Action: notification_delivered, Details: {"notification_count":4,"notification_ids":[20,19,18,12],"timestamp":"2025-02-05T09:04:45.9415892"}
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_AuthLogs_Customers_NationalId". The conflict occurred in database "NayifatApp", table "dbo.Customers", column 'NationalId'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:b6270b92-44b6-402b-a7bc-ce23f62f08fd
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at NayifatAPI.Services.AuditLogService.LogAsync(String nationalId, String action, Object details) in C:\Users\yamta\StudioProjects\nayifat_app_2025_new\nayifatapi\Services\AuditLogService.cs:line 36
2025-02-05 09:04:46.350 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 09:04:46.356 +03:00 [INF] Executed action NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI) in 456.9984ms
2025-02-05 09:04:46.358 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI)'
2025-02-05 09:04:46.361 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/list - 200 null application/json; charset=utf-8 472.9454ms
2025-02-05 09:05:19.548 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/list - application/json; charset=utf-8 45
2025-02-05 09:05:19.554 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI)'
2025-02-05 09:05:19.556 +03:00 [INF] Route matched with {action = "GetNotifications", controller = "Notifications"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetNotifications(NayifatAPI.Controllers.GetNotificationsRequest) on controller NayifatAPI.Controllers.NotificationsController (NayifatAPI).
2025-02-05 09:05:19.629 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 09:05:19.634 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__request_NationalId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[national_id], [u].[last_updated], [u].[notifications]
FROM [user_notifications] AS [u]
WHERE [u].[national_id] = @__request_NationalId_0
2025-02-05 09:05:19.637 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 09:05:19.640 +03:00 [INF] Executed action NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI) in 82.5067ms
2025-02-05 09:05:19.642 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI)'
2025-02-05 09:05:19.644 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/list - 200 null application/json; charset=utf-8 96.1649ms
2025-02-05 09:05:19.932 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/list - application/json; charset=utf-8 39
2025-02-05 09:05:19.936 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI)'
2025-02-05 09:05:19.937 +03:00 [INF] Route matched with {action = "GetNotifications", controller = "Notifications"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetNotifications(NayifatAPI.Controllers.GetNotificationsRequest) on controller NayifatAPI.Controllers.NotificationsController (NayifatAPI).
2025-02-05 09:05:19.942 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 09:05:19.947 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__request_NationalId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[national_id], [u].[last_updated], [u].[notifications]
FROM [user_notifications] AS [u]
WHERE [u].[national_id] = @__request_NationalId_0
2025-02-05 09:05:19.952 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__Parse_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [n].[Id], [n].[additional_data], [n].[Body], [n].[body_ar], [n].[body_en], [n].[created_at], [n].[expiry_at], [n].[Route], [n].[target_criteria], [n].[Title], [n].[title_ar], [n].[title_en]
FROM [notification_templates] AS [n]
WHERE [n].[Id] = @__Parse_0
2025-02-05 09:05:19.957 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__Parse_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [n].[Id], [n].[additional_data], [n].[Body], [n].[body_ar], [n].[body_en], [n].[created_at], [n].[expiry_at], [n].[Route], [n].[target_criteria], [n].[Title], [n].[title_ar], [n].[title_en]
FROM [notification_templates] AS [n]
WHERE [n].[Id] = @__Parse_0
2025-02-05 09:05:19.961 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__Parse_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [n].[Id], [n].[additional_data], [n].[Body], [n].[body_ar], [n].[body_en], [n].[created_at], [n].[expiry_at], [n].[Route], [n].[target_criteria], [n].[Title], [n].[title_ar], [n].[title_en]
FROM [notification_templates] AS [n]
WHERE [n].[Id] = @__Parse_0
2025-02-05 09:05:19.965 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__Parse_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [n].[Id], [n].[additional_data], [n].[Body], [n].[body_ar], [n].[body_en], [n].[created_at], [n].[expiry_at], [n].[Route], [n].[target_criteria], [n].[Title], [n].[title_ar], [n].[title_en]
FROM [notification_templates] AS [n]
WHERE [n].[Id] = @__Parse_0
2025-02-05 09:05:19.971 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@p0='?' (Size = 4000), @p1='?' (DbType = DateTime2), @p2='?' (Size = 4000), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (Size = 450), @p6='?' (Size = 4000), @p7='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [AuthLogs] ([AuthType], [CreatedAt], [DeviceId], [FailureReason], [IpAddress], [NationalId], [Status], [UserAgent])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7);
2025-02-05 09:05:19.976 +03:00 [ERR] An exception occurred in the database while saving changes for context type 'NayifatAPI.Data.ApplicationDbContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_AuthLogs_Customers_NationalId". The conflict occurred in database "NayifatApp", table "dbo.Customers", column 'NationalId'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:b6270b92-44b6-402b-a7bc-ce23f62f08fd
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_AuthLogs_Customers_NationalId". The conflict occurred in database "NayifatApp", table "dbo.Customers", column 'NationalId'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:b6270b92-44b6-402b-a7bc-ce23f62f08fd
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2025-02-05 09:05:19.988 +03:00 [ERR] Error logging audit event. NationalId: all, Action: notification_delivered, Details: {"notification_count":4,"notification_ids":[20,19,18,12],"timestamp":"2025-02-05T09:05:19.9506051"}
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_AuthLogs_Customers_NationalId". The conflict occurred in database "NayifatApp", table "dbo.Customers", column 'NationalId'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:b6270b92-44b6-402b-a7bc-ce23f62f08fd
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at NayifatAPI.Services.AuditLogService.LogAsync(String nationalId, String action, Object details) in C:\Users\yamta\StudioProjects\nayifat_app_2025_new\nayifatapi\Services\AuditLogService.cs:line 36
2025-02-05 09:05:19.998 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 09:05:19.999 +03:00 [INF] Executed action NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI) in 59.5515ms
2025-02-05 09:05:20.000 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI)'
2025-02-05 09:05:20.002 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/list - 200 null application/json; charset=utf-8 70.3542ms
2025-02-05 09:05:32.476 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/list - application/json; charset=utf-8 45
2025-02-05 09:05:32.480 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI)'
2025-02-05 09:05:32.481 +03:00 [INF] Route matched with {action = "GetNotifications", controller = "Notifications"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetNotifications(NayifatAPI.Controllers.GetNotificationsRequest) on controller NayifatAPI.Controllers.NotificationsController (NayifatAPI).
2025-02-05 09:05:32.485 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 09:05:32.490 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__request_NationalId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[national_id], [u].[last_updated], [u].[notifications]
FROM [user_notifications] AS [u]
WHERE [u].[national_id] = @__request_NationalId_0
2025-02-05 09:05:32.492 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 09:05:32.493 +03:00 [INF] Executed action NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI) in 10.703ms
2025-02-05 09:05:32.494 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI)'
2025-02-05 09:05:32.496 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/list - 200 null application/json; charset=utf-8 20.325ms
2025-02-05 09:05:32.972 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/list - application/json; charset=utf-8 39
2025-02-05 09:05:32.975 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI)'
2025-02-05 09:05:32.976 +03:00 [INF] Route matched with {action = "GetNotifications", controller = "Notifications"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetNotifications(NayifatAPI.Controllers.GetNotificationsRequest) on controller NayifatAPI.Controllers.NotificationsController (NayifatAPI).
2025-02-05 09:05:32.980 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 09:05:32.983 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__request_NationalId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[national_id], [u].[last_updated], [u].[notifications]
FROM [user_notifications] AS [u]
WHERE [u].[national_id] = @__request_NationalId_0
2025-02-05 09:05:32.990 +03:00 [INF] Executed DbCommand (4ms) [Parameters=[@__Parse_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [n].[Id], [n].[additional_data], [n].[Body], [n].[body_ar], [n].[body_en], [n].[created_at], [n].[expiry_at], [n].[Route], [n].[target_criteria], [n].[Title], [n].[title_ar], [n].[title_en]
FROM [notification_templates] AS [n]
WHERE [n].[Id] = @__Parse_0
2025-02-05 09:05:32.993 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__Parse_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [n].[Id], [n].[additional_data], [n].[Body], [n].[body_ar], [n].[body_en], [n].[created_at], [n].[expiry_at], [n].[Route], [n].[target_criteria], [n].[Title], [n].[title_ar], [n].[title_en]
FROM [notification_templates] AS [n]
WHERE [n].[Id] = @__Parse_0
2025-02-05 09:05:32.996 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__Parse_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [n].[Id], [n].[additional_data], [n].[Body], [n].[body_ar], [n].[body_en], [n].[created_at], [n].[expiry_at], [n].[Route], [n].[target_criteria], [n].[Title], [n].[title_ar], [n].[title_en]
FROM [notification_templates] AS [n]
WHERE [n].[Id] = @__Parse_0
2025-02-05 09:05:32.999 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__Parse_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [n].[Id], [n].[additional_data], [n].[Body], [n].[body_ar], [n].[body_en], [n].[created_at], [n].[expiry_at], [n].[Route], [n].[target_criteria], [n].[Title], [n].[title_ar], [n].[title_en]
FROM [notification_templates] AS [n]
WHERE [n].[Id] = @__Parse_0
2025-02-05 09:05:33.006 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[@p0='?' (Size = 4000), @p1='?' (DbType = DateTime2), @p2='?' (Size = 4000), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (Size = 450), @p6='?' (Size = 4000), @p7='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [AuthLogs] ([AuthType], [CreatedAt], [DeviceId], [FailureReason], [IpAddress], [NationalId], [Status], [UserAgent])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7);
2025-02-05 09:05:33.009 +03:00 [ERR] An exception occurred in the database while saving changes for context type 'NayifatAPI.Data.ApplicationDbContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_AuthLogs_Customers_NationalId". The conflict occurred in database "NayifatApp", table "dbo.Customers", column 'NationalId'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:b6270b92-44b6-402b-a7bc-ce23f62f08fd
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_AuthLogs_Customers_NationalId". The conflict occurred in database "NayifatApp", table "dbo.Customers", column 'NationalId'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:b6270b92-44b6-402b-a7bc-ce23f62f08fd
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2025-02-05 09:05:33.022 +03:00 [ERR] Error logging audit event. NationalId: all, Action: notification_delivered, Details: {"notification_count":4,"notification_ids":[20,19,18,12],"timestamp":"2025-02-05T09:05:32.9864684"}
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_AuthLogs_Customers_NationalId". The conflict occurred in database "NayifatApp", table "dbo.Customers", column 'NationalId'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:b6270b92-44b6-402b-a7bc-ce23f62f08fd
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at NayifatAPI.Services.AuditLogService.LogAsync(String nationalId, String action, Object details) in C:\Users\yamta\StudioProjects\nayifat_app_2025_new\nayifatapi\Services\AuditLogService.cs:line 36
2025-02-05 09:05:33.029 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 09:05:33.030 +03:00 [INF] Executed action NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI) in 52.2942ms
2025-02-05 09:05:33.031 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI)'
2025-02-05 09:05:33.033 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/list - 200 null application/json; charset=utf-8 60.5001ms
2025-02-05 09:08:15.868 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/list - application/json; charset=utf-8 45
2025-02-05 09:08:15.870 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI)'
2025-02-05 09:08:15.871 +03:00 [INF] Route matched with {action = "GetNotifications", controller = "Notifications"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetNotifications(NayifatAPI.Controllers.GetNotificationsRequest) on controller NayifatAPI.Controllers.NotificationsController (NayifatAPI).
2025-02-05 09:08:15.879 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 09:08:15.884 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__request_NationalId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[national_id], [u].[last_updated], [u].[notifications]
FROM [user_notifications] AS [u]
WHERE [u].[national_id] = @__request_NationalId_0
2025-02-05 09:08:15.887 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 09:08:15.889 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/timestamps - application/json; charset=utf-8 2
2025-02-05 09:08:15.889 +03:00 [INF] Executed action NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI) in 15.1818ms
2025-02-05 09:08:15.892 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.ContentController.GetTimestamps (NayifatAPI)'
2025-02-05 09:08:15.894 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI)'
2025-02-05 09:08:15.896 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/list - 200 null application/json; charset=utf-8 28.3675ms
2025-02-05 09:08:15.900 +03:00 [INF] Route matched with {action = "GetTimestamps", controller = "Content"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetTimestamps() on controller NayifatAPI.Controllers.ContentController (NayifatAPI).
2025-02-05 09:08:15.905 +03:00 [INF] TTT_
2025-02-05 09:08:15.905 +03:00 [INF] TTT_=== Getting Content Timestamps ===
2025-02-05 09:08:15.907 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 09:08:15.909 +03:00 [INF] TTT_Fetching timestamps from database
2025-02-05 09:08:15.929 +03:00 [INF] Executed DbCommand (8ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [m].[page] AS [Page], [m].[key_name] AS [KeyName], [m].[last_updated] AS [LastUpdated]
FROM [master_config] AS [m]
2025-02-05 09:08:15.932 +03:00 [INF] TTT_Found 18 content items
2025-02-05 09:08:15.940 +03:00 [INF] TTT_Page: home
2025-02-05 09:08:15.942 +03:00 [INF] TTT_  - slideshow_content: "2025-02-04T10:01:06.9430000"
2025-02-05 09:08:15.943 +03:00 [INF] TTT_  - slideshow_content_ar: "2025-02-04T10:01:06.9430000"
2025-02-05 09:08:15.945 +03:00 [INF] TTT_  - contact_details: "2025-02-04T10:01:06.9430000"
2025-02-05 09:08:15.947 +03:00 [INF] TTT_  - contact_details_ar: "2025-02-04T10:01:06.9430000"
2025-02-05 09:08:15.948 +03:00 [INF] TTT_  - termsEN1: "2025-02-03T14:23:58.0000000"
2025-02-05 09:08:15.949 +03:00 [INF] TTT_  - termsEN2: "2025-02-03T14:25:20.1730000"
2025-02-05 09:08:15.951 +03:00 [INF] TTT_  - privacyEN1: "2025-02-03T14:26:08.6130000"
2025-02-05 09:08:15.952 +03:00 [INF] TTT_  - privacyEN2: "2025-02-03T14:25:20.1730000"
2025-02-05 09:08:15.953 +03:00 [INF] TTT_  - termsAR1: "2025-02-03T14:23:58.0000000"
2025-02-05 09:08:15.954 +03:00 [INF] TTT_  - termsAR2: "2025-02-03T14:25:20.1730000"
2025-02-05 09:08:15.955 +03:00 [INF] TTT_  - privacyAR1: "2025-02-03T14:26:08.6130000"
2025-02-05 09:08:15.956 +03:00 [INF] TTT_  - privacyAR2: "2025-02-03T14:25:20.1730000"
2025-02-05 09:08:15.957 +03:00 [INF] TTT_  - terms&conditionsCC_AR: "2025-02-03T17:06:57.7700000"
2025-02-05 09:08:15.959 +03:00 [INF] TTT_  - terms&conditionsCC_EN: "2025-02-03T17:07:47.4900000"
2025-02-05 09:08:15.960 +03:00 [INF] TTT_  - terms&conditionsPF_AR: "2025-02-03T17:06:57.7700000"
2025-02-05 09:08:15.962 +03:00 [INF] TTT_  - terms&conditionsPF_EN: "2025-02-03T17:06:57.7700000"
2025-02-05 09:08:15.964 +03:00 [INF] TTT_Page: loans
2025-02-05 09:08:15.965 +03:00 [INF] TTT_  - loan_ad: "2025-02-04T10:01:06.9430000"
2025-02-05 09:08:15.966 +03:00 [INF] TTT_Page: cards
2025-02-05 09:08:15.967 +03:00 [INF] TTT_  - card_ad: "2025-02-04T10:01:06.9430000"
2025-02-05 09:08:15.967 +03:00 [INF] TTT_Successfully retrieved all timestamps
2025-02-05 09:08:15.968 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 09:08:15.976 +03:00 [INF] Executed action NayifatAPI.Controllers.ContentController.GetTimestamps (NayifatAPI) in 74.1753ms
2025-02-05 09:08:15.977 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.ContentController.GetTimestamps (NayifatAPI)'
2025-02-05 09:08:15.979 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/timestamps - 200 null application/json; charset=utf-8 89.8226ms
2025-02-05 09:08:16.194 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/list - application/json; charset=utf-8 39
2025-02-05 09:08:16.197 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI)'
2025-02-05 09:08:16.199 +03:00 [INF] Route matched with {action = "GetNotifications", controller = "Notifications"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetNotifications(NayifatAPI.Controllers.GetNotificationsRequest) on controller NayifatAPI.Controllers.NotificationsController (NayifatAPI).
2025-02-05 09:08:16.202 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 09:08:16.207 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__request_NationalId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[national_id], [u].[last_updated], [u].[notifications]
FROM [user_notifications] AS [u]
WHERE [u].[national_id] = @__request_NationalId_0
2025-02-05 09:08:16.219 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__Parse_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [n].[Id], [n].[additional_data], [n].[Body], [n].[body_ar], [n].[body_en], [n].[created_at], [n].[expiry_at], [n].[Route], [n].[target_criteria], [n].[Title], [n].[title_ar], [n].[title_en]
FROM [notification_templates] AS [n]
WHERE [n].[Id] = @__Parse_0
2025-02-05 09:08:16.222 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__Parse_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [n].[Id], [n].[additional_data], [n].[Body], [n].[body_ar], [n].[body_en], [n].[created_at], [n].[expiry_at], [n].[Route], [n].[target_criteria], [n].[Title], [n].[title_ar], [n].[title_en]
FROM [notification_templates] AS [n]
WHERE [n].[Id] = @__Parse_0
2025-02-05 09:08:16.225 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__Parse_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [n].[Id], [n].[additional_data], [n].[Body], [n].[body_ar], [n].[body_en], [n].[created_at], [n].[expiry_at], [n].[Route], [n].[target_criteria], [n].[Title], [n].[title_ar], [n].[title_en]
FROM [notification_templates] AS [n]
WHERE [n].[Id] = @__Parse_0
2025-02-05 09:08:16.230 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__Parse_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [n].[Id], [n].[additional_data], [n].[Body], [n].[body_ar], [n].[body_en], [n].[created_at], [n].[expiry_at], [n].[Route], [n].[target_criteria], [n].[Title], [n].[title_ar], [n].[title_en]
FROM [notification_templates] AS [n]
WHERE [n].[Id] = @__Parse_0
2025-02-05 09:08:16.238 +03:00 [INF] Executed DbCommand (5ms) [Parameters=[@p0='?' (Size = 4000), @p1='?' (DbType = DateTime2), @p2='?' (Size = 4000), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (Size = 450), @p6='?' (Size = 4000), @p7='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [AuthLogs] ([AuthType], [CreatedAt], [DeviceId], [FailureReason], [IpAddress], [NationalId], [Status], [UserAgent])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7);
2025-02-05 09:08:16.241 +03:00 [ERR] An exception occurred in the database while saving changes for context type 'NayifatAPI.Data.ApplicationDbContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_AuthLogs_Customers_NationalId". The conflict occurred in database "NayifatApp", table "dbo.Customers", column 'NationalId'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:b6270b92-44b6-402b-a7bc-ce23f62f08fd
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_AuthLogs_Customers_NationalId". The conflict occurred in database "NayifatApp", table "dbo.Customers", column 'NationalId'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:b6270b92-44b6-402b-a7bc-ce23f62f08fd
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2025-02-05 09:08:16.257 +03:00 [ERR] Error logging audit event. NationalId: all, Action: notification_delivered, Details: {"notification_count":4,"notification_ids":[20,19,18,12],"timestamp":"2025-02-05T09:08:16.2167906"}
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_AuthLogs_Customers_NationalId". The conflict occurred in database "NayifatApp", table "dbo.Customers", column 'NationalId'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:b6270b92-44b6-402b-a7bc-ce23f62f08fd
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at NayifatAPI.Services.AuditLogService.LogAsync(String nationalId, String action, Object details) in C:\Users\yamta\StudioProjects\nayifat_app_2025_new\nayifatapi\Services\AuditLogService.cs:line 36
2025-02-05 09:08:16.270 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 09:08:16.272 +03:00 [INF] Executed action NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI) in 71.8215ms
2025-02-05 09:08:16.274 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI)'
2025-02-05 09:08:16.276 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/list - 200 null application/json; charset=utf-8 81.9469ms
2025-02-05 09:08:16.296 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - application/json; charset=utf-8 45
2025-02-05 09:08:16.302 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 09:08:16.306 +03:00 [INF] Route matched with {action = "MasterFetch", controller = "Content"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] MasterFetch(NayifatAPI.Controllers.MasterFetchRequest) on controller NayifatAPI.Controllers.ContentController (NayifatAPI).
2025-02-05 09:08:16.315 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 09:08:16.335 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__request_Page_0='?' (Size = 450), @__request_KeyName_1='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[config_id], [m].[key_name], [m].[last_updated], [m].[page], [m].[value]
FROM [master_config] AS [m]
WHERE [m].[page] = @__request_Page_0 AND [m].[key_name] = @__request_KeyName_1
2025-02-05 09:08:16.364 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 09:08:16.368 +03:00 [INF] Executed action NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI) in 60.0048ms
2025-02-05 09:08:16.371 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 09:08:16.373 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - 200 null application/json; charset=utf-8 76.9177ms
2025-02-05 09:08:18.410 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/timestamps - application/json; charset=utf-8 2
2025-02-05 09:08:18.414 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.ContentController.GetTimestamps (NayifatAPI)'
2025-02-05 09:08:18.414 +03:00 [INF] Route matched with {action = "GetTimestamps", controller = "Content"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetTimestamps() on controller NayifatAPI.Controllers.ContentController (NayifatAPI).
2025-02-05 09:08:18.416 +03:00 [INF] TTT_
2025-02-05 09:08:18.416 +03:00 [INF] TTT_=== Getting Content Timestamps ===
2025-02-05 09:08:18.419 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 09:08:18.421 +03:00 [INF] TTT_Fetching timestamps from database
2025-02-05 09:08:18.424 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [m].[page] AS [Page], [m].[key_name] AS [KeyName], [m].[last_updated] AS [LastUpdated]
FROM [master_config] AS [m]
2025-02-05 09:08:18.428 +03:00 [INF] TTT_Found 18 content items
2025-02-05 09:08:18.429 +03:00 [INF] TTT_Page: home
2025-02-05 09:08:18.430 +03:00 [INF] TTT_  - slideshow_content: "2025-02-04T10:01:06.9430000"
2025-02-05 09:08:18.432 +03:00 [INF] TTT_  - slideshow_content_ar: "2025-02-04T10:01:06.9430000"
2025-02-05 09:08:18.433 +03:00 [INF] TTT_  - contact_details: "2025-02-04T10:01:06.9430000"
2025-02-05 09:08:18.434 +03:00 [INF] TTT_  - contact_details_ar: "2025-02-04T10:01:06.9430000"
2025-02-05 09:08:18.435 +03:00 [INF] TTT_  - termsEN1: "2025-02-03T14:23:58.0000000"
2025-02-05 09:08:18.436 +03:00 [INF] TTT_  - termsEN2: "2025-02-03T14:25:20.1730000"
2025-02-05 09:08:18.437 +03:00 [INF] TTT_  - privacyEN1: "2025-02-03T14:26:08.6130000"
2025-02-05 09:08:18.437 +03:00 [INF] TTT_  - privacyEN2: "2025-02-03T14:25:20.1730000"
2025-02-05 09:08:18.438 +03:00 [INF] TTT_  - termsAR1: "2025-02-03T14:23:58.0000000"
2025-02-05 09:08:18.439 +03:00 [INF] TTT_  - termsAR2: "2025-02-03T14:25:20.1730000"
2025-02-05 09:08:18.440 +03:00 [INF] TTT_  - privacyAR1: "2025-02-03T14:26:08.6130000"
2025-02-05 09:08:18.440 +03:00 [INF] TTT_  - privacyAR2: "2025-02-03T14:25:20.1730000"
2025-02-05 09:08:18.442 +03:00 [INF] TTT_  - terms&conditionsCC_AR: "2025-02-03T17:06:57.7700000"
2025-02-05 09:08:18.442 +03:00 [INF] TTT_  - terms&conditionsCC_EN: "2025-02-03T17:07:47.4900000"
2025-02-05 09:08:18.444 +03:00 [INF] TTT_  - terms&conditionsPF_AR: "2025-02-03T17:06:57.7700000"
2025-02-05 09:08:18.445 +03:00 [INF] TTT_  - terms&conditionsPF_EN: "2025-02-03T17:06:57.7700000"
2025-02-05 09:08:18.446 +03:00 [INF] TTT_Page: loans
2025-02-05 09:08:18.447 +03:00 [INF] TTT_  - loan_ad: "2025-02-04T10:01:06.9430000"
2025-02-05 09:08:18.448 +03:00 [INF] TTT_Page: cards
2025-02-05 09:08:18.449 +03:00 [INF] TTT_  - card_ad: "2025-02-04T10:01:06.9430000"
2025-02-05 09:08:18.449 +03:00 [INF] TTT_Successfully retrieved all timestamps
2025-02-05 09:08:18.450 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 09:08:18.451 +03:00 [INF] Executed action NayifatAPI.Controllers.ContentController.GetTimestamps (NayifatAPI) in 35.5403ms
2025-02-05 09:08:18.452 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.ContentController.GetTimestamps (NayifatAPI)'
2025-02-05 09:08:18.453 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/timestamps - 200 null application/json; charset=utf-8 43.2491ms
2025-02-05 09:08:19.027 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - application/json; charset=utf-8 45
2025-02-05 09:08:19.103 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 09:08:19.105 +03:00 [INF] Route matched with {action = "MasterFetch", controller = "Content"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] MasterFetch(NayifatAPI.Controllers.MasterFetchRequest) on controller NayifatAPI.Controllers.ContentController (NayifatAPI).
2025-02-05 09:08:19.109 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 09:08:19.113 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__request_Page_0='?' (Size = 450), @__request_KeyName_1='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[config_id], [m].[key_name], [m].[last_updated], [m].[page], [m].[value]
FROM [master_config] AS [m]
WHERE [m].[page] = @__request_Page_0 AND [m].[key_name] = @__request_KeyName_1
2025-02-05 09:08:19.117 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 09:08:19.119 +03:00 [INF] Executed action NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI) in 12.7637ms
2025-02-05 09:08:19.121 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 09:08:19.122 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - 200 null application/json; charset=utf-8 95.6924ms
2025-02-05 09:08:19.903 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - application/json; charset=utf-8 48
2025-02-05 09:08:20.087 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 09:08:20.088 +03:00 [INF] Route matched with {action = "MasterFetch", controller = "Content"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] MasterFetch(NayifatAPI.Controllers.MasterFetchRequest) on controller NayifatAPI.Controllers.ContentController (NayifatAPI).
2025-02-05 09:08:20.091 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 09:08:20.094 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__request_Page_0='?' (Size = 450), @__request_KeyName_1='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[config_id], [m].[key_name], [m].[last_updated], [m].[page], [m].[value]
FROM [master_config] AS [m]
WHERE [m].[page] = @__request_Page_0 AND [m].[key_name] = @__request_KeyName_1
2025-02-05 09:08:20.097 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 09:08:20.098 +03:00 [INF] Executed action NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI) in 9.284ms
2025-02-05 09:08:20.100 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 09:08:20.101 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - 200 null application/json; charset=utf-8 198.2096ms
2025-02-05 09:08:21.119 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - application/json; charset=utf-8 48
2025-02-05 09:08:21.122 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 09:08:21.123 +03:00 [INF] Route matched with {action = "MasterFetch", controller = "Content"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] MasterFetch(NayifatAPI.Controllers.MasterFetchRequest) on controller NayifatAPI.Controllers.ContentController (NayifatAPI).
2025-02-05 09:08:21.187 +03:00 [INF] Executed DbCommand (61ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 09:08:21.283 +03:00 [INF] Executed DbCommand (93ms) [Parameters=[@__request_Page_0='?' (Size = 450), @__request_KeyName_1='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[config_id], [m].[key_name], [m].[last_updated], [m].[page], [m].[value]
FROM [master_config] AS [m]
WHERE [m].[page] = @__request_Page_0 AND [m].[key_name] = @__request_KeyName_1
2025-02-05 09:08:21.380 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - application/json; charset=utf-8 43
2025-02-05 09:08:21.411 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 09:08:21.412 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 09:08:21.413 +03:00 [INF] Executed action NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI) in 288.9801ms
2025-02-05 09:08:21.414 +03:00 [INF] Route matched with {action = "MasterFetch", controller = "Content"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] MasterFetch(NayifatAPI.Controllers.MasterFetchRequest) on controller NayifatAPI.Controllers.ContentController (NayifatAPI).
2025-02-05 09:08:21.415 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 09:08:21.424 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - 200 null application/json; charset=utf-8 304.9006ms
2025-02-05 09:08:21.454 +03:00 [INF] Executed DbCommand (32ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 09:08:21.458 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__request_Page_0='?' (Size = 450), @__request_KeyName_1='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[config_id], [m].[key_name], [m].[last_updated], [m].[page], [m].[value]
FROM [master_config] AS [m]
WHERE [m].[page] = @__request_Page_0 AND [m].[key_name] = @__request_KeyName_1
2025-02-05 09:08:21.462 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 09:08:21.464 +03:00 [INF] Executed action NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI) in 43.6373ms
2025-02-05 09:08:21.466 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 09:08:21.468 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - 200 null application/json; charset=utf-8 87.3087ms
2025-02-05 09:08:21.756 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - application/json; charset=utf-8 46
2025-02-05 09:08:21.761 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 09:08:21.762 +03:00 [INF] Route matched with {action = "MasterFetch", controller = "Content"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] MasterFetch(NayifatAPI.Controllers.MasterFetchRequest) on controller NayifatAPI.Controllers.ContentController (NayifatAPI).
2025-02-05 09:08:21.766 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 09:08:21.770 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__request_Page_0='?' (Size = 450), @__request_KeyName_1='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[config_id], [m].[key_name], [m].[last_updated], [m].[page], [m].[value]
FROM [master_config] AS [m]
WHERE [m].[page] = @__request_Page_0 AND [m].[key_name] = @__request_KeyName_1
2025-02-05 09:08:21.774 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 09:08:21.776 +03:00 [INF] Executed action NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI) in 11.7789ms
2025-02-05 09:08:21.778 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 09:08:21.780 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - 200 null application/json; charset=utf-8 23.6948ms
2025-02-05 09:08:22.033 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - application/json; charset=utf-8 36
2025-02-05 09:08:22.038 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 09:08:22.039 +03:00 [INF] Route matched with {action = "MasterFetch", controller = "Content"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] MasterFetch(NayifatAPI.Controllers.MasterFetchRequest) on controller NayifatAPI.Controllers.ContentController (NayifatAPI).
2025-02-05 09:08:22.044 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 09:08:22.050 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__request_Page_0='?' (Size = 450), @__request_KeyName_1='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[config_id], [m].[key_name], [m].[last_updated], [m].[page], [m].[value]
FROM [master_config] AS [m]
WHERE [m].[page] = @__request_Page_0 AND [m].[key_name] = @__request_KeyName_1
2025-02-05 09:08:22.054 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 09:08:22.059 +03:00 [INF] Executed action NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI) in 16.9587ms
2025-02-05 09:08:22.062 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 09:08:22.064 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - 200 null application/json; charset=utf-8 30.5361ms
2025-02-05 09:08:22.384 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - application/json; charset=utf-8 36
2025-02-05 09:08:22.389 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 09:08:22.390 +03:00 [INF] Route matched with {action = "MasterFetch", controller = "Content"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] MasterFetch(NayifatAPI.Controllers.MasterFetchRequest) on controller NayifatAPI.Controllers.ContentController (NayifatAPI).
2025-02-05 09:08:22.395 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 09:08:22.400 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__request_Page_0='?' (Size = 450), @__request_KeyName_1='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[config_id], [m].[key_name], [m].[last_updated], [m].[page], [m].[value]
FROM [master_config] AS [m]
WHERE [m].[page] = @__request_Page_0 AND [m].[key_name] = @__request_KeyName_1
2025-02-05 09:08:22.403 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 09:08:22.404 +03:00 [INF] Executed action NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI) in 11.8649ms
2025-02-05 09:08:22.406 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 09:08:22.406 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - 200 null application/json; charset=utf-8 21.9885ms
2025-02-05 09:08:22.710 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - application/json; charset=utf-8 38
2025-02-05 09:08:22.713 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 09:08:22.714 +03:00 [INF] Route matched with {action = "MasterFetch", controller = "Content"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] MasterFetch(NayifatAPI.Controllers.MasterFetchRequest) on controller NayifatAPI.Controllers.ContentController (NayifatAPI).
2025-02-05 09:08:22.717 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 09:08:22.720 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__request_Page_0='?' (Size = 450), @__request_KeyName_1='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[config_id], [m].[key_name], [m].[last_updated], [m].[page], [m].[value]
FROM [master_config] AS [m]
WHERE [m].[page] = @__request_Page_0 AND [m].[key_name] = @__request_KeyName_1
2025-02-05 09:08:22.723 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 09:08:22.725 +03:00 [INF] Executed action NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI) in 9.2803ms
2025-02-05 09:08:22.726 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 09:08:22.728 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - 200 null application/json; charset=utf-8 18.0287ms
2025-02-05 09:08:22.953 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - application/json; charset=utf-8 43
2025-02-05 09:08:22.957 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 09:08:22.959 +03:00 [INF] Route matched with {action = "MasterFetch", controller = "Content"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] MasterFetch(NayifatAPI.Controllers.MasterFetchRequest) on controller NayifatAPI.Controllers.ContentController (NayifatAPI).
2025-02-05 09:08:22.964 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 09:08:22.969 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__request_Page_0='?' (Size = 450), @__request_KeyName_1='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[config_id], [m].[key_name], [m].[last_updated], [m].[page], [m].[value]
FROM [master_config] AS [m]
WHERE [m].[page] = @__request_Page_0 AND [m].[key_name] = @__request_KeyName_1
2025-02-05 09:08:22.971 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 09:08:22.973 +03:00 [INF] Executed action NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI) in 10.8234ms
2025-02-05 09:08:22.975 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 09:08:22.977 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - 200 null application/json; charset=utf-8 23.532ms
2025-02-05 09:08:22.992 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - application/json; charset=utf-8 38
2025-02-05 09:08:22.995 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 09:08:22.996 +03:00 [INF] Route matched with {action = "MasterFetch", controller = "Content"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] MasterFetch(NayifatAPI.Controllers.MasterFetchRequest) on controller NayifatAPI.Controllers.ContentController (NayifatAPI).
2025-02-05 09:08:23.001 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 09:08:23.005 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__request_Page_0='?' (Size = 450), @__request_KeyName_1='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[config_id], [m].[key_name], [m].[last_updated], [m].[page], [m].[value]
FROM [master_config] AS [m]
WHERE [m].[page] = @__request_Page_0 AND [m].[key_name] = @__request_KeyName_1
2025-02-05 09:08:23.008 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 09:08:23.010 +03:00 [INF] Executed action NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI) in 10.842ms
2025-02-05 09:08:23.013 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 09:08:23.015 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - 200 null application/json; charset=utf-8 22.4706ms
2025-02-05 09:08:23.223 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - application/json; charset=utf-8 46
2025-02-05 09:08:23.227 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 09:08:23.230 +03:00 [INF] Route matched with {action = "MasterFetch", controller = "Content"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] MasterFetch(NayifatAPI.Controllers.MasterFetchRequest) on controller NayifatAPI.Controllers.ContentController (NayifatAPI).
2025-02-05 09:08:23.232 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 09:08:23.238 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__request_Page_0='?' (Size = 450), @__request_KeyName_1='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[config_id], [m].[key_name], [m].[last_updated], [m].[page], [m].[value]
FROM [master_config] AS [m]
WHERE [m].[page] = @__request_Page_0 AND [m].[key_name] = @__request_KeyName_1
2025-02-05 09:08:23.242 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 09:08:23.244 +03:00 [INF] Executed action NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI) in 13.8224ms
2025-02-05 09:08:23.246 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 09:08:23.248 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - 200 null application/json; charset=utf-8 25.4793ms
2025-02-05 09:08:23.259 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - application/json; charset=utf-8 36
2025-02-05 09:08:23.262 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 09:08:23.264 +03:00 [INF] Route matched with {action = "MasterFetch", controller = "Content"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] MasterFetch(NayifatAPI.Controllers.MasterFetchRequest) on controller NayifatAPI.Controllers.ContentController (NayifatAPI).
2025-02-05 09:08:23.269 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 09:08:23.272 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__request_Page_0='?' (Size = 450), @__request_KeyName_1='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[config_id], [m].[key_name], [m].[last_updated], [m].[page], [m].[value]
FROM [master_config] AS [m]
WHERE [m].[page] = @__request_Page_0 AND [m].[key_name] = @__request_KeyName_1
2025-02-05 09:08:23.275 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 09:08:23.277 +03:00 [INF] Executed action NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI) in 10.3989ms
2025-02-05 09:08:23.278 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 09:08:23.279 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - 200 null application/json; charset=utf-8 20.0025ms
2025-02-05 09:08:23.487 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - application/json; charset=utf-8 36
2025-02-05 09:08:23.490 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 09:08:23.491 +03:00 [INF] Route matched with {action = "MasterFetch", controller = "Content"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] MasterFetch(NayifatAPI.Controllers.MasterFetchRequest) on controller NayifatAPI.Controllers.ContentController (NayifatAPI).
2025-02-05 09:08:23.494 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 09:08:23.497 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__request_Page_0='?' (Size = 450), @__request_KeyName_1='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[config_id], [m].[key_name], [m].[last_updated], [m].[page], [m].[value]
FROM [master_config] AS [m]
WHERE [m].[page] = @__request_Page_0 AND [m].[key_name] = @__request_KeyName_1
2025-02-05 09:08:23.499 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 09:08:23.500 +03:00 [INF] Executed action NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI) in 7.9737ms
2025-02-05 09:08:23.506 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 09:08:23.509 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - 200 null application/json; charset=utf-8 21.937ms
2025-02-05 09:08:23.520 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - application/json; charset=utf-8 36
2025-02-05 09:08:23.522 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 09:08:23.523 +03:00 [INF] Route matched with {action = "MasterFetch", controller = "Content"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] MasterFetch(NayifatAPI.Controllers.MasterFetchRequest) on controller NayifatAPI.Controllers.ContentController (NayifatAPI).
2025-02-05 09:08:23.528 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 09:08:23.533 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__request_Page_0='?' (Size = 450), @__request_KeyName_1='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[config_id], [m].[key_name], [m].[last_updated], [m].[page], [m].[value]
FROM [master_config] AS [m]
WHERE [m].[page] = @__request_Page_0 AND [m].[key_name] = @__request_KeyName_1
2025-02-05 09:08:23.536 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 09:08:23.538 +03:00 [INF] Executed action NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI) in 13.3946ms
2025-02-05 09:08:23.541 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 09:08:23.543 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - 200 null application/json; charset=utf-8 22.8202ms
2025-02-05 09:08:23.772 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - application/json; charset=utf-8 36
2025-02-05 09:08:23.775 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 09:08:23.776 +03:00 [INF] Route matched with {action = "MasterFetch", controller = "Content"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] MasterFetch(NayifatAPI.Controllers.MasterFetchRequest) on controller NayifatAPI.Controllers.ContentController (NayifatAPI).
2025-02-05 09:08:23.779 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 09:08:23.781 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__request_Page_0='?' (Size = 450), @__request_KeyName_1='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[config_id], [m].[key_name], [m].[last_updated], [m].[page], [m].[value]
FROM [master_config] AS [m]
WHERE [m].[page] = @__request_Page_0 AND [m].[key_name] = @__request_KeyName_1
2025-02-05 09:08:23.783 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 09:08:23.784 +03:00 [INF] Executed action NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI) in 6.9236ms
2025-02-05 09:08:23.785 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 09:08:23.786 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - 200 null application/json; charset=utf-8 13.6875ms
2025-02-05 09:08:23.812 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - application/json; charset=utf-8 38
2025-02-05 09:08:23.815 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 09:08:23.817 +03:00 [INF] Route matched with {action = "MasterFetch", controller = "Content"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] MasterFetch(NayifatAPI.Controllers.MasterFetchRequest) on controller NayifatAPI.Controllers.ContentController (NayifatAPI).
2025-02-05 09:08:23.820 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 09:08:23.822 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__request_Page_0='?' (Size = 450), @__request_KeyName_1='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[config_id], [m].[key_name], [m].[last_updated], [m].[page], [m].[value]
FROM [master_config] AS [m]
WHERE [m].[page] = @__request_Page_0 AND [m].[key_name] = @__request_KeyName_1
2025-02-05 09:08:23.825 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 09:08:23.827 +03:00 [INF] Executed action NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI) in 8.8028ms
2025-02-05 09:08:23.829 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 09:08:23.830 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - 200 null application/json; charset=utf-8 17.8818ms
2025-02-05 09:08:24.053 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - application/json; charset=utf-8 38
2025-02-05 09:08:24.058 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 09:08:24.060 +03:00 [INF] Route matched with {action = "MasterFetch", controller = "Content"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] MasterFetch(NayifatAPI.Controllers.MasterFetchRequest) on controller NayifatAPI.Controllers.ContentController (NayifatAPI).
2025-02-05 09:08:24.064 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 09:08:24.067 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__request_Page_0='?' (Size = 450), @__request_KeyName_1='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[config_id], [m].[key_name], [m].[last_updated], [m].[page], [m].[value]
FROM [master_config] AS [m]
WHERE [m].[page] = @__request_Page_0 AND [m].[key_name] = @__request_KeyName_1
2025-02-05 09:08:24.069 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 09:08:24.070 +03:00 [INF] Executed action NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI) in 8.556ms
2025-02-05 09:08:24.071 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 09:08:24.075 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - 200 null application/json; charset=utf-8 21.6122ms
2025-02-05 09:08:24.088 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - application/json; charset=utf-8 38
2025-02-05 09:08:24.094 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 09:08:24.095 +03:00 [INF] Route matched with {action = "MasterFetch", controller = "Content"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] MasterFetch(NayifatAPI.Controllers.MasterFetchRequest) on controller NayifatAPI.Controllers.ContentController (NayifatAPI).
2025-02-05 09:08:24.098 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 09:08:24.101 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__request_Page_0='?' (Size = 450), @__request_KeyName_1='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[config_id], [m].[key_name], [m].[last_updated], [m].[page], [m].[value]
FROM [master_config] AS [m]
WHERE [m].[page] = @__request_Page_0 AND [m].[key_name] = @__request_KeyName_1
2025-02-05 09:08:24.103 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 09:08:24.105 +03:00 [INF] Executed action NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI) in 8.2709ms
2025-02-05 09:08:24.107 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 09:08:24.108 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - 200 null application/json; charset=utf-8 19.2889ms
2025-02-05 09:08:24.328 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - application/json; charset=utf-8 38
2025-02-05 09:08:24.331 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 09:08:24.332 +03:00 [INF] Route matched with {action = "MasterFetch", controller = "Content"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] MasterFetch(NayifatAPI.Controllers.MasterFetchRequest) on controller NayifatAPI.Controllers.ContentController (NayifatAPI).
2025-02-05 09:08:24.335 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 09:08:24.338 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__request_Page_0='?' (Size = 450), @__request_KeyName_1='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[config_id], [m].[key_name], [m].[last_updated], [m].[page], [m].[value]
FROM [master_config] AS [m]
WHERE [m].[page] = @__request_Page_0 AND [m].[key_name] = @__request_KeyName_1
2025-02-05 09:08:24.340 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 09:08:24.343 +03:00 [INF] Executed action NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI) in 9.1877ms
2025-02-05 09:08:24.344 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 09:08:24.345 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - 200 null application/json; charset=utf-8 16.9224ms
2025-02-05 09:08:24.349 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - application/json; charset=utf-8 49
2025-02-05 09:08:24.352 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 09:08:24.353 +03:00 [INF] Route matched with {action = "MasterFetch", controller = "Content"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] MasterFetch(NayifatAPI.Controllers.MasterFetchRequest) on controller NayifatAPI.Controllers.ContentController (NayifatAPI).
2025-02-05 09:08:24.360 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 09:08:24.363 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__request_Page_0='?' (Size = 450), @__request_KeyName_1='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[config_id], [m].[key_name], [m].[last_updated], [m].[page], [m].[value]
FROM [master_config] AS [m]
WHERE [m].[page] = @__request_Page_0 AND [m].[key_name] = @__request_KeyName_1
2025-02-05 09:08:24.366 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 09:08:24.367 +03:00 [INF] Executed action NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI) in 11.6535ms
2025-02-05 09:08:24.368 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 09:08:24.369 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - 200 null application/json; charset=utf-8 19.7041ms
2025-02-05 09:08:24.647 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - application/json; charset=utf-8 36
2025-02-05 09:08:24.649 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 09:08:24.650 +03:00 [INF] Route matched with {action = "MasterFetch", controller = "Content"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] MasterFetch(NayifatAPI.Controllers.MasterFetchRequest) on controller NayifatAPI.Controllers.ContentController (NayifatAPI).
2025-02-05 09:08:24.653 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 09:08:24.657 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__request_Page_0='?' (Size = 450), @__request_KeyName_1='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[config_id], [m].[key_name], [m].[last_updated], [m].[page], [m].[value]
FROM [master_config] AS [m]
WHERE [m].[page] = @__request_Page_0 AND [m].[key_name] = @__request_KeyName_1
2025-02-05 09:08:24.660 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 09:08:24.662 +03:00 [INF] Executed action NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI) in 10.3435ms
2025-02-05 09:08:24.663 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 09:08:24.664 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - 200 null application/json; charset=utf-8 17.6496ms
2025-02-05 09:08:24.715 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - application/json; charset=utf-8 49
2025-02-05 09:08:24.718 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 09:08:24.719 +03:00 [INF] Route matched with {action = "MasterFetch", controller = "Content"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] MasterFetch(NayifatAPI.Controllers.MasterFetchRequest) on controller NayifatAPI.Controllers.ContentController (NayifatAPI).
2025-02-05 09:08:24.722 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 09:08:24.726 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__request_Page_0='?' (Size = 450), @__request_KeyName_1='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[config_id], [m].[key_name], [m].[last_updated], [m].[page], [m].[value]
FROM [master_config] AS [m]
WHERE [m].[page] = @__request_Page_0 AND [m].[key_name] = @__request_KeyName_1
2025-02-05 09:08:24.728 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 09:08:24.729 +03:00 [INF] Executed action NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI) in 8.9854ms
2025-02-05 09:08:24.731 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 09:08:24.731 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - 200 null application/json; charset=utf-8 16.7885ms
2025-02-05 09:08:24.950 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - application/json; charset=utf-8 36
2025-02-05 09:08:24.953 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 09:08:24.954 +03:00 [INF] Route matched with {action = "MasterFetch", controller = "Content"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] MasterFetch(NayifatAPI.Controllers.MasterFetchRequest) on controller NayifatAPI.Controllers.ContentController (NayifatAPI).
2025-02-05 09:08:24.956 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 09:08:24.960 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__request_Page_0='?' (Size = 450), @__request_KeyName_1='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[config_id], [m].[key_name], [m].[last_updated], [m].[page], [m].[value]
FROM [master_config] AS [m]
WHERE [m].[page] = @__request_Page_0 AND [m].[key_name] = @__request_KeyName_1
2025-02-05 09:08:24.962 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 09:08:24.963 +03:00 [INF] Executed action NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI) in 8.081ms
2025-02-05 09:08:24.965 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 09:08:24.965 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - 200 null application/json; charset=utf-8 15.3733ms
2025-02-05 09:08:24.982 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - application/json; charset=utf-8 49
2025-02-05 09:08:24.984 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 09:08:24.985 +03:00 [INF] Route matched with {action = "MasterFetch", controller = "Content"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] MasterFetch(NayifatAPI.Controllers.MasterFetchRequest) on controller NayifatAPI.Controllers.ContentController (NayifatAPI).
2025-02-05 09:08:24.988 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 09:08:24.991 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__request_Page_0='?' (Size = 450), @__request_KeyName_1='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[config_id], [m].[key_name], [m].[last_updated], [m].[page], [m].[value]
FROM [master_config] AS [m]
WHERE [m].[page] = @__request_Page_0 AND [m].[key_name] = @__request_KeyName_1
2025-02-05 09:08:24.993 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 09:08:24.994 +03:00 [INF] Executed action NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI) in 7.8334ms
2025-02-05 09:08:24.995 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 09:08:24.996 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - 200 null application/json; charset=utf-8 14.1924ms
2025-02-05 09:08:25.212 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - application/json; charset=utf-8 38
2025-02-05 09:08:25.215 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 09:08:25.217 +03:00 [INF] Route matched with {action = "MasterFetch", controller = "Content"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] MasterFetch(NayifatAPI.Controllers.MasterFetchRequest) on controller NayifatAPI.Controllers.ContentController (NayifatAPI).
2025-02-05 09:08:25.222 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 09:08:25.227 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__request_Page_0='?' (Size = 450), @__request_KeyName_1='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[config_id], [m].[key_name], [m].[last_updated], [m].[page], [m].[value]
FROM [master_config] AS [m]
WHERE [m].[page] = @__request_Page_0 AND [m].[key_name] = @__request_KeyName_1
2025-02-05 09:08:25.231 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 09:08:25.232 +03:00 [INF] Executed action NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI) in 13.0801ms
2025-02-05 09:08:25.234 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 09:08:25.235 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - 200 null application/json; charset=utf-8 22.4409ms
2025-02-05 09:08:25.241 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - application/json; charset=utf-8 49
2025-02-05 09:08:25.245 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 09:08:25.247 +03:00 [INF] Route matched with {action = "MasterFetch", controller = "Content"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] MasterFetch(NayifatAPI.Controllers.MasterFetchRequest) on controller NayifatAPI.Controllers.ContentController (NayifatAPI).
2025-02-05 09:08:25.252 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 09:08:25.256 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__request_Page_0='?' (Size = 450), @__request_KeyName_1='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[config_id], [m].[key_name], [m].[last_updated], [m].[page], [m].[value]
FROM [master_config] AS [m]
WHERE [m].[page] = @__request_Page_0 AND [m].[key_name] = @__request_KeyName_1
2025-02-05 09:08:25.261 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 09:08:25.263 +03:00 [INF] Executed action NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI) in 13.8412ms
2025-02-05 09:08:25.266 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 09:08:25.268 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - 200 null application/json; charset=utf-8 26.8305ms
2025-02-05 09:08:25.489 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - application/json; charset=utf-8 38
2025-02-05 09:08:25.492 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 09:08:25.494 +03:00 [INF] Route matched with {action = "MasterFetch", controller = "Content"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] MasterFetch(NayifatAPI.Controllers.MasterFetchRequest) on controller NayifatAPI.Controllers.ContentController (NayifatAPI).
2025-02-05 09:08:25.498 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 09:08:25.501 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__request_Page_0='?' (Size = 450), @__request_KeyName_1='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[config_id], [m].[key_name], [m].[last_updated], [m].[page], [m].[value]
FROM [master_config] AS [m]
WHERE [m].[page] = @__request_Page_0 AND [m].[key_name] = @__request_KeyName_1
2025-02-05 09:08:25.504 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 09:08:25.506 +03:00 [INF] Executed action NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI) in 9.7513ms
2025-02-05 09:08:25.507 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 09:08:25.508 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - 200 null application/json; charset=utf-8 18.7736ms
2025-02-05 09:08:25.526 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - application/json; charset=utf-8 36
2025-02-05 09:08:25.531 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 09:08:25.539 +03:00 [INF] Route matched with {action = "MasterFetch", controller = "Content"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] MasterFetch(NayifatAPI.Controllers.MasterFetchRequest) on controller NayifatAPI.Controllers.ContentController (NayifatAPI).
2025-02-05 09:08:25.544 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 09:08:25.547 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__request_Page_0='?' (Size = 450), @__request_KeyName_1='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[config_id], [m].[key_name], [m].[last_updated], [m].[page], [m].[value]
FROM [master_config] AS [m]
WHERE [m].[page] = @__request_Page_0 AND [m].[key_name] = @__request_KeyName_1
2025-02-05 09:08:25.549 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 09:08:25.550 +03:00 [INF] Executed action NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI) in 8.905ms
2025-02-05 09:08:25.551 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 09:08:25.553 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - 200 null application/json; charset=utf-8 27.0049ms
2025-02-05 09:08:25.787 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - application/json; charset=utf-8 49
2025-02-05 09:08:25.791 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 09:08:25.792 +03:00 [INF] Route matched with {action = "MasterFetch", controller = "Content"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] MasterFetch(NayifatAPI.Controllers.MasterFetchRequest) on controller NayifatAPI.Controllers.ContentController (NayifatAPI).
2025-02-05 09:08:25.797 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 09:08:25.802 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__request_Page_0='?' (Size = 450), @__request_KeyName_1='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[config_id], [m].[key_name], [m].[last_updated], [m].[page], [m].[value]
FROM [master_config] AS [m]
WHERE [m].[page] = @__request_Page_0 AND [m].[key_name] = @__request_KeyName_1
2025-02-05 09:08:25.805 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 09:08:25.807 +03:00 [INF] Executed action NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI) in 13.2049ms
2025-02-05 09:08:25.810 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 09:08:25.812 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - 200 null application/json; charset=utf-8 25.1098ms
2025-02-05 09:08:26.219 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - application/json; charset=utf-8 49
2025-02-05 09:08:26.219 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - application/json; charset=utf-8 36
2025-02-05 09:08:26.223 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 09:08:26.226 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 09:08:26.227 +03:00 [INF] Route matched with {action = "MasterFetch", controller = "Content"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] MasterFetch(NayifatAPI.Controllers.MasterFetchRequest) on controller NayifatAPI.Controllers.ContentController (NayifatAPI).
2025-02-05 09:08:26.227 +03:00 [INF] Route matched with {action = "MasterFetch", controller = "Content"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] MasterFetch(NayifatAPI.Controllers.MasterFetchRequest) on controller NayifatAPI.Controllers.ContentController (NayifatAPI).
2025-02-05 09:08:26.232 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 09:08:26.237 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__request_Page_0='?' (Size = 450), @__request_KeyName_1='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[config_id], [m].[key_name], [m].[last_updated], [m].[page], [m].[value]
FROM [master_config] AS [m]
WHERE [m].[page] = @__request_Page_0 AND [m].[key_name] = @__request_KeyName_1
2025-02-05 09:08:26.239 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 09:08:26.240 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 09:08:26.244 +03:00 [INF] Executed action NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI) in 14.8952ms
2025-02-05 09:08:26.244 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__request_Page_0='?' (Size = 450), @__request_KeyName_1='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[config_id], [m].[key_name], [m].[last_updated], [m].[page], [m].[value]
FROM [master_config] AS [m]
WHERE [m].[page] = @__request_Page_0 AND [m].[key_name] = @__request_KeyName_1
2025-02-05 09:08:26.245 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 09:08:26.247 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 09:08:26.248 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - 200 null application/json; charset=utf-8 28.4378ms
2025-02-05 09:08:26.249 +03:00 [INF] Executed action NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI) in 18.5909ms
2025-02-05 09:08:26.267 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 09:08:26.281 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - 200 null application/json; charset=utf-8 62.0594ms
2025-02-05 09:08:26.531 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - application/json; charset=utf-8 49
2025-02-05 09:08:26.534 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 09:08:26.536 +03:00 [INF] Route matched with {action = "MasterFetch", controller = "Content"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] MasterFetch(NayifatAPI.Controllers.MasterFetchRequest) on controller NayifatAPI.Controllers.ContentController (NayifatAPI).
2025-02-05 09:08:26.539 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 09:08:26.545 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__request_Page_0='?' (Size = 450), @__request_KeyName_1='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[config_id], [m].[key_name], [m].[last_updated], [m].[page], [m].[value]
FROM [master_config] AS [m]
WHERE [m].[page] = @__request_Page_0 AND [m].[key_name] = @__request_KeyName_1
2025-02-05 09:08:26.547 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 09:08:26.548 +03:00 [INF] Executed action NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI) in 11.2377ms
2025-02-05 09:08:26.550 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 09:08:26.551 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - 200 null application/json; charset=utf-8 19.8762ms
2025-02-05 09:08:26.775 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - application/json; charset=utf-8 49
2025-02-05 09:08:26.783 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 09:08:26.784 +03:00 [INF] Route matched with {action = "MasterFetch", controller = "Content"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] MasterFetch(NayifatAPI.Controllers.MasterFetchRequest) on controller NayifatAPI.Controllers.ContentController (NayifatAPI).
2025-02-05 09:08:26.788 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 09:08:26.792 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__request_Page_0='?' (Size = 450), @__request_KeyName_1='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[config_id], [m].[key_name], [m].[last_updated], [m].[page], [m].[value]
FROM [master_config] AS [m]
WHERE [m].[page] = @__request_Page_0 AND [m].[key_name] = @__request_KeyName_1
2025-02-05 09:08:26.794 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 09:08:26.797 +03:00 [INF] Executed action NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI) in 11.1597ms
2025-02-05 09:08:26.798 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 09:08:26.799 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - 200 null application/json; charset=utf-8 24.2329ms
2025-02-05 09:08:27.238 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - application/json; charset=utf-8 36
2025-02-05 09:08:27.244 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 09:08:27.245 +03:00 [INF] Route matched with {action = "MasterFetch", controller = "Content"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] MasterFetch(NayifatAPI.Controllers.MasterFetchRequest) on controller NayifatAPI.Controllers.ContentController (NayifatAPI).
2025-02-05 09:08:27.248 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 09:08:27.251 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__request_Page_0='?' (Size = 450), @__request_KeyName_1='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[config_id], [m].[key_name], [m].[last_updated], [m].[page], [m].[value]
FROM [master_config] AS [m]
WHERE [m].[page] = @__request_Page_0 AND [m].[key_name] = @__request_KeyName_1
2025-02-05 09:08:27.254 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 09:08:27.256 +03:00 [INF] Executed action NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI) in 9.2435ms
2025-02-05 09:08:27.257 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 09:08:27.259 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - 200 null application/json; charset=utf-8 20.5759ms
2025-02-05 09:08:27.987 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - application/json; charset=utf-8 36
2025-02-05 09:08:27.990 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 09:08:27.991 +03:00 [INF] Route matched with {action = "MasterFetch", controller = "Content"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] MasterFetch(NayifatAPI.Controllers.MasterFetchRequest) on controller NayifatAPI.Controllers.ContentController (NayifatAPI).
2025-02-05 09:08:27.995 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 09:08:27.998 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__request_Page_0='?' (Size = 450), @__request_KeyName_1='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[config_id], [m].[key_name], [m].[last_updated], [m].[page], [m].[value]
FROM [master_config] AS [m]
WHERE [m].[page] = @__request_Page_0 AND [m].[key_name] = @__request_KeyName_1
2025-02-05 09:08:28.000 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 09:08:28.004 +03:00 [INF] Executed action NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI) in 11.0821ms
2025-02-05 09:08:28.008 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 09:08:28.010 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - 200 null application/json; charset=utf-8 22.4797ms
2025-02-05 09:09:32.039 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/list - application/json 39
2025-02-05 09:09:32.045 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI)'
2025-02-05 09:09:32.045 +03:00 [INF] Route matched with {action = "GetNotifications", controller = "Notifications"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetNotifications(NayifatAPI.Controllers.GetNotificationsRequest) on controller NayifatAPI.Controllers.NotificationsController (NayifatAPI).
2025-02-05 09:09:32.049 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 09:09:32.054 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__request_NationalId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[national_id], [u].[last_updated], [u].[notifications]
FROM [user_notifications] AS [u]
WHERE [u].[national_id] = @__request_NationalId_0
2025-02-05 09:09:32.060 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[@__Parse_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [n].[Id], [n].[additional_data], [n].[Body], [n].[body_ar], [n].[body_en], [n].[created_at], [n].[expiry_at], [n].[Route], [n].[target_criteria], [n].[Title], [n].[title_ar], [n].[title_en]
FROM [notification_templates] AS [n]
WHERE [n].[Id] = @__Parse_0
2025-02-05 09:09:32.063 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/list - application/json 39
2025-02-05 09:09:32.063 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__Parse_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [n].[Id], [n].[additional_data], [n].[Body], [n].[body_ar], [n].[body_en], [n].[created_at], [n].[expiry_at], [n].[Route], [n].[target_criteria], [n].[Title], [n].[title_ar], [n].[title_en]
FROM [notification_templates] AS [n]
WHERE [n].[Id] = @__Parse_0
2025-02-05 09:09:32.064 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI)'
2025-02-05 09:09:32.066 +03:00 [INF] Route matched with {action = "GetNotifications", controller = "Notifications"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetNotifications(NayifatAPI.Controllers.GetNotificationsRequest) on controller NayifatAPI.Controllers.NotificationsController (NayifatAPI).
2025-02-05 09:09:32.066 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__Parse_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [n].[Id], [n].[additional_data], [n].[Body], [n].[body_ar], [n].[body_en], [n].[created_at], [n].[expiry_at], [n].[Route], [n].[target_criteria], [n].[Title], [n].[title_ar], [n].[title_en]
FROM [notification_templates] AS [n]
WHERE [n].[Id] = @__Parse_0
2025-02-05 09:09:32.069 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 09:09:32.069 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__Parse_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [n].[Id], [n].[additional_data], [n].[Body], [n].[body_ar], [n].[body_en], [n].[created_at], [n].[expiry_at], [n].[Route], [n].[target_criteria], [n].[Title], [n].[title_ar], [n].[title_en]
FROM [notification_templates] AS [n]
WHERE [n].[Id] = @__Parse_0
2025-02-05 09:09:32.071 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__request_NationalId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[national_id], [u].[last_updated], [u].[notifications]
FROM [user_notifications] AS [u]
WHERE [u].[national_id] = @__request_NationalId_0
2025-02-05 09:09:32.078 +03:00 [INF] Executed DbCommand (4ms) [Parameters=[@__Parse_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [n].[Id], [n].[additional_data], [n].[Body], [n].[body_ar], [n].[body_en], [n].[created_at], [n].[expiry_at], [n].[Route], [n].[target_criteria], [n].[Title], [n].[title_ar], [n].[title_en]
FROM [notification_templates] AS [n]
WHERE [n].[Id] = @__Parse_0
2025-02-05 09:09:32.078 +03:00 [INF] Executed DbCommand (6ms) [Parameters=[@p0='?' (Size = 4000), @p1='?' (DbType = DateTime2), @p2='?' (Size = 4000), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (Size = 450), @p6='?' (Size = 4000), @p7='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [AuthLogs] ([AuthType], [CreatedAt], [DeviceId], [FailureReason], [IpAddress], [NationalId], [Status], [UserAgent])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7);
2025-02-05 09:09:32.080 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__Parse_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [n].[Id], [n].[additional_data], [n].[Body], [n].[body_ar], [n].[body_en], [n].[created_at], [n].[expiry_at], [n].[Route], [n].[target_criteria], [n].[Title], [n].[title_ar], [n].[title_en]
FROM [notification_templates] AS [n]
WHERE [n].[Id] = @__Parse_0
2025-02-05 09:09:32.082 +03:00 [ERR] An exception occurred in the database while saving changes for context type 'NayifatAPI.Data.ApplicationDbContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_AuthLogs_Customers_NationalId". The conflict occurred in database "NayifatApp", table "dbo.Customers", column 'NationalId'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:c3a4aaca-a3c2-49b8-b397-bbbd1285c502
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_AuthLogs_Customers_NationalId". The conflict occurred in database "NayifatApp", table "dbo.Customers", column 'NationalId'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:c3a4aaca-a3c2-49b8-b397-bbbd1285c502
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2025-02-05 09:09:32.084 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__Parse_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [n].[Id], [n].[additional_data], [n].[Body], [n].[body_ar], [n].[body_en], [n].[created_at], [n].[expiry_at], [n].[Route], [n].[target_criteria], [n].[Title], [n].[title_ar], [n].[title_en]
FROM [notification_templates] AS [n]
WHERE [n].[Id] = @__Parse_0
2025-02-05 09:09:32.094 +03:00 [ERR] Error logging audit event. NationalId: all, Action: notification_delivered, Details: {"notification_count":4,"notification_ids":[20,19,18,12],"timestamp":"2025-02-05T09:09:32.0569721"}
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_AuthLogs_Customers_NationalId". The conflict occurred in database "NayifatApp", table "dbo.Customers", column 'NationalId'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:c3a4aaca-a3c2-49b8-b397-bbbd1285c502
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at NayifatAPI.Services.AuditLogService.LogAsync(String nationalId, String action, Object details) in C:\Users\yamta\StudioProjects\nayifat_app_2025_new\nayifatapi\Services\AuditLogService.cs:line 36
2025-02-05 09:09:32.096 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__Parse_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [n].[Id], [n].[additional_data], [n].[Body], [n].[body_ar], [n].[body_en], [n].[created_at], [n].[expiry_at], [n].[Route], [n].[target_criteria], [n].[Title], [n].[title_ar], [n].[title_en]
FROM [notification_templates] AS [n]
WHERE [n].[Id] = @__Parse_0
2025-02-05 09:09:32.103 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 09:09:32.105 +03:00 [INF] Executed action NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI) in 58.0491ms
2025-02-05 09:09:32.105 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@p0='?' (Size = 4000), @p1='?' (DbType = DateTime2), @p2='?' (Size = 4000), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (Size = 450), @p6='?' (Size = 4000), @p7='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [AuthLogs] ([AuthType], [CreatedAt], [DeviceId], [FailureReason], [IpAddress], [NationalId], [Status], [UserAgent])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7);
2025-02-05 09:09:32.106 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI)'
2025-02-05 09:09:32.109 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/list - 200 null application/json; charset=utf-8 69.3466ms
2025-02-05 09:09:32.110 +03:00 [ERR] An exception occurred in the database while saving changes for context type 'NayifatAPI.Data.ApplicationDbContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_AuthLogs_Customers_NationalId". The conflict occurred in database "NayifatApp", table "dbo.Customers", column 'NationalId'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:b6270b92-44b6-402b-a7bc-ce23f62f08fd
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_AuthLogs_Customers_NationalId". The conflict occurred in database "NayifatApp", table "dbo.Customers", column 'NationalId'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:b6270b92-44b6-402b-a7bc-ce23f62f08fd
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2025-02-05 09:09:32.120 +03:00 [ERR] Error logging audit event. NationalId: all, Action: notification_delivered, Details: {"notification_count":4,"notification_ids":[20,19,18,12],"timestamp":"2025-02-05T09:09:32.0733868"}
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_AuthLogs_Customers_NationalId". The conflict occurred in database "NayifatApp", table "dbo.Customers", column 'NationalId'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:b6270b92-44b6-402b-a7bc-ce23f62f08fd
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at NayifatAPI.Services.AuditLogService.LogAsync(String nationalId, String action, Object details) in C:\Users\yamta\StudioProjects\nayifat_app_2025_new\nayifatapi\Services\AuditLogService.cs:line 36
2025-02-05 09:09:32.128 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 09:09:32.129 +03:00 [INF] Executed action NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI) in 62.1199ms
2025-02-05 09:09:32.130 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI)'
2025-02-05 09:09:32.131 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/list - 200 null application/json; charset=utf-8 68.39ms
2025-02-05 09:09:32.224 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/list - application/json 45
2025-02-05 09:09:32.227 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI)'
2025-02-05 09:09:32.228 +03:00 [INF] Route matched with {action = "GetNotifications", controller = "Notifications"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetNotifications(NayifatAPI.Controllers.GetNotificationsRequest) on controller NayifatAPI.Controllers.NotificationsController (NayifatAPI).
2025-02-05 09:09:32.230 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 09:09:32.233 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__request_NationalId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[national_id], [u].[last_updated], [u].[notifications]
FROM [user_notifications] AS [u]
WHERE [u].[national_id] = @__request_NationalId_0
2025-02-05 09:09:32.234 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 09:09:32.235 +03:00 [INF] Executed action NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI) in 5.8191ms
2025-02-05 09:09:32.236 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI)'
2025-02-05 09:09:32.237 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/list - 200 null application/json; charset=utf-8 13.4125ms
2025-02-05 09:09:32.251 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/list - application/json 45
2025-02-05 09:09:32.254 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI)'
2025-02-05 09:09:32.254 +03:00 [INF] Route matched with {action = "GetNotifications", controller = "Notifications"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetNotifications(NayifatAPI.Controllers.GetNotificationsRequest) on controller NayifatAPI.Controllers.NotificationsController (NayifatAPI).
2025-02-05 09:09:32.256 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 09:09:32.259 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__request_NationalId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[national_id], [u].[last_updated], [u].[notifications]
FROM [user_notifications] AS [u]
WHERE [u].[national_id] = @__request_NationalId_0
2025-02-05 09:09:32.261 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 09:09:32.262 +03:00 [INF] Executed action NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI) in 6.6644ms
2025-02-05 09:09:32.263 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI)'
2025-02-05 09:09:32.263 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/list - 200 null application/json; charset=utf-8 11.8557ms
2025-02-05 09:09:43.537 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/list - application/json; charset=utf-8 45
2025-02-05 09:09:43.541 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI)'
2025-02-05 09:09:43.543 +03:00 [INF] Route matched with {action = "GetNotifications", controller = "Notifications"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetNotifications(NayifatAPI.Controllers.GetNotificationsRequest) on controller NayifatAPI.Controllers.NotificationsController (NayifatAPI).
2025-02-05 09:09:43.545 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 09:09:43.547 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__request_NationalId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[national_id], [u].[last_updated], [u].[notifications]
FROM [user_notifications] AS [u]
WHERE [u].[national_id] = @__request_NationalId_0
2025-02-05 09:09:43.548 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 09:09:43.549 +03:00 [INF] Executed action NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI) in 5.3937ms
2025-02-05 09:09:43.550 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI)'
2025-02-05 09:09:43.551 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/list - 200 null application/json; charset=utf-8 13.8858ms
2025-02-05 09:09:43.828 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/list - application/json; charset=utf-8 39
2025-02-05 09:09:43.832 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI)'
2025-02-05 09:09:43.833 +03:00 [INF] Route matched with {action = "GetNotifications", controller = "Notifications"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetNotifications(NayifatAPI.Controllers.GetNotificationsRequest) on controller NayifatAPI.Controllers.NotificationsController (NayifatAPI).
2025-02-05 09:09:43.835 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 09:09:43.837 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__request_NationalId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[national_id], [u].[last_updated], [u].[notifications]
FROM [user_notifications] AS [u]
WHERE [u].[national_id] = @__request_NationalId_0
2025-02-05 09:09:43.839 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__Parse_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [n].[Id], [n].[additional_data], [n].[Body], [n].[body_ar], [n].[body_en], [n].[created_at], [n].[expiry_at], [n].[Route], [n].[target_criteria], [n].[Title], [n].[title_ar], [n].[title_en]
FROM [notification_templates] AS [n]
WHERE [n].[Id] = @__Parse_0
2025-02-05 09:09:43.842 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__Parse_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [n].[Id], [n].[additional_data], [n].[Body], [n].[body_ar], [n].[body_en], [n].[created_at], [n].[expiry_at], [n].[Route], [n].[target_criteria], [n].[Title], [n].[title_ar], [n].[title_en]
FROM [notification_templates] AS [n]
WHERE [n].[Id] = @__Parse_0
2025-02-05 09:09:43.845 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__Parse_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [n].[Id], [n].[additional_data], [n].[Body], [n].[body_ar], [n].[body_en], [n].[created_at], [n].[expiry_at], [n].[Route], [n].[target_criteria], [n].[Title], [n].[title_ar], [n].[title_en]
FROM [notification_templates] AS [n]
WHERE [n].[Id] = @__Parse_0
2025-02-05 09:09:43.847 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__Parse_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [n].[Id], [n].[additional_data], [n].[Body], [n].[body_ar], [n].[body_en], [n].[created_at], [n].[expiry_at], [n].[Route], [n].[target_criteria], [n].[Title], [n].[title_ar], [n].[title_en]
FROM [notification_templates] AS [n]
WHERE [n].[Id] = @__Parse_0
2025-02-05 09:09:43.849 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@p0='?' (Size = 4000), @p1='?' (DbType = DateTime2), @p2='?' (Size = 4000), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (Size = 450), @p6='?' (Size = 4000), @p7='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [AuthLogs] ([AuthType], [CreatedAt], [DeviceId], [FailureReason], [IpAddress], [NationalId], [Status], [UserAgent])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7);
2025-02-05 09:09:43.852 +03:00 [ERR] An exception occurred in the database while saving changes for context type 'NayifatAPI.Data.ApplicationDbContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_AuthLogs_Customers_NationalId". The conflict occurred in database "NayifatApp", table "dbo.Customers", column 'NationalId'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:b6270b92-44b6-402b-a7bc-ce23f62f08fd
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_AuthLogs_Customers_NationalId". The conflict occurred in database "NayifatApp", table "dbo.Customers", column 'NationalId'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:b6270b92-44b6-402b-a7bc-ce23f62f08fd
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2025-02-05 09:09:43.861 +03:00 [ERR] Error logging audit event. NationalId: all, Action: notification_delivered, Details: {"notification_count":4,"notification_ids":[20,19,18,12],"timestamp":"2025-02-05T09:09:43.8389361"}
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_AuthLogs_Customers_NationalId". The conflict occurred in database "NayifatApp", table "dbo.Customers", column 'NationalId'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:b6270b92-44b6-402b-a7bc-ce23f62f08fd
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at NayifatAPI.Services.AuditLogService.LogAsync(String nationalId, String action, Object details) in C:\Users\yamta\StudioProjects\nayifat_app_2025_new\nayifatapi\Services\AuditLogService.cs:line 36
2025-02-05 09:09:43.867 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 09:09:43.868 +03:00 [INF] Executed action NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI) in 34.0983ms
2025-02-05 09:09:43.869 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI)'
2025-02-05 09:09:43.870 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/list - 200 null application/json; charset=utf-8 41.2368ms
2025-02-05 09:10:20.667 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/list - application/json; charset=utf-8 45
2025-02-05 09:10:20.709 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI)'
2025-02-05 09:10:20.771 +03:00 [INF] Route matched with {action = "GetNotifications", controller = "Notifications"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetNotifications(NayifatAPI.Controllers.GetNotificationsRequest) on controller NayifatAPI.Controllers.NotificationsController (NayifatAPI).
2025-02-05 09:10:21.592 +03:00 [INF] Executed DbCommand (72ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 09:10:22.393 +03:00 [INF] Executed DbCommand (71ms) [Parameters=[@__request_NationalId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[national_id], [u].[last_updated], [u].[notifications]
FROM [user_notifications] AS [u]
WHERE [u].[national_id] = @__request_NationalId_0
2025-02-05 09:10:24.121 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 09:10:24.123 +03:00 [INF] Executed action NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI) in 2603.5439ms
2025-02-05 09:10:24.124 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI)'
2025-02-05 09:10:24.125 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/list - 200 null application/json; charset=utf-8 3458.1715ms
2025-02-05 09:10:24.685 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/list - application/json; charset=utf-8 39
2025-02-05 09:10:24.687 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI)'
2025-02-05 09:10:24.689 +03:00 [INF] Route matched with {action = "GetNotifications", controller = "Notifications"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetNotifications(NayifatAPI.Controllers.GetNotificationsRequest) on controller NayifatAPI.Controllers.NotificationsController (NayifatAPI).
2025-02-05 09:10:24.710 +03:00 [INF] Executed DbCommand (19ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 09:10:24.775 +03:00 [INF] Executed DbCommand (9ms) [Parameters=[@__request_NationalId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[national_id], [u].[last_updated], [u].[notifications]
FROM [user_notifications] AS [u]
WHERE [u].[national_id] = @__request_NationalId_0
2025-02-05 09:10:24.842 +03:00 [INF] Executed DbCommand (20ms) [Parameters=[@__Parse_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [n].[Id], [n].[additional_data], [n].[Body], [n].[body_ar], [n].[body_en], [n].[created_at], [n].[expiry_at], [n].[Route], [n].[target_criteria], [n].[Title], [n].[title_ar], [n].[title_en]
FROM [notification_templates] AS [n]
WHERE [n].[Id] = @__Parse_0
2025-02-05 09:10:24.857 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__Parse_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [n].[Id], [n].[additional_data], [n].[Body], [n].[body_ar], [n].[body_en], [n].[created_at], [n].[expiry_at], [n].[Route], [n].[target_criteria], [n].[Title], [n].[title_ar], [n].[title_en]
FROM [notification_templates] AS [n]
WHERE [n].[Id] = @__Parse_0
2025-02-05 09:10:24.864 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__Parse_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [n].[Id], [n].[additional_data], [n].[Body], [n].[body_ar], [n].[body_en], [n].[created_at], [n].[expiry_at], [n].[Route], [n].[target_criteria], [n].[Title], [n].[title_ar], [n].[title_en]
FROM [notification_templates] AS [n]
WHERE [n].[Id] = @__Parse_0
2025-02-05 09:10:24.870 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__Parse_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [n].[Id], [n].[additional_data], [n].[Body], [n].[body_ar], [n].[body_en], [n].[created_at], [n].[expiry_at], [n].[Route], [n].[target_criteria], [n].[Title], [n].[title_ar], [n].[title_en]
FROM [notification_templates] AS [n]
WHERE [n].[Id] = @__Parse_0
2025-02-05 09:10:24.888 +03:00 [INF] Executed DbCommand (15ms) [Parameters=[@p0='?' (Size = 4000), @p1='?' (DbType = DateTime2), @p2='?' (Size = 4000), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (Size = 450), @p6='?' (Size = 4000), @p7='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [AuthLogs] ([AuthType], [CreatedAt], [DeviceId], [FailureReason], [IpAddress], [NationalId], [Status], [UserAgent])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7);
2025-02-05 09:10:24.895 +03:00 [ERR] An exception occurred in the database while saving changes for context type 'NayifatAPI.Data.ApplicationDbContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_AuthLogs_Customers_NationalId". The conflict occurred in database "NayifatApp", table "dbo.Customers", column 'NationalId'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:b6270b92-44b6-402b-a7bc-ce23f62f08fd
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_AuthLogs_Customers_NationalId". The conflict occurred in database "NayifatApp", table "dbo.Customers", column 'NationalId'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:b6270b92-44b6-402b-a7bc-ce23f62f08fd
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2025-02-05 09:10:24.918 +03:00 [ERR] Error logging audit event. NationalId: all, Action: notification_delivered, Details: {"notification_count":4,"notification_ids":[20,19,18,12],"timestamp":"2025-02-05T09:10:24.8220562"}
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_AuthLogs_Customers_NationalId". The conflict occurred in database "NayifatApp", table "dbo.Customers", column 'NationalId'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:b6270b92-44b6-402b-a7bc-ce23f62f08fd
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at NayifatAPI.Services.AuditLogService.LogAsync(String nationalId, String action, Object details) in C:\Users\yamta\StudioProjects\nayifat_app_2025_new\nayifatapi\Services\AuditLogService.cs:line 36
2025-02-05 09:10:24.981 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 09:10:25.007 +03:00 [INF] Executed action NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI) in 316.5836ms
2025-02-05 09:10:25.009 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI)'
2025-02-05 09:10:25.012 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/list - 200 null application/json; charset=utf-8 327.3845ms
2025-02-05 09:10:33.530 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/list - application/json; charset=utf-8 45
2025-02-05 09:10:33.532 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI)'
2025-02-05 09:10:33.533 +03:00 [INF] Route matched with {action = "GetNotifications", controller = "Notifications"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetNotifications(NayifatAPI.Controllers.GetNotificationsRequest) on controller NayifatAPI.Controllers.NotificationsController (NayifatAPI).
2025-02-05 09:10:33.544 +03:00 [INF] Executed DbCommand (7ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 09:10:33.550 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[@__request_NationalId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[national_id], [u].[last_updated], [u].[notifications]
FROM [user_notifications] AS [u]
WHERE [u].[national_id] = @__request_NationalId_0
2025-02-05 09:10:33.553 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 09:10:33.555 +03:00 [INF] Executed action NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI) in 19.1882ms
2025-02-05 09:10:33.556 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI)'
2025-02-05 09:10:33.557 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/list - 200 null application/json; charset=utf-8 27.4322ms
2025-02-05 09:10:33.866 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/list - application/json; charset=utf-8 39
2025-02-05 09:10:33.887 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI)'
2025-02-05 09:10:33.889 +03:00 [INF] Route matched with {action = "GetNotifications", controller = "Notifications"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetNotifications(NayifatAPI.Controllers.GetNotificationsRequest) on controller NayifatAPI.Controllers.NotificationsController (NayifatAPI).
2025-02-05 09:10:33.897 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 09:10:33.916 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__request_NationalId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[national_id], [u].[last_updated], [u].[notifications]
FROM [user_notifications] AS [u]
WHERE [u].[national_id] = @__request_NationalId_0
2025-02-05 09:10:33.989 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__Parse_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [n].[Id], [n].[additional_data], [n].[Body], [n].[body_ar], [n].[body_en], [n].[created_at], [n].[expiry_at], [n].[Route], [n].[target_criteria], [n].[Title], [n].[title_ar], [n].[title_en]
FROM [notification_templates] AS [n]
WHERE [n].[Id] = @__Parse_0
2025-02-05 09:10:34.007 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__Parse_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [n].[Id], [n].[additional_data], [n].[Body], [n].[body_ar], [n].[body_en], [n].[created_at], [n].[expiry_at], [n].[Route], [n].[target_criteria], [n].[Title], [n].[title_ar], [n].[title_en]
FROM [notification_templates] AS [n]
WHERE [n].[Id] = @__Parse_0
2025-02-05 09:10:34.013 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__Parse_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [n].[Id], [n].[additional_data], [n].[Body], [n].[body_ar], [n].[body_en], [n].[created_at], [n].[expiry_at], [n].[Route], [n].[target_criteria], [n].[Title], [n].[title_ar], [n].[title_en]
FROM [notification_templates] AS [n]
WHERE [n].[Id] = @__Parse_0
2025-02-05 09:10:34.030 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__Parse_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [n].[Id], [n].[additional_data], [n].[Body], [n].[body_ar], [n].[body_en], [n].[created_at], [n].[expiry_at], [n].[Route], [n].[target_criteria], [n].[Title], [n].[title_ar], [n].[title_en]
FROM [notification_templates] AS [n]
WHERE [n].[Id] = @__Parse_0
2025-02-05 09:10:34.062 +03:00 [INF] Executed DbCommand (12ms) [Parameters=[@p0='?' (Size = 4000), @p1='?' (DbType = DateTime2), @p2='?' (Size = 4000), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (Size = 450), @p6='?' (Size = 4000), @p7='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [AuthLogs] ([AuthType], [CreatedAt], [DeviceId], [FailureReason], [IpAddress], [NationalId], [Status], [UserAgent])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7);
2025-02-05 09:10:34.077 +03:00 [ERR] An exception occurred in the database while saving changes for context type 'NayifatAPI.Data.ApplicationDbContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_AuthLogs_Customers_NationalId". The conflict occurred in database "NayifatApp", table "dbo.Customers", column 'NationalId'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:b6270b92-44b6-402b-a7bc-ce23f62f08fd
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_AuthLogs_Customers_NationalId". The conflict occurred in database "NayifatApp", table "dbo.Customers", column 'NationalId'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:b6270b92-44b6-402b-a7bc-ce23f62f08fd
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2025-02-05 09:10:34.131 +03:00 [ERR] Error logging audit event. NationalId: all, Action: notification_delivered, Details: {"notification_count":4,"notification_ids":[20,19,18,12],"timestamp":"2025-02-05T09:10:33.9882178"}
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_AuthLogs_Customers_NationalId". The conflict occurred in database "NayifatApp", table "dbo.Customers", column 'NationalId'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:b6270b92-44b6-402b-a7bc-ce23f62f08fd
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at NayifatAPI.Services.AuditLogService.LogAsync(String nationalId, String action, Object details) in C:\Users\yamta\StudioProjects\nayifat_app_2025_new\nayifatapi\Services\AuditLogService.cs:line 36
2025-02-05 09:10:34.207 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 09:10:34.210 +03:00 [INF] Executed action NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI) in 315.1196ms
2025-02-05 09:10:34.220 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI)'
2025-02-05 09:10:34.223 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/list - 200 null application/json; charset=utf-8 356.9582ms
2025-02-05 09:11:18.771 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/timestamps - application/json; charset=utf-8 2
2025-02-05 09:11:18.949 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.ContentController.GetTimestamps (NayifatAPI)'
2025-02-05 09:11:18.982 +03:00 [INF] Route matched with {action = "GetTimestamps", controller = "Content"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetTimestamps() on controller NayifatAPI.Controllers.ContentController (NayifatAPI).
2025-02-05 09:11:19.039 +03:00 [INF] TTT_
2025-02-05 09:11:19.061 +03:00 [INF] TTT_=== Getting Content Timestamps ===
2025-02-05 09:11:19.160 +03:00 [INF] Executed DbCommand (87ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 09:11:19.164 +03:00 [INF] TTT_Fetching timestamps from database
2025-02-05 09:11:19.339 +03:00 [INF] Executed DbCommand (172ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [m].[page] AS [Page], [m].[key_name] AS [KeyName], [m].[last_updated] AS [LastUpdated]
FROM [master_config] AS [m]
2025-02-05 09:11:19.362 +03:00 [INF] TTT_Found 18 content items
2025-02-05 09:11:19.374 +03:00 [INF] TTT_Page: home
2025-02-05 09:11:19.404 +03:00 [INF] TTT_  - slideshow_content: "2025-02-04T10:01:06.9430000"
2025-02-05 09:11:19.411 +03:00 [INF] TTT_  - slideshow_content_ar: "2025-02-04T10:01:06.9430000"
2025-02-05 09:11:19.413 +03:00 [INF] TTT_  - contact_details: "2025-02-04T10:01:06.9430000"
2025-02-05 09:11:19.415 +03:00 [INF] TTT_  - contact_details_ar: "2025-02-04T10:01:06.9430000"
2025-02-05 09:11:19.419 +03:00 [INF] TTT_  - termsEN1: "2025-02-03T14:23:58.0000000"
2025-02-05 09:11:19.431 +03:00 [INF] TTT_  - termsEN2: "2025-02-03T14:25:20.1730000"
2025-02-05 09:11:19.443 +03:00 [INF] TTT_  - privacyEN1: "2025-02-03T14:26:08.6130000"
2025-02-05 09:11:19.446 +03:00 [INF] TTT_  - privacyEN2: "2025-02-03T14:25:20.1730000"
2025-02-05 09:11:19.448 +03:00 [INF] TTT_  - termsAR1: "2025-02-03T14:23:58.0000000"
2025-02-05 09:11:19.454 +03:00 [INF] TTT_  - termsAR2: "2025-02-03T14:25:20.1730000"
2025-02-05 09:11:19.456 +03:00 [INF] TTT_  - privacyAR1: "2025-02-03T14:26:08.6130000"
2025-02-05 09:11:19.459 +03:00 [INF] TTT_  - privacyAR2: "2025-02-03T14:25:20.1730000"
2025-02-05 09:11:19.470 +03:00 [INF] TTT_  - terms&conditionsCC_AR: "2025-02-03T17:06:57.7700000"
2025-02-05 09:11:19.477 +03:00 [INF] TTT_  - terms&conditionsCC_EN: "2025-02-03T17:07:47.4900000"
2025-02-05 09:11:19.485 +03:00 [INF] TTT_  - terms&conditionsPF_AR: "2025-02-03T17:06:57.7700000"
2025-02-05 09:11:19.495 +03:00 [INF] TTT_  - terms&conditionsPF_EN: "2025-02-03T17:06:57.7700000"
2025-02-05 09:11:19.518 +03:00 [INF] TTT_Page: loans
2025-02-05 09:11:19.539 +03:00 [INF] TTT_  - loan_ad: "2025-02-04T10:01:06.9430000"
2025-02-05 09:11:19.542 +03:00 [INF] TTT_Page: cards
2025-02-05 09:11:19.549 +03:00 [INF] TTT_  - card_ad: "2025-02-04T10:01:06.9430000"
2025-02-05 09:11:19.554 +03:00 [INF] TTT_Successfully retrieved all timestamps
2025-02-05 09:11:19.558 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 09:11:19.628 +03:00 [INF] Executed action NayifatAPI.Controllers.ContentController.GetTimestamps (NayifatAPI) in 589.6796ms
2025-02-05 09:11:19.663 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.ContentController.GetTimestamps (NayifatAPI)'
2025-02-05 09:11:19.667 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/timestamps - 200 null application/json; charset=utf-8 896.2899ms
2025-02-05 09:11:19.928 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - application/json; charset=utf-8 45
2025-02-05 09:11:20.138 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 09:11:20.147 +03:00 [INF] Route matched with {action = "MasterFetch", controller = "Content"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] MasterFetch(NayifatAPI.Controllers.MasterFetchRequest) on controller NayifatAPI.Controllers.ContentController (NayifatAPI).
2025-02-05 09:11:20.179 +03:00 [INF] Executed DbCommand (23ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 09:11:20.235 +03:00 [INF] Executed DbCommand (13ms) [Parameters=[@__request_Page_0='?' (Size = 450), @__request_KeyName_1='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[config_id], [m].[key_name], [m].[last_updated], [m].[page], [m].[value]
FROM [master_config] AS [m]
WHERE [m].[page] = @__request_Page_0 AND [m].[key_name] = @__request_KeyName_1
2025-02-05 09:11:20.255 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 09:11:20.280 +03:00 [INF] Executed action NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI) in 124.5814ms
2025-02-05 09:11:20.299 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 09:11:20.368 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - 200 null application/json; charset=utf-8 440.1492ms
2025-02-05 09:11:21.664 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - application/json; charset=utf-8 48
2025-02-05 09:11:21.679 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 09:11:21.682 +03:00 [INF] Route matched with {action = "MasterFetch", controller = "Content"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] MasterFetch(NayifatAPI.Controllers.MasterFetchRequest) on controller NayifatAPI.Controllers.ContentController (NayifatAPI).
2025-02-05 09:11:21.902 +03:00 [INF] Executed DbCommand (24ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 09:11:22.009 +03:00 [INF] Executed DbCommand (30ms) [Parameters=[@__request_Page_0='?' (Size = 450), @__request_KeyName_1='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[config_id], [m].[key_name], [m].[last_updated], [m].[page], [m].[value]
FROM [master_config] AS [m]
WHERE [m].[page] = @__request_Page_0 AND [m].[key_name] = @__request_KeyName_1
2025-02-05 09:11:22.050 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 09:11:22.195 +03:00 [INF] Executed action NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI) in 319.2399ms
2025-02-05 09:11:22.285 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 09:11:22.402 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - 200 null application/json; charset=utf-8 737.5815ms
2025-02-05 09:11:24.291 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - application/json; charset=utf-8 43
2025-02-05 09:11:28.100 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 09:11:28.203 +03:00 [INF] Route matched with {action = "MasterFetch", controller = "Content"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] MasterFetch(NayifatAPI.Controllers.MasterFetchRequest) on controller NayifatAPI.Controllers.ContentController (NayifatAPI).
2025-02-05 09:11:28.315 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 09:11:28.338 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__request_Page_0='?' (Size = 450), @__request_KeyName_1='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[config_id], [m].[key_name], [m].[last_updated], [m].[page], [m].[value]
FROM [master_config] AS [m]
WHERE [m].[page] = @__request_Page_0 AND [m].[key_name] = @__request_KeyName_1
2025-02-05 09:11:28.348 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 09:11:28.351 +03:00 [INF] Executed action NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI) in 40.9816ms
2025-02-05 09:11:28.355 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 09:11:28.357 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - 200 null application/json; charset=utf-8 4065.9931ms
2025-02-05 09:11:29.298 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - application/json; charset=utf-8 46
2025-02-05 09:11:29.304 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 09:11:29.308 +03:00 [INF] Route matched with {action = "MasterFetch", controller = "Content"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] MasterFetch(NayifatAPI.Controllers.MasterFetchRequest) on controller NayifatAPI.Controllers.ContentController (NayifatAPI).
2025-02-05 09:11:29.542 +03:00 [INF] Executed DbCommand (226ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 09:11:29.608 +03:00 [INF] Executed DbCommand (64ms) [Parameters=[@__request_Page_0='?' (Size = 450), @__request_KeyName_1='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[config_id], [m].[key_name], [m].[last_updated], [m].[page], [m].[value]
FROM [master_config] AS [m]
WHERE [m].[page] = @__request_Page_0 AND [m].[key_name] = @__request_KeyName_1
2025-02-05 09:11:29.686 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 09:11:29.723 +03:00 [INF] Executed action NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI) in 408.9699ms
2025-02-05 09:11:29.742 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 09:11:29.775 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - 200 null application/json; charset=utf-8 477.486ms
2025-02-05 09:11:30.399 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - application/json; charset=utf-8 36
2025-02-05 09:11:36.258 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 09:11:36.271 +03:00 [INF] Route matched with {action = "MasterFetch", controller = "Content"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] MasterFetch(NayifatAPI.Controllers.MasterFetchRequest) on controller NayifatAPI.Controllers.ContentController (NayifatAPI).
2025-02-05 09:11:37.314 +03:00 [INF] Executed DbCommand (1,036ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 09:11:38.569 +03:00 [INF] Executed DbCommand (1,251ms) [Parameters=[@__request_Page_0='?' (Size = 450), @__request_KeyName_1='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[config_id], [m].[key_name], [m].[last_updated], [m].[page], [m].[value]
FROM [master_config] AS [m]
WHERE [m].[page] = @__request_Page_0 AND [m].[key_name] = @__request_KeyName_1
2025-02-05 09:11:40.939 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 09:11:40.973 +03:00 [INF] Executed action NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI) in 4696.3095ms
2025-02-05 09:11:40.978 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 09:11:40.981 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - 200 null application/json; charset=utf-8 10582.258ms
2025-02-05 09:11:42.321 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - application/json; charset=utf-8 36
2025-02-05 09:11:44.101 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 09:11:44.101 +03:00 [INF] Route matched with {action = "MasterFetch", controller = "Content"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] MasterFetch(NayifatAPI.Controllers.MasterFetchRequest) on controller NayifatAPI.Controllers.ContentController (NayifatAPI).
2025-02-05 09:11:44.105 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 09:11:44.145 +03:00 [INF] Executed DbCommand (37ms) [Parameters=[@__request_Page_0='?' (Size = 450), @__request_KeyName_1='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[config_id], [m].[key_name], [m].[last_updated], [m].[page], [m].[value]
FROM [master_config] AS [m]
WHERE [m].[page] = @__request_Page_0 AND [m].[key_name] = @__request_KeyName_1
2025-02-05 09:11:50.008 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 09:11:50.010 +03:00 [INF] Executed action NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI) in 5906.909ms
2025-02-05 09:11:50.012 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 09:11:50.013 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - 200 null application/json; charset=utf-8 7691.6332ms
2025-02-05 09:11:51.288 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - application/json; charset=utf-8 38
2025-02-05 09:11:53.221 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 09:11:53.222 +03:00 [INF] Route matched with {action = "MasterFetch", controller = "Content"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] MasterFetch(NayifatAPI.Controllers.MasterFetchRequest) on controller NayifatAPI.Controllers.ContentController (NayifatAPI).
2025-02-05 09:11:53.275 +03:00 [INF] Executed DbCommand (49ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 09:11:53.390 +03:00 [INF] Executed DbCommand (111ms) [Parameters=[@__request_Page_0='?' (Size = 450), @__request_KeyName_1='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[config_id], [m].[key_name], [m].[last_updated], [m].[page], [m].[value]
FROM [master_config] AS [m]
WHERE [m].[page] = @__request_Page_0 AND [m].[key_name] = @__request_KeyName_1
2025-02-05 09:11:57.474 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 09:11:57.534 +03:00 [INF] Executed action NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI) in 4309.3951ms
2025-02-05 09:11:58.298 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 09:11:58.396 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - 200 null application/json; charset=utf-8 7108.0718ms
2025-02-05 09:11:58.865 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - application/json; charset=utf-8 38
2025-02-05 09:11:59.244 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 09:11:59.245 +03:00 [INF] Route matched with {action = "MasterFetch", controller = "Content"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] MasterFetch(NayifatAPI.Controllers.MasterFetchRequest) on controller NayifatAPI.Controllers.ContentController (NayifatAPI).
2025-02-05 09:11:59.259 +03:00 [INF] Executed DbCommand (11ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 09:11:59.281 +03:00 [INF] Executed DbCommand (18ms) [Parameters=[@__request_Page_0='?' (Size = 450), @__request_KeyName_1='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[config_id], [m].[key_name], [m].[last_updated], [m].[page], [m].[value]
FROM [master_config] AS [m]
WHERE [m].[page] = @__request_Page_0 AND [m].[key_name] = @__request_KeyName_1
2025-02-05 09:11:59.342 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 09:11:59.344 +03:00 [INF] Executed action NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI) in 96.8877ms
2025-02-05 09:11:59.345 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 09:11:59.347 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - 200 null application/json; charset=utf-8 481.8561ms
2025-02-05 09:11:59.640 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - application/json; charset=utf-8 36
2025-02-05 09:11:59.756 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 09:11:59.759 +03:00 [INF] Route matched with {action = "MasterFetch", controller = "Content"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] MasterFetch(NayifatAPI.Controllers.MasterFetchRequest) on controller NayifatAPI.Controllers.ContentController (NayifatAPI).
2025-02-05 09:11:59.765 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 09:11:59.769 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__request_Page_0='?' (Size = 450), @__request_KeyName_1='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[config_id], [m].[key_name], [m].[last_updated], [m].[page], [m].[value]
FROM [master_config] AS [m]
WHERE [m].[page] = @__request_Page_0 AND [m].[key_name] = @__request_KeyName_1
2025-02-05 09:11:59.776 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 09:11:59.797 +03:00 [INF] Executed action NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI) in 34.1596ms
2025-02-05 09:11:59.803 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 09:11:59.809 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - 200 null application/json; charset=utf-8 168.4725ms
2025-02-05 09:12:00.064 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - application/json; charset=utf-8 36
2025-02-05 09:12:00.067 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 09:12:00.068 +03:00 [INF] Route matched with {action = "MasterFetch", controller = "Content"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] MasterFetch(NayifatAPI.Controllers.MasterFetchRequest) on controller NayifatAPI.Controllers.ContentController (NayifatAPI).
2025-02-05 09:12:00.084 +03:00 [INF] Executed DbCommand (13ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 09:12:00.095 +03:00 [INF] Executed DbCommand (6ms) [Parameters=[@__request_Page_0='?' (Size = 450), @__request_KeyName_1='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[config_id], [m].[key_name], [m].[last_updated], [m].[page], [m].[value]
FROM [master_config] AS [m]
WHERE [m].[page] = @__request_Page_0 AND [m].[key_name] = @__request_KeyName_1
2025-02-05 09:12:00.125 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 09:12:00.127 +03:00 [INF] Executed action NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI) in 57.0688ms
2025-02-05 09:12:00.132 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 09:12:00.133 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - 200 null application/json; charset=utf-8 69.2753ms
2025-02-05 09:12:00.408 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - application/json; charset=utf-8 38
2025-02-05 09:12:00.410 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 09:12:00.411 +03:00 [INF] Route matched with {action = "MasterFetch", controller = "Content"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] MasterFetch(NayifatAPI.Controllers.MasterFetchRequest) on controller NayifatAPI.Controllers.ContentController (NayifatAPI).
2025-02-05 09:12:00.449 +03:00 [INF] Executed DbCommand (35ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 09:12:00.481 +03:00 [INF] Executed DbCommand (30ms) [Parameters=[@__request_Page_0='?' (Size = 450), @__request_KeyName_1='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[config_id], [m].[key_name], [m].[last_updated], [m].[page], [m].[value]
FROM [master_config] AS [m]
WHERE [m].[page] = @__request_Page_0 AND [m].[key_name] = @__request_KeyName_1
2025-02-05 09:12:00.677 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 09:12:00.682 +03:00 [INF] Executed action NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI) in 268.6952ms
2025-02-05 09:12:00.748 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 09:12:00.752 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - 200 null application/json; charset=utf-8 344.3707ms
2025-02-05 09:12:01.026 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - application/json; charset=utf-8 38
2025-02-05 09:12:01.030 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 09:12:01.031 +03:00 [INF] Route matched with {action = "MasterFetch", controller = "Content"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] MasterFetch(NayifatAPI.Controllers.MasterFetchRequest) on controller NayifatAPI.Controllers.ContentController (NayifatAPI).
2025-02-05 09:12:01.034 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 09:12:01.038 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__request_Page_0='?' (Size = 450), @__request_KeyName_1='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[config_id], [m].[key_name], [m].[last_updated], [m].[page], [m].[value]
FROM [master_config] AS [m]
WHERE [m].[page] = @__request_Page_0 AND [m].[key_name] = @__request_KeyName_1
2025-02-05 09:12:01.040 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 09:12:01.042 +03:00 [INF] Executed action NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI) in 8.6935ms
2025-02-05 09:12:01.044 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 09:12:01.045 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - 200 null application/json; charset=utf-8 19.223ms
2025-02-05 09:12:01.375 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - application/json; charset=utf-8 49
2025-02-05 09:12:01.464 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 09:12:01.466 +03:00 [INF] Route matched with {action = "MasterFetch", controller = "Content"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] MasterFetch(NayifatAPI.Controllers.MasterFetchRequest) on controller NayifatAPI.Controllers.ContentController (NayifatAPI).
2025-02-05 09:12:01.647 +03:00 [INF] Executed DbCommand (17ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 09:12:01.708 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[@__request_Page_0='?' (Size = 450), @__request_KeyName_1='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[config_id], [m].[key_name], [m].[last_updated], [m].[page], [m].[value]
FROM [master_config] AS [m]
WHERE [m].[page] = @__request_Page_0 AND [m].[key_name] = @__request_KeyName_1
2025-02-05 09:12:01.725 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 09:12:01.728 +03:00 [INF] Executed action NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI) in 98.992ms
2025-02-05 09:12:01.748 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 09:12:01.750 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - 200 null application/json; charset=utf-8 374.9715ms
2025-02-05 09:12:02.142 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - application/json; charset=utf-8 49
2025-02-05 09:12:02.158 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 09:12:02.164 +03:00 [INF] Route matched with {action = "MasterFetch", controller = "Content"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] MasterFetch(NayifatAPI.Controllers.MasterFetchRequest) on controller NayifatAPI.Controllers.ContentController (NayifatAPI).
2025-02-05 09:12:02.215 +03:00 [INF] Executed DbCommand (20ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 09:12:02.266 +03:00 [INF] Executed DbCommand (5ms) [Parameters=[@__request_Page_0='?' (Size = 450), @__request_KeyName_1='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[config_id], [m].[key_name], [m].[last_updated], [m].[page], [m].[value]
FROM [master_config] AS [m]
WHERE [m].[page] = @__request_Page_0 AND [m].[key_name] = @__request_KeyName_1
2025-02-05 09:12:02.299 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 09:12:02.535 +03:00 [INF] Executed action NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI) in 341.6737ms
2025-02-05 09:12:02.593 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 09:12:02.596 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - 200 null application/json; charset=utf-8 453.9984ms
2025-02-05 09:12:02.932 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - application/json; charset=utf-8 49
2025-02-05 09:12:02.936 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 09:12:02.937 +03:00 [INF] Route matched with {action = "MasterFetch", controller = "Content"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] MasterFetch(NayifatAPI.Controllers.MasterFetchRequest) on controller NayifatAPI.Controllers.ContentController (NayifatAPI).
2025-02-05 09:12:02.946 +03:00 [INF] Executed DbCommand (6ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 09:12:02.953 +03:00 [INF] Executed DbCommand (4ms) [Parameters=[@__request_Page_0='?' (Size = 450), @__request_KeyName_1='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[config_id], [m].[key_name], [m].[last_updated], [m].[page], [m].[value]
FROM [master_config] AS [m]
WHERE [m].[page] = @__request_Page_0 AND [m].[key_name] = @__request_KeyName_1
2025-02-05 09:12:02.958 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 09:12:02.961 +03:00 [INF] Executed action NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI) in 22.2077ms
2025-02-05 09:12:02.962 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 09:12:02.965 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - 200 null application/json; charset=utf-8 32.7115ms
2025-02-05 09:12:03.223 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - application/json; charset=utf-8 49
2025-02-05 09:12:03.225 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 09:12:03.226 +03:00 [INF] Route matched with {action = "MasterFetch", controller = "Content"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] MasterFetch(NayifatAPI.Controllers.MasterFetchRequest) on controller NayifatAPI.Controllers.ContentController (NayifatAPI).
2025-02-05 09:12:03.244 +03:00 [INF] Executed DbCommand (15ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 09:12:03.252 +03:00 [INF] Executed DbCommand (5ms) [Parameters=[@__request_Page_0='?' (Size = 450), @__request_KeyName_1='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[config_id], [m].[key_name], [m].[last_updated], [m].[page], [m].[value]
FROM [master_config] AS [m]
WHERE [m].[page] = @__request_Page_0 AND [m].[key_name] = @__request_KeyName_1
2025-02-05 09:12:03.261 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 09:12:03.263 +03:00 [INF] Executed action NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI) in 35.8428ms
2025-02-05 09:12:03.268 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 09:12:03.270 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - 200 null application/json; charset=utf-8 47.3519ms
2025-02-05 09:12:03.546 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - application/json; charset=utf-8 36
2025-02-05 09:12:03.548 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 09:12:03.631 +03:00 [INF] Route matched with {action = "MasterFetch", controller = "Content"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] MasterFetch(NayifatAPI.Controllers.MasterFetchRequest) on controller NayifatAPI.Controllers.ContentController (NayifatAPI).
2025-02-05 09:12:03.835 +03:00 [INF] Executed DbCommand (4ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 09:12:03.844 +03:00 [INF] Executed DbCommand (6ms) [Parameters=[@__request_Page_0='?' (Size = 450), @__request_KeyName_1='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[config_id], [m].[key_name], [m].[last_updated], [m].[page], [m].[value]
FROM [master_config] AS [m]
WHERE [m].[page] = @__request_Page_0 AND [m].[key_name] = @__request_KeyName_1
2025-02-05 09:12:03.845 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 09:12:03.847 +03:00 [INF] Executed action NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI) in 17.1061ms
2025-02-05 09:12:03.848 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 09:12:03.848 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - 200 null application/json; charset=utf-8 302.7356ms
2025-02-05 09:12:04.607 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - application/json; charset=utf-8 36
2025-02-05 09:12:04.868 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 09:12:04.869 +03:00 [INF] Route matched with {action = "MasterFetch", controller = "Content"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] MasterFetch(NayifatAPI.Controllers.MasterFetchRequest) on controller NayifatAPI.Controllers.ContentController (NayifatAPI).
2025-02-05 09:12:04.877 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 09:12:05.061 +03:00 [INF] Executed DbCommand (182ms) [Parameters=[@__request_Page_0='?' (Size = 450), @__request_KeyName_1='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[config_id], [m].[key_name], [m].[last_updated], [m].[page], [m].[value]
FROM [master_config] AS [m]
WHERE [m].[page] = @__request_Page_0 AND [m].[key_name] = @__request_KeyName_1
2025-02-05 09:12:05.449 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 09:12:05.451 +03:00 [INF] Executed action NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI) in 578.3047ms
2025-02-05 09:12:05.963 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 09:12:05.965 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - 200 null application/json; charset=utf-8 1357.9362ms
2025-02-05 09:12:22.605 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/list - application/json 39
2025-02-05 09:12:22.613 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI)'
2025-02-05 09:12:22.615 +03:00 [INF] Route matched with {action = "GetNotifications", controller = "Notifications"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetNotifications(NayifatAPI.Controllers.GetNotificationsRequest) on controller NayifatAPI.Controllers.NotificationsController (NayifatAPI).
2025-02-05 09:12:22.623 +03:00 [INF] Executed DbCommand (4ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 09:12:22.640 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[@__request_NationalId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[national_id], [u].[last_updated], [u].[notifications]
FROM [user_notifications] AS [u]
WHERE [u].[national_id] = @__request_NationalId_0
2025-02-05 09:12:22.646 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[@__Parse_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [n].[Id], [n].[additional_data], [n].[Body], [n].[body_ar], [n].[body_en], [n].[created_at], [n].[expiry_at], [n].[Route], [n].[target_criteria], [n].[Title], [n].[title_ar], [n].[title_en]
FROM [notification_templates] AS [n]
WHERE [n].[Id] = @__Parse_0
2025-02-05 09:12:22.649 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__Parse_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [n].[Id], [n].[additional_data], [n].[Body], [n].[body_ar], [n].[body_en], [n].[created_at], [n].[expiry_at], [n].[Route], [n].[target_criteria], [n].[Title], [n].[title_ar], [n].[title_en]
FROM [notification_templates] AS [n]
WHERE [n].[Id] = @__Parse_0
2025-02-05 09:12:22.653 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__Parse_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [n].[Id], [n].[additional_data], [n].[Body], [n].[body_ar], [n].[body_en], [n].[created_at], [n].[expiry_at], [n].[Route], [n].[target_criteria], [n].[Title], [n].[title_ar], [n].[title_en]
FROM [notification_templates] AS [n]
WHERE [n].[Id] = @__Parse_0
2025-02-05 09:12:22.656 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__Parse_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [n].[Id], [n].[additional_data], [n].[Body], [n].[body_ar], [n].[body_en], [n].[created_at], [n].[expiry_at], [n].[Route], [n].[target_criteria], [n].[Title], [n].[title_ar], [n].[title_en]
FROM [notification_templates] AS [n]
WHERE [n].[Id] = @__Parse_0
2025-02-05 09:12:22.669 +03:00 [INF] Executed DbCommand (11ms) [Parameters=[@p0='?' (Size = 4000), @p1='?' (DbType = DateTime2), @p2='?' (Size = 4000), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (Size = 450), @p6='?' (Size = 4000), @p7='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [AuthLogs] ([AuthType], [CreatedAt], [DeviceId], [FailureReason], [IpAddress], [NationalId], [Status], [UserAgent])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7);
2025-02-05 09:12:22.675 +03:00 [ERR] An exception occurred in the database while saving changes for context type 'NayifatAPI.Data.ApplicationDbContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_AuthLogs_Customers_NationalId". The conflict occurred in database "NayifatApp", table "dbo.Customers", column 'NationalId'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:c3a4aaca-a3c2-49b8-b397-bbbd1285c502
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_AuthLogs_Customers_NationalId". The conflict occurred in database "NayifatApp", table "dbo.Customers", column 'NationalId'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:c3a4aaca-a3c2-49b8-b397-bbbd1285c502
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2025-02-05 09:12:23.166 +03:00 [ERR] Error logging audit event. NationalId: all, Action: notification_delivered, Details: {"notification_count":4,"notification_ids":[20,19,18,12],"timestamp":"2025-02-05T09:12:22.642806"}
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_AuthLogs_Customers_NationalId". The conflict occurred in database "NayifatApp", table "dbo.Customers", column 'NationalId'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:c3a4aaca-a3c2-49b8-b397-bbbd1285c502
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at NayifatAPI.Services.AuditLogService.LogAsync(String nationalId, String action, Object details) in C:\Users\yamta\StudioProjects\nayifat_app_2025_new\nayifatapi\Services\AuditLogService.cs:line 36
2025-02-05 09:12:23.236 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 09:12:23.238 +03:00 [INF] Executed action NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI) in 620.4949ms
2025-02-05 09:12:23.243 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI)'
2025-02-05 09:12:23.245 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/list - 200 null application/json; charset=utf-8 639.9657ms
2025-02-05 09:12:23.511 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/list - application/json 45
2025-02-05 09:12:23.535 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI)'
2025-02-05 09:12:23.538 +03:00 [INF] Route matched with {action = "GetNotifications", controller = "Notifications"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetNotifications(NayifatAPI.Controllers.GetNotificationsRequest) on controller NayifatAPI.Controllers.NotificationsController (NayifatAPI).
2025-02-05 09:12:23.580 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 09:12:23.593 +03:00 [INF] Executed DbCommand (8ms) [Parameters=[@__request_NationalId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[national_id], [u].[last_updated], [u].[notifications]
FROM [user_notifications] AS [u]
WHERE [u].[national_id] = @__request_NationalId_0
2025-02-05 09:12:23.663 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 09:12:23.666 +03:00 [INF] Executed action NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI) in 88.5979ms
2025-02-05 09:12:23.672 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI)'
2025-02-05 09:12:23.676 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/list - 200 null application/json; charset=utf-8 165.2938ms
2025-02-05 09:12:33.718 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/list - application/json; charset=utf-8 45
2025-02-05 09:12:33.720 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI)'
2025-02-05 09:12:33.720 +03:00 [INF] Route matched with {action = "GetNotifications", controller = "Notifications"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetNotifications(NayifatAPI.Controllers.GetNotificationsRequest) on controller NayifatAPI.Controllers.NotificationsController (NayifatAPI).
2025-02-05 09:12:33.723 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 09:12:33.726 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__request_NationalId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[national_id], [u].[last_updated], [u].[notifications]
FROM [user_notifications] AS [u]
WHERE [u].[national_id] = @__request_NationalId_0
2025-02-05 09:12:33.728 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 09:12:33.729 +03:00 [INF] Executed action NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI) in 7.098ms
2025-02-05 09:12:33.730 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI)'
2025-02-05 09:12:33.731 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/list - 200 null application/json; charset=utf-8 13.6004ms
2025-02-05 09:12:34.207 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/list - application/json; charset=utf-8 39
2025-02-05 09:12:34.210 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI)'
2025-02-05 09:12:34.212 +03:00 [INF] Route matched with {action = "GetNotifications", controller = "Notifications"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetNotifications(NayifatAPI.Controllers.GetNotificationsRequest) on controller NayifatAPI.Controllers.NotificationsController (NayifatAPI).
2025-02-05 09:12:34.215 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 09:12:34.219 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__request_NationalId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[national_id], [u].[last_updated], [u].[notifications]
FROM [user_notifications] AS [u]
WHERE [u].[national_id] = @__request_NationalId_0
2025-02-05 09:12:34.222 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__Parse_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [n].[Id], [n].[additional_data], [n].[Body], [n].[body_ar], [n].[body_en], [n].[created_at], [n].[expiry_at], [n].[Route], [n].[target_criteria], [n].[Title], [n].[title_ar], [n].[title_en]
FROM [notification_templates] AS [n]
WHERE [n].[Id] = @__Parse_0
2025-02-05 09:12:34.224 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__Parse_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [n].[Id], [n].[additional_data], [n].[Body], [n].[body_ar], [n].[body_en], [n].[created_at], [n].[expiry_at], [n].[Route], [n].[target_criteria], [n].[Title], [n].[title_ar], [n].[title_en]
FROM [notification_templates] AS [n]
WHERE [n].[Id] = @__Parse_0
2025-02-05 09:12:34.227 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__Parse_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [n].[Id], [n].[additional_data], [n].[Body], [n].[body_ar], [n].[body_en], [n].[created_at], [n].[expiry_at], [n].[Route], [n].[target_criteria], [n].[Title], [n].[title_ar], [n].[title_en]
FROM [notification_templates] AS [n]
WHERE [n].[Id] = @__Parse_0
2025-02-05 09:12:34.229 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__Parse_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [n].[Id], [n].[additional_data], [n].[Body], [n].[body_ar], [n].[body_en], [n].[created_at], [n].[expiry_at], [n].[Route], [n].[target_criteria], [n].[Title], [n].[title_ar], [n].[title_en]
FROM [notification_templates] AS [n]
WHERE [n].[Id] = @__Parse_0
2025-02-05 09:12:34.233 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@p0='?' (Size = 4000), @p1='?' (DbType = DateTime2), @p2='?' (Size = 4000), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (Size = 450), @p6='?' (Size = 4000), @p7='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [AuthLogs] ([AuthType], [CreatedAt], [DeviceId], [FailureReason], [IpAddress], [NationalId], [Status], [UserAgent])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7);
2025-02-05 09:12:34.237 +03:00 [ERR] An exception occurred in the database while saving changes for context type 'NayifatAPI.Data.ApplicationDbContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_AuthLogs_Customers_NationalId". The conflict occurred in database "NayifatApp", table "dbo.Customers", column 'NationalId'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:c3a4aaca-a3c2-49b8-b397-bbbd1285c502
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_AuthLogs_Customers_NationalId". The conflict occurred in database "NayifatApp", table "dbo.Customers", column 'NationalId'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:c3a4aaca-a3c2-49b8-b397-bbbd1285c502
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2025-02-05 09:12:34.251 +03:00 [ERR] Error logging audit event. NationalId: all, Action: notification_delivered, Details: {"notification_count":4,"notification_ids":[20,19,18,12],"timestamp":"2025-02-05T09:12:34.2211998"}
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_AuthLogs_Customers_NationalId". The conflict occurred in database "NayifatApp", table "dbo.Customers", column 'NationalId'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:c3a4aaca-a3c2-49b8-b397-bbbd1285c502
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at NayifatAPI.Services.AuditLogService.LogAsync(String nationalId, String action, Object details) in C:\Users\yamta\StudioProjects\nayifat_app_2025_new\nayifatapi\Services\AuditLogService.cs:line 36
2025-02-05 09:12:34.262 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 09:12:34.264 +03:00 [INF] Executed action NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI) in 50.5606ms
2025-02-05 09:12:34.265 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI)'
2025-02-05 09:12:34.266 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/list - 200 null application/json; charset=utf-8 59.3025ms
2025-02-05 09:14:50.723 +03:00 [INF] Application is shutting down...
2025-02-05 09:15:06.593 +03:00 [INF] Starting web application
2025-02-05 09:15:06.681 +03:00 [INF] Now listening on: http://localhost:5264
2025-02-05 09:15:06.684 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2025-02-05 09:15:06.685 +03:00 [INF] Hosting environment: Development
2025-02-05 09:15:06.686 +03:00 [INF] Content root path: C:\Users\yamta\StudioProjects\nayifat_app_2025_new\nayifatapi
2025-02-05 09:17:35.030 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/list - application/json; charset=utf-8 45
2025-02-05 09:17:35.117 +03:00 [WRN] Failed to determine the https port for redirect.
2025-02-05 09:17:35.125 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI)'
2025-02-05 09:17:35.173 +03:00 [INF] Route matched with {action = "GetNotifications", controller = "Notifications"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetNotifications(NayifatAPI.Controllers.GetNotificationsRequest) on controller NayifatAPI.Controllers.NotificationsController (NayifatAPI).
2025-02-05 09:17:38.611 +03:00 [INF] Executed DbCommand (61ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 09:17:39.058 +03:00 [INF] Executed DbCommand (68ms) [Parameters=[@__request_NationalId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[national_id], [u].[last_updated], [u].[notifications]
FROM [user_notifications] AS [u]
WHERE [u].[national_id] = @__request_NationalId_0
2025-02-05 09:17:39.224 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 09:17:39.243 +03:00 [INF] Executed action NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI) in 4061.0425ms
2025-02-05 09:17:39.319 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI)'
2025-02-05 09:17:39.527 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/list - 200 null application/json; charset=utf-8 4500.3353ms
2025-02-05 09:17:40.838 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/list - application/json; charset=utf-8 39
2025-02-05 09:17:40.853 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI)'
2025-02-05 09:17:40.855 +03:00 [INF] Route matched with {action = "GetNotifications", controller = "Notifications"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetNotifications(NayifatAPI.Controllers.GetNotificationsRequest) on controller NayifatAPI.Controllers.NotificationsController (NayifatAPI).
2025-02-05 09:17:40.957 +03:00 [INF] Executed DbCommand (27ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 09:17:41.191 +03:00 [INF] Executed DbCommand (43ms) [Parameters=[@__request_NationalId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[national_id], [u].[last_updated], [u].[notifications]
FROM [user_notifications] AS [u]
WHERE [u].[national_id] = @__request_NationalId_0
2025-02-05 09:17:41.380 +03:00 [INF] Executed DbCommand (39ms) [Parameters=[@__Parse_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [n].[Id], [n].[additional_data], [n].[Body], [n].[body_ar], [n].[body_en], [n].[created_at], [n].[expiry_at], [n].[Route], [n].[target_criteria], [n].[Title], [n].[title_ar], [n].[title_en]
FROM [notification_templates] AS [n]
WHERE [n].[Id] = @__Parse_0
2025-02-05 09:17:41.917 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__Parse_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [n].[Id], [n].[additional_data], [n].[Body], [n].[body_ar], [n].[body_en], [n].[created_at], [n].[expiry_at], [n].[Route], [n].[target_criteria], [n].[Title], [n].[title_ar], [n].[title_en]
FROM [notification_templates] AS [n]
WHERE [n].[Id] = @__Parse_0
2025-02-05 09:17:41.937 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__Parse_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [n].[Id], [n].[additional_data], [n].[Body], [n].[body_ar], [n].[body_en], [n].[created_at], [n].[expiry_at], [n].[Route], [n].[target_criteria], [n].[Title], [n].[title_ar], [n].[title_en]
FROM [notification_templates] AS [n]
WHERE [n].[Id] = @__Parse_0
2025-02-05 09:17:41.942 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__Parse_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [n].[Id], [n].[additional_data], [n].[Body], [n].[body_ar], [n].[body_en], [n].[created_at], [n].[expiry_at], [n].[Route], [n].[target_criteria], [n].[Title], [n].[title_ar], [n].[title_en]
FROM [notification_templates] AS [n]
WHERE [n].[Id] = @__Parse_0
2025-02-05 09:17:42.279 +03:00 [INF] Executed DbCommand (13ms) [Parameters=[@p0='?' (Size = 4000), @p1='?' (DbType = DateTime2), @p2='?' (Size = 4000), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (Size = 450), @p6='?' (Size = 4000), @p7='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [AuthLogs] ([AuthType], [CreatedAt], [DeviceId], [FailureReason], [IpAddress], [NationalId], [Status], [UserAgent])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7);
2025-02-05 09:17:42.343 +03:00 [ERR] An exception occurred in the database while saving changes for context type 'NayifatAPI.Data.ApplicationDbContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_AuthLogs_Customers_NationalId". The conflict occurred in database "NayifatApp", table "dbo.Customers", column 'NationalId'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:1590a622-44c7-499e-98ee-84f3dcf19821
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_AuthLogs_Customers_NationalId". The conflict occurred in database "NayifatApp", table "dbo.Customers", column 'NationalId'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:1590a622-44c7-499e-98ee-84f3dcf19821
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2025-02-05 09:17:42.394 +03:00 [ERR] Error logging audit event. NationalId: all, Action: notification_delivered, Details: {"notification_count":4,"notification_ids":[20,19,18,12],"timestamp":"2025-02-05T09:17:41.316956"}
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_AuthLogs_Customers_NationalId". The conflict occurred in database "NayifatApp", table "dbo.Customers", column 'NationalId'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:1590a622-44c7-499e-98ee-84f3dcf19821
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at NayifatAPI.Services.AuditLogService.LogAsync(String nationalId, String action, Object details) in C:\Users\yamta\StudioProjects\nayifat_app_2025_new\nayifatapi\Services\AuditLogService.cs:line 36
2025-02-05 09:17:42.439 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 09:17:42.453 +03:00 [INF] Executed action NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI) in 1566.0814ms
2025-02-05 09:17:42.467 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI)'
2025-02-05 09:17:42.469 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/list - 200 null application/json; charset=utf-8 1631.0921ms
2025-02-05 09:18:48.229 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/list - application/json 39
2025-02-05 09:18:48.235 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI)'
2025-02-05 09:18:48.236 +03:00 [INF] Route matched with {action = "GetNotifications", controller = "Notifications"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetNotifications(NayifatAPI.Controllers.GetNotificationsRequest) on controller NayifatAPI.Controllers.NotificationsController (NayifatAPI).
2025-02-05 09:18:48.338 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 09:18:48.347 +03:00 [INF] Executed DbCommand (4ms) [Parameters=[@__request_NationalId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[national_id], [u].[last_updated], [u].[notifications]
FROM [user_notifications] AS [u]
WHERE [u].[national_id] = @__request_NationalId_0
2025-02-05 09:18:48.356 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[@__Parse_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [n].[Id], [n].[additional_data], [n].[Body], [n].[body_ar], [n].[body_en], [n].[created_at], [n].[expiry_at], [n].[Route], [n].[target_criteria], [n].[Title], [n].[title_ar], [n].[title_en]
FROM [notification_templates] AS [n]
WHERE [n].[Id] = @__Parse_0
2025-02-05 09:18:48.364 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__Parse_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [n].[Id], [n].[additional_data], [n].[Body], [n].[body_ar], [n].[body_en], [n].[created_at], [n].[expiry_at], [n].[Route], [n].[target_criteria], [n].[Title], [n].[title_ar], [n].[title_en]
FROM [notification_templates] AS [n]
WHERE [n].[Id] = @__Parse_0
2025-02-05 09:18:48.368 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__Parse_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [n].[Id], [n].[additional_data], [n].[Body], [n].[body_ar], [n].[body_en], [n].[created_at], [n].[expiry_at], [n].[Route], [n].[target_criteria], [n].[Title], [n].[title_ar], [n].[title_en]
FROM [notification_templates] AS [n]
WHERE [n].[Id] = @__Parse_0
2025-02-05 09:18:48.372 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__Parse_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [n].[Id], [n].[additional_data], [n].[Body], [n].[body_ar], [n].[body_en], [n].[created_at], [n].[expiry_at], [n].[Route], [n].[target_criteria], [n].[Title], [n].[title_ar], [n].[title_en]
FROM [notification_templates] AS [n]
WHERE [n].[Id] = @__Parse_0
2025-02-05 09:18:48.385 +03:00 [INF] Executed DbCommand (5ms) [Parameters=[@p0='?' (Size = 4000), @p1='?' (DbType = DateTime2), @p2='?' (Size = 4000), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (Size = 450), @p6='?' (Size = 4000), @p7='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [AuthLogs] ([AuthType], [CreatedAt], [DeviceId], [FailureReason], [IpAddress], [NationalId], [Status], [UserAgent])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7);
2025-02-05 09:18:48.391 +03:00 [ERR] An exception occurred in the database while saving changes for context type 'NayifatAPI.Data.ApplicationDbContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_AuthLogs_Customers_NationalId". The conflict occurred in database "NayifatApp", table "dbo.Customers", column 'NationalId'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:1590a622-44c7-499e-98ee-84f3dcf19821
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_AuthLogs_Customers_NationalId". The conflict occurred in database "NayifatApp", table "dbo.Customers", column 'NationalId'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:1590a622-44c7-499e-98ee-84f3dcf19821
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2025-02-05 09:18:48.405 +03:00 [ERR] Error logging audit event. NationalId: all, Action: notification_delivered, Details: {"notification_count":4,"notification_ids":[20,19,18,12],"timestamp":"2025-02-05T09:18:48.3514018"}
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_AuthLogs_Customers_NationalId". The conflict occurred in database "NayifatApp", table "dbo.Customers", column 'NationalId'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:1590a622-44c7-499e-98ee-84f3dcf19821
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at NayifatAPI.Services.AuditLogService.LogAsync(String nationalId, String action, Object details) in C:\Users\yamta\StudioProjects\nayifat_app_2025_new\nayifatapi\Services\AuditLogService.cs:line 36
2025-02-05 09:18:48.417 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 09:18:48.419 +03:00 [INF] Executed action NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI) in 180.5795ms
2025-02-05 09:18:48.420 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI)'
2025-02-05 09:18:48.424 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/list - 200 null application/json; charset=utf-8 194.6642ms
2025-02-05 09:18:48.548 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/list - application/json 45
2025-02-05 09:18:48.551 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI)'
2025-02-05 09:18:48.553 +03:00 [INF] Route matched with {action = "GetNotifications", controller = "Notifications"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetNotifications(NayifatAPI.Controllers.GetNotificationsRequest) on controller NayifatAPI.Controllers.NotificationsController (NayifatAPI).
2025-02-05 09:18:48.560 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 09:18:48.567 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__request_NationalId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[national_id], [u].[last_updated], [u].[notifications]
FROM [user_notifications] AS [u]
WHERE [u].[national_id] = @__request_NationalId_0
2025-02-05 09:18:48.572 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 09:18:48.576 +03:00 [INF] Executed action NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI) in 19.3572ms
2025-02-05 09:18:48.606 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI)'
2025-02-05 09:18:48.608 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/list - 200 null application/json; charset=utf-8 59.4232ms
2025-02-05 09:18:59.755 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/list - application/json; charset=utf-8 45
2025-02-05 09:18:59.757 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI)'
2025-02-05 09:18:59.758 +03:00 [INF] Route matched with {action = "GetNotifications", controller = "Notifications"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetNotifications(NayifatAPI.Controllers.GetNotificationsRequest) on controller NayifatAPI.Controllers.NotificationsController (NayifatAPI).
2025-02-05 09:18:59.798 +03:00 [INF] Executed DbCommand (19ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 09:18:59.823 +03:00 [INF] Executed DbCommand (22ms) [Parameters=[@__request_NationalId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[national_id], [u].[last_updated], [u].[notifications]
FROM [user_notifications] AS [u]
WHERE [u].[national_id] = @__request_NationalId_0
2025-02-05 09:19:00.052 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 09:19:00.054 +03:00 [INF] Executed action NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI) in 294.7724ms
2025-02-05 09:19:00.056 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI)'
2025-02-05 09:19:00.058 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/list - 200 null application/json; charset=utf-8 302.7913ms
2025-02-05 09:19:00.837 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/list - application/json; charset=utf-8 39
2025-02-05 09:19:00.960 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI)'
2025-02-05 09:19:00.961 +03:00 [INF] Route matched with {action = "GetNotifications", controller = "Notifications"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetNotifications(NayifatAPI.Controllers.GetNotificationsRequest) on controller NayifatAPI.Controllers.NotificationsController (NayifatAPI).
2025-02-05 09:19:00.976 +03:00 [INF] Executed DbCommand (10ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 09:19:00.992 +03:00 [INF] Executed DbCommand (13ms) [Parameters=[@__request_NationalId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[national_id], [u].[last_updated], [u].[notifications]
FROM [user_notifications] AS [u]
WHERE [u].[national_id] = @__request_NationalId_0
2025-02-05 09:19:01.013 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__Parse_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [n].[Id], [n].[additional_data], [n].[Body], [n].[body_ar], [n].[body_en], [n].[created_at], [n].[expiry_at], [n].[Route], [n].[target_criteria], [n].[Title], [n].[title_ar], [n].[title_en]
FROM [notification_templates] AS [n]
WHERE [n].[Id] = @__Parse_0
2025-02-05 09:19:01.016 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__Parse_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [n].[Id], [n].[additional_data], [n].[Body], [n].[body_ar], [n].[body_en], [n].[created_at], [n].[expiry_at], [n].[Route], [n].[target_criteria], [n].[Title], [n].[title_ar], [n].[title_en]
FROM [notification_templates] AS [n]
WHERE [n].[Id] = @__Parse_0
2025-02-05 09:19:01.019 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__Parse_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [n].[Id], [n].[additional_data], [n].[Body], [n].[body_ar], [n].[body_en], [n].[created_at], [n].[expiry_at], [n].[Route], [n].[target_criteria], [n].[Title], [n].[title_ar], [n].[title_en]
FROM [notification_templates] AS [n]
WHERE [n].[Id] = @__Parse_0
2025-02-05 09:19:01.022 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__Parse_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [n].[Id], [n].[additional_data], [n].[Body], [n].[body_ar], [n].[body_en], [n].[created_at], [n].[expiry_at], [n].[Route], [n].[target_criteria], [n].[Title], [n].[title_ar], [n].[title_en]
FROM [notification_templates] AS [n]
WHERE [n].[Id] = @__Parse_0
2025-02-05 09:19:01.025 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@p0='?' (Size = 4000), @p1='?' (DbType = DateTime2), @p2='?' (Size = 4000), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (Size = 450), @p6='?' (Size = 4000), @p7='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [AuthLogs] ([AuthType], [CreatedAt], [DeviceId], [FailureReason], [IpAddress], [NationalId], [Status], [UserAgent])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7);
2025-02-05 09:19:01.030 +03:00 [ERR] An exception occurred in the database while saving changes for context type 'NayifatAPI.Data.ApplicationDbContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_AuthLogs_Customers_NationalId". The conflict occurred in database "NayifatApp", table "dbo.Customers", column 'NationalId'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:1590a622-44c7-499e-98ee-84f3dcf19821
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_AuthLogs_Customers_NationalId". The conflict occurred in database "NayifatApp", table "dbo.Customers", column 'NationalId'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:1590a622-44c7-499e-98ee-84f3dcf19821
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2025-02-05 09:19:01.039 +03:00 [ERR] Error logging audit event. NationalId: all, Action: notification_delivered, Details: {"notification_count":4,"notification_ids":[20,19,18,12],"timestamp":"2025-02-05T09:19:01.0115938"}
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_AuthLogs_Customers_NationalId". The conflict occurred in database "NayifatApp", table "dbo.Customers", column 'NationalId'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:1590a622-44c7-499e-98ee-84f3dcf19821
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at NayifatAPI.Services.AuditLogService.LogAsync(String nationalId, String action, Object details) in C:\Users\yamta\StudioProjects\nayifat_app_2025_new\nayifatapi\Services\AuditLogService.cs:line 36
2025-02-05 09:19:01.049 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 09:19:01.050 +03:00 [INF] Executed action NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI) in 86.4971ms
2025-02-05 09:19:01.051 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI)'
2025-02-05 09:19:01.052 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/list - 200 null application/json; charset=utf-8 214.8637ms
2025-02-05 09:20:44.420 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/list - application/json; charset=utf-8 45
2025-02-05 09:20:44.500 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI)'
2025-02-05 09:20:44.502 +03:00 [INF] Route matched with {action = "GetNotifications", controller = "Notifications"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetNotifications(NayifatAPI.Controllers.GetNotificationsRequest) on controller NayifatAPI.Controllers.NotificationsController (NayifatAPI).
2025-02-05 09:20:44.509 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 09:20:44.515 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[@__request_NationalId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[national_id], [u].[last_updated], [u].[notifications]
FROM [user_notifications] AS [u]
WHERE [u].[national_id] = @__request_NationalId_0
2025-02-05 09:20:44.518 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 09:20:44.520 +03:00 [INF] Executed action NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI) in 16.7932ms
2025-02-05 09:20:44.521 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI)'
2025-02-05 09:20:44.523 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/list - 200 null application/json; charset=utf-8 102.7528ms
2025-02-05 09:20:45.085 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/list - application/json; charset=utf-8 39
2025-02-05 09:20:45.099 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI)'
2025-02-05 09:20:45.106 +03:00 [INF] Route matched with {action = "GetNotifications", controller = "Notifications"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetNotifications(NayifatAPI.Controllers.GetNotificationsRequest) on controller NayifatAPI.Controllers.NotificationsController (NayifatAPI).
2025-02-05 09:20:45.119 +03:00 [INF] Executed DbCommand (9ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 09:20:45.141 +03:00 [INF] Executed DbCommand (18ms) [Parameters=[@__request_NationalId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[national_id], [u].[last_updated], [u].[notifications]
FROM [user_notifications] AS [u]
WHERE [u].[national_id] = @__request_NationalId_0
2025-02-05 09:20:45.221 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__Parse_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [n].[Id], [n].[additional_data], [n].[Body], [n].[body_ar], [n].[body_en], [n].[created_at], [n].[expiry_at], [n].[Route], [n].[target_criteria], [n].[Title], [n].[title_ar], [n].[title_en]
FROM [notification_templates] AS [n]
WHERE [n].[Id] = @__Parse_0
2025-02-05 09:20:45.228 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__Parse_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [n].[Id], [n].[additional_data], [n].[Body], [n].[body_ar], [n].[body_en], [n].[created_at], [n].[expiry_at], [n].[Route], [n].[target_criteria], [n].[Title], [n].[title_ar], [n].[title_en]
FROM [notification_templates] AS [n]
WHERE [n].[Id] = @__Parse_0
2025-02-05 09:20:45.232 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__Parse_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [n].[Id], [n].[additional_data], [n].[Body], [n].[body_ar], [n].[body_en], [n].[created_at], [n].[expiry_at], [n].[Route], [n].[target_criteria], [n].[Title], [n].[title_ar], [n].[title_en]
FROM [notification_templates] AS [n]
WHERE [n].[Id] = @__Parse_0
2025-02-05 09:20:45.235 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__Parse_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [n].[Id], [n].[additional_data], [n].[Body], [n].[body_ar], [n].[body_en], [n].[created_at], [n].[expiry_at], [n].[Route], [n].[target_criteria], [n].[Title], [n].[title_ar], [n].[title_en]
FROM [notification_templates] AS [n]
WHERE [n].[Id] = @__Parse_0
2025-02-05 09:20:45.246 +03:00 [INF] Executed DbCommand (4ms) [Parameters=[@p0='?' (Size = 4000), @p1='?' (DbType = DateTime2), @p2='?' (Size = 4000), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (Size = 450), @p6='?' (Size = 4000), @p7='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [AuthLogs] ([AuthType], [CreatedAt], [DeviceId], [FailureReason], [IpAddress], [NationalId], [Status], [UserAgent])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7);
2025-02-05 09:20:45.249 +03:00 [ERR] An exception occurred in the database while saving changes for context type 'NayifatAPI.Data.ApplicationDbContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_AuthLogs_Customers_NationalId". The conflict occurred in database "NayifatApp", table "dbo.Customers", column 'NationalId'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:1590a622-44c7-499e-98ee-84f3dcf19821
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_AuthLogs_Customers_NationalId". The conflict occurred in database "NayifatApp", table "dbo.Customers", column 'NationalId'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:1590a622-44c7-499e-98ee-84f3dcf19821
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2025-02-05 09:20:45.262 +03:00 [ERR] Error logging audit event. NationalId: all, Action: notification_delivered, Details: {"notification_count":4,"notification_ids":[20,19,18,12],"timestamp":"2025-02-05T09:20:45.2182044"}
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_AuthLogs_Customers_NationalId". The conflict occurred in database "NayifatApp", table "dbo.Customers", column 'NationalId'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:1590a622-44c7-499e-98ee-84f3dcf19821
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at NayifatAPI.Services.AuditLogService.LogAsync(String nationalId, String action, Object details) in C:\Users\yamta\StudioProjects\nayifat_app_2025_new\nayifatapi\Services\AuditLogService.cs:line 36
2025-02-05 09:20:45.271 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 09:20:45.272 +03:00 [INF] Executed action NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI) in 164.439ms
2025-02-05 09:20:45.274 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI)'
2025-02-05 09:20:45.275 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/list - 200 null application/json; charset=utf-8 189.1776ms
2025-02-05 09:21:33.533 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/list - application/json; charset=utf-8 45
2025-02-05 09:21:33.537 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI)'
2025-02-05 09:21:33.539 +03:00 [INF] Route matched with {action = "GetNotifications", controller = "Notifications"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetNotifications(NayifatAPI.Controllers.GetNotificationsRequest) on controller NayifatAPI.Controllers.NotificationsController (NayifatAPI).
2025-02-05 09:21:33.545 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 09:21:33.555 +03:00 [INF] Executed DbCommand (5ms) [Parameters=[@__request_NationalId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[national_id], [u].[last_updated], [u].[notifications]
FROM [user_notifications] AS [u]
WHERE [u].[national_id] = @__request_NationalId_0
2025-02-05 09:21:33.559 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 09:21:33.562 +03:00 [INF] Executed action NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI) in 21.7215ms
2025-02-05 09:21:33.564 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI)'
2025-02-05 09:21:33.566 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/list - 200 null application/json; charset=utf-8 33.0505ms
2025-02-05 09:21:33.992 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/list - application/json; charset=utf-8 39
2025-02-05 09:21:33.995 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI)'
2025-02-05 09:21:33.996 +03:00 [INF] Route matched with {action = "GetNotifications", controller = "Notifications"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetNotifications(NayifatAPI.Controllers.GetNotificationsRequest) on controller NayifatAPI.Controllers.NotificationsController (NayifatAPI).
2025-02-05 09:21:33.999 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 09:21:34.003 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__request_NationalId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[national_id], [u].[last_updated], [u].[notifications]
FROM [user_notifications] AS [u]
WHERE [u].[national_id] = @__request_NationalId_0
2025-02-05 09:21:34.007 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__Parse_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [n].[Id], [n].[additional_data], [n].[Body], [n].[body_ar], [n].[body_en], [n].[created_at], [n].[expiry_at], [n].[Route], [n].[target_criteria], [n].[Title], [n].[title_ar], [n].[title_en]
FROM [notification_templates] AS [n]
WHERE [n].[Id] = @__Parse_0
2025-02-05 09:21:34.011 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__Parse_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [n].[Id], [n].[additional_data], [n].[Body], [n].[body_ar], [n].[body_en], [n].[created_at], [n].[expiry_at], [n].[Route], [n].[target_criteria], [n].[Title], [n].[title_ar], [n].[title_en]
FROM [notification_templates] AS [n]
WHERE [n].[Id] = @__Parse_0
2025-02-05 09:21:34.015 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__Parse_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [n].[Id], [n].[additional_data], [n].[Body], [n].[body_ar], [n].[body_en], [n].[created_at], [n].[expiry_at], [n].[Route], [n].[target_criteria], [n].[Title], [n].[title_ar], [n].[title_en]
FROM [notification_templates] AS [n]
WHERE [n].[Id] = @__Parse_0
2025-02-05 09:21:34.019 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__Parse_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [n].[Id], [n].[additional_data], [n].[Body], [n].[body_ar], [n].[body_en], [n].[created_at], [n].[expiry_at], [n].[Route], [n].[target_criteria], [n].[Title], [n].[title_ar], [n].[title_en]
FROM [notification_templates] AS [n]
WHERE [n].[Id] = @__Parse_0
2025-02-05 09:21:34.027 +03:00 [INF] Executed DbCommand (5ms) [Parameters=[@p0='?' (Size = 4000), @p1='?' (DbType = DateTime2), @p2='?' (Size = 4000), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (Size = 450), @p6='?' (Size = 4000), @p7='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [AuthLogs] ([AuthType], [CreatedAt], [DeviceId], [FailureReason], [IpAddress], [NationalId], [Status], [UserAgent])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7);
2025-02-05 09:21:34.030 +03:00 [ERR] An exception occurred in the database while saving changes for context type 'NayifatAPI.Data.ApplicationDbContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_AuthLogs_Customers_NationalId". The conflict occurred in database "NayifatApp", table "dbo.Customers", column 'NationalId'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:1590a622-44c7-499e-98ee-84f3dcf19821
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_AuthLogs_Customers_NationalId". The conflict occurred in database "NayifatApp", table "dbo.Customers", column 'NationalId'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:1590a622-44c7-499e-98ee-84f3dcf19821
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2025-02-05 09:21:34.042 +03:00 [ERR] Error logging audit event. NationalId: all, Action: notification_delivered, Details: {"notification_count":4,"notification_ids":[20,19,18,12],"timestamp":"2025-02-05T09:21:34.0050538"}
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_AuthLogs_Customers_NationalId". The conflict occurred in database "NayifatApp", table "dbo.Customers", column 'NationalId'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:1590a622-44c7-499e-98ee-84f3dcf19821
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at NayifatAPI.Services.AuditLogService.LogAsync(String nationalId, String action, Object details) in C:\Users\yamta\StudioProjects\nayifat_app_2025_new\nayifatapi\Services\AuditLogService.cs:line 36
2025-02-05 09:21:34.052 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 09:21:34.054 +03:00 [INF] Executed action NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI) in 55.8315ms
2025-02-05 09:21:34.055 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI)'
2025-02-05 09:21:34.057 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/list - 200 null application/json; charset=utf-8 64.5582ms
2025-02-05 09:24:02.274 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/list - application/json; charset=utf-8 45
2025-02-05 09:24:02.715 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI)'
2025-02-05 09:24:02.716 +03:00 [INF] Route matched with {action = "GetNotifications", controller = "Notifications"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetNotifications(NayifatAPI.Controllers.GetNotificationsRequest) on controller NayifatAPI.Controllers.NotificationsController (NayifatAPI).
2025-02-05 09:24:02.727 +03:00 [INF] Executed DbCommand (5ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 09:24:02.733 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[@__request_NationalId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[national_id], [u].[last_updated], [u].[notifications]
FROM [user_notifications] AS [u]
WHERE [u].[national_id] = @__request_NationalId_0
2025-02-05 09:24:02.735 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 09:24:02.737 +03:00 [INF] Executed action NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI) in 17.014ms
2025-02-05 09:24:02.738 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI)'
2025-02-05 09:24:02.739 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/list - 200 null application/json; charset=utf-8 465.1221ms
2025-02-05 09:24:03.106 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/list - application/json; charset=utf-8 39
2025-02-05 09:24:03.109 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI)'
2025-02-05 09:24:03.110 +03:00 [INF] Route matched with {action = "GetNotifications", controller = "Notifications"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetNotifications(NayifatAPI.Controllers.GetNotificationsRequest) on controller NayifatAPI.Controllers.NotificationsController (NayifatAPI).
2025-02-05 09:24:03.114 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 09:24:03.117 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__request_NationalId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[national_id], [u].[last_updated], [u].[notifications]
FROM [user_notifications] AS [u]
WHERE [u].[national_id] = @__request_NationalId_0
2025-02-05 09:24:03.124 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__Parse_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [n].[Id], [n].[additional_data], [n].[Body], [n].[body_ar], [n].[body_en], [n].[created_at], [n].[expiry_at], [n].[Route], [n].[target_criteria], [n].[Title], [n].[title_ar], [n].[title_en]
FROM [notification_templates] AS [n]
WHERE [n].[Id] = @__Parse_0
2025-02-05 09:24:03.127 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__Parse_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [n].[Id], [n].[additional_data], [n].[Body], [n].[body_ar], [n].[body_en], [n].[created_at], [n].[expiry_at], [n].[Route], [n].[target_criteria], [n].[Title], [n].[title_ar], [n].[title_en]
FROM [notification_templates] AS [n]
WHERE [n].[Id] = @__Parse_0
2025-02-05 09:24:03.130 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__Parse_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [n].[Id], [n].[additional_data], [n].[Body], [n].[body_ar], [n].[body_en], [n].[created_at], [n].[expiry_at], [n].[Route], [n].[target_criteria], [n].[Title], [n].[title_ar], [n].[title_en]
FROM [notification_templates] AS [n]
WHERE [n].[Id] = @__Parse_0
2025-02-05 09:24:03.134 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__Parse_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [n].[Id], [n].[additional_data], [n].[Body], [n].[body_ar], [n].[body_en], [n].[created_at], [n].[expiry_at], [n].[Route], [n].[target_criteria], [n].[Title], [n].[title_ar], [n].[title_en]
FROM [notification_templates] AS [n]
WHERE [n].[Id] = @__Parse_0
2025-02-05 09:24:03.140 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[@p0='?' (Size = 4000), @p1='?' (DbType = DateTime2), @p2='?' (Size = 4000), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (Size = 450), @p6='?' (Size = 4000), @p7='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [AuthLogs] ([AuthType], [CreatedAt], [DeviceId], [FailureReason], [IpAddress], [NationalId], [Status], [UserAgent])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7);
2025-02-05 09:24:03.144 +03:00 [ERR] An exception occurred in the database while saving changes for context type 'NayifatAPI.Data.ApplicationDbContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_AuthLogs_Customers_NationalId". The conflict occurred in database "NayifatApp", table "dbo.Customers", column 'NationalId'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:1590a622-44c7-499e-98ee-84f3dcf19821
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_AuthLogs_Customers_NationalId". The conflict occurred in database "NayifatApp", table "dbo.Customers", column 'NationalId'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:1590a622-44c7-499e-98ee-84f3dcf19821
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2025-02-05 09:24:03.156 +03:00 [ERR] Error logging audit event. NationalId: all, Action: notification_delivered, Details: {"notification_count":4,"notification_ids":[20,19,18,12],"timestamp":"2025-02-05T09:24:03.1213762"}
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_AuthLogs_Customers_NationalId". The conflict occurred in database "NayifatApp", table "dbo.Customers", column 'NationalId'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:1590a622-44c7-499e-98ee-84f3dcf19821
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at NayifatAPI.Services.AuditLogService.LogAsync(String nationalId, String action, Object details) in C:\Users\yamta\StudioProjects\nayifat_app_2025_new\nayifatapi\Services\AuditLogService.cs:line 36
2025-02-05 09:24:03.167 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 09:24:03.168 +03:00 [INF] Executed action NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI) in 56.6369ms
2025-02-05 09:24:03.169 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI)'
2025-02-05 09:24:03.171 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/list - 200 null application/json; charset=utf-8 64.566ms
2025-02-05 09:25:46.054 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/list - application/json; charset=utf-8 45
2025-02-05 09:25:46.058 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI)'
2025-02-05 09:25:46.058 +03:00 [INF] Route matched with {action = "GetNotifications", controller = "Notifications"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetNotifications(NayifatAPI.Controllers.GetNotificationsRequest) on controller NayifatAPI.Controllers.NotificationsController (NayifatAPI).
2025-02-05 09:25:46.066 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 09:25:46.072 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__request_NationalId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[national_id], [u].[last_updated], [u].[notifications]
FROM [user_notifications] AS [u]
WHERE [u].[national_id] = @__request_NationalId_0
2025-02-05 09:25:46.075 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 09:25:46.076 +03:00 [INF] Executed action NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI) in 15.7605ms
2025-02-05 09:25:46.078 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI)'
2025-02-05 09:25:46.081 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/list - 200 null application/json; charset=utf-8 27.0233ms
2025-02-05 09:25:46.487 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/list - application/json; charset=utf-8 39
2025-02-05 09:25:46.491 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI)'
2025-02-05 09:25:46.492 +03:00 [INF] Route matched with {action = "GetNotifications", controller = "Notifications"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetNotifications(NayifatAPI.Controllers.GetNotificationsRequest) on controller NayifatAPI.Controllers.NotificationsController (NayifatAPI).
2025-02-05 09:25:46.499 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 09:25:46.503 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__request_NationalId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[national_id], [u].[last_updated], [u].[notifications]
FROM [user_notifications] AS [u]
WHERE [u].[national_id] = @__request_NationalId_0
2025-02-05 09:25:46.508 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__Parse_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [n].[Id], [n].[additional_data], [n].[Body], [n].[body_ar], [n].[body_en], [n].[created_at], [n].[expiry_at], [n].[Route], [n].[target_criteria], [n].[Title], [n].[title_ar], [n].[title_en]
FROM [notification_templates] AS [n]
WHERE [n].[Id] = @__Parse_0
2025-02-05 09:25:46.512 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__Parse_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [n].[Id], [n].[additional_data], [n].[Body], [n].[body_ar], [n].[body_en], [n].[created_at], [n].[expiry_at], [n].[Route], [n].[target_criteria], [n].[Title], [n].[title_ar], [n].[title_en]
FROM [notification_templates] AS [n]
WHERE [n].[Id] = @__Parse_0
2025-02-05 09:25:46.515 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__Parse_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [n].[Id], [n].[additional_data], [n].[Body], [n].[body_ar], [n].[body_en], [n].[created_at], [n].[expiry_at], [n].[Route], [n].[target_criteria], [n].[Title], [n].[title_ar], [n].[title_en]
FROM [notification_templates] AS [n]
WHERE [n].[Id] = @__Parse_0
2025-02-05 09:25:46.519 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__Parse_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [n].[Id], [n].[additional_data], [n].[Body], [n].[body_ar], [n].[body_en], [n].[created_at], [n].[expiry_at], [n].[Route], [n].[target_criteria], [n].[Title], [n].[title_ar], [n].[title_en]
FROM [notification_templates] AS [n]
WHERE [n].[Id] = @__Parse_0
2025-02-05 09:25:46.525 +03:00 [INF] Executed DbCommand (4ms) [Parameters=[@p0='?' (Size = 4000), @p1='?' (DbType = DateTime2), @p2='?' (Size = 4000), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (Size = 450), @p6='?' (Size = 4000), @p7='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [AuthLogs] ([AuthType], [CreatedAt], [DeviceId], [FailureReason], [IpAddress], [NationalId], [Status], [UserAgent])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7);
2025-02-05 09:25:46.530 +03:00 [ERR] An exception occurred in the database while saving changes for context type 'NayifatAPI.Data.ApplicationDbContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_AuthLogs_Customers_NationalId". The conflict occurred in database "NayifatApp", table "dbo.Customers", column 'NationalId'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:1590a622-44c7-499e-98ee-84f3dcf19821
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_AuthLogs_Customers_NationalId". The conflict occurred in database "NayifatApp", table "dbo.Customers", column 'NationalId'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:1590a622-44c7-499e-98ee-84f3dcf19821
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2025-02-05 09:25:46.544 +03:00 [ERR] Error logging audit event. NationalId: all, Action: notification_delivered, Details: {"notification_count":4,"notification_ids":[20,19,18,12],"timestamp":"2025-02-05T09:25:46.5063007"}
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_AuthLogs_Customers_NationalId". The conflict occurred in database "NayifatApp", table "dbo.Customers", column 'NationalId'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:1590a622-44c7-499e-98ee-84f3dcf19821
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at NayifatAPI.Services.AuditLogService.LogAsync(String nationalId, String action, Object details) in C:\Users\yamta\StudioProjects\nayifat_app_2025_new\nayifatapi\Services\AuditLogService.cs:line 36
2025-02-05 09:25:46.555 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 09:25:46.557 +03:00 [INF] Executed action NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI) in 60.3893ms
2025-02-05 09:25:46.560 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI)'
2025-02-05 09:25:46.561 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/list - 200 null application/json; charset=utf-8 73.9186ms
2025-02-05 09:26:34.697 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/list - application/json; charset=utf-8 45
2025-02-05 09:26:34.699 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI)'
2025-02-05 09:26:34.700 +03:00 [INF] Route matched with {action = "GetNotifications", controller = "Notifications"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetNotifications(NayifatAPI.Controllers.GetNotificationsRequest) on controller NayifatAPI.Controllers.NotificationsController (NayifatAPI).
2025-02-05 09:26:34.705 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 09:26:34.709 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__request_NationalId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[national_id], [u].[last_updated], [u].[notifications]
FROM [user_notifications] AS [u]
WHERE [u].[national_id] = @__request_NationalId_0
2025-02-05 09:26:34.712 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 09:26:34.713 +03:00 [INF] Executed action NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI) in 12.03ms
2025-02-05 09:26:34.714 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI)'
2025-02-05 09:26:34.715 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/list - 200 null application/json; charset=utf-8 18.5708ms
2025-02-05 09:26:35.114 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/list - application/json; charset=utf-8 39
2025-02-05 09:26:35.117 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI)'
2025-02-05 09:26:35.118 +03:00 [INF] Route matched with {action = "GetNotifications", controller = "Notifications"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetNotifications(NayifatAPI.Controllers.GetNotificationsRequest) on controller NayifatAPI.Controllers.NotificationsController (NayifatAPI).
2025-02-05 09:26:35.123 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 09:26:35.131 +03:00 [INF] Executed DbCommand (4ms) [Parameters=[@__request_NationalId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[national_id], [u].[last_updated], [u].[notifications]
FROM [user_notifications] AS [u]
WHERE [u].[national_id] = @__request_NationalId_0
2025-02-05 09:26:35.138 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[@__Parse_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [n].[Id], [n].[additional_data], [n].[Body], [n].[body_ar], [n].[body_en], [n].[created_at], [n].[expiry_at], [n].[Route], [n].[target_criteria], [n].[Title], [n].[title_ar], [n].[title_en]
FROM [notification_templates] AS [n]
WHERE [n].[Id] = @__Parse_0
2025-02-05 09:26:35.141 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__Parse_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [n].[Id], [n].[additional_data], [n].[Body], [n].[body_ar], [n].[body_en], [n].[created_at], [n].[expiry_at], [n].[Route], [n].[target_criteria], [n].[Title], [n].[title_ar], [n].[title_en]
FROM [notification_templates] AS [n]
WHERE [n].[Id] = @__Parse_0
2025-02-05 09:26:35.146 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__Parse_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [n].[Id], [n].[additional_data], [n].[Body], [n].[body_ar], [n].[body_en], [n].[created_at], [n].[expiry_at], [n].[Route], [n].[target_criteria], [n].[Title], [n].[title_ar], [n].[title_en]
FROM [notification_templates] AS [n]
WHERE [n].[Id] = @__Parse_0
2025-02-05 09:26:35.149 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__Parse_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [n].[Id], [n].[additional_data], [n].[Body], [n].[body_ar], [n].[body_en], [n].[created_at], [n].[expiry_at], [n].[Route], [n].[target_criteria], [n].[Title], [n].[title_ar], [n].[title_en]
FROM [notification_templates] AS [n]
WHERE [n].[Id] = @__Parse_0
2025-02-05 09:26:35.158 +03:00 [INF] Executed DbCommand (7ms) [Parameters=[@p0='?' (Size = 4000), @p1='?' (DbType = DateTime2), @p2='?' (Size = 4000), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (Size = 450), @p6='?' (Size = 4000), @p7='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [AuthLogs] ([AuthType], [CreatedAt], [DeviceId], [FailureReason], [IpAddress], [NationalId], [Status], [UserAgent])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7);
2025-02-05 09:26:35.164 +03:00 [ERR] An exception occurred in the database while saving changes for context type 'NayifatAPI.Data.ApplicationDbContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_AuthLogs_Customers_NationalId". The conflict occurred in database "NayifatApp", table "dbo.Customers", column 'NationalId'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:1590a622-44c7-499e-98ee-84f3dcf19821
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_AuthLogs_Customers_NationalId". The conflict occurred in database "NayifatApp", table "dbo.Customers", column 'NationalId'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:1590a622-44c7-499e-98ee-84f3dcf19821
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2025-02-05 09:26:35.180 +03:00 [ERR] Error logging audit event. NationalId: all, Action: notification_delivered, Details: {"notification_count":4,"notification_ids":[20,19,18,12],"timestamp":"2025-02-05T09:26:35.1357787"}
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_AuthLogs_Customers_NationalId". The conflict occurred in database "NayifatApp", table "dbo.Customers", column 'NationalId'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:1590a622-44c7-499e-98ee-84f3dcf19821
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at NayifatAPI.Services.AuditLogService.LogAsync(String nationalId, String action, Object details) in C:\Users\yamta\StudioProjects\nayifat_app_2025_new\nayifatapi\Services\AuditLogService.cs:line 36
2025-02-05 09:26:35.195 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 09:26:35.197 +03:00 [INF] Executed action NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI) in 76.354ms
2025-02-05 09:26:35.199 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI)'
2025-02-05 09:26:35.200 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/list - 200 null application/json; charset=utf-8 86.6218ms
2025-02-05 09:28:46.893 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/list - application/json 39
2025-02-05 09:28:46.896 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI)'
2025-02-05 09:28:46.897 +03:00 [INF] Route matched with {action = "GetNotifications", controller = "Notifications"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetNotifications(NayifatAPI.Controllers.GetNotificationsRequest) on controller NayifatAPI.Controllers.NotificationsController (NayifatAPI).
2025-02-05 09:28:46.904 +03:00 [INF] Executed DbCommand (5ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 09:28:46.909 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[@__request_NationalId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[national_id], [u].[last_updated], [u].[notifications]
FROM [user_notifications] AS [u]
WHERE [u].[national_id] = @__request_NationalId_0
2025-02-05 09:28:46.915 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__Parse_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [n].[Id], [n].[additional_data], [n].[Body], [n].[body_ar], [n].[body_en], [n].[created_at], [n].[expiry_at], [n].[Route], [n].[target_criteria], [n].[Title], [n].[title_ar], [n].[title_en]
FROM [notification_templates] AS [n]
WHERE [n].[Id] = @__Parse_0
2025-02-05 09:28:46.917 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__Parse_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [n].[Id], [n].[additional_data], [n].[Body], [n].[body_ar], [n].[body_en], [n].[created_at], [n].[expiry_at], [n].[Route], [n].[target_criteria], [n].[Title], [n].[title_ar], [n].[title_en]
FROM [notification_templates] AS [n]
WHERE [n].[Id] = @__Parse_0
2025-02-05 09:28:46.920 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__Parse_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [n].[Id], [n].[additional_data], [n].[Body], [n].[body_ar], [n].[body_en], [n].[created_at], [n].[expiry_at], [n].[Route], [n].[target_criteria], [n].[Title], [n].[title_ar], [n].[title_en]
FROM [notification_templates] AS [n]
WHERE [n].[Id] = @__Parse_0
2025-02-05 09:28:46.923 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__Parse_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [n].[Id], [n].[additional_data], [n].[Body], [n].[body_ar], [n].[body_en], [n].[created_at], [n].[expiry_at], [n].[Route], [n].[target_criteria], [n].[Title], [n].[title_ar], [n].[title_en]
FROM [notification_templates] AS [n]
WHERE [n].[Id] = @__Parse_0
2025-02-05 09:28:46.930 +03:00 [INF] Executed DbCommand (5ms) [Parameters=[@p0='?' (Size = 4000), @p1='?' (DbType = DateTime2), @p2='?' (Size = 4000), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (Size = 450), @p6='?' (Size = 4000), @p7='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [AuthLogs] ([AuthType], [CreatedAt], [DeviceId], [FailureReason], [IpAddress], [NationalId], [Status], [UserAgent])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7);
2025-02-05 09:28:46.934 +03:00 [ERR] An exception occurred in the database while saving changes for context type 'NayifatAPI.Data.ApplicationDbContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_AuthLogs_Customers_NationalId". The conflict occurred in database "NayifatApp", table "dbo.Customers", column 'NationalId'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:1590a622-44c7-499e-98ee-84f3dcf19821
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_AuthLogs_Customers_NationalId". The conflict occurred in database "NayifatApp", table "dbo.Customers", column 'NationalId'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:1590a622-44c7-499e-98ee-84f3dcf19821
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2025-02-05 09:28:46.947 +03:00 [ERR] Error logging audit event. NationalId: all, Action: notification_delivered, Details: {"notification_count":4,"notification_ids":[20,19,18,12],"timestamp":"2025-02-05T09:28:46.9128109"}
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_AuthLogs_Customers_NationalId". The conflict occurred in database "NayifatApp", table "dbo.Customers", column 'NationalId'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:1590a622-44c7-499e-98ee-84f3dcf19821
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at NayifatAPI.Services.AuditLogService.LogAsync(String nationalId, String action, Object details) in C:\Users\yamta\StudioProjects\nayifat_app_2025_new\nayifatapi\Services\AuditLogService.cs:line 36
2025-02-05 09:28:46.956 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 09:28:46.957 +03:00 [INF] Executed action NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI) in 59.2484ms
2025-02-05 09:28:46.958 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI)'
2025-02-05 09:28:46.960 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/list - 200 null application/json; charset=utf-8 67.5839ms
2025-02-05 09:28:46.967 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/list - application/json 39
2025-02-05 09:28:46.970 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI)'
2025-02-05 09:28:46.971 +03:00 [INF] Route matched with {action = "GetNotifications", controller = "Notifications"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetNotifications(NayifatAPI.Controllers.GetNotificationsRequest) on controller NayifatAPI.Controllers.NotificationsController (NayifatAPI).
2025-02-05 09:28:46.973 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 09:28:46.977 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__request_NationalId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[national_id], [u].[last_updated], [u].[notifications]
FROM [user_notifications] AS [u]
WHERE [u].[national_id] = @__request_NationalId_0
2025-02-05 09:28:46.979 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__Parse_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [n].[Id], [n].[additional_data], [n].[Body], [n].[body_ar], [n].[body_en], [n].[created_at], [n].[expiry_at], [n].[Route], [n].[target_criteria], [n].[Title], [n].[title_ar], [n].[title_en]
FROM [notification_templates] AS [n]
WHERE [n].[Id] = @__Parse_0
2025-02-05 09:28:46.983 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__Parse_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [n].[Id], [n].[additional_data], [n].[Body], [n].[body_ar], [n].[body_en], [n].[created_at], [n].[expiry_at], [n].[Route], [n].[target_criteria], [n].[Title], [n].[title_ar], [n].[title_en]
FROM [notification_templates] AS [n]
WHERE [n].[Id] = @__Parse_0
2025-02-05 09:28:46.986 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__Parse_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [n].[Id], [n].[additional_data], [n].[Body], [n].[body_ar], [n].[body_en], [n].[created_at], [n].[expiry_at], [n].[Route], [n].[target_criteria], [n].[Title], [n].[title_ar], [n].[title_en]
FROM [notification_templates] AS [n]
WHERE [n].[Id] = @__Parse_0
2025-02-05 09:28:46.988 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__Parse_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [n].[Id], [n].[additional_data], [n].[Body], [n].[body_ar], [n].[body_en], [n].[created_at], [n].[expiry_at], [n].[Route], [n].[target_criteria], [n].[Title], [n].[title_ar], [n].[title_en]
FROM [notification_templates] AS [n]
WHERE [n].[Id] = @__Parse_0
2025-02-05 09:28:46.991 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@p0='?' (Size = 4000), @p1='?' (DbType = DateTime2), @p2='?' (Size = 4000), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (Size = 450), @p6='?' (Size = 4000), @p7='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [AuthLogs] ([AuthType], [CreatedAt], [DeviceId], [FailureReason], [IpAddress], [NationalId], [Status], [UserAgent])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7);
2025-02-05 09:28:46.993 +03:00 [ERR] An exception occurred in the database while saving changes for context type 'NayifatAPI.Data.ApplicationDbContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_AuthLogs_Customers_NationalId". The conflict occurred in database "NayifatApp", table "dbo.Customers", column 'NationalId'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:1590a622-44c7-499e-98ee-84f3dcf19821
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_AuthLogs_Customers_NationalId". The conflict occurred in database "NayifatApp", table "dbo.Customers", column 'NationalId'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:1590a622-44c7-499e-98ee-84f3dcf19821
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2025-02-05 09:28:47.004 +03:00 [ERR] Error logging audit event. NationalId: all, Action: notification_delivered, Details: {"notification_count":4,"notification_ids":[20,19,18,12],"timestamp":"2025-02-05T09:28:46.9789346"}
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_AuthLogs_Customers_NationalId". The conflict occurred in database "NayifatApp", table "dbo.Customers", column 'NationalId'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:1590a622-44c7-499e-98ee-84f3dcf19821
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at NayifatAPI.Services.AuditLogService.LogAsync(String nationalId, String action, Object details) in C:\Users\yamta\StudioProjects\nayifat_app_2025_new\nayifatapi\Services\AuditLogService.cs:line 36
2025-02-05 09:28:47.014 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 09:28:47.015 +03:00 [INF] Executed action NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI) in 43.6446ms
2025-02-05 09:28:47.017 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI)'
2025-02-05 09:28:47.017 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/list - 200 null application/json; charset=utf-8 50.1289ms
2025-02-05 09:28:47.155 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/list - application/json 45
2025-02-05 09:28:47.158 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI)'
2025-02-05 09:28:47.159 +03:00 [INF] Route matched with {action = "GetNotifications", controller = "Notifications"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetNotifications(NayifatAPI.Controllers.GetNotificationsRequest) on controller NayifatAPI.Controllers.NotificationsController (NayifatAPI).
2025-02-05 09:28:47.161 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 09:28:47.164 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__request_NationalId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[national_id], [u].[last_updated], [u].[notifications]
FROM [user_notifications] AS [u]
WHERE [u].[national_id] = @__request_NationalId_0
2025-02-05 09:28:47.166 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 09:28:47.167 +03:00 [INF] Executed action NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI) in 6.9222ms
2025-02-05 09:28:47.167 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI)'
2025-02-05 09:28:47.168 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/list - 200 null application/json; charset=utf-8 13.0982ms
2025-02-05 09:28:47.239 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/list - application/json 45
2025-02-05 09:28:47.243 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI)'
2025-02-05 09:28:47.244 +03:00 [INF] Route matched with {action = "GetNotifications", controller = "Notifications"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetNotifications(NayifatAPI.Controllers.GetNotificationsRequest) on controller NayifatAPI.Controllers.NotificationsController (NayifatAPI).
2025-02-05 09:28:47.251 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 09:28:47.254 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__request_NationalId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[national_id], [u].[last_updated], [u].[notifications]
FROM [user_notifications] AS [u]
WHERE [u].[national_id] = @__request_NationalId_0
2025-02-05 09:28:47.256 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 09:28:47.258 +03:00 [INF] Executed action NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI) in 12.635ms
2025-02-05 09:28:47.259 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI)'
2025-02-05 09:28:47.260 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/list - 200 null application/json; charset=utf-8 20.7137ms
2025-02-05 09:28:51.278 +03:00 [INF] Application is shutting down...
2025-02-05 09:29:10.511 +03:00 [INF] Starting web application
2025-02-05 09:29:10.729 +03:00 [INF] Now listening on: http://localhost:5264
2025-02-05 09:29:10.742 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2025-02-05 09:29:10.745 +03:00 [INF] Hosting environment: Development
2025-02-05 09:29:10.747 +03:00 [INF] Content root path: C:\Users\yamta\StudioProjects\nayifat_app_2025_new\nayifatapi
2025-02-05 09:29:17.540 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/list - application/json; charset=utf-8 45
2025-02-05 09:29:17.583 +03:00 [WRN] Failed to determine the https port for redirect.
2025-02-05 09:29:17.587 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI)'
2025-02-05 09:29:17.607 +03:00 [INF] Route matched with {action = "GetNotifications", controller = "Notifications"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetNotifications(NayifatAPI.Controllers.GetNotificationsRequest) on controller NayifatAPI.Controllers.NotificationsController (NayifatAPI).
2025-02-05 09:29:18.804 +03:00 [INF] Executed DbCommand (31ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 09:29:18.902 +03:00 [INF] Executed DbCommand (13ms) [Parameters=[@__request_NationalId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[national_id], [u].[last_updated], [u].[notifications]
FROM [user_notifications] AS [u]
WHERE [u].[national_id] = @__request_NationalId_0
2025-02-05 09:29:18.959 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 09:29:18.975 +03:00 [INF] Executed action NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI) in 1361.4895ms
2025-02-05 09:29:18.978 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI)'
2025-02-05 09:29:18.988 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/list - 200 null application/json; charset=utf-8 1448.4194ms
2025-02-05 09:29:19.603 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/list - application/json; charset=utf-8 39
2025-02-05 09:29:19.634 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI)'
2025-02-05 09:29:19.636 +03:00 [INF] Route matched with {action = "GetNotifications", controller = "Notifications"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetNotifications(NayifatAPI.Controllers.GetNotificationsRequest) on controller NayifatAPI.Controllers.NotificationsController (NayifatAPI).
2025-02-05 09:29:19.677 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 09:29:19.683 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__request_NationalId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[national_id], [u].[last_updated], [u].[notifications]
FROM [user_notifications] AS [u]
WHERE [u].[national_id] = @__request_NationalId_0
2025-02-05 09:29:19.715 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__Parse_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [n].[Id], [n].[additional_data], [n].[Body], [n].[body_ar], [n].[body_en], [n].[created_at], [n].[expiry_at], [n].[Route], [n].[target_criteria], [n].[Title], [n].[title_ar], [n].[title_en]
FROM [notification_templates] AS [n]
WHERE [n].[Id] = @__Parse_0
2025-02-05 09:29:19.762 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__Parse_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [n].[Id], [n].[additional_data], [n].[Body], [n].[body_ar], [n].[body_en], [n].[created_at], [n].[expiry_at], [n].[Route], [n].[target_criteria], [n].[Title], [n].[title_ar], [n].[title_en]
FROM [notification_templates] AS [n]
WHERE [n].[Id] = @__Parse_0
2025-02-05 09:29:19.767 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__Parse_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [n].[Id], [n].[additional_data], [n].[Body], [n].[body_ar], [n].[body_en], [n].[created_at], [n].[expiry_at], [n].[Route], [n].[target_criteria], [n].[Title], [n].[title_ar], [n].[title_en]
FROM [notification_templates] AS [n]
WHERE [n].[Id] = @__Parse_0
2025-02-05 09:29:19.771 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__Parse_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [n].[Id], [n].[additional_data], [n].[Body], [n].[body_ar], [n].[body_en], [n].[created_at], [n].[expiry_at], [n].[Route], [n].[target_criteria], [n].[Title], [n].[title_ar], [n].[title_en]
FROM [notification_templates] AS [n]
WHERE [n].[Id] = @__Parse_0
2025-02-05 09:29:20.009 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@p0='?' (Size = 4000), @p1='?' (DbType = DateTime2), @p2='?' (Size = 4000), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (Size = 450), @p6='?' (Size = 4000), @p7='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [AuthLogs] ([AuthType], [CreatedAt], [DeviceId], [FailureReason], [IpAddress], [NationalId], [Status], [UserAgent])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7);
2025-02-05 09:29:20.039 +03:00 [ERR] An exception occurred in the database while saving changes for context type 'NayifatAPI.Data.ApplicationDbContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_AuthLogs_Customers_NationalId". The conflict occurred in database "NayifatApp", table "dbo.Customers", column 'NationalId'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:755cf778-396c-4941-b460-2b126d3160f2
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_AuthLogs_Customers_NationalId". The conflict occurred in database "NayifatApp", table "dbo.Customers", column 'NationalId'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:755cf778-396c-4941-b460-2b126d3160f2
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2025-02-05 09:29:20.072 +03:00 [ERR] Error logging audit event. NationalId: all, Action: notification_delivered, Details: {"notification_count":4,"notification_ids":[20,19,18,12],"timestamp":"2025-02-05T09:29:19.6955711"}
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_AuthLogs_Customers_NationalId". The conflict occurred in database "NayifatApp", table "dbo.Customers", column 'NationalId'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:755cf778-396c-4941-b460-2b126d3160f2
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at NayifatAPI.Services.AuditLogService.LogAsync(String nationalId, String action, Object details) in C:\Users\yamta\StudioProjects\nayifat_app_2025_new\nayifatapi\Services\AuditLogService.cs:line 36
2025-02-05 09:29:20.098 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 09:29:20.106 +03:00 [INF] Executed action NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI) in 467.1577ms
2025-02-05 09:29:20.107 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI)'
2025-02-05 09:29:20.110 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/list - 200 null application/json; charset=utf-8 506.9492ms
2025-02-05 09:31:46.779 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/list - application/json; charset=utf-8 45
2025-02-05 09:31:46.783 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI)'
2025-02-05 09:31:46.784 +03:00 [INF] Route matched with {action = "GetNotifications", controller = "Notifications"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetNotifications(NayifatAPI.Controllers.GetNotificationsRequest) on controller NayifatAPI.Controllers.NotificationsController (NayifatAPI).
2025-02-05 09:31:46.845 +03:00 [INF] Executed DbCommand (4ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 09:31:46.849 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__request_NationalId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[national_id], [u].[last_updated], [u].[notifications]
FROM [user_notifications] AS [u]
WHERE [u].[national_id] = @__request_NationalId_0
2025-02-05 09:31:46.852 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 09:31:46.853 +03:00 [INF] Executed action NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI) in 68.356ms
2025-02-05 09:31:46.854 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI)'
2025-02-05 09:31:46.856 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/list - 200 null application/json; charset=utf-8 77.0268ms
2025-02-05 09:31:47.386 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/list - application/json; charset=utf-8 39
2025-02-05 09:31:47.389 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI)'
2025-02-05 09:31:47.390 +03:00 [INF] Route matched with {action = "GetNotifications", controller = "Notifications"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetNotifications(NayifatAPI.Controllers.GetNotificationsRequest) on controller NayifatAPI.Controllers.NotificationsController (NayifatAPI).
2025-02-05 09:31:47.393 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 09:31:47.400 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__request_NationalId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[national_id], [u].[last_updated], [u].[notifications]
FROM [user_notifications] AS [u]
WHERE [u].[national_id] = @__request_NationalId_0
2025-02-05 09:31:47.406 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__Parse_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [n].[Id], [n].[additional_data], [n].[Body], [n].[body_ar], [n].[body_en], [n].[created_at], [n].[expiry_at], [n].[Route], [n].[target_criteria], [n].[Title], [n].[title_ar], [n].[title_en]
FROM [notification_templates] AS [n]
WHERE [n].[Id] = @__Parse_0
2025-02-05 09:31:47.410 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__Parse_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [n].[Id], [n].[additional_data], [n].[Body], [n].[body_ar], [n].[body_en], [n].[created_at], [n].[expiry_at], [n].[Route], [n].[target_criteria], [n].[Title], [n].[title_ar], [n].[title_en]
FROM [notification_templates] AS [n]
WHERE [n].[Id] = @__Parse_0
2025-02-05 09:31:47.413 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__Parse_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [n].[Id], [n].[additional_data], [n].[Body], [n].[body_ar], [n].[body_en], [n].[created_at], [n].[expiry_at], [n].[Route], [n].[target_criteria], [n].[Title], [n].[title_ar], [n].[title_en]
FROM [notification_templates] AS [n]
WHERE [n].[Id] = @__Parse_0
2025-02-05 09:31:47.416 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__Parse_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [n].[Id], [n].[additional_data], [n].[Body], [n].[body_ar], [n].[body_en], [n].[created_at], [n].[expiry_at], [n].[Route], [n].[target_criteria], [n].[Title], [n].[title_ar], [n].[title_en]
FROM [notification_templates] AS [n]
WHERE [n].[Id] = @__Parse_0
2025-02-05 09:31:47.425 +03:00 [INF] Executed DbCommand (4ms) [Parameters=[@p0='?' (Size = 4000), @p1='?' (DbType = DateTime2), @p2='?' (Size = 4000), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (Size = 450), @p6='?' (Size = 4000), @p7='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [AuthLogs] ([AuthType], [CreatedAt], [DeviceId], [FailureReason], [IpAddress], [NationalId], [Status], [UserAgent])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7);
2025-02-05 09:31:47.429 +03:00 [ERR] An exception occurred in the database while saving changes for context type 'NayifatAPI.Data.ApplicationDbContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_AuthLogs_Customers_NationalId". The conflict occurred in database "NayifatApp", table "dbo.Customers", column 'NationalId'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:755cf778-396c-4941-b460-2b126d3160f2
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_AuthLogs_Customers_NationalId". The conflict occurred in database "NayifatApp", table "dbo.Customers", column 'NationalId'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:755cf778-396c-4941-b460-2b126d3160f2
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2025-02-05 09:31:47.445 +03:00 [ERR] Error logging audit event. NationalId: all, Action: notification_delivered, Details: {"notification_count":4,"notification_ids":[20,19,18,12],"timestamp":"2025-02-05T09:31:47.4037229"}
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_AuthLogs_Customers_NationalId". The conflict occurred in database "NayifatApp", table "dbo.Customers", column 'NationalId'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:755cf778-396c-4941-b460-2b126d3160f2
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at NayifatAPI.Services.AuditLogService.LogAsync(String nationalId, String action, Object details) in C:\Users\yamta\StudioProjects\nayifat_app_2025_new\nayifatapi\Services\AuditLogService.cs:line 36
2025-02-05 09:31:47.454 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 09:31:47.456 +03:00 [INF] Executed action NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI) in 64.0583ms
2025-02-05 09:31:47.457 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI)'
2025-02-05 09:31:47.457 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/list - 200 null application/json; charset=utf-8 71.5801ms
2025-02-05 09:31:55.593 +03:00 [INF] Request starting HTTP/1.1 GET http://45f9-51-252-155-185.ngrok-free.app/api/api/loan-application/latest-status/1064448614 - application/json null
2025-02-05 09:31:55.603 +03:00 [INF] Request finished HTTP/1.1 GET http://45f9-51-252-155-185.ngrok-free.app/api/api/loan-application/latest-status/1064448614 - 404 0 null 10.388ms
2025-02-05 09:31:55.606 +03:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET http://45f9-51-252-155-185.ngrok-free.app/api/api/loan-application/latest-status/1064448614, Response status code: 404
2025-02-05 09:31:59.263 +03:00 [INF] Request starting HTTP/1.1 GET http://45f9-51-252-155-185.ngrok-free.app/api/api/loan-application/latest-status/1064448614 - application/json null
2025-02-05 09:31:59.266 +03:00 [INF] Request finished HTTP/1.1 GET http://45f9-51-252-155-185.ngrok-free.app/api/api/loan-application/latest-status/1064448614 - 404 0 null 3.3314ms
2025-02-05 09:31:59.269 +03:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET http://45f9-51-252-155-185.ngrok-free.app/api/api/loan-application/latest-status/1064448614, Response status code: 404
2025-02-05 09:33:22.724 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/list - application/json; charset=utf-8 45
2025-02-05 09:33:22.726 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI)'
2025-02-05 09:33:22.727 +03:00 [INF] Route matched with {action = "GetNotifications", controller = "Notifications"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetNotifications(NayifatAPI.Controllers.GetNotificationsRequest) on controller NayifatAPI.Controllers.NotificationsController (NayifatAPI).
2025-02-05 09:33:22.733 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 09:33:22.744 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__request_NationalId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[national_id], [u].[last_updated], [u].[notifications]
FROM [user_notifications] AS [u]
WHERE [u].[national_id] = @__request_NationalId_0
2025-02-05 09:33:22.748 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 09:33:22.749 +03:00 [INF] Executed action NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI) in 20.6244ms
2025-02-05 09:33:22.750 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI)'
2025-02-05 09:33:22.751 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/list - 200 null application/json; charset=utf-8 26.6682ms
2025-02-05 09:33:23.325 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/list - application/json; charset=utf-8 39
2025-02-05 09:33:23.329 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI)'
2025-02-05 09:33:23.330 +03:00 [INF] Route matched with {action = "GetNotifications", controller = "Notifications"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetNotifications(NayifatAPI.Controllers.GetNotificationsRequest) on controller NayifatAPI.Controllers.NotificationsController (NayifatAPI).
2025-02-05 09:33:23.333 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 09:33:23.335 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__request_NationalId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[national_id], [u].[last_updated], [u].[notifications]
FROM [user_notifications] AS [u]
WHERE [u].[national_id] = @__request_NationalId_0
2025-02-05 09:33:23.340 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__Parse_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [n].[Id], [n].[additional_data], [n].[Body], [n].[body_ar], [n].[body_en], [n].[created_at], [n].[expiry_at], [n].[Route], [n].[target_criteria], [n].[Title], [n].[title_ar], [n].[title_en]
FROM [notification_templates] AS [n]
WHERE [n].[Id] = @__Parse_0
2025-02-05 09:33:23.342 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__Parse_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [n].[Id], [n].[additional_data], [n].[Body], [n].[body_ar], [n].[body_en], [n].[created_at], [n].[expiry_at], [n].[Route], [n].[target_criteria], [n].[Title], [n].[title_ar], [n].[title_en]
FROM [notification_templates] AS [n]
WHERE [n].[Id] = @__Parse_0
2025-02-05 09:33:23.344 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__Parse_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [n].[Id], [n].[additional_data], [n].[Body], [n].[body_ar], [n].[body_en], [n].[created_at], [n].[expiry_at], [n].[Route], [n].[target_criteria], [n].[Title], [n].[title_ar], [n].[title_en]
FROM [notification_templates] AS [n]
WHERE [n].[Id] = @__Parse_0
2025-02-05 09:33:23.347 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__Parse_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [n].[Id], [n].[additional_data], [n].[Body], [n].[body_ar], [n].[body_en], [n].[created_at], [n].[expiry_at], [n].[Route], [n].[target_criteria], [n].[Title], [n].[title_ar], [n].[title_en]
FROM [notification_templates] AS [n]
WHERE [n].[Id] = @__Parse_0
2025-02-05 09:33:23.353 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[@p0='?' (Size = 4000), @p1='?' (DbType = DateTime2), @p2='?' (Size = 4000), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (Size = 450), @p6='?' (Size = 4000), @p7='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [AuthLogs] ([AuthType], [CreatedAt], [DeviceId], [FailureReason], [IpAddress], [NationalId], [Status], [UserAgent])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7);
2025-02-05 09:33:23.356 +03:00 [ERR] An exception occurred in the database while saving changes for context type 'NayifatAPI.Data.ApplicationDbContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_AuthLogs_Customers_NationalId". The conflict occurred in database "NayifatApp", table "dbo.Customers", column 'NationalId'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:755cf778-396c-4941-b460-2b126d3160f2
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_AuthLogs_Customers_NationalId". The conflict occurred in database "NayifatApp", table "dbo.Customers", column 'NationalId'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:755cf778-396c-4941-b460-2b126d3160f2
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2025-02-05 09:33:23.366 +03:00 [ERR] Error logging audit event. NationalId: all, Action: notification_delivered, Details: {"notification_count":4,"notification_ids":[20,19,18,12],"timestamp":"2025-02-05T09:33:23.3382858"}
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_AuthLogs_Customers_NationalId". The conflict occurred in database "NayifatApp", table "dbo.Customers", column 'NationalId'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:755cf778-396c-4941-b460-2b126d3160f2
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at NayifatAPI.Services.AuditLogService.LogAsync(String nationalId, String action, Object details) in C:\Users\yamta\StudioProjects\nayifat_app_2025_new\nayifatapi\Services\AuditLogService.cs:line 36
2025-02-05 09:33:23.373 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 09:33:23.374 +03:00 [INF] Executed action NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI) in 42.7318ms
2025-02-05 09:33:23.375 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI)'
2025-02-05 09:33:23.376 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/list - 200 null application/json; charset=utf-8 50.4749ms
2025-02-05 09:33:26.479 +03:00 [INF] Request starting HTTP/1.1 GET http://45f9-51-252-155-185.ngrok-free.app/api/loan-application/latest-status/1064448614 - application/json null
2025-02-05 09:33:26.484 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.LoanApplicationController.GetLatestStatus (NayifatAPI)'
2025-02-05 09:33:26.489 +03:00 [INF] Route matched with {action = "GetLatestStatus", controller = "LoanApplication"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetLatestStatus(System.String) on controller NayifatAPI.Controllers.LoanApplicationController (NayifatAPI).
2025-02-05 09:33:26.495 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 09:33:26.496 +03:00 [INF] Getting latest status for National ID: 1064448614
2025-02-05 09:33:26.585 +03:00 [INF] Executed DbCommand (81ms) [Parameters=[@__nationalId_0='?' (Size = 20)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [l].[Id], [l].[name], [l].[national_id], [l].[phone], [l].[status], [l].[status_timestamp]
FROM [lead_apps_loans] AS [l]
WHERE [l].[national_id] = @__nationalId_0
ORDER BY [l].[status_timestamp] DESC
2025-02-05 09:33:26.589 +03:00 [INF] Latest Lead App: null
2025-02-05 09:33:26.602 +03:00 [INF] Executed DbCommand (7ms) [Parameters=[@__nationalId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [l].[loan_id], [l].[loan_amount], [l].[application_no], [l].[customerDecision], [l].[interest_rate], [l].[national_id], [l].[note], [l].[noteUser], [l].[loan_purpose], [l].[remarks], [l].[status], [l].[status_date], [l].[loan_tenure]
FROM [loan_application_details] AS [l]
WHERE [l].[national_id] = @__nationalId_0
ORDER BY [l].[status_date] DESC
2025-02-05 09:33:26.634 +03:00 [INF] Latest Loan App: {"Id":1,"ApplicationNo":1,"NationalId":"1064448614","CustomerDecision":"accepted","Amount":50000.00,"Purpose":"Personal","Tenure":36,"InterestRate":12.50,"Status":"approved","StatusDate":"2025-02-01T10:55:59.5970000","Remarks":"Loan application approved","NoteUser":"SYSTEM","Note":"Customer accepted loan offer","Customer":null,"$type":"LoanApplication"}
2025-02-05 09:33:26.644 +03:00 [INF] Using Loan App Status: approved
2025-02-05 09:33:26.644 +03:00 [INF] Returning status: approved
2025-02-05 09:33:26.648 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 09:33:26.650 +03:00 [INF] Executed action NayifatAPI.Controllers.LoanApplicationController.GetLatestStatus (NayifatAPI) in 158.3964ms
2025-02-05 09:33:26.650 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.LoanApplicationController.GetLatestStatus (NayifatAPI)'
2025-02-05 09:33:26.652 +03:00 [INF] Request finished HTTP/1.1 GET http://45f9-51-252-155-185.ngrok-free.app/api/loan-application/latest-status/1064448614 - 200 null application/json; charset=utf-8 172.6694ms
2025-02-05 09:33:34.664 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/list - application/json; charset=utf-8 45
2025-02-05 09:33:34.665 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI)'
2025-02-05 09:33:34.667 +03:00 [INF] Route matched with {action = "GetNotifications", controller = "Notifications"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetNotifications(NayifatAPI.Controllers.GetNotificationsRequest) on controller NayifatAPI.Controllers.NotificationsController (NayifatAPI).
2025-02-05 09:33:34.669 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 09:33:34.672 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__request_NationalId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[national_id], [u].[last_updated], [u].[notifications]
FROM [user_notifications] AS [u]
WHERE [u].[national_id] = @__request_NationalId_0
2025-02-05 09:33:34.675 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 09:33:34.676 +03:00 [INF] Executed action NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI) in 8.4115ms
2025-02-05 09:33:34.677 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI)'
2025-02-05 09:33:34.678 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/list - 200 null application/json; charset=utf-8 14.3392ms
2025-02-05 09:33:35.067 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/list - application/json; charset=utf-8 39
2025-02-05 09:33:35.070 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI)'
2025-02-05 09:33:35.071 +03:00 [INF] Route matched with {action = "GetNotifications", controller = "Notifications"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetNotifications(NayifatAPI.Controllers.GetNotificationsRequest) on controller NayifatAPI.Controllers.NotificationsController (NayifatAPI).
2025-02-05 09:33:35.073 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 09:33:35.076 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__request_NationalId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[national_id], [u].[last_updated], [u].[notifications]
FROM [user_notifications] AS [u]
WHERE [u].[national_id] = @__request_NationalId_0
2025-02-05 09:33:35.078 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__Parse_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [n].[Id], [n].[additional_data], [n].[Body], [n].[body_ar], [n].[body_en], [n].[created_at], [n].[expiry_at], [n].[Route], [n].[target_criteria], [n].[Title], [n].[title_ar], [n].[title_en]
FROM [notification_templates] AS [n]
WHERE [n].[Id] = @__Parse_0
2025-02-05 09:33:35.082 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__Parse_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [n].[Id], [n].[additional_data], [n].[Body], [n].[body_ar], [n].[body_en], [n].[created_at], [n].[expiry_at], [n].[Route], [n].[target_criteria], [n].[Title], [n].[title_ar], [n].[title_en]
FROM [notification_templates] AS [n]
WHERE [n].[Id] = @__Parse_0
2025-02-05 09:33:35.085 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__Parse_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [n].[Id], [n].[additional_data], [n].[Body], [n].[body_ar], [n].[body_en], [n].[created_at], [n].[expiry_at], [n].[Route], [n].[target_criteria], [n].[Title], [n].[title_ar], [n].[title_en]
FROM [notification_templates] AS [n]
WHERE [n].[Id] = @__Parse_0
2025-02-05 09:33:35.089 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__Parse_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [n].[Id], [n].[additional_data], [n].[Body], [n].[body_ar], [n].[body_en], [n].[created_at], [n].[expiry_at], [n].[Route], [n].[target_criteria], [n].[Title], [n].[title_ar], [n].[title_en]
FROM [notification_templates] AS [n]
WHERE [n].[Id] = @__Parse_0
2025-02-05 09:33:35.092 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@p0='?' (Size = 4000), @p1='?' (DbType = DateTime2), @p2='?' (Size = 4000), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (Size = 450), @p6='?' (Size = 4000), @p7='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [AuthLogs] ([AuthType], [CreatedAt], [DeviceId], [FailureReason], [IpAddress], [NationalId], [Status], [UserAgent])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7);
2025-02-05 09:33:35.095 +03:00 [ERR] An exception occurred in the database while saving changes for context type 'NayifatAPI.Data.ApplicationDbContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_AuthLogs_Customers_NationalId". The conflict occurred in database "NayifatApp", table "dbo.Customers", column 'NationalId'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:755cf778-396c-4941-b460-2b126d3160f2
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_AuthLogs_Customers_NationalId". The conflict occurred in database "NayifatApp", table "dbo.Customers", column 'NationalId'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:755cf778-396c-4941-b460-2b126d3160f2
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2025-02-05 09:33:35.105 +03:00 [ERR] Error logging audit event. NationalId: all, Action: notification_delivered, Details: {"notification_count":4,"notification_ids":[20,19,18,12],"timestamp":"2025-02-05T09:33:35.0776576"}
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_AuthLogs_Customers_NationalId". The conflict occurred in database "NayifatApp", table "dbo.Customers", column 'NationalId'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:755cf778-396c-4941-b460-2b126d3160f2
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at NayifatAPI.Services.AuditLogService.LogAsync(String nationalId, String action, Object details) in C:\Users\yamta\StudioProjects\nayifat_app_2025_new\nayifatapi\Services\AuditLogService.cs:line 36
2025-02-05 09:33:35.113 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 09:33:35.114 +03:00 [INF] Executed action NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI) in 42.4302ms
2025-02-05 09:33:35.115 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI)'
2025-02-05 09:33:35.116 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/list - 200 null application/json; charset=utf-8 49.1824ms
2025-02-05 09:33:36.824 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/list - application/json; charset=utf-8 45
2025-02-05 09:33:36.827 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI)'
2025-02-05 09:33:36.828 +03:00 [INF] Route matched with {action = "GetNotifications", controller = "Notifications"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetNotifications(NayifatAPI.Controllers.GetNotificationsRequest) on controller NayifatAPI.Controllers.NotificationsController (NayifatAPI).
2025-02-05 09:33:36.832 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 09:33:36.835 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__request_NationalId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[national_id], [u].[last_updated], [u].[notifications]
FROM [user_notifications] AS [u]
WHERE [u].[national_id] = @__request_NationalId_0
2025-02-05 09:33:36.837 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 09:33:36.838 +03:00 [INF] Executed action NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI) in 7.7686ms
2025-02-05 09:33:36.839 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI)'
2025-02-05 09:33:36.840 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/list - 200 null application/json; charset=utf-8 15.8133ms
2025-02-05 09:33:37.293 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/list - application/json; charset=utf-8 39
2025-02-05 09:33:37.296 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI)'
2025-02-05 09:33:37.297 +03:00 [INF] Route matched with {action = "GetNotifications", controller = "Notifications"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetNotifications(NayifatAPI.Controllers.GetNotificationsRequest) on controller NayifatAPI.Controllers.NotificationsController (NayifatAPI).
2025-02-05 09:33:37.299 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 09:33:37.302 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__request_NationalId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[national_id], [u].[last_updated], [u].[notifications]
FROM [user_notifications] AS [u]
WHERE [u].[national_id] = @__request_NationalId_0
2025-02-05 09:33:37.305 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__Parse_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [n].[Id], [n].[additional_data], [n].[Body], [n].[body_ar], [n].[body_en], [n].[created_at], [n].[expiry_at], [n].[Route], [n].[target_criteria], [n].[Title], [n].[title_ar], [n].[title_en]
FROM [notification_templates] AS [n]
WHERE [n].[Id] = @__Parse_0
2025-02-05 09:33:37.307 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__Parse_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [n].[Id], [n].[additional_data], [n].[Body], [n].[body_ar], [n].[body_en], [n].[created_at], [n].[expiry_at], [n].[Route], [n].[target_criteria], [n].[Title], [n].[title_ar], [n].[title_en]
FROM [notification_templates] AS [n]
WHERE [n].[Id] = @__Parse_0
2025-02-05 09:33:37.311 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__Parse_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [n].[Id], [n].[additional_data], [n].[Body], [n].[body_ar], [n].[body_en], [n].[created_at], [n].[expiry_at], [n].[Route], [n].[target_criteria], [n].[Title], [n].[title_ar], [n].[title_en]
FROM [notification_templates] AS [n]
WHERE [n].[Id] = @__Parse_0
2025-02-05 09:33:37.313 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__Parse_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [n].[Id], [n].[additional_data], [n].[Body], [n].[body_ar], [n].[body_en], [n].[created_at], [n].[expiry_at], [n].[Route], [n].[target_criteria], [n].[Title], [n].[title_ar], [n].[title_en]
FROM [notification_templates] AS [n]
WHERE [n].[Id] = @__Parse_0
2025-02-05 09:33:37.319 +03:00 [INF] Executed DbCommand (4ms) [Parameters=[@p0='?' (Size = 4000), @p1='?' (DbType = DateTime2), @p2='?' (Size = 4000), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (Size = 450), @p6='?' (Size = 4000), @p7='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [AuthLogs] ([AuthType], [CreatedAt], [DeviceId], [FailureReason], [IpAddress], [NationalId], [Status], [UserAgent])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7);
2025-02-05 09:33:37.322 +03:00 [ERR] An exception occurred in the database while saving changes for context type 'NayifatAPI.Data.ApplicationDbContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_AuthLogs_Customers_NationalId". The conflict occurred in database "NayifatApp", table "dbo.Customers", column 'NationalId'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:755cf778-396c-4941-b460-2b126d3160f2
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_AuthLogs_Customers_NationalId". The conflict occurred in database "NayifatApp", table "dbo.Customers", column 'NationalId'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:755cf778-396c-4941-b460-2b126d3160f2
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2025-02-05 09:33:37.332 +03:00 [ERR] Error logging audit event. NationalId: all, Action: notification_delivered, Details: {"notification_count":4,"notification_ids":[20,19,18,12],"timestamp":"2025-02-05T09:33:37.3044592"}
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_AuthLogs_Customers_NationalId". The conflict occurred in database "NayifatApp", table "dbo.Customers", column 'NationalId'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:755cf778-396c-4941-b460-2b126d3160f2
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at NayifatAPI.Services.AuditLogService.LogAsync(String nationalId, String action, Object details) in C:\Users\yamta\StudioProjects\nayifat_app_2025_new\nayifatapi\Services\AuditLogService.cs:line 36
2025-02-05 09:33:37.340 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 09:33:37.341 +03:00 [INF] Executed action NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI) in 42.8326ms
2025-02-05 09:33:37.342 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI)'
2025-02-05 09:33:37.343 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/list - 200 null application/json; charset=utf-8 49.4651ms
2025-02-05 09:33:39.609 +03:00 [INF] Request starting HTTP/1.1 GET http://45f9-51-252-155-185.ngrok-free.app/api/loan-application/latest-status/1064448614 - application/json null
2025-02-05 09:33:39.613 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.LoanApplicationController.GetLatestStatus (NayifatAPI)'
2025-02-05 09:33:39.613 +03:00 [INF] Route matched with {action = "GetLatestStatus", controller = "LoanApplication"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetLatestStatus(System.String) on controller NayifatAPI.Controllers.LoanApplicationController (NayifatAPI).
2025-02-05 09:33:39.616 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 09:33:39.618 +03:00 [INF] Getting latest status for National ID: 1064448614
2025-02-05 09:33:39.619 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__nationalId_0='?' (Size = 20)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [l].[Id], [l].[name], [l].[national_id], [l].[phone], [l].[status], [l].[status_timestamp]
FROM [lead_apps_loans] AS [l]
WHERE [l].[national_id] = @__nationalId_0
ORDER BY [l].[status_timestamp] DESC
2025-02-05 09:33:39.621 +03:00 [INF] Latest Lead App: null
2025-02-05 09:33:39.622 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__nationalId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [l].[loan_id], [l].[loan_amount], [l].[application_no], [l].[customerDecision], [l].[interest_rate], [l].[national_id], [l].[note], [l].[noteUser], [l].[loan_purpose], [l].[remarks], [l].[status], [l].[status_date], [l].[loan_tenure]
FROM [loan_application_details] AS [l]
WHERE [l].[national_id] = @__nationalId_0
ORDER BY [l].[status_date] DESC
2025-02-05 09:33:39.627 +03:00 [INF] Latest Loan App: {"Id":1,"ApplicationNo":1,"NationalId":"1064448614","CustomerDecision":"accepted","Amount":50000.00,"Purpose":"Personal","Tenure":36,"InterestRate":12.50,"Status":"approved","StatusDate":"2025-02-01T10:55:59.5970000","Remarks":"Loan application approved","NoteUser":"SYSTEM","Note":"Customer accepted loan offer","Customer":null,"$type":"LoanApplication"}
2025-02-05 09:33:39.632 +03:00 [INF] Using Loan App Status: approved
2025-02-05 09:33:39.633 +03:00 [INF] Returning status: approved
2025-02-05 09:33:39.634 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 09:33:39.634 +03:00 [INF] Executed action NayifatAPI.Controllers.LoanApplicationController.GetLatestStatus (NayifatAPI) in 20.0336ms
2025-02-05 09:33:39.635 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.LoanApplicationController.GetLatestStatus (NayifatAPI)'
2025-02-05 09:33:39.636 +03:00 [INF] Request finished HTTP/1.1 GET http://45f9-51-252-155-185.ngrok-free.app/api/loan-application/latest-status/1064448614 - 200 null application/json; charset=utf-8 27.1556ms
2025-02-05 09:37:29.636 +03:00 [INF] Application is shutting down...
2025-02-05 09:37:43.118 +03:00 [INF] Starting web application
2025-02-05 09:37:43.235 +03:00 [INF] Now listening on: http://localhost:5264
2025-02-05 09:37:43.240 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2025-02-05 09:37:43.242 +03:00 [INF] Hosting environment: Development
2025-02-05 09:37:43.243 +03:00 [INF] Content root path: C:\Users\yamta\StudioProjects\nayifat_app_2025_new\nayifatapi
2025-02-05 09:38:00.894 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/list - application/json; charset=utf-8 45
2025-02-05 09:38:00.936 +03:00 [WRN] Failed to determine the https port for redirect.
2025-02-05 09:38:00.939 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI)'
2025-02-05 09:38:00.957 +03:00 [INF] Route matched with {action = "GetNotifications", controller = "Notifications"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetNotifications(NayifatAPI.Controllers.GetNotificationsRequest) on controller NayifatAPI.Controllers.NotificationsController (NayifatAPI).
2025-02-05 09:38:02.092 +03:00 [INF] Executed DbCommand (21ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 09:38:02.191 +03:00 [INF] Executed DbCommand (12ms) [Parameters=[@__request_NationalId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[national_id], [u].[last_updated], [u].[notifications]
FROM [user_notifications] AS [u]
WHERE [u].[national_id] = @__request_NationalId_0
2025-02-05 09:38:02.242 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 09:38:02.259 +03:00 [INF] Executed action NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI) in 1295.1105ms
2025-02-05 09:38:02.263 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI)'
2025-02-05 09:38:02.271 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/list - 200 null application/json; charset=utf-8 1378.6416ms
2025-02-05 09:38:02.690 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/list - application/json; charset=utf-8 39
2025-02-05 09:38:02.698 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI)'
2025-02-05 09:38:02.700 +03:00 [INF] Route matched with {action = "GetNotifications", controller = "Notifications"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetNotifications(NayifatAPI.Controllers.GetNotificationsRequest) on controller NayifatAPI.Controllers.NotificationsController (NayifatAPI).
2025-02-05 09:38:02.720 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 09:38:02.724 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__request_NationalId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[national_id], [u].[last_updated], [u].[notifications]
FROM [user_notifications] AS [u]
WHERE [u].[national_id] = @__request_NationalId_0
2025-02-05 09:38:02.752 +03:00 [INF] Executed DbCommand (13ms) [Parameters=[@__Parse_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [n].[Id], [n].[additional_data], [n].[Body], [n].[body_ar], [n].[body_en], [n].[created_at], [n].[expiry_at], [n].[Route], [n].[target_criteria], [n].[Title], [n].[title_ar], [n].[title_en]
FROM [notification_templates] AS [n]
WHERE [n].[Id] = @__Parse_0
2025-02-05 09:38:02.998 +03:00 [INF] Executed DbCommand (17ms) [Parameters=[@__Parse_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [n].[Id], [n].[additional_data], [n].[Body], [n].[body_ar], [n].[body_en], [n].[created_at], [n].[expiry_at], [n].[Route], [n].[target_criteria], [n].[Title], [n].[title_ar], [n].[title_en]
FROM [notification_templates] AS [n]
WHERE [n].[Id] = @__Parse_0
2025-02-05 09:38:03.132 +03:00 [INF] Executed DbCommand (9ms) [Parameters=[@__Parse_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [n].[Id], [n].[additional_data], [n].[Body], [n].[body_ar], [n].[body_en], [n].[created_at], [n].[expiry_at], [n].[Route], [n].[target_criteria], [n].[Title], [n].[title_ar], [n].[title_en]
FROM [notification_templates] AS [n]
WHERE [n].[Id] = @__Parse_0
2025-02-05 09:38:03.136 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__Parse_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [n].[Id], [n].[additional_data], [n].[Body], [n].[body_ar], [n].[body_en], [n].[created_at], [n].[expiry_at], [n].[Route], [n].[target_criteria], [n].[Title], [n].[title_ar], [n].[title_en]
FROM [notification_templates] AS [n]
WHERE [n].[Id] = @__Parse_0
2025-02-05 09:38:03.766 +03:00 [INF] Executed DbCommand (50ms) [Parameters=[@p0='?' (Size = 4000), @p1='?' (DbType = DateTime2), @p2='?' (Size = 4000), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (Size = 450), @p6='?' (Size = 4000), @p7='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [AuthLogs] ([AuthType], [CreatedAt], [DeviceId], [FailureReason], [IpAddress], [NationalId], [Status], [UserAgent])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7);
2025-02-05 09:38:04.022 +03:00 [ERR] An exception occurred in the database while saving changes for context type 'NayifatAPI.Data.ApplicationDbContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_AuthLogs_Customers_NationalId". The conflict occurred in database "NayifatApp", table "dbo.Customers", column 'NationalId'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:d3bd78e3-55c6-4a98-84ed-f036d63d103e
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_AuthLogs_Customers_NationalId". The conflict occurred in database "NayifatApp", table "dbo.Customers", column 'NationalId'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:d3bd78e3-55c6-4a98-84ed-f036d63d103e
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2025-02-05 09:38:04.288 +03:00 [ERR] Error logging audit event. NationalId: all, Action: notification_delivered, Details: {"notification_count":4,"notification_ids":[20,19,18,12],"timestamp":"2025-02-05T09:38:02.7265082"}
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_AuthLogs_Customers_NationalId". The conflict occurred in database "NayifatApp", table "dbo.Customers", column 'NationalId'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:d3bd78e3-55c6-4a98-84ed-f036d63d103e
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at NayifatAPI.Services.AuditLogService.LogAsync(String nationalId, String action, Object details) in C:\Users\yamta\StudioProjects\nayifat_app_2025_new\nayifatapi\Services\AuditLogService.cs:line 36
2025-02-05 09:38:04.931 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 09:38:05.269 +03:00 [INF] Executed action NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI) in 2567.3078ms
2025-02-05 09:38:05.274 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI)'
2025-02-05 09:38:05.275 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/list - 200 null application/json; charset=utf-8 2584.9343ms
2025-02-05 09:38:48.770 +03:00 [INF] Request starting HTTP/1.1 GET http://45f9-51-252-155-185.ngrok-free.app/api/loan-application/latest-status/1064448614 - application/json null
2025-02-05 09:38:48.776 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.LoanApplicationController.GetLatestStatus (NayifatAPI)'
2025-02-05 09:38:48.782 +03:00 [INF] Route matched with {action = "GetLatestStatus", controller = "LoanApplication"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetLatestStatus(System.String) on controller NayifatAPI.Controllers.LoanApplicationController (NayifatAPI).
2025-02-05 09:38:48.844 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 09:38:48.846 +03:00 [INF] Getting latest status for National ID: 1064448614
2025-02-05 09:38:48.854 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__nationalId_0='?' (Size = 20)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [l].[Id], [l].[name], [l].[national_id], [l].[phone], [l].[status], [l].[status_timestamp]
FROM [lead_apps_loans] AS [l]
WHERE [l].[national_id] = @__nationalId_0
ORDER BY [l].[status_timestamp] DESC
2025-02-05 09:38:48.858 +03:00 [INF] Latest Lead App: Status=null, Timestamp=null
2025-02-05 09:38:48.869 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[@__nationalId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [l].[loan_id], [l].[loan_amount], [l].[application_no], [l].[customerDecision], [l].[interest_rate], [l].[national_id], [l].[note], [l].[noteUser], [l].[loan_purpose], [l].[remarks], [l].[status], [l].[status_date], [l].[loan_tenure]
FROM [loan_application_details] AS [l]
WHERE [l].[national_id] = @__nationalId_0
ORDER BY [l].[status_date] DESC
2025-02-05 09:38:48.893 +03:00 [INF] Latest Loan App: Status=approved, StatusDate="2025-02-01T10:55:59.5970000"
2025-02-05 09:38:48.896 +03:00 [INF] Using Loan App Status: approved, Date: "2025-02-01T10:55:59.5970000"
2025-02-05 09:38:48.896 +03:00 [INF] Returning final status: approved, Timestamp: "2025-02-01T10:55:59.5970000"
2025-02-05 09:38:48.897 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 09:38:48.903 +03:00 [INF] Executed action NayifatAPI.Controllers.LoanApplicationController.GetLatestStatus (NayifatAPI) in 118.4635ms
2025-02-05 09:38:48.904 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.LoanApplicationController.GetLatestStatus (NayifatAPI)'
2025-02-05 09:38:48.907 +03:00 [INF] Request finished HTTP/1.1 GET http://45f9-51-252-155-185.ngrok-free.app/api/loan-application/latest-status/1064448614 - 200 null application/json; charset=utf-8 136.8001ms
2025-02-05 09:39:40.130 +03:00 [INF] Request starting HTTP/1.1 GET http://45f9-51-252-155-185.ngrok-free.app/api/loan-application/latest-status/1064448614 - application/json null
2025-02-05 09:39:40.135 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.LoanApplicationController.GetLatestStatus (NayifatAPI)'
2025-02-05 09:39:40.137 +03:00 [INF] Route matched with {action = "GetLatestStatus", controller = "LoanApplication"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetLatestStatus(System.String) on controller NayifatAPI.Controllers.LoanApplicationController (NayifatAPI).
2025-02-05 09:39:40.144 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 09:39:40.146 +03:00 [INF] Getting latest status for National ID: 1064448614
2025-02-05 09:39:40.150 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__nationalId_0='?' (Size = 20)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [l].[Id], [l].[name], [l].[national_id], [l].[phone], [l].[status], [l].[status_timestamp]
FROM [lead_apps_loans] AS [l]
WHERE [l].[national_id] = @__nationalId_0
ORDER BY [l].[status_timestamp] DESC
2025-02-05 09:39:40.151 +03:00 [INF] Latest Lead App: Status=null, Timestamp=null
2025-02-05 09:39:40.155 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[@__nationalId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [l].[loan_id], [l].[loan_amount], [l].[application_no], [l].[customerDecision], [l].[interest_rate], [l].[national_id], [l].[note], [l].[noteUser], [l].[loan_purpose], [l].[remarks], [l].[status], [l].[status_date], [l].[loan_tenure]
FROM [loan_application_details] AS [l]
WHERE [l].[national_id] = @__nationalId_0
ORDER BY [l].[status_date] DESC
2025-02-05 09:39:40.156 +03:00 [INF] Latest Loan App: Status=approved, StatusDate="2025-02-01T10:55:59.5970000"
2025-02-05 09:39:40.157 +03:00 [INF] Using Loan App Status: approved, Date: "2025-02-01T10:55:59.5970000"
2025-02-05 09:39:40.158 +03:00 [INF] Returning final status: approved, Timestamp: "2025-02-01T10:55:59.5970000"
2025-02-05 09:39:40.159 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 09:39:40.160 +03:00 [INF] Executed action NayifatAPI.Controllers.LoanApplicationController.GetLatestStatus (NayifatAPI) in 20.9537ms
2025-02-05 09:39:40.161 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.LoanApplicationController.GetLatestStatus (NayifatAPI)'
2025-02-05 09:39:40.162 +03:00 [INF] Request finished HTTP/1.1 GET http://45f9-51-252-155-185.ngrok-free.app/api/loan-application/latest-status/1064448614 - 200 null application/json; charset=utf-8 32.4223ms
2025-02-05 09:43:05.797 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/list - application/json; charset=utf-8 45
2025-02-05 09:43:05.800 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI)'
2025-02-05 09:43:05.801 +03:00 [INF] Route matched with {action = "GetNotifications", controller = "Notifications"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetNotifications(NayifatAPI.Controllers.GetNotificationsRequest) on controller NayifatAPI.Controllers.NotificationsController (NayifatAPI).
2025-02-05 09:43:05.809 +03:00 [INF] Executed DbCommand (4ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 09:43:05.813 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__request_NationalId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[national_id], [u].[last_updated], [u].[notifications]
FROM [user_notifications] AS [u]
WHERE [u].[national_id] = @__request_NationalId_0
2025-02-05 09:43:05.816 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 09:43:05.818 +03:00 [INF] Executed action NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI) in 15.9702ms
2025-02-05 09:43:05.819 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI)'
2025-02-05 09:43:05.820 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/list - 200 null application/json; charset=utf-8 22.9206ms
2025-02-05 09:43:06.260 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/list - application/json; charset=utf-8 39
2025-02-05 09:43:06.264 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI)'
2025-02-05 09:43:06.265 +03:00 [INF] Route matched with {action = "GetNotifications", controller = "Notifications"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetNotifications(NayifatAPI.Controllers.GetNotificationsRequest) on controller NayifatAPI.Controllers.NotificationsController (NayifatAPI).
2025-02-05 09:43:06.268 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 09:43:06.271 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__request_NationalId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[national_id], [u].[last_updated], [u].[notifications]
FROM [user_notifications] AS [u]
WHERE [u].[national_id] = @__request_NationalId_0
2025-02-05 09:43:06.276 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__Parse_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [n].[Id], [n].[additional_data], [n].[Body], [n].[body_ar], [n].[body_en], [n].[created_at], [n].[expiry_at], [n].[Route], [n].[target_criteria], [n].[Title], [n].[title_ar], [n].[title_en]
FROM [notification_templates] AS [n]
WHERE [n].[Id] = @__Parse_0
2025-02-05 09:43:06.281 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__Parse_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [n].[Id], [n].[additional_data], [n].[Body], [n].[body_ar], [n].[body_en], [n].[created_at], [n].[expiry_at], [n].[Route], [n].[target_criteria], [n].[Title], [n].[title_ar], [n].[title_en]
FROM [notification_templates] AS [n]
WHERE [n].[Id] = @__Parse_0
2025-02-05 09:43:06.284 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__Parse_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [n].[Id], [n].[additional_data], [n].[Body], [n].[body_ar], [n].[body_en], [n].[created_at], [n].[expiry_at], [n].[Route], [n].[target_criteria], [n].[Title], [n].[title_ar], [n].[title_en]
FROM [notification_templates] AS [n]
WHERE [n].[Id] = @__Parse_0
2025-02-05 09:43:06.287 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__Parse_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [n].[Id], [n].[additional_data], [n].[Body], [n].[body_ar], [n].[body_en], [n].[created_at], [n].[expiry_at], [n].[Route], [n].[target_criteria], [n].[Title], [n].[title_ar], [n].[title_en]
FROM [notification_templates] AS [n]
WHERE [n].[Id] = @__Parse_0
2025-02-05 09:43:06.297 +03:00 [INF] Executed DbCommand (5ms) [Parameters=[@p0='?' (Size = 4000), @p1='?' (DbType = DateTime2), @p2='?' (Size = 4000), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (Size = 450), @p6='?' (Size = 4000), @p7='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [AuthLogs] ([AuthType], [CreatedAt], [DeviceId], [FailureReason], [IpAddress], [NationalId], [Status], [UserAgent])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7);
2025-02-05 09:43:06.301 +03:00 [ERR] An exception occurred in the database while saving changes for context type 'NayifatAPI.Data.ApplicationDbContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_AuthLogs_Customers_NationalId". The conflict occurred in database "NayifatApp", table "dbo.Customers", column 'NationalId'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:d3bd78e3-55c6-4a98-84ed-f036d63d103e
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_AuthLogs_Customers_NationalId". The conflict occurred in database "NayifatApp", table "dbo.Customers", column 'NationalId'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:d3bd78e3-55c6-4a98-84ed-f036d63d103e
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2025-02-05 09:43:06.312 +03:00 [ERR] Error logging audit event. NationalId: all, Action: notification_delivered, Details: {"notification_count":4,"notification_ids":[20,19,18,12],"timestamp":"2025-02-05T09:43:06.2731035"}
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_AuthLogs_Customers_NationalId". The conflict occurred in database "NayifatApp", table "dbo.Customers", column 'NationalId'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:d3bd78e3-55c6-4a98-84ed-f036d63d103e
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at NayifatAPI.Services.AuditLogService.LogAsync(String nationalId, String action, Object details) in C:\Users\yamta\StudioProjects\nayifat_app_2025_new\nayifatapi\Services\AuditLogService.cs:line 36
2025-02-05 09:43:06.321 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 09:43:06.322 +03:00 [INF] Executed action NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI) in 55.9721ms
2025-02-05 09:43:06.325 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI)'
2025-02-05 09:43:06.327 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/list - 200 null application/json; charset=utf-8 65.987ms
2025-02-05 09:43:30.379 +03:00 [INF] Application is shutting down...
2025-02-05 09:48:19.088 +03:00 [INF] Starting web application
2025-02-05 09:48:19.206 +03:00 [INF] Now listening on: http://localhost:5264
2025-02-05 09:48:19.211 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2025-02-05 09:48:19.212 +03:00 [INF] Hosting environment: Development
2025-02-05 09:48:19.213 +03:00 [INF] Content root path: C:\Users\yamta\StudioProjects\nayifat_app_2025_new\nayifatapi
2025-02-05 09:48:25.303 +03:00 [INF] Request starting HTTP/1.1 GET http://45f9-51-252-155-185.ngrok-free.app/api/loan-application/latest-status/1064448614 - application/json null
2025-02-05 09:48:25.345 +03:00 [WRN] Failed to determine the https port for redirect.
2025-02-05 09:48:25.350 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.LoanApplicationController.GetLatestStatus (NayifatAPI)'
2025-02-05 09:48:25.375 +03:00 [INF] Route matched with {action = "GetLatestStatus", controller = "LoanApplication"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetLatestStatus(System.String) on controller NayifatAPI.Controllers.LoanApplicationController (NayifatAPI).
2025-02-05 09:48:26.491 +03:00 [INF] Executed DbCommand (31ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 09:48:26.565 +03:00 [INF] Getting latest status for National ID: 1064448614
2025-02-05 09:48:26.579 +03:00 [INF] Lead Apps Query: DECLARE @__nationalId_0 nvarchar(20) = N'1064448614';

SELECT [l].[id], [l].[name], [l].[national_id], [l].[phone], [l].[status], [l].[status_timestamp]
FROM [lead_apps_loans] AS [l]
WHERE [l].[national_id] = @__nationalId_0
ORDER BY [l].[status_timestamp] DESC
2025-02-05 09:48:26.612 +03:00 [INF] Executed DbCommand (15ms) [Parameters=[@__nationalId_0='?' (Size = 20)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [l].[id], [l].[name], [l].[national_id], [l].[phone], [l].[status], [l].[status_timestamp]
FROM [lead_apps_loans] AS [l]
WHERE [l].[national_id] = @__nationalId_0
ORDER BY [l].[status_timestamp] DESC
2025-02-05 09:48:26.625 +03:00 [INF] Latest Lead App: Status=null, Timestamp=null, Found=false
2025-02-05 09:48:26.634 +03:00 [INF] Loan Apps Query: DECLARE @__nationalId_0 nvarchar(450) = N'1064448614';

SELECT [l].[loan_id], [l].[loan_amount], [l].[application_no], [l].[customerDecision], [l].[interest_rate], [l].[national_id], [l].[note], [l].[noteUser], [l].[loan_purpose], [l].[remarks], [l].[status], [l].[status_date], [l].[loan_tenure]
FROM [loan_application_details] AS [l]
WHERE [l].[national_id] = @__nationalId_0
ORDER BY [l].[status_date] DESC
2025-02-05 09:48:26.644 +03:00 [INF] Executed DbCommand (4ms) [Parameters=[@__nationalId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [l].[loan_id], [l].[loan_amount], [l].[application_no], [l].[customerDecision], [l].[interest_rate], [l].[national_id], [l].[note], [l].[noteUser], [l].[loan_purpose], [l].[remarks], [l].[status], [l].[status_date], [l].[loan_tenure]
FROM [loan_application_details] AS [l]
WHERE [l].[national_id] = @__nationalId_0
ORDER BY [l].[status_date] DESC
2025-02-05 09:48:26.681 +03:00 [INF] Latest Loan App: Status=approved, StatusDate="2025-02-01T10:55:59.5970000", Found=true
2025-02-05 09:48:26.683 +03:00 [INF] Using Loan App Status: approved, Date: "2025-02-01T10:55:59.5970000"
2025-02-05 09:48:26.684 +03:00 [INF] Returning final status: approved, Timestamp: "2025-02-01T10:55:59.5970000"
2025-02-05 09:48:26.691 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 09:48:26.724 +03:00 [INF] Executed action NayifatAPI.Controllers.LoanApplicationController.GetLatestStatus (NayifatAPI) in 1342.2339ms
2025-02-05 09:48:26.726 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.LoanApplicationController.GetLatestStatus (NayifatAPI)'
2025-02-05 09:48:26.736 +03:00 [INF] Request finished HTTP/1.1 GET http://45f9-51-252-155-185.ngrok-free.app/api/loan-application/latest-status/1064448614 - 200 null application/json; charset=utf-8 1434.0471ms
2025-02-05 09:48:54.035 +03:00 [INF] Request starting HTTP/1.1 GET http://45f9-51-252-155-185.ngrok-free.app/api/loan-application/latest-status/1064448614 - application/json null
2025-02-05 09:48:54.094 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.LoanApplicationController.GetLatestStatus (NayifatAPI)'
2025-02-05 09:48:54.118 +03:00 [INF] Route matched with {action = "GetLatestStatus", controller = "LoanApplication"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetLatestStatus(System.String) on controller NayifatAPI.Controllers.LoanApplicationController (NayifatAPI).
2025-02-05 09:48:54.204 +03:00 [INF] Executed DbCommand (4ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 09:48:54.223 +03:00 [INF] Getting latest status for National ID: 1064448614
2025-02-05 09:48:54.231 +03:00 [INF] Lead Apps Query: DECLARE @__nationalId_0 nvarchar(20) = N'1064448614';

SELECT [l].[id], [l].[name], [l].[national_id], [l].[phone], [l].[status], [l].[status_timestamp]
FROM [lead_apps_loans] AS [l]
WHERE [l].[national_id] = @__nationalId_0
ORDER BY [l].[status_timestamp] DESC
2025-02-05 09:48:54.250 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__nationalId_0='?' (Size = 20)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [l].[id], [l].[name], [l].[national_id], [l].[phone], [l].[status], [l].[status_timestamp]
FROM [lead_apps_loans] AS [l]
WHERE [l].[national_id] = @__nationalId_0
ORDER BY [l].[status_timestamp] DESC
2025-02-05 09:48:54.296 +03:00 [INF] Latest Lead App: Status=null, Timestamp=null, Found=false
2025-02-05 09:48:54.298 +03:00 [INF] Loan Apps Query: DECLARE @__nationalId_0 nvarchar(450) = N'1064448614';

SELECT [l].[loan_id], [l].[loan_amount], [l].[application_no], [l].[customerDecision], [l].[interest_rate], [l].[national_id], [l].[note], [l].[noteUser], [l].[loan_purpose], [l].[remarks], [l].[status], [l].[status_date], [l].[loan_tenure]
FROM [loan_application_details] AS [l]
WHERE [l].[national_id] = @__nationalId_0
ORDER BY [l].[status_date] DESC
2025-02-05 09:48:54.301 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__nationalId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [l].[loan_id], [l].[loan_amount], [l].[application_no], [l].[customerDecision], [l].[interest_rate], [l].[national_id], [l].[note], [l].[noteUser], [l].[loan_purpose], [l].[remarks], [l].[status], [l].[status_date], [l].[loan_tenure]
FROM [loan_application_details] AS [l]
WHERE [l].[national_id] = @__nationalId_0
ORDER BY [l].[status_date] DESC
2025-02-05 09:48:54.304 +03:00 [INF] Latest Loan App: Status=approved, StatusDate="2025-02-01T10:55:59.5970000", Found=true
2025-02-05 09:48:54.305 +03:00 [INF] Using Loan App Status: approved, Date: "2025-02-01T10:55:59.5970000"
2025-02-05 09:48:54.306 +03:00 [INF] Returning final status: approved, Timestamp: "2025-02-01T10:55:59.5970000"
2025-02-05 09:48:54.307 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 09:48:54.309 +03:00 [INF] Executed action NayifatAPI.Controllers.LoanApplicationController.GetLatestStatus (NayifatAPI) in 146.8424ms
2025-02-05 09:48:54.311 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.LoanApplicationController.GetLatestStatus (NayifatAPI)'
2025-02-05 09:48:54.313 +03:00 [INF] Request finished HTTP/1.1 GET http://45f9-51-252-155-185.ngrok-free.app/api/loan-application/latest-status/1064448614 - 200 null application/json; charset=utf-8 278.449ms
2025-02-05 09:48:55.076 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/list - application/json; charset=utf-8 45
2025-02-05 09:48:55.082 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI)'
2025-02-05 09:48:55.337 +03:00 [INF] Route matched with {action = "GetNotifications", controller = "Notifications"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetNotifications(NayifatAPI.Controllers.GetNotificationsRequest) on controller NayifatAPI.Controllers.NotificationsController (NayifatAPI).
2025-02-05 09:48:55.536 +03:00 [INF] Executed DbCommand (17ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 09:48:55.663 +03:00 [INF] Executed DbCommand (17ms) [Parameters=[@__request_NationalId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[national_id], [u].[last_updated], [u].[notifications]
FROM [user_notifications] AS [u]
WHERE [u].[national_id] = @__request_NationalId_0
2025-02-05 09:48:55.939 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 09:48:55.995 +03:00 [INF] Executed action NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI) in 656.5969ms
2025-02-05 09:48:55.997 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI)'
2025-02-05 09:48:55.999 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/list - 200 null application/json; charset=utf-8 922.8666ms
2025-02-05 09:48:56.309 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/list - application/json; charset=utf-8 39
2025-02-05 09:48:56.368 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI)'
2025-02-05 09:48:56.369 +03:00 [INF] Route matched with {action = "GetNotifications", controller = "Notifications"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetNotifications(NayifatAPI.Controllers.GetNotificationsRequest) on controller NayifatAPI.Controllers.NotificationsController (NayifatAPI).
2025-02-05 09:48:56.397 +03:00 [INF] Executed DbCommand (19ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 09:48:56.525 +03:00 [INF] Executed DbCommand (26ms) [Parameters=[@__request_NationalId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[national_id], [u].[last_updated], [u].[notifications]
FROM [user_notifications] AS [u]
WHERE [u].[national_id] = @__request_NationalId_0
2025-02-05 09:48:56.685 +03:00 [INF] Executed DbCommand (4ms) [Parameters=[@__Parse_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [n].[Id], [n].[additional_data], [n].[Body], [n].[body_ar], [n].[body_en], [n].[created_at], [n].[expiry_at], [n].[Route], [n].[target_criteria], [n].[Title], [n].[title_ar], [n].[title_en]
FROM [notification_templates] AS [n]
WHERE [n].[Id] = @__Parse_0
2025-02-05 09:48:56.752 +03:00 [INF] Executed DbCommand (36ms) [Parameters=[@__Parse_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [n].[Id], [n].[additional_data], [n].[Body], [n].[body_ar], [n].[body_en], [n].[created_at], [n].[expiry_at], [n].[Route], [n].[target_criteria], [n].[Title], [n].[title_ar], [n].[title_en]
FROM [notification_templates] AS [n]
WHERE [n].[Id] = @__Parse_0
2025-02-05 09:48:56.982 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__Parse_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [n].[Id], [n].[additional_data], [n].[Body], [n].[body_ar], [n].[body_en], [n].[created_at], [n].[expiry_at], [n].[Route], [n].[target_criteria], [n].[Title], [n].[title_ar], [n].[title_en]
FROM [notification_templates] AS [n]
WHERE [n].[Id] = @__Parse_0
2025-02-05 09:48:57.031 +03:00 [INF] Executed DbCommand (23ms) [Parameters=[@__Parse_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [n].[Id], [n].[additional_data], [n].[Body], [n].[body_ar], [n].[body_en], [n].[created_at], [n].[expiry_at], [n].[Route], [n].[target_criteria], [n].[Title], [n].[title_ar], [n].[title_en]
FROM [notification_templates] AS [n]
WHERE [n].[Id] = @__Parse_0
2025-02-05 09:48:57.237 +03:00 [INF] Executed DbCommand (9ms) [Parameters=[@p0='?' (Size = 4000), @p1='?' (DbType = DateTime2), @p2='?' (Size = 4000), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (Size = 450), @p6='?' (Size = 4000), @p7='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [AuthLogs] ([AuthType], [CreatedAt], [DeviceId], [FailureReason], [IpAddress], [NationalId], [Status], [UserAgent])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7);
2025-02-05 09:48:57.263 +03:00 [ERR] An exception occurred in the database while saving changes for context type 'NayifatAPI.Data.ApplicationDbContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_AuthLogs_Customers_NationalId". The conflict occurred in database "NayifatApp", table "dbo.Customers", column 'NationalId'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:ff4a0d0e-5899-44d4-a1eb-aaebe2f1bb4e
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_AuthLogs_Customers_NationalId". The conflict occurred in database "NayifatApp", table "dbo.Customers", column 'NationalId'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:ff4a0d0e-5899-44d4-a1eb-aaebe2f1bb4e
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2025-02-05 09:48:57.288 +03:00 [ERR] Error logging audit event. NationalId: all, Action: notification_delivered, Details: {"notification_count":4,"notification_ids":[20,19,18,12],"timestamp":"2025-02-05T09:48:56.6721462"}
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_AuthLogs_Customers_NationalId". The conflict occurred in database "NayifatApp", table "dbo.Customers", column 'NationalId'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:ff4a0d0e-5899-44d4-a1eb-aaebe2f1bb4e
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at NayifatAPI.Services.AuditLogService.LogAsync(String nationalId, String action, Object details) in C:\Users\yamta\StudioProjects\nayifat_app_2025_new\nayifatapi\Services\AuditLogService.cs:line 36
2025-02-05 09:48:57.305 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 09:48:57.309 +03:00 [INF] Executed action NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI) in 938.4481ms
2025-02-05 09:48:57.310 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI)'
2025-02-05 09:48:57.311 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/list - 200 null application/json; charset=utf-8 1002.662ms
2025-02-05 09:50:42.958 +03:00 [INF] Application is shutting down...
2025-02-05 09:50:54.158 +03:00 [INF] Starting web application
2025-02-05 09:50:54.279 +03:00 [INF] Now listening on: http://localhost:5264
2025-02-05 09:50:54.285 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2025-02-05 09:50:54.286 +03:00 [INF] Hosting environment: Development
2025-02-05 09:50:54.287 +03:00 [INF] Content root path: C:\Users\yamta\StudioProjects\nayifat_app_2025_new\nayifatapi
2025-02-05 09:51:04.705 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/list - application/json; charset=utf-8 45
2025-02-05 09:51:04.743 +03:00 [WRN] Failed to determine the https port for redirect.
2025-02-05 09:51:04.747 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI)'
2025-02-05 09:51:04.765 +03:00 [INF] Route matched with {action = "GetNotifications", controller = "Notifications"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetNotifications(NayifatAPI.Controllers.GetNotificationsRequest) on controller NayifatAPI.Controllers.NotificationsController (NayifatAPI).
2025-02-05 09:51:05.887 +03:00 [INF] Executed DbCommand (24ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 09:51:05.979 +03:00 [INF] Executed DbCommand (10ms) [Parameters=[@__request_NationalId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[national_id], [u].[last_updated], [u].[notifications]
FROM [user_notifications] AS [u]
WHERE [u].[national_id] = @__request_NationalId_0
2025-02-05 09:51:06.028 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 09:51:06.040 +03:00 [INF] Executed action NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI) in 1268.4944ms
2025-02-05 09:51:06.042 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI)'
2025-02-05 09:51:06.051 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/list - 200 null application/json; charset=utf-8 1348.0823ms
2025-02-05 09:51:06.625 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/list - application/json; charset=utf-8 39
2025-02-05 09:51:06.631 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI)'
2025-02-05 09:51:06.633 +03:00 [INF] Route matched with {action = "GetNotifications", controller = "Notifications"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetNotifications(NayifatAPI.Controllers.GetNotificationsRequest) on controller NayifatAPI.Controllers.NotificationsController (NayifatAPI).
2025-02-05 09:51:06.661 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 09:51:06.667 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__request_NationalId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[national_id], [u].[last_updated], [u].[notifications]
FROM [user_notifications] AS [u]
WHERE [u].[national_id] = @__request_NationalId_0
2025-02-05 09:51:06.688 +03:00 [INF] Executed DbCommand (4ms) [Parameters=[@__Parse_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [n].[Id], [n].[additional_data], [n].[Body], [n].[body_ar], [n].[body_en], [n].[created_at], [n].[expiry_at], [n].[Route], [n].[target_criteria], [n].[Title], [n].[title_ar], [n].[title_en]
FROM [notification_templates] AS [n]
WHERE [n].[Id] = @__Parse_0
2025-02-05 09:51:06.717 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__Parse_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [n].[Id], [n].[additional_data], [n].[Body], [n].[body_ar], [n].[body_en], [n].[created_at], [n].[expiry_at], [n].[Route], [n].[target_criteria], [n].[Title], [n].[title_ar], [n].[title_en]
FROM [notification_templates] AS [n]
WHERE [n].[Id] = @__Parse_0
2025-02-05 09:51:06.721 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__Parse_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [n].[Id], [n].[additional_data], [n].[Body], [n].[body_ar], [n].[body_en], [n].[created_at], [n].[expiry_at], [n].[Route], [n].[target_criteria], [n].[Title], [n].[title_ar], [n].[title_en]
FROM [notification_templates] AS [n]
WHERE [n].[Id] = @__Parse_0
2025-02-05 09:51:06.724 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__Parse_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [n].[Id], [n].[additional_data], [n].[Body], [n].[body_ar], [n].[body_en], [n].[created_at], [n].[expiry_at], [n].[Route], [n].[target_criteria], [n].[Title], [n].[title_ar], [n].[title_en]
FROM [notification_templates] AS [n]
WHERE [n].[Id] = @__Parse_0
2025-02-05 09:51:06.880 +03:00 [INF] Executed DbCommand (5ms) [Parameters=[@p0='?' (Size = 4000), @p1='?' (DbType = DateTime2), @p2='?' (Size = 4000), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (Size = 450), @p6='?' (Size = 4000), @p7='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [AuthLogs] ([AuthType], [CreatedAt], [DeviceId], [FailureReason], [IpAddress], [NationalId], [Status], [UserAgent])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7);
2025-02-05 09:51:06.903 +03:00 [ERR] An exception occurred in the database while saving changes for context type 'NayifatAPI.Data.ApplicationDbContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_AuthLogs_Customers_NationalId". The conflict occurred in database "NayifatApp", table "dbo.Customers", column 'NationalId'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:8aa90c5d-eeee-4c0e-a4b5-b752d809224a
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_AuthLogs_Customers_NationalId". The conflict occurred in database "NayifatApp", table "dbo.Customers", column 'NationalId'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:8aa90c5d-eeee-4c0e-a4b5-b752d809224a
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2025-02-05 09:51:06.933 +03:00 [ERR] Error logging audit event. NationalId: all, Action: notification_delivered, Details: {"notification_count":4,"notification_ids":[20,19,18,12],"timestamp":"2025-02-05T09:51:06.6691935"}
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_AuthLogs_Customers_NationalId". The conflict occurred in database "NayifatApp", table "dbo.Customers", column 'NationalId'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:8aa90c5d-eeee-4c0e-a4b5-b752d809224a
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at NayifatAPI.Services.AuditLogService.LogAsync(String nationalId, String action, Object details) in C:\Users\yamta\StudioProjects\nayifat_app_2025_new\nayifatapi\Services\AuditLogService.cs:line 36
2025-02-05 09:51:06.962 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 09:51:06.967 +03:00 [INF] Executed action NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI) in 332.6157ms
2025-02-05 09:51:06.968 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI)'
2025-02-05 09:51:06.970 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/list - 200 null application/json; charset=utf-8 345.456ms
2025-02-05 09:51:22.021 +03:00 [INF] Request starting HTTP/1.1 GET http://45f9-51-252-155-185.ngrok-free.app/api/loan-application/latest-status/1064448614 - application/json null
2025-02-05 09:51:22.027 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.LoanApplicationController.GetLatestStatus (NayifatAPI)'
2025-02-05 09:51:22.034 +03:00 [INF] Route matched with {action = "GetLatestStatus", controller = "LoanApplication"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetLatestStatus(System.String) on controller NayifatAPI.Controllers.LoanApplicationController (NayifatAPI).
2025-02-05 09:51:22.102 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 09:51:22.104 +03:00 [INF] Getting latest status for National ID: 1064448614
2025-02-05 09:51:22.118 +03:00 [INF] Executed DbCommand (4ms) [Parameters=[@__nationalId_0='?' (Size = 20)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [l].[id], [l].[name], [l].[national_id], [l].[phone], [l].[status], [l].[status_timestamp]
FROM [lead_apps_loans] AS [l]
WHERE [l].[national_id] = @__nationalId_0
ORDER BY [l].[status_timestamp] DESC
2025-02-05 09:51:22.120 +03:00 [INF] Latest Lead App: Status=null, Timestamp=null, Found=false
2025-02-05 09:51:22.131 +03:00 [INF] Executed DbCommand (4ms) [Parameters=[@__nationalId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [l].[loan_id], [l].[loan_amount], [l].[application_no], [l].[customerDecision], [l].[interest_rate], [l].[national_id], [l].[note], [l].[noteUser], [l].[loan_purpose], [l].[remarks], [l].[status], [l].[status_date], [l].[loan_tenure]
FROM [loan_application_details] AS [l]
WHERE [l].[national_id] = @__nationalId_0
ORDER BY [l].[status_date] DESC
2025-02-05 09:51:22.162 +03:00 [INF] Latest Loan App: Status=approved, StatusDate="2025-02-01T10:55:59.5970000", Found=true
2025-02-05 09:51:22.163 +03:00 [INF] Using Loan App Status: approved, Date: "2025-02-01T10:55:59.5970000"
2025-02-05 09:51:22.163 +03:00 [INF] Returning final status: approved, Timestamp: "2025-02-01T10:55:59.5970000"
2025-02-05 09:51:22.165 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 09:51:22.172 +03:00 [INF] Executed action NayifatAPI.Controllers.LoanApplicationController.GetLatestStatus (NayifatAPI) in 136.6438ms
2025-02-05 09:51:22.174 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.LoanApplicationController.GetLatestStatus (NayifatAPI)'
2025-02-05 09:51:22.176 +03:00 [INF] Request finished HTTP/1.1 GET http://45f9-51-252-155-185.ngrok-free.app/api/loan-application/latest-status/1064448614 - 200 null application/json; charset=utf-8 154.7184ms
2025-02-05 09:54:04.753 +03:00 [INF] Application is shutting down...
2025-02-05 09:54:14.457 +03:00 [INF] Starting web application
2025-02-05 09:54:14.569 +03:00 [INF] Now listening on: http://localhost:5264
2025-02-05 09:54:14.575 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2025-02-05 09:54:14.576 +03:00 [INF] Hosting environment: Development
2025-02-05 09:54:14.577 +03:00 [INF] Content root path: C:\Users\yamta\StudioProjects\nayifat_app_2025_new\nayifatapi
2025-02-05 09:54:42.868 +03:00 [INF] Request starting HTTP/1.1 GET http://45f9-51-252-155-185.ngrok-free.app/api/loan-application/latest-status/1064448614 - application/json null
2025-02-05 09:54:42.907 +03:00 [WRN] Failed to determine the https port for redirect.
2025-02-05 09:54:42.910 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.LoanApplicationController.GetLatestStatus (NayifatAPI)'
2025-02-05 09:54:42.927 +03:00 [INF] Route matched with {action = "GetLatestStatus", controller = "LoanApplication"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetLatestStatus(System.String) on controller NayifatAPI.Controllers.LoanApplicationController (NayifatAPI).
2025-02-05 09:54:44.074 +03:00 [INF] Executed DbCommand (23ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 09:54:44.144 +03:00 [INF] LOANS_CHECK_START: Getting latest status for National ID: 1064448614
2025-02-05 09:54:44.145 +03:00 [INF] LOANS_CHECK_LEAD_QUERY: SELECT TOP 1 FROM lead_apps_loans WHERE national_id = 1064448614 ORDER BY status_timestamp DESC
2025-02-05 09:54:44.177 +03:00 [INF] Executed DbCommand (11ms) [Parameters=[@__nationalId_0='?' (Size = 20)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [l].[id], [l].[name], [l].[national_id], [l].[phone], [l].[status], [l].[status_timestamp]
FROM [lead_apps_loans] AS [l]
WHERE [l].[national_id] = @__nationalId_0
ORDER BY [l].[status_timestamp] DESC
2025-02-05 09:54:44.187 +03:00 [INF] LOANS_CHECK_LEAD_RESULT: Found=false, Status=null, Timestamp=null
2025-02-05 09:54:44.188 +03:00 [INF] LOANS_CHECK_LOAN_QUERY: SELECT TOP 1 FROM loan_application_details WHERE national_id = 1064448614 ORDER BY status_date DESC
2025-02-05 09:54:44.201 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[@__nationalId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [l].[loan_id], [l].[loan_amount], [l].[application_no], [l].[customerDecision], [l].[interest_rate], [l].[national_id], [l].[note], [l].[noteUser], [l].[loan_purpose], [l].[remarks], [l].[status], [l].[status_date], [l].[loan_tenure]
FROM [loan_application_details] AS [l]
WHERE [l].[national_id] = @__nationalId_0
ORDER BY [l].[status_date] DESC
2025-02-05 09:54:44.244 +03:00 [INF] LOANS_CHECK_LOAN_RESULT: Found=true, Status=approved, Timestamp=01/02/2025 10:55:59 AM
2025-02-05 09:54:44.246 +03:00 [INF] LOANS_CHECK_DECISION: Using Loan App (Lead App not found). Status=approved, Date="2025-02-01T10:55:59.5970000"
2025-02-05 09:54:44.249 +03:00 [INF] LOANS_CHECK_FINAL: Returning Status=approved, Timestamp="2025-02-01T10:55:59.5970000"
2025-02-05 09:54:44.257 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 09:54:44.292 +03:00 [INF] Executed action NayifatAPI.Controllers.LoanApplicationController.GetLatestStatus (NayifatAPI) in 1359.8716ms
2025-02-05 09:54:44.295 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.LoanApplicationController.GetLatestStatus (NayifatAPI)'
2025-02-05 09:54:44.303 +03:00 [INF] Request finished HTTP/1.1 GET http://45f9-51-252-155-185.ngrok-free.app/api/loan-application/latest-status/1064448614 - 200 null application/json; charset=utf-8 1436.0006ms
2025-02-05 09:56:06.734 +03:00 [INF] Application is shutting down...
2025-02-05 09:56:15.869 +03:00 [INF] Starting web application
2025-02-05 09:56:16.424 +03:00 [INF] Now listening on: http://localhost:5264
2025-02-05 09:56:16.753 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2025-02-05 09:56:17.069 +03:00 [INF] Hosting environment: Development
2025-02-05 09:56:17.071 +03:00 [INF] Content root path: C:\Users\yamta\StudioProjects\nayifat_app_2025_new\nayifatapi
2025-02-05 09:56:21.569 +03:00 [INF] Request starting HTTP/1.1 GET http://45f9-51-252-155-185.ngrok-free.app/api/loan-application/latest-status/1064448614 - application/json null
2025-02-05 09:56:21.609 +03:00 [WRN] Failed to determine the https port for redirect.
2025-02-05 09:56:21.619 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.LoanApplicationController.GetLatestStatus (NayifatAPI)'
2025-02-05 09:56:21.644 +03:00 [INF] Route matched with {action = "GetLatestStatus", controller = "LoanApplication"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetLatestStatus(System.String) on controller NayifatAPI.Controllers.LoanApplicationController (NayifatAPI).
2025-02-05 09:56:23.031 +03:00 [INF] Executed DbCommand (28ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 09:56:23.105 +03:00 [INF] LOANS_CHECK_START: Getting latest status for National ID: 1064448614
2025-02-05 09:56:23.119 +03:00 [INF] LOANS_CHECK_LEAD_SQL: DECLARE @__nationalId_0 nvarchar(20) = N'1064448614';

SELECT [l].[id], [l].[name], [l].[national_id], [l].[phone], [l].[status], [l].[status_timestamp]
FROM [lead_apps_loans] AS [l]
WHERE [l].[national_id] = @__nationalId_0
ORDER BY [l].[status_timestamp] DESC
2025-02-05 09:56:23.156 +03:00 [INF] Executed DbCommand (14ms) [Parameters=[@__nationalId_0='?' (Size = 20)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [l].[id], [l].[name], [l].[national_id], [l].[phone], [l].[status], [l].[status_timestamp]
FROM [lead_apps_loans] AS [l]
WHERE [l].[national_id] = @__nationalId_0
ORDER BY [l].[status_timestamp] DESC
2025-02-05 09:56:23.170 +03:00 [INF] LOANS_CHECK_LEAD_RESULT: Found=false, Status=null, Timestamp=null
2025-02-05 09:56:23.177 +03:00 [INF] LOANS_CHECK_LOAN_SQL: DECLARE @__nationalId_0 nvarchar(450) = N'1064448614';

SELECT [l].[loan_id], [l].[loan_amount], [l].[application_no], [l].[customerDecision], [l].[interest_rate], [l].[national_id], [l].[note], [l].[noteUser], [l].[loan_purpose], [l].[remarks], [l].[status], [l].[status_date], [l].[loan_tenure]
FROM [loan_application_details] AS [l]
WHERE [l].[national_id] = @__nationalId_0
ORDER BY [l].[status_date] DESC
2025-02-05 09:56:23.190 +03:00 [INF] Executed DbCommand (4ms) [Parameters=[@__nationalId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [l].[loan_id], [l].[loan_amount], [l].[application_no], [l].[customerDecision], [l].[interest_rate], [l].[national_id], [l].[note], [l].[noteUser], [l].[loan_purpose], [l].[remarks], [l].[status], [l].[status_date], [l].[loan_tenure]
FROM [loan_application_details] AS [l]
WHERE [l].[national_id] = @__nationalId_0
ORDER BY [l].[status_date] DESC
2025-02-05 09:56:23.245 +03:00 [INF] LOANS_CHECK_LOAN_RESULT: Found=true, Status=approved, Timestamp=01/02/2025 10:55:59 AM
2025-02-05 09:56:23.246 +03:00 [INF] LOANS_CHECK_DECISION: Using Loan App (Lead App not found). Status=approved, Date="2025-02-01T10:55:59.5970000"
2025-02-05 09:56:23.248 +03:00 [INF] LOANS_CHECK_FINAL: Returning Status=approved, Timestamp="2025-02-01T10:55:59.5970000"
2025-02-05 09:56:23.255 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 09:56:23.294 +03:00 [INF] Executed action NayifatAPI.Controllers.LoanApplicationController.GetLatestStatus (NayifatAPI) in 1644.64ms
2025-02-05 09:56:23.297 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.LoanApplicationController.GetLatestStatus (NayifatAPI)'
2025-02-05 09:56:23.309 +03:00 [INF] Request finished HTTP/1.1 GET http://45f9-51-252-155-185.ngrok-free.app/api/loan-application/latest-status/1064448614 - 200 null application/json; charset=utf-8 1742.5763ms
2025-02-05 09:57:30.562 +03:00 [INF] Request starting HTTP/1.1 GET http://45f9-51-252-155-185.ngrok-free.app/api/loan-application/latest-status/1064448614 - application/json null
2025-02-05 09:57:30.570 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.LoanApplicationController.GetLatestStatus (NayifatAPI)'
2025-02-05 09:57:30.571 +03:00 [INF] Route matched with {action = "GetLatestStatus", controller = "LoanApplication"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetLatestStatus(System.String) on controller NayifatAPI.Controllers.LoanApplicationController (NayifatAPI).
2025-02-05 09:57:30.599 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 09:57:30.601 +03:00 [INF] LOANS_CHECK_START: Getting latest status for National ID: 1064448614
2025-02-05 09:57:30.603 +03:00 [INF] LOANS_CHECK_LEAD_SQL: DECLARE @__nationalId_0 nvarchar(20) = N'1064448614';

SELECT [l].[id], [l].[name], [l].[national_id], [l].[phone], [l].[status], [l].[status_timestamp]
FROM [lead_apps_loans] AS [l]
WHERE [l].[national_id] = @__nationalId_0
ORDER BY [l].[status_timestamp] DESC
2025-02-05 09:57:30.608 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[@__nationalId_0='?' (Size = 20)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [l].[id], [l].[name], [l].[national_id], [l].[phone], [l].[status], [l].[status_timestamp]
FROM [lead_apps_loans] AS [l]
WHERE [l].[national_id] = @__nationalId_0
ORDER BY [l].[status_timestamp] DESC
2025-02-05 09:57:30.629 +03:00 [INF] LOANS_CHECK_LEAD_RESULT: Found=true, Status=PENDING, Timestamp=04/02/2025 6:43:35 PM
2025-02-05 09:57:30.631 +03:00 [INF] LOANS_CHECK_LOAN_SQL: DECLARE @__nationalId_0 nvarchar(450) = N'1064448614';

SELECT [l].[loan_id], [l].[loan_amount], [l].[application_no], [l].[customerDecision], [l].[interest_rate], [l].[national_id], [l].[note], [l].[noteUser], [l].[loan_purpose], [l].[remarks], [l].[status], [l].[status_date], [l].[loan_tenure]
FROM [loan_application_details] AS [l]
WHERE [l].[national_id] = @__nationalId_0
ORDER BY [l].[status_date] DESC
2025-02-05 09:57:30.638 +03:00 [INF] Executed DbCommand (4ms) [Parameters=[@__nationalId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [l].[loan_id], [l].[loan_amount], [l].[application_no], [l].[customerDecision], [l].[interest_rate], [l].[national_id], [l].[note], [l].[noteUser], [l].[loan_purpose], [l].[remarks], [l].[status], [l].[status_date], [l].[loan_tenure]
FROM [loan_application_details] AS [l]
WHERE [l].[national_id] = @__nationalId_0
ORDER BY [l].[status_date] DESC
2025-02-05 09:57:30.642 +03:00 [INF] LOANS_CHECK_LOAN_RESULT: Found=true, Status=approved, Timestamp=01/02/2025 10:55:59 AM
2025-02-05 09:57:30.643 +03:00 [INF] LOANS_CHECK_COMPARISON: Lead App Time="2025-02-04T18:43:35.8870000Z", Status=PENDING | Loan App Time="2025-02-01T10:55:59.5970000Z", Status=approved
2025-02-05 09:57:30.645 +03:00 [INF] LOANS_CHECK_DECISION: Selected Lead App (more recent). Status=PENDING, Date="2025-02-04T18:43:35.8870000Z"
2025-02-05 09:57:30.646 +03:00 [INF] LOANS_CHECK_FINAL: Returning Status=PENDING, Timestamp="2025-02-04T18:43:35.8870000Z"
2025-02-05 09:57:30.648 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 09:57:30.650 +03:00 [INF] Executed action NayifatAPI.Controllers.LoanApplicationController.GetLatestStatus (NayifatAPI) in 77.5713ms
2025-02-05 09:57:30.651 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.LoanApplicationController.GetLatestStatus (NayifatAPI)'
2025-02-05 09:57:30.654 +03:00 [INF] Request finished HTTP/1.1 GET http://45f9-51-252-155-185.ngrok-free.app/api/loan-application/latest-status/1064448614 - 200 null application/json; charset=utf-8 91.7316ms
2025-02-05 09:57:56.990 +03:00 [INF] Request starting HTTP/1.1 GET http://45f9-51-252-155-185.ngrok-free.app/api/loan-application/latest-status/1064448614 - application/json null
2025-02-05 09:57:56.998 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.LoanApplicationController.GetLatestStatus (NayifatAPI)'
2025-02-05 09:57:57.000 +03:00 [INF] Route matched with {action = "GetLatestStatus", controller = "LoanApplication"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetLatestStatus(System.String) on controller NayifatAPI.Controllers.LoanApplicationController (NayifatAPI).
2025-02-05 09:57:57.144 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 09:57:57.146 +03:00 [INF] LOANS_CHECK_START: Getting latest status for National ID: 1064448614
2025-02-05 09:57:57.147 +03:00 [INF] LOANS_CHECK_LEAD_SQL: DECLARE @__nationalId_0 nvarchar(20) = N'1064448614';

SELECT [l].[id], [l].[name], [l].[national_id], [l].[phone], [l].[status], [l].[status_timestamp]
FROM [lead_apps_loans] AS [l]
WHERE [l].[national_id] = @__nationalId_0
ORDER BY [l].[status_timestamp] DESC
2025-02-05 09:57:57.151 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__nationalId_0='?' (Size = 20)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [l].[id], [l].[name], [l].[national_id], [l].[phone], [l].[status], [l].[status_timestamp]
FROM [lead_apps_loans] AS [l]
WHERE [l].[national_id] = @__nationalId_0
ORDER BY [l].[status_timestamp] DESC
2025-02-05 09:57:57.155 +03:00 [INF] LOANS_CHECK_LEAD_RESULT: Found=true, Status=PENDING, Timestamp=01/02/2025 12:43:35 AM
2025-02-05 09:57:57.156 +03:00 [INF] LOANS_CHECK_LOAN_SQL: DECLARE @__nationalId_0 nvarchar(450) = N'1064448614';

SELECT [l].[loan_id], [l].[loan_amount], [l].[application_no], [l].[customerDecision], [l].[interest_rate], [l].[national_id], [l].[note], [l].[noteUser], [l].[loan_purpose], [l].[remarks], [l].[status], [l].[status_date], [l].[loan_tenure]
FROM [loan_application_details] AS [l]
WHERE [l].[national_id] = @__nationalId_0
ORDER BY [l].[status_date] DESC
2025-02-05 09:57:57.162 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__nationalId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [l].[loan_id], [l].[loan_amount], [l].[application_no], [l].[customerDecision], [l].[interest_rate], [l].[national_id], [l].[note], [l].[noteUser], [l].[loan_purpose], [l].[remarks], [l].[status], [l].[status_date], [l].[loan_tenure]
FROM [loan_application_details] AS [l]
WHERE [l].[national_id] = @__nationalId_0
ORDER BY [l].[status_date] DESC
2025-02-05 09:57:57.165 +03:00 [INF] LOANS_CHECK_LOAN_RESULT: Found=true, Status=approved, Timestamp=01/02/2025 10:55:59 AM
2025-02-05 09:57:57.167 +03:00 [INF] LOANS_CHECK_COMPARISON: Lead App Time="2025-02-01T00:43:35.8870000Z", Status=PENDING | Loan App Time="2025-02-01T10:55:59.5970000Z", Status=approved
2025-02-05 09:57:57.170 +03:00 [INF] LOANS_CHECK_DECISION: Selected Loan App (more recent). Status=approved, Date="2025-02-01T10:55:59.5970000Z"
2025-02-05 09:57:57.172 +03:00 [INF] LOANS_CHECK_FINAL: Returning Status=approved, Timestamp="2025-02-01T10:55:59.5970000Z"
2025-02-05 09:57:57.174 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 09:57:57.177 +03:00 [INF] Executed action NayifatAPI.Controllers.LoanApplicationController.GetLatestStatus (NayifatAPI) in 173.4934ms
2025-02-05 09:57:57.179 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.LoanApplicationController.GetLatestStatus (NayifatAPI)'
2025-02-05 09:57:57.180 +03:00 [INF] Request finished HTTP/1.1 GET http://45f9-51-252-155-185.ngrok-free.app/api/loan-application/latest-status/1064448614 - 200 null application/json; charset=utf-8 189.8307ms
2025-02-05 09:58:49.437 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/list - application/json 39
2025-02-05 09:58:49.555 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/list - application/json 39
2025-02-05 09:58:49.557 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI)'
2025-02-05 09:58:49.560 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI)'
2025-02-05 09:58:49.567 +03:00 [INF] Route matched with {action = "GetNotifications", controller = "Notifications"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetNotifications(NayifatAPI.Controllers.GetNotificationsRequest) on controller NayifatAPI.Controllers.NotificationsController (NayifatAPI).
2025-02-05 09:58:49.567 +03:00 [INF] Route matched with {action = "GetNotifications", controller = "Notifications"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetNotifications(NayifatAPI.Controllers.GetNotificationsRequest) on controller NayifatAPI.Controllers.NotificationsController (NayifatAPI).
2025-02-05 09:58:49.637 +03:00 [INF] Executed DbCommand (30ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 09:58:49.768 +03:00 [INF] Executed DbCommand (117ms) [Parameters=[@__request_NationalId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[national_id], [u].[last_updated], [u].[notifications]
FROM [user_notifications] AS [u]
WHERE [u].[national_id] = @__request_NationalId_0
2025-02-05 09:58:49.789 +03:00 [INF] Executed DbCommand (27ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 09:58:49.904 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__request_NationalId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[national_id], [u].[last_updated], [u].[notifications]
FROM [user_notifications] AS [u]
WHERE [u].[national_id] = @__request_NationalId_0
2025-02-05 09:58:51.474 +03:00 [INF] Executed DbCommand (1,490ms) [Parameters=[@__Parse_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [n].[Id], [n].[additional_data], [n].[Body], [n].[body_ar], [n].[body_en], [n].[created_at], [n].[expiry_at], [n].[Route], [n].[target_criteria], [n].[Title], [n].[title_ar], [n].[title_en]
FROM [notification_templates] AS [n]
WHERE [n].[Id] = @__Parse_0
2025-02-05 09:58:51.481 +03:00 [INF] Executed DbCommand (1,388ms) [Parameters=[@__Parse_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [n].[Id], [n].[additional_data], [n].[Body], [n].[body_ar], [n].[body_en], [n].[created_at], [n].[expiry_at], [n].[Route], [n].[target_criteria], [n].[Title], [n].[title_ar], [n].[title_en]
FROM [notification_templates] AS [n]
WHERE [n].[Id] = @__Parse_0
2025-02-05 09:58:51.538 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__Parse_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [n].[Id], [n].[additional_data], [n].[Body], [n].[body_ar], [n].[body_en], [n].[created_at], [n].[expiry_at], [n].[Route], [n].[target_criteria], [n].[Title], [n].[title_ar], [n].[title_en]
FROM [notification_templates] AS [n]
WHERE [n].[Id] = @__Parse_0
2025-02-05 09:58:51.538 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__Parse_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [n].[Id], [n].[additional_data], [n].[Body], [n].[body_ar], [n].[body_en], [n].[created_at], [n].[expiry_at], [n].[Route], [n].[target_criteria], [n].[Title], [n].[title_ar], [n].[title_en]
FROM [notification_templates] AS [n]
WHERE [n].[Id] = @__Parse_0
2025-02-05 09:58:51.542 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__Parse_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [n].[Id], [n].[additional_data], [n].[Body], [n].[body_ar], [n].[body_en], [n].[created_at], [n].[expiry_at], [n].[Route], [n].[target_criteria], [n].[Title], [n].[title_ar], [n].[title_en]
FROM [notification_templates] AS [n]
WHERE [n].[Id] = @__Parse_0
2025-02-05 09:58:51.543 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__Parse_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [n].[Id], [n].[additional_data], [n].[Body], [n].[body_ar], [n].[body_en], [n].[created_at], [n].[expiry_at], [n].[Route], [n].[target_criteria], [n].[Title], [n].[title_ar], [n].[title_en]
FROM [notification_templates] AS [n]
WHERE [n].[Id] = @__Parse_0
2025-02-05 09:58:51.545 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__Parse_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [n].[Id], [n].[additional_data], [n].[Body], [n].[body_ar], [n].[body_en], [n].[created_at], [n].[expiry_at], [n].[Route], [n].[target_criteria], [n].[Title], [n].[title_ar], [n].[title_en]
FROM [notification_templates] AS [n]
WHERE [n].[Id] = @__Parse_0
2025-02-05 09:58:51.547 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__Parse_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [n].[Id], [n].[additional_data], [n].[Body], [n].[body_ar], [n].[body_en], [n].[created_at], [n].[expiry_at], [n].[Route], [n].[target_criteria], [n].[Title], [n].[title_ar], [n].[title_en]
FROM [notification_templates] AS [n]
WHERE [n].[Id] = @__Parse_0
2025-02-05 09:58:52.127 +03:00 [INF] Executed DbCommand (363ms) [Parameters=[@p0='?' (Size = 4000), @p1='?' (DbType = DateTime2), @p2='?' (Size = 4000), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (Size = 450), @p6='?' (Size = 4000), @p7='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [AuthLogs] ([AuthType], [CreatedAt], [DeviceId], [FailureReason], [IpAddress], [NationalId], [Status], [UserAgent])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7);
2025-02-05 09:58:52.127 +03:00 [INF] Executed DbCommand (363ms) [Parameters=[@p0='?' (Size = 4000), @p1='?' (DbType = DateTime2), @p2='?' (Size = 4000), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (Size = 450), @p6='?' (Size = 4000), @p7='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [AuthLogs] ([AuthType], [CreatedAt], [DeviceId], [FailureReason], [IpAddress], [NationalId], [Status], [UserAgent])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7);
2025-02-05 09:58:52.161 +03:00 [ERR] An exception occurred in the database while saving changes for context type 'NayifatAPI.Data.ApplicationDbContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_AuthLogs_Customers_NationalId". The conflict occurred in database "NayifatApp", table "dbo.Customers", column 'NationalId'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:a1637792-a3f1-4870-94aa-55724939b48a
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_AuthLogs_Customers_NationalId". The conflict occurred in database "NayifatApp", table "dbo.Customers", column 'NationalId'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:a1637792-a3f1-4870-94aa-55724939b48a
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2025-02-05 09:58:52.161 +03:00 [ERR] An exception occurred in the database while saving changes for context type 'NayifatAPI.Data.ApplicationDbContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_AuthLogs_Customers_NationalId". The conflict occurred in database "NayifatApp", table "dbo.Customers", column 'NationalId'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:ccf0e465-102e-4930-8058-e161fe572e44
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_AuthLogs_Customers_NationalId". The conflict occurred in database "NayifatApp", table "dbo.Customers", column 'NationalId'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:ccf0e465-102e-4930-8058-e161fe572e44
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2025-02-05 09:58:52.194 +03:00 [ERR] Error logging audit event. NationalId: all, Action: notification_delivered, Details: {"notification_count":4,"notification_ids":[20,19,18,12],"timestamp":"2025-02-05T09:58:49.9399564"}
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_AuthLogs_Customers_NationalId". The conflict occurred in database "NayifatApp", table "dbo.Customers", column 'NationalId'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:a1637792-a3f1-4870-94aa-55724939b48a
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at NayifatAPI.Services.AuditLogService.LogAsync(String nationalId, String action, Object details) in C:\Users\yamta\StudioProjects\nayifat_app_2025_new\nayifatapi\Services\AuditLogService.cs:line 36
2025-02-05 09:58:52.194 +03:00 [ERR] Error logging audit event. NationalId: all, Action: notification_delivered, Details: {"notification_count":4,"notification_ids":[20,19,18,12],"timestamp":"2025-02-05T09:58:50.0866397"}
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_AuthLogs_Customers_NationalId". The conflict occurred in database "NayifatApp", table "dbo.Customers", column 'NationalId'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:ccf0e465-102e-4930-8058-e161fe572e44
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at NayifatAPI.Services.AuditLogService.LogAsync(String nationalId, String action, Object details) in C:\Users\yamta\StudioProjects\nayifat_app_2025_new\nayifatapi\Services\AuditLogService.cs:line 36
2025-02-05 09:58:52.218 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 09:58:52.227 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 09:58:52.234 +03:00 [INF] Executed action NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI) in 2665.5535ms
2025-02-05 09:58:52.234 +03:00 [INF] Executed action NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI) in 2663.8374ms
2025-02-05 09:58:52.235 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI)'
2025-02-05 09:58:52.237 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI)'
2025-02-05 09:58:52.238 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/list - 200 null application/json; charset=utf-8 2683.7282ms
2025-02-05 09:58:52.239 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/list - 200 null application/json; charset=utf-8 2802.0527ms
2025-02-05 09:58:52.475 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/list - application/json 45
2025-02-05 09:58:52.476 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/list - application/json 45
2025-02-05 09:58:52.478 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI)'
2025-02-05 09:58:52.481 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI)'
2025-02-05 09:58:52.483 +03:00 [INF] Route matched with {action = "GetNotifications", controller = "Notifications"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetNotifications(NayifatAPI.Controllers.GetNotificationsRequest) on controller NayifatAPI.Controllers.NotificationsController (NayifatAPI).
2025-02-05 09:58:52.485 +03:00 [INF] Route matched with {action = "GetNotifications", controller = "Notifications"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetNotifications(NayifatAPI.Controllers.GetNotificationsRequest) on controller NayifatAPI.Controllers.NotificationsController (NayifatAPI).
2025-02-05 09:58:52.493 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 09:58:52.494 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 09:58:52.499 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__request_NationalId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[national_id], [u].[last_updated], [u].[notifications]
FROM [user_notifications] AS [u]
WHERE [u].[national_id] = @__request_NationalId_0
2025-02-05 09:58:52.503 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__request_NationalId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[national_id], [u].[last_updated], [u].[notifications]
FROM [user_notifications] AS [u]
WHERE [u].[national_id] = @__request_NationalId_0
2025-02-05 09:58:52.506 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 09:58:52.508 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 09:58:52.510 +03:00 [INF] Executed action NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI) in 22.6741ms
2025-02-05 09:58:52.512 +03:00 [INF] Executed action NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI) in 22.2905ms
2025-02-05 09:58:52.515 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI)'
2025-02-05 09:58:52.517 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI)'
2025-02-05 09:58:52.518 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/list - 200 null application/json; charset=utf-8 42.7981ms
2025-02-05 09:58:52.518 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/list - 200 null application/json; charset=utf-8 42.4047ms
2025-02-05 10:00:24.194 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/timestamps - application/json; charset=utf-8 2
2025-02-05 10:00:24.196 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.ContentController.GetTimestamps (NayifatAPI)'
2025-02-05 10:00:24.201 +03:00 [INF] Route matched with {action = "GetTimestamps", controller = "Content"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetTimestamps() on controller NayifatAPI.Controllers.ContentController (NayifatAPI).
2025-02-05 10:00:24.205 +03:00 [INF] TTT_
2025-02-05 10:00:24.206 +03:00 [INF] TTT_=== Getting Content Timestamps ===
2025-02-05 10:00:24.218 +03:00 [INF] Executed DbCommand (10ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 10:00:24.220 +03:00 [INF] TTT_Fetching timestamps from database
2025-02-05 10:00:24.442 +03:00 [INF] Executed DbCommand (200ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [m].[page] AS [Page], [m].[key_name] AS [KeyName], [m].[last_updated] AS [LastUpdated]
FROM [master_config] AS [m]
2025-02-05 10:00:24.448 +03:00 [INF] TTT_Found 18 content items
2025-02-05 10:00:24.452 +03:00 [INF] TTT_Page: home
2025-02-05 10:00:24.453 +03:00 [INF] TTT_  - slideshow_content: "2025-02-04T10:01:06.9430000"
2025-02-05 10:00:24.454 +03:00 [INF] TTT_  - slideshow_content_ar: "2025-02-04T10:01:06.9430000"
2025-02-05 10:00:24.454 +03:00 [INF] TTT_  - contact_details: "2025-02-04T10:01:06.9430000"
2025-02-05 10:00:24.455 +03:00 [INF] TTT_  - contact_details_ar: "2025-02-04T10:01:06.9430000"
2025-02-05 10:00:24.456 +03:00 [INF] TTT_  - termsEN1: "2025-02-03T14:23:58.0000000"
2025-02-05 10:00:24.457 +03:00 [INF] TTT_  - termsEN2: "2025-02-03T14:25:20.1730000"
2025-02-05 10:00:24.458 +03:00 [INF] TTT_  - privacyEN1: "2025-02-03T14:26:08.6130000"
2025-02-05 10:00:24.460 +03:00 [INF] TTT_  - privacyEN2: "2025-02-03T14:25:20.1730000"
2025-02-05 10:00:24.461 +03:00 [INF] TTT_  - termsAR1: "2025-02-03T14:23:58.0000000"
2025-02-05 10:00:24.462 +03:00 [INF] TTT_  - termsAR2: "2025-02-03T14:25:20.1730000"
2025-02-05 10:00:24.464 +03:00 [INF] TTT_  - privacyAR1: "2025-02-03T14:26:08.6130000"
2025-02-05 10:00:24.465 +03:00 [INF] TTT_  - privacyAR2: "2025-02-03T14:25:20.1730000"
2025-02-05 10:00:24.466 +03:00 [INF] TTT_  - terms&conditionsCC_AR: "2025-02-03T17:06:57.7700000"
2025-02-05 10:00:24.467 +03:00 [INF] TTT_  - terms&conditionsCC_EN: "2025-02-03T17:07:47.4900000"
2025-02-05 10:00:24.468 +03:00 [INF] TTT_  - terms&conditionsPF_AR: "2025-02-03T17:06:57.7700000"
2025-02-05 10:00:24.468 +03:00 [INF] TTT_  - terms&conditionsPF_EN: "2025-02-03T17:06:57.7700000"
2025-02-05 10:00:24.469 +03:00 [INF] TTT_Page: loans
2025-02-05 10:00:24.470 +03:00 [INF] TTT_  - loan_ad: "2025-02-04T10:01:06.9430000"
2025-02-05 10:00:24.471 +03:00 [INF] TTT_Page: cards
2025-02-05 10:00:24.471 +03:00 [INF] TTT_  - card_ad: "2025-02-04T10:01:06.9430000"
2025-02-05 10:00:24.472 +03:00 [INF] TTT_Successfully retrieved all timestamps
2025-02-05 10:00:24.473 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 10:00:24.482 +03:00 [INF] Executed action NayifatAPI.Controllers.ContentController.GetTimestamps (NayifatAPI) in 279.7413ms
2025-02-05 10:00:24.484 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.ContentController.GetTimestamps (NayifatAPI)'
2025-02-05 10:00:24.485 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/timestamps - 200 null application/json; charset=utf-8 291.0229ms
2025-02-05 10:00:24.839 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - application/json; charset=utf-8 45
2025-02-05 10:00:24.844 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 10:00:24.848 +03:00 [INF] Route matched with {action = "MasterFetch", controller = "Content"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] MasterFetch(NayifatAPI.Controllers.MasterFetchRequest) on controller NayifatAPI.Controllers.ContentController (NayifatAPI).
2025-02-05 10:00:24.858 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 10:00:25.071 +03:00 [INF] Executed DbCommand (204ms) [Parameters=[@__request_Page_0='?' (Size = 450), @__request_KeyName_1='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[config_id], [m].[key_name], [m].[last_updated], [m].[page], [m].[value]
FROM [master_config] AS [m]
WHERE [m].[page] = @__request_Page_0 AND [m].[key_name] = @__request_KeyName_1
2025-02-05 10:00:25.091 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 10:00:25.094 +03:00 [INF] Executed action NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI) in 244.125ms
2025-02-05 10:00:25.095 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 10:00:25.096 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - 200 null application/json; charset=utf-8 256.5596ms
2025-02-05 10:00:26.553 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - application/json; charset=utf-8 48
2025-02-05 10:00:26.557 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 10:00:26.560 +03:00 [INF] Route matched with {action = "MasterFetch", controller = "Content"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] MasterFetch(NayifatAPI.Controllers.MasterFetchRequest) on controller NayifatAPI.Controllers.ContentController (NayifatAPI).
2025-02-05 10:00:26.566 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 10:00:26.577 +03:00 [INF] Executed DbCommand (7ms) [Parameters=[@__request_Page_0='?' (Size = 450), @__request_KeyName_1='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[config_id], [m].[key_name], [m].[last_updated], [m].[page], [m].[value]
FROM [master_config] AS [m]
WHERE [m].[page] = @__request_Page_0 AND [m].[key_name] = @__request_KeyName_1
2025-02-05 10:00:26.579 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 10:00:26.581 +03:00 [INF] Executed action NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI) in 20.0984ms
2025-02-05 10:00:26.583 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 10:00:26.585 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - 200 null application/json; charset=utf-8 31.0667ms
2025-02-05 10:00:28.172 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - application/json; charset=utf-8 43
2025-02-05 10:00:28.271 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 10:00:28.273 +03:00 [INF] Route matched with {action = "MasterFetch", controller = "Content"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] MasterFetch(NayifatAPI.Controllers.MasterFetchRequest) on controller NayifatAPI.Controllers.ContentController (NayifatAPI).
2025-02-05 10:00:28.279 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 10:00:28.398 +03:00 [INF] Executed DbCommand (116ms) [Parameters=[@__request_Page_0='?' (Size = 450), @__request_KeyName_1='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[config_id], [m].[key_name], [m].[last_updated], [m].[page], [m].[value]
FROM [master_config] AS [m]
WHERE [m].[page] = @__request_Page_0 AND [m].[key_name] = @__request_KeyName_1
2025-02-05 10:00:28.615 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 10:00:28.617 +03:00 [INF] Executed action NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI) in 342.3479ms
2025-02-05 10:00:28.618 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 10:00:28.937 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - 200 null application/json; charset=utf-8 765.2516ms
2025-02-05 10:00:29.387 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - application/json; charset=utf-8 46
2025-02-05 10:00:29.562 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 10:00:29.563 +03:00 [INF] Route matched with {action = "MasterFetch", controller = "Content"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] MasterFetch(NayifatAPI.Controllers.MasterFetchRequest) on controller NayifatAPI.Controllers.ContentController (NayifatAPI).
2025-02-05 10:00:29.577 +03:00 [INF] Executed DbCommand (8ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 10:00:29.585 +03:00 [INF] Executed DbCommand (4ms) [Parameters=[@__request_Page_0='?' (Size = 450), @__request_KeyName_1='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[config_id], [m].[key_name], [m].[last_updated], [m].[page], [m].[value]
FROM [master_config] AS [m]
WHERE [m].[page] = @__request_Page_0 AND [m].[key_name] = @__request_KeyName_1
2025-02-05 10:00:29.589 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 10:00:29.592 +03:00 [INF] Executed action NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI) in 24.7916ms
2025-02-05 10:00:29.594 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 10:00:29.597 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - 200 null application/json; charset=utf-8 209.8647ms
2025-02-05 10:00:29.865 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - application/json; charset=utf-8 36
2025-02-05 10:00:29.868 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 10:00:29.870 +03:00 [INF] Route matched with {action = "MasterFetch", controller = "Content"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] MasterFetch(NayifatAPI.Controllers.MasterFetchRequest) on controller NayifatAPI.Controllers.ContentController (NayifatAPI).
2025-02-05 10:00:29.883 +03:00 [INF] Executed DbCommand (7ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 10:00:29.892 +03:00 [INF] Executed DbCommand (5ms) [Parameters=[@__request_Page_0='?' (Size = 450), @__request_KeyName_1='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[config_id], [m].[key_name], [m].[last_updated], [m].[page], [m].[value]
FROM [master_config] AS [m]
WHERE [m].[page] = @__request_Page_0 AND [m].[key_name] = @__request_KeyName_1
2025-02-05 10:00:29.895 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 10:00:29.900 +03:00 [INF] Executed action NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI) in 26.3359ms
2025-02-05 10:00:29.903 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 10:00:29.905 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - 200 null application/json; charset=utf-8 39.9174ms
2025-02-05 10:00:30.167 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - application/json; charset=utf-8 36
2025-02-05 10:00:30.170 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 10:00:30.171 +03:00 [INF] Route matched with {action = "MasterFetch", controller = "Content"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] MasterFetch(NayifatAPI.Controllers.MasterFetchRequest) on controller NayifatAPI.Controllers.ContentController (NayifatAPI).
2025-02-05 10:00:30.179 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 10:00:30.187 +03:00 [INF] Executed DbCommand (5ms) [Parameters=[@__request_Page_0='?' (Size = 450), @__request_KeyName_1='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[config_id], [m].[key_name], [m].[last_updated], [m].[page], [m].[value]
FROM [master_config] AS [m]
WHERE [m].[page] = @__request_Page_0 AND [m].[key_name] = @__request_KeyName_1
2025-02-05 10:00:30.190 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 10:00:30.192 +03:00 [INF] Executed action NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI) in 17.4125ms
2025-02-05 10:00:30.193 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 10:00:30.195 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - 200 null application/json; charset=utf-8 28.4473ms
2025-02-05 10:00:30.461 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - application/json; charset=utf-8 38
2025-02-05 10:00:30.464 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 10:00:30.466 +03:00 [INF] Route matched with {action = "MasterFetch", controller = "Content"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] MasterFetch(NayifatAPI.Controllers.MasterFetchRequest) on controller NayifatAPI.Controllers.ContentController (NayifatAPI).
2025-02-05 10:00:30.477 +03:00 [INF] Executed DbCommand (5ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 10:00:30.488 +03:00 [INF] Executed DbCommand (6ms) [Parameters=[@__request_Page_0='?' (Size = 450), @__request_KeyName_1='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[config_id], [m].[key_name], [m].[last_updated], [m].[page], [m].[value]
FROM [master_config] AS [m]
WHERE [m].[page] = @__request_Page_0 AND [m].[key_name] = @__request_KeyName_1
2025-02-05 10:00:30.493 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 10:00:30.495 +03:00 [INF] Executed action NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI) in 25.7485ms
2025-02-05 10:00:30.498 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 10:00:30.501 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - 200 null application/json; charset=utf-8 40.0909ms
2025-02-05 10:00:30.798 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - application/json; charset=utf-8 38
2025-02-05 10:00:30.803 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 10:00:30.806 +03:00 [INF] Route matched with {action = "MasterFetch", controller = "Content"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] MasterFetch(NayifatAPI.Controllers.MasterFetchRequest) on controller NayifatAPI.Controllers.ContentController (NayifatAPI).
2025-02-05 10:00:30.816 +03:00 [INF] Executed DbCommand (5ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 10:00:30.824 +03:00 [INF] Executed DbCommand (4ms) [Parameters=[@__request_Page_0='?' (Size = 450), @__request_KeyName_1='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[config_id], [m].[key_name], [m].[last_updated], [m].[page], [m].[value]
FROM [master_config] AS [m]
WHERE [m].[page] = @__request_Page_0 AND [m].[key_name] = @__request_KeyName_1
2025-02-05 10:00:30.827 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 10:00:30.829 +03:00 [INF] Executed action NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI) in 19.3046ms
2025-02-05 10:00:30.831 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 10:00:30.833 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - 200 null application/json; charset=utf-8 35.324ms
2025-02-05 10:00:31.120 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - application/json; charset=utf-8 36
2025-02-05 10:00:31.123 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 10:00:31.125 +03:00 [INF] Route matched with {action = "MasterFetch", controller = "Content"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] MasterFetch(NayifatAPI.Controllers.MasterFetchRequest) on controller NayifatAPI.Controllers.ContentController (NayifatAPI).
2025-02-05 10:00:31.132 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 10:00:31.140 +03:00 [INF] Executed DbCommand (4ms) [Parameters=[@__request_Page_0='?' (Size = 450), @__request_KeyName_1='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[config_id], [m].[key_name], [m].[last_updated], [m].[page], [m].[value]
FROM [master_config] AS [m]
WHERE [m].[page] = @__request_Page_0 AND [m].[key_name] = @__request_KeyName_1
2025-02-05 10:00:31.145 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 10:00:31.148 +03:00 [INF] Executed action NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI) in 20.2101ms
2025-02-05 10:00:31.149 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 10:00:31.151 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - 200 null application/json; charset=utf-8 31.1256ms
2025-02-05 10:00:31.435 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - application/json; charset=utf-8 36
2025-02-05 10:00:31.440 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 10:00:31.441 +03:00 [INF] Route matched with {action = "MasterFetch", controller = "Content"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] MasterFetch(NayifatAPI.Controllers.MasterFetchRequest) on controller NayifatAPI.Controllers.ContentController (NayifatAPI).
2025-02-05 10:00:31.445 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 10:00:31.456 +03:00 [INF] Executed DbCommand (9ms) [Parameters=[@__request_Page_0='?' (Size = 450), @__request_KeyName_1='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[config_id], [m].[key_name], [m].[last_updated], [m].[page], [m].[value]
FROM [master_config] AS [m]
WHERE [m].[page] = @__request_Page_0 AND [m].[key_name] = @__request_KeyName_1
2025-02-05 10:00:31.459 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 10:00:31.460 +03:00 [INF] Executed action NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI) in 17.992ms
2025-02-05 10:00:31.462 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 10:00:31.464 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - 200 null application/json; charset=utf-8 29.361ms
2025-02-05 10:00:31.768 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - application/json; charset=utf-8 38
2025-02-05 10:00:31.772 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 10:00:31.773 +03:00 [INF] Route matched with {action = "MasterFetch", controller = "Content"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] MasterFetch(NayifatAPI.Controllers.MasterFetchRequest) on controller NayifatAPI.Controllers.ContentController (NayifatAPI).
2025-02-05 10:00:31.780 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 10:00:31.786 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__request_Page_0='?' (Size = 450), @__request_KeyName_1='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[config_id], [m].[key_name], [m].[last_updated], [m].[page], [m].[value]
FROM [master_config] AS [m]
WHERE [m].[page] = @__request_Page_0 AND [m].[key_name] = @__request_KeyName_1
2025-02-05 10:00:31.790 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 10:00:31.791 +03:00 [INF] Executed action NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI) in 15.5398ms
2025-02-05 10:00:31.793 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 10:00:31.794 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - 200 null application/json; charset=utf-8 26.3552ms
2025-02-05 10:00:32.084 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - application/json; charset=utf-8 38
2025-02-05 10:00:32.087 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 10:00:32.089 +03:00 [INF] Route matched with {action = "MasterFetch", controller = "Content"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] MasterFetch(NayifatAPI.Controllers.MasterFetchRequest) on controller NayifatAPI.Controllers.ContentController (NayifatAPI).
2025-02-05 10:00:32.093 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 10:00:32.098 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__request_Page_0='?' (Size = 450), @__request_KeyName_1='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[config_id], [m].[key_name], [m].[last_updated], [m].[page], [m].[value]
FROM [master_config] AS [m]
WHERE [m].[page] = @__request_Page_0 AND [m].[key_name] = @__request_KeyName_1
2025-02-05 10:00:32.101 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 10:00:32.103 +03:00 [INF] Executed action NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI) in 12.1951ms
2025-02-05 10:00:32.106 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 10:00:32.109 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - 200 null application/json; charset=utf-8 24.7874ms
2025-02-05 10:00:32.400 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - application/json; charset=utf-8 49
2025-02-05 10:00:32.404 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 10:00:32.406 +03:00 [INF] Route matched with {action = "MasterFetch", controller = "Content"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] MasterFetch(NayifatAPI.Controllers.MasterFetchRequest) on controller NayifatAPI.Controllers.ContentController (NayifatAPI).
2025-02-05 10:00:32.412 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 10:00:32.417 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__request_Page_0='?' (Size = 450), @__request_KeyName_1='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[config_id], [m].[key_name], [m].[last_updated], [m].[page], [m].[value]
FROM [master_config] AS [m]
WHERE [m].[page] = @__request_Page_0 AND [m].[key_name] = @__request_KeyName_1
2025-02-05 10:00:32.421 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 10:00:32.423 +03:00 [INF] Executed action NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI) in 12.9513ms
2025-02-05 10:00:32.424 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 10:00:32.425 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - 200 null application/json; charset=utf-8 24.8498ms
2025-02-05 10:00:32.717 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - application/json; charset=utf-8 49
2025-02-05 10:00:32.722 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 10:00:32.728 +03:00 [INF] Route matched with {action = "MasterFetch", controller = "Content"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] MasterFetch(NayifatAPI.Controllers.MasterFetchRequest) on controller NayifatAPI.Controllers.ContentController (NayifatAPI).
2025-02-05 10:00:32.734 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 10:00:32.739 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__request_Page_0='?' (Size = 450), @__request_KeyName_1='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[config_id], [m].[key_name], [m].[last_updated], [m].[page], [m].[value]
FROM [master_config] AS [m]
WHERE [m].[page] = @__request_Page_0 AND [m].[key_name] = @__request_KeyName_1
2025-02-05 10:00:32.743 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 10:00:32.745 +03:00 [INF] Executed action NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI) in 14.8594ms
2025-02-05 10:00:32.747 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 10:00:32.749 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - 200 null application/json; charset=utf-8 31.9955ms
2025-02-05 10:00:33.047 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - application/json; charset=utf-8 49
2025-02-05 10:00:33.051 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 10:00:33.053 +03:00 [INF] Route matched with {action = "MasterFetch", controller = "Content"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] MasterFetch(NayifatAPI.Controllers.MasterFetchRequest) on controller NayifatAPI.Controllers.ContentController (NayifatAPI).
2025-02-05 10:00:33.058 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 10:00:33.061 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__request_Page_0='?' (Size = 450), @__request_KeyName_1='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[config_id], [m].[key_name], [m].[last_updated], [m].[page], [m].[value]
FROM [master_config] AS [m]
WHERE [m].[page] = @__request_Page_0 AND [m].[key_name] = @__request_KeyName_1
2025-02-05 10:00:33.063 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 10:00:33.066 +03:00 [INF] Executed action NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI) in 10.3797ms
2025-02-05 10:00:33.069 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 10:00:33.070 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - 200 null application/json; charset=utf-8 22.508ms
2025-02-05 10:00:33.350 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - application/json; charset=utf-8 49
2025-02-05 10:00:33.356 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 10:00:33.358 +03:00 [INF] Route matched with {action = "MasterFetch", controller = "Content"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] MasterFetch(NayifatAPI.Controllers.MasterFetchRequest) on controller NayifatAPI.Controllers.ContentController (NayifatAPI).
2025-02-05 10:00:33.362 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 10:00:33.366 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__request_Page_0='?' (Size = 450), @__request_KeyName_1='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[config_id], [m].[key_name], [m].[last_updated], [m].[page], [m].[value]
FROM [master_config] AS [m]
WHERE [m].[page] = @__request_Page_0 AND [m].[key_name] = @__request_KeyName_1
2025-02-05 10:00:33.371 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 10:00:33.372 +03:00 [INF] Executed action NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI) in 11.617ms
2025-02-05 10:00:33.374 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 10:00:33.375 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - 200 null application/json; charset=utf-8 24.6972ms
2025-02-05 10:00:33.641 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - application/json; charset=utf-8 36
2025-02-05 10:00:33.645 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 10:00:33.646 +03:00 [INF] Route matched with {action = "MasterFetch", controller = "Content"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] MasterFetch(NayifatAPI.Controllers.MasterFetchRequest) on controller NayifatAPI.Controllers.ContentController (NayifatAPI).
2025-02-05 10:00:33.650 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 10:00:33.654 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__request_Page_0='?' (Size = 450), @__request_KeyName_1='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[config_id], [m].[key_name], [m].[last_updated], [m].[page], [m].[value]
FROM [master_config] AS [m]
WHERE [m].[page] = @__request_Page_0 AND [m].[key_name] = @__request_KeyName_1
2025-02-05 10:00:33.657 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 10:00:33.659 +03:00 [INF] Executed action NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI) in 11.2794ms
2025-02-05 10:00:33.661 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 10:00:33.662 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - 200 null application/json; charset=utf-8 20.6362ms
2025-02-05 10:00:34.376 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - application/json; charset=utf-8 36
2025-02-05 10:00:34.378 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 10:00:34.379 +03:00 [INF] Route matched with {action = "MasterFetch", controller = "Content"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] MasterFetch(NayifatAPI.Controllers.MasterFetchRequest) on controller NayifatAPI.Controllers.ContentController (NayifatAPI).
2025-02-05 10:00:34.382 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 10:00:34.385 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__request_Page_0='?' (Size = 450), @__request_KeyName_1='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[config_id], [m].[key_name], [m].[last_updated], [m].[page], [m].[value]
FROM [master_config] AS [m]
WHERE [m].[page] = @__request_Page_0 AND [m].[key_name] = @__request_KeyName_1
2025-02-05 10:00:34.387 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 10:00:34.389 +03:00 [INF] Executed action NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI) in 8.5657ms
2025-02-05 10:00:34.391 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 10:00:34.392 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - 200 null application/json; charset=utf-8 15.6975ms
2025-02-05 10:01:07.597 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/list - application/json; charset=utf-8 45
2025-02-05 10:01:07.742 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI)'
2025-02-05 10:01:07.743 +03:00 [INF] Route matched with {action = "GetNotifications", controller = "Notifications"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetNotifications(NayifatAPI.Controllers.GetNotificationsRequest) on controller NayifatAPI.Controllers.NotificationsController (NayifatAPI).
2025-02-05 10:01:07.747 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 10:01:07.830 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__request_NationalId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[national_id], [u].[last_updated], [u].[notifications]
FROM [user_notifications] AS [u]
WHERE [u].[national_id] = @__request_NationalId_0
2025-02-05 10:01:07.833 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 10:01:07.834 +03:00 [INF] Executed action NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI) in 89.9866ms
2025-02-05 10:01:07.835 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI)'
2025-02-05 10:01:07.837 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/list - 200 null application/json; charset=utf-8 239.2291ms
2025-02-05 10:01:08.184 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/list - application/json; charset=utf-8 39
2025-02-05 10:01:08.187 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI)'
2025-02-05 10:01:08.188 +03:00 [INF] Route matched with {action = "GetNotifications", controller = "Notifications"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetNotifications(NayifatAPI.Controllers.GetNotificationsRequest) on controller NayifatAPI.Controllers.NotificationsController (NayifatAPI).
2025-02-05 10:01:08.190 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 10:01:08.192 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__request_NationalId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[national_id], [u].[last_updated], [u].[notifications]
FROM [user_notifications] AS [u]
WHERE [u].[national_id] = @__request_NationalId_0
2025-02-05 10:01:08.270 +03:00 [INF] Executed DbCommand (76ms) [Parameters=[@__Parse_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [n].[Id], [n].[additional_data], [n].[Body], [n].[body_ar], [n].[body_en], [n].[created_at], [n].[expiry_at], [n].[Route], [n].[target_criteria], [n].[Title], [n].[title_ar], [n].[title_en]
FROM [notification_templates] AS [n]
WHERE [n].[Id] = @__Parse_0
2025-02-05 10:01:08.273 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__Parse_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [n].[Id], [n].[additional_data], [n].[Body], [n].[body_ar], [n].[body_en], [n].[created_at], [n].[expiry_at], [n].[Route], [n].[target_criteria], [n].[Title], [n].[title_ar], [n].[title_en]
FROM [notification_templates] AS [n]
WHERE [n].[Id] = @__Parse_0
2025-02-05 10:01:08.275 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__Parse_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [n].[Id], [n].[additional_data], [n].[Body], [n].[body_ar], [n].[body_en], [n].[created_at], [n].[expiry_at], [n].[Route], [n].[target_criteria], [n].[Title], [n].[title_ar], [n].[title_en]
FROM [notification_templates] AS [n]
WHERE [n].[Id] = @__Parse_0
2025-02-05 10:01:08.277 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__Parse_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [n].[Id], [n].[additional_data], [n].[Body], [n].[body_ar], [n].[body_en], [n].[created_at], [n].[expiry_at], [n].[Route], [n].[target_criteria], [n].[Title], [n].[title_ar], [n].[title_en]
FROM [notification_templates] AS [n]
WHERE [n].[Id] = @__Parse_0
2025-02-05 10:01:08.286 +03:00 [INF] Executed DbCommand (6ms) [Parameters=[@p0='?' (Size = 4000), @p1='?' (DbType = DateTime2), @p2='?' (Size = 4000), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (Size = 450), @p6='?' (Size = 4000), @p7='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [AuthLogs] ([AuthType], [CreatedAt], [DeviceId], [FailureReason], [IpAddress], [NationalId], [Status], [UserAgent])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7);
2025-02-05 10:01:08.290 +03:00 [ERR] An exception occurred in the database while saving changes for context type 'NayifatAPI.Data.ApplicationDbContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_AuthLogs_Customers_NationalId". The conflict occurred in database "NayifatApp", table "dbo.Customers", column 'NationalId'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:a1637792-a3f1-4870-94aa-55724939b48a
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_AuthLogs_Customers_NationalId". The conflict occurred in database "NayifatApp", table "dbo.Customers", column 'NationalId'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:a1637792-a3f1-4870-94aa-55724939b48a
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2025-02-05 10:01:08.302 +03:00 [ERR] Error logging audit event. NationalId: all, Action: notification_delivered, Details: {"notification_count":4,"notification_ids":[20,19,18,12],"timestamp":"2025-02-05T10:01:08.1946726"}
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_AuthLogs_Customers_NationalId". The conflict occurred in database "NayifatApp", table "dbo.Customers", column 'NationalId'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:a1637792-a3f1-4870-94aa-55724939b48a
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at NayifatAPI.Services.AuditLogService.LogAsync(String nationalId, String action, Object details) in C:\Users\yamta\StudioProjects\nayifat_app_2025_new\nayifatapi\Services\AuditLogService.cs:line 36
2025-02-05 10:01:08.314 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 10:01:08.315 +03:00 [INF] Executed action NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI) in 126.4135ms
2025-02-05 10:01:08.316 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI)'
2025-02-05 10:01:08.318 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/list - 200 null application/json; charset=utf-8 133.6989ms
2025-02-05 10:06:07.773 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/list - application/json; charset=utf-8 45
2025-02-05 10:06:08.122 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI)'
2025-02-05 10:06:08.123 +03:00 [INF] Route matched with {action = "GetNotifications", controller = "Notifications"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetNotifications(NayifatAPI.Controllers.GetNotificationsRequest) on controller NayifatAPI.Controllers.NotificationsController (NayifatAPI).
2025-02-05 10:06:08.144 +03:00 [INF] Executed DbCommand (5ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 10:06:08.166 +03:00 [INF] Executed DbCommand (18ms) [Parameters=[@__request_NationalId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[national_id], [u].[last_updated], [u].[notifications]
FROM [user_notifications] AS [u]
WHERE [u].[national_id] = @__request_NationalId_0
2025-02-05 10:06:08.244 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 10:06:08.327 +03:00 [INF] Executed action NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI) in 202.7257ms
2025-02-05 10:06:08.384 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI)'
2025-02-05 10:06:08.411 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/list - 200 null application/json; charset=utf-8 637.8685ms
2025-02-05 10:06:08.724 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/list - application/json; charset=utf-8 39
2025-02-05 10:06:08.728 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI)'
2025-02-05 10:06:08.730 +03:00 [INF] Route matched with {action = "GetNotifications", controller = "Notifications"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetNotifications(NayifatAPI.Controllers.GetNotificationsRequest) on controller NayifatAPI.Controllers.NotificationsController (NayifatAPI).
2025-02-05 10:06:08.734 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 10:06:08.737 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__request_NationalId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[national_id], [u].[last_updated], [u].[notifications]
FROM [user_notifications] AS [u]
WHERE [u].[national_id] = @__request_NationalId_0
2025-02-05 10:06:08.745 +03:00 [INF] Executed DbCommand (4ms) [Parameters=[@__Parse_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [n].[Id], [n].[additional_data], [n].[Body], [n].[body_ar], [n].[body_en], [n].[created_at], [n].[expiry_at], [n].[Route], [n].[target_criteria], [n].[Title], [n].[title_ar], [n].[title_en]
FROM [notification_templates] AS [n]
WHERE [n].[Id] = @__Parse_0
2025-02-05 10:06:08.753 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__Parse_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [n].[Id], [n].[additional_data], [n].[Body], [n].[body_ar], [n].[body_en], [n].[created_at], [n].[expiry_at], [n].[Route], [n].[target_criteria], [n].[Title], [n].[title_ar], [n].[title_en]
FROM [notification_templates] AS [n]
WHERE [n].[Id] = @__Parse_0
2025-02-05 10:06:08.761 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__Parse_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [n].[Id], [n].[additional_data], [n].[Body], [n].[body_ar], [n].[body_en], [n].[created_at], [n].[expiry_at], [n].[Route], [n].[target_criteria], [n].[Title], [n].[title_ar], [n].[title_en]
FROM [notification_templates] AS [n]
WHERE [n].[Id] = @__Parse_0
2025-02-05 10:06:08.765 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__Parse_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [n].[Id], [n].[additional_data], [n].[Body], [n].[body_ar], [n].[body_en], [n].[created_at], [n].[expiry_at], [n].[Route], [n].[target_criteria], [n].[Title], [n].[title_ar], [n].[title_en]
FROM [notification_templates] AS [n]
WHERE [n].[Id] = @__Parse_0
2025-02-05 10:06:08.774 +03:00 [INF] Executed DbCommand (5ms) [Parameters=[@p0='?' (Size = 4000), @p1='?' (DbType = DateTime2), @p2='?' (Size = 4000), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (Size = 450), @p6='?' (Size = 4000), @p7='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [AuthLogs] ([AuthType], [CreatedAt], [DeviceId], [FailureReason], [IpAddress], [NationalId], [Status], [UserAgent])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7);
2025-02-05 10:06:08.780 +03:00 [ERR] An exception occurred in the database while saving changes for context type 'NayifatAPI.Data.ApplicationDbContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_AuthLogs_Customers_NationalId". The conflict occurred in database "NayifatApp", table "dbo.Customers", column 'NationalId'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:266c6245-37ea-47c1-bca9-754f24969bb7
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_AuthLogs_Customers_NationalId". The conflict occurred in database "NayifatApp", table "dbo.Customers", column 'NationalId'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:266c6245-37ea-47c1-bca9-754f24969bb7
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2025-02-05 10:06:08.799 +03:00 [ERR] Error logging audit event. NationalId: all, Action: notification_delivered, Details: {"notification_count":4,"notification_ids":[20,19,18,12],"timestamp":"2025-02-05T10:06:08.7407013"}
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_AuthLogs_Customers_NationalId". The conflict occurred in database "NayifatApp", table "dbo.Customers", column 'NationalId'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:266c6245-37ea-47c1-bca9-754f24969bb7
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at NayifatAPI.Services.AuditLogService.LogAsync(String nationalId, String action, Object details) in C:\Users\yamta\StudioProjects\nayifat_app_2025_new\nayifatapi\Services\AuditLogService.cs:line 36
2025-02-05 10:06:08.815 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 10:06:08.817 +03:00 [INF] Executed action NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI) in 84.8812ms
2025-02-05 10:06:08.819 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI)'
2025-02-05 10:06:08.821 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/list - 200 null application/json; charset=utf-8 97.2183ms
2025-02-05 10:08:11.486 +03:00 [INF] Application is shutting down...
2025-02-05 10:11:11.728 +03:00 [INF] Starting web application
2025-02-05 10:11:11.859 +03:00 [INF] Now listening on: http://localhost:5264
2025-02-05 10:11:11.865 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2025-02-05 10:11:11.867 +03:00 [INF] Hosting environment: Development
2025-02-05 10:11:11.868 +03:00 [INF] Content root path: C:\Users\yamta\StudioProjects\nayifat_app_2025_new\nayifatapi
2025-02-05 10:11:29.984 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/list - application/json; charset=utf-8 45
2025-02-05 10:11:30.009 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/timestamps - application/json; charset=utf-8 2
2025-02-05 10:11:31.038 +03:00 [WRN] Failed to determine the https port for redirect.
2025-02-05 10:11:31.330 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI)'
2025-02-05 10:11:31.330 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.ContentController.GetTimestamps (NayifatAPI)'
2025-02-05 10:11:31.455 +03:00 [INF] Route matched with {action = "GetNotifications", controller = "Notifications"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetNotifications(NayifatAPI.Controllers.GetNotificationsRequest) on controller NayifatAPI.Controllers.NotificationsController (NayifatAPI).
2025-02-05 10:11:31.455 +03:00 [INF] Route matched with {action = "GetTimestamps", controller = "Content"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetTimestamps() on controller NayifatAPI.Controllers.ContentController (NayifatAPI).
2025-02-05 10:11:31.612 +03:00 [INF] TTT_
2025-02-05 10:11:31.613 +03:00 [INF] TTT_=== Getting Content Timestamps ===
2025-02-05 10:11:31.647 +03:00 [INF] Executed action NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI) in 185.6117ms
2025-02-05 10:11:31.653 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI)'
2025-02-05 10:11:31.654 +03:00 [ERR] Unhandled exception
Microsoft.AspNetCore.Server.Kestrel.Core.BadHttpRequestException: Unexpected end of request content.
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.Http.Http1ContentLengthMessageBody.ReadAsyncInternal(CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.Http.HttpRequestStream.ReadAsyncInternal(Memory`1 destination, CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at System.Text.Json.Serialization.ReadBufferState.ReadFromStreamAsync(Stream utf8Json, CancellationToken cancellationToken, Boolean fillBuffer)
   at System.Text.Json.Serialization.Metadata.JsonTypeInfo`1.DeserializeAsync(Stream utf8Json, CancellationToken cancellationToken)
   at System.Text.Json.Serialization.Metadata.JsonTypeInfo`1.DeserializeAsObjectAsync(Stream utf8Json, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter.ReadRequestBodyAsync(InputFormatterContext context, Encoding encoding)
   at Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter.ReadRequestBodyAsync(InputFormatterContext context, Encoding encoding)
   at Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinder.BindModelAsync(ModelBindingContext bindingContext)
   at Microsoft.AspNetCore.Mvc.ModelBinding.ParameterBinder.BindModelAsync(ActionContext actionContext, IModelBinder modelBinder, IValueProvider valueProvider, ParameterDescriptor parameter, ModelMetadata metadata, Object value, Object container)
   at Microsoft.AspNetCore.Mvc.Controllers.ControllerBinderDelegateProvider.<>c__DisplayClass0_0.<<CreateBinderDelegate>g__Bind|0>d.MoveNext()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Program.<>c.<<<Main>$>b__0_3>d.MoveNext() in C:\Users\yamta\StudioProjects\nayifat_app_2025_new\nayifatapi\Program.cs:line 83
2025-02-05 10:11:31.692 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/list - 499 null null 1710.4003ms
2025-02-05 10:11:32.729 +03:00 [INF] Executed DbCommand (21ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 10:11:32.787 +03:00 [INF] TTT_Fetching timestamps from database
2025-02-05 10:11:32.896 +03:00 [INF] Executed DbCommand (86ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [m].[page] AS [Page], [m].[key_name] AS [KeyName], [m].[last_updated] AS [LastUpdated]
FROM [master_config] AS [m]
2025-02-05 10:11:32.906 +03:00 [INF] TTT_Found 18 content items
2025-02-05 10:11:32.909 +03:00 [INF] TTT_Page: home
2025-02-05 10:11:32.911 +03:00 [INF] TTT_  - slideshow_content: "2025-02-04T10:01:06.9430000"
2025-02-05 10:11:32.913 +03:00 [INF] TTT_  - slideshow_content_ar: "2025-02-04T10:01:06.9430000"
2025-02-05 10:11:32.915 +03:00 [INF] TTT_  - contact_details: "2025-02-04T10:01:06.9430000"
2025-02-05 10:11:32.916 +03:00 [INF] TTT_  - contact_details_ar: "2025-02-04T10:01:06.9430000"
2025-02-05 10:11:32.916 +03:00 [INF] TTT_  - termsEN1: "2025-02-03T14:23:58.0000000"
2025-02-05 10:11:32.918 +03:00 [INF] TTT_  - termsEN2: "2025-02-03T14:25:20.1730000"
2025-02-05 10:11:32.919 +03:00 [INF] TTT_  - privacyEN1: "2025-02-03T14:26:08.6130000"
2025-02-05 10:11:32.920 +03:00 [INF] TTT_  - privacyEN2: "2025-02-03T14:25:20.1730000"
2025-02-05 10:11:32.921 +03:00 [INF] TTT_  - termsAR1: "2025-02-03T14:23:58.0000000"
2025-02-05 10:11:32.922 +03:00 [INF] TTT_  - termsAR2: "2025-02-03T14:25:20.1730000"
2025-02-05 10:11:32.924 +03:00 [INF] TTT_  - privacyAR1: "2025-02-03T14:26:08.6130000"
2025-02-05 10:11:32.925 +03:00 [INF] TTT_  - privacyAR2: "2025-02-03T14:25:20.1730000"
2025-02-05 10:11:32.926 +03:00 [INF] TTT_  - terms&conditionsCC_AR: "2025-02-03T17:06:57.7700000"
2025-02-05 10:11:32.928 +03:00 [INF] TTT_  - terms&conditionsCC_EN: "2025-02-03T17:07:47.4900000"
2025-02-05 10:11:32.929 +03:00 [INF] TTT_  - terms&conditionsPF_AR: "2025-02-03T17:06:57.7700000"
2025-02-05 10:11:32.930 +03:00 [INF] TTT_  - terms&conditionsPF_EN: "2025-02-03T17:06:57.7700000"
2025-02-05 10:11:32.931 +03:00 [INF] TTT_Page: loans
2025-02-05 10:11:32.932 +03:00 [INF] TTT_  - loan_ad: "2025-02-04T10:01:06.9430000"
2025-02-05 10:11:32.933 +03:00 [INF] TTT_Page: cards
2025-02-05 10:11:32.933 +03:00 [INF] TTT_  - card_ad: "2025-02-04T10:01:06.9430000"
2025-02-05 10:11:32.934 +03:00 [INF] TTT_Successfully retrieved all timestamps
2025-02-05 10:11:32.940 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 10:11:32.970 +03:00 [INF] Executed action NayifatAPI.Controllers.ContentController.GetTimestamps (NayifatAPI) in 1510.5446ms
2025-02-05 10:11:32.972 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.ContentController.GetTimestamps (NayifatAPI)'
2025-02-05 10:11:32.981 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/timestamps - 499 null application/json; charset=utf-8 2972.3061ms
2025-02-05 10:11:43.471 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/list - application/json; charset=utf-8 45
2025-02-05 10:11:43.740 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI)'
2025-02-05 10:11:43.741 +03:00 [INF] Route matched with {action = "GetNotifications", controller = "Notifications"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetNotifications(NayifatAPI.Controllers.GetNotificationsRequest) on controller NayifatAPI.Controllers.NotificationsController (NayifatAPI).
2025-02-05 10:11:43.845 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 10:11:43.872 +03:00 [INF] Executed DbCommand (9ms) [Parameters=[@__request_NationalId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[national_id], [u].[last_updated], [u].[notifications]
FROM [user_notifications] AS [u]
WHERE [u].[national_id] = @__request_NationalId_0
2025-02-05 10:11:44.054 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 10:11:44.071 +03:00 [INF] Executed action NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI) in 279.1742ms
2025-02-05 10:11:44.087 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI)'
2025-02-05 10:11:44.102 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/list - 200 null application/json; charset=utf-8 630.7639ms
2025-02-05 10:11:44.760 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/list - application/json; charset=utf-8 39
2025-02-05 10:11:44.763 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI)'
2025-02-05 10:11:44.764 +03:00 [INF] Route matched with {action = "GetNotifications", controller = "Notifications"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetNotifications(NayifatAPI.Controllers.GetNotificationsRequest) on controller NayifatAPI.Controllers.NotificationsController (NayifatAPI).
2025-02-05 10:11:44.839 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 10:11:44.842 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__request_NationalId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[national_id], [u].[last_updated], [u].[notifications]
FROM [user_notifications] AS [u]
WHERE [u].[national_id] = @__request_NationalId_0
2025-02-05 10:11:44.854 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__Parse_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [n].[Id], [n].[additional_data], [n].[Body], [n].[body_ar], [n].[body_en], [n].[created_at], [n].[expiry_at], [n].[Route], [n].[target_criteria], [n].[Title], [n].[title_ar], [n].[title_en]
FROM [notification_templates] AS [n]
WHERE [n].[Id] = @__Parse_0
2025-02-05 10:11:44.879 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__Parse_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [n].[Id], [n].[additional_data], [n].[Body], [n].[body_ar], [n].[body_en], [n].[created_at], [n].[expiry_at], [n].[Route], [n].[target_criteria], [n].[Title], [n].[title_ar], [n].[title_en]
FROM [notification_templates] AS [n]
WHERE [n].[Id] = @__Parse_0
2025-02-05 10:11:44.884 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__Parse_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [n].[Id], [n].[additional_data], [n].[Body], [n].[body_ar], [n].[body_en], [n].[created_at], [n].[expiry_at], [n].[Route], [n].[target_criteria], [n].[Title], [n].[title_ar], [n].[title_en]
FROM [notification_templates] AS [n]
WHERE [n].[Id] = @__Parse_0
2025-02-05 10:11:44.887 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__Parse_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [n].[Id], [n].[additional_data], [n].[Body], [n].[body_ar], [n].[body_en], [n].[created_at], [n].[expiry_at], [n].[Route], [n].[target_criteria], [n].[Title], [n].[title_ar], [n].[title_en]
FROM [notification_templates] AS [n]
WHERE [n].[Id] = @__Parse_0
2025-02-05 10:11:45.035 +03:00 [INF] Executed DbCommand (4ms) [Parameters=[@p0='?' (Size = 4000), @p1='?' (DbType = DateTime2), @p2='?' (Size = 4000), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (Size = 450), @p6='?' (Size = 4000), @p7='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [AuthLogs] ([AuthType], [CreatedAt], [DeviceId], [FailureReason], [IpAddress], [NationalId], [Status], [UserAgent])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7);
2025-02-05 10:11:45.053 +03:00 [ERR] An exception occurred in the database while saving changes for context type 'NayifatAPI.Data.ApplicationDbContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_AuthLogs_Customers_NationalId". The conflict occurred in database "NayifatApp", table "dbo.Customers", column 'NationalId'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:82feae6d-988e-4735-a428-f3512c4d3c67
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_AuthLogs_Customers_NationalId". The conflict occurred in database "NayifatApp", table "dbo.Customers", column 'NationalId'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:82feae6d-988e-4735-a428-f3512c4d3c67
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2025-02-05 10:11:45.073 +03:00 [ERR] Error logging audit event. NationalId: all, Action: notification_delivered, Details: {"notification_count":4,"notification_ids":[20,19,18,12],"timestamp":"2025-02-05T10:11:44.8450954"}
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_AuthLogs_Customers_NationalId". The conflict occurred in database "NayifatApp", table "dbo.Customers", column 'NationalId'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:82feae6d-988e-4735-a428-f3512c4d3c67
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at NayifatAPI.Services.AuditLogService.LogAsync(String nationalId, String action, Object details) in C:\Users\yamta\StudioProjects\nayifat_app_2025_new\nayifatapi\Services\AuditLogService.cs:line 36
2025-02-05 10:11:45.081 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 10:11:45.086 +03:00 [INF] Executed action NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI) in 319.668ms
2025-02-05 10:11:45.087 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.NotificationsController.GetNotifications (NayifatAPI)'
2025-02-05 10:11:45.088 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/notifications/list - 200 null application/json; charset=utf-8 328.4696ms
2025-02-05 10:11:55.948 +03:00 [INF] Request starting HTTP/1.1 GET http://45f9-51-252-155-185.ngrok-free.app/api/api/card-application/latest-status/1064448614 - application/json null
2025-02-05 10:11:55.999 +03:00 [INF] Request finished HTTP/1.1 GET http://45f9-51-252-155-185.ngrok-free.app/api/api/card-application/latest-status/1064448614 - 404 0 null 51.1396ms
2025-02-05 10:11:56.002 +03:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET http://45f9-51-252-155-185.ngrok-free.app/api/api/card-application/latest-status/1064448614, Response status code: 404
2025-02-05 10:12:08.285 +03:00 [INF] Request starting HTTP/1.1 GET http://45f9-51-252-155-185.ngrok-free.app/api/api/card-application/latest-status/1064448614 - application/json null
2025-02-05 10:12:08.370 +03:00 [INF] Request finished HTTP/1.1 GET http://45f9-51-252-155-185.ngrok-free.app/api/api/card-application/latest-status/1064448614 - 404 0 null 85.4555ms
2025-02-05 10:12:08.378 +03:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET http://45f9-51-252-155-185.ngrok-free.app/api/api/card-application/latest-status/1064448614, Response status code: 404
2025-02-05 10:14:20.702 +03:00 [INF] Application is shutting down...
2025-02-05 10:14:27.581 +03:00 [INF] Starting web application
2025-02-05 10:14:27.663 +03:00 [INF] Now listening on: http://localhost:5264
2025-02-05 10:14:27.667 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2025-02-05 10:14:27.667 +03:00 [INF] Hosting environment: Development
2025-02-05 10:14:27.668 +03:00 [INF] Content root path: C:\Users\yamta\StudioProjects\nayifat_app_2025_new\nayifatapi
2025-02-05 10:14:34.673 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/timestamps - application/json; charset=utf-8 2
2025-02-05 10:14:34.719 +03:00 [WRN] Failed to determine the https port for redirect.
2025-02-05 10:14:34.724 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.ContentController.GetTimestamps (NayifatAPI)'
2025-02-05 10:14:34.739 +03:00 [INF] Route matched with {action = "GetTimestamps", controller = "Content"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetTimestamps() on controller NayifatAPI.Controllers.ContentController (NayifatAPI).
2025-02-05 10:14:34.832 +03:00 [INF] TTT_
2025-02-05 10:14:34.833 +03:00 [INF] TTT_=== Getting Content Timestamps ===
2025-02-05 10:14:35.878 +03:00 [INF] Executed DbCommand (23ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 10:14:35.948 +03:00 [INF] TTT_Fetching timestamps from database
2025-02-05 10:14:35.989 +03:00 [INF] Executed DbCommand (11ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [m].[page] AS [Page], [m].[key_name] AS [KeyName], [m].[last_updated] AS [LastUpdated]
FROM [master_config] AS [m]
2025-02-05 10:14:35.999 +03:00 [INF] TTT_Found 18 content items
2025-02-05 10:14:36.003 +03:00 [INF] TTT_Page: home
2025-02-05 10:14:36.005 +03:00 [INF] TTT_  - slideshow_content: "2025-02-04T10:01:06.9430000"
2025-02-05 10:14:36.007 +03:00 [INF] TTT_  - slideshow_content_ar: "2025-02-04T10:01:06.9430000"
2025-02-05 10:14:36.008 +03:00 [INF] TTT_  - contact_details: "2025-02-04T10:01:06.9430000"
2025-02-05 10:14:36.008 +03:00 [INF] TTT_  - contact_details_ar: "2025-02-04T10:01:06.9430000"
2025-02-05 10:14:36.009 +03:00 [INF] TTT_  - termsEN1: "2025-02-03T14:23:58.0000000"
2025-02-05 10:14:36.010 +03:00 [INF] TTT_  - termsEN2: "2025-02-03T14:25:20.1730000"
2025-02-05 10:14:36.011 +03:00 [INF] TTT_  - privacyEN1: "2025-02-03T14:26:08.6130000"
2025-02-05 10:14:36.011 +03:00 [INF] TTT_  - privacyEN2: "2025-02-03T14:25:20.1730000"
2025-02-05 10:14:36.012 +03:00 [INF] TTT_  - termsAR1: "2025-02-03T14:23:58.0000000"
2025-02-05 10:14:36.013 +03:00 [INF] TTT_  - termsAR2: "2025-02-03T14:25:20.1730000"
2025-02-05 10:14:36.014 +03:00 [INF] TTT_  - privacyAR1: "2025-02-03T14:26:08.6130000"
2025-02-05 10:14:36.014 +03:00 [INF] TTT_  - privacyAR2: "2025-02-03T14:25:20.1730000"
2025-02-05 10:14:36.015 +03:00 [INF] TTT_  - terms&conditionsCC_AR: "2025-02-03T17:06:57.7700000"
2025-02-05 10:14:36.015 +03:00 [INF] TTT_  - terms&conditionsCC_EN: "2025-02-03T17:07:47.4900000"
2025-02-05 10:14:36.016 +03:00 [INF] TTT_  - terms&conditionsPF_AR: "2025-02-03T17:06:57.7700000"
2025-02-05 10:14:36.017 +03:00 [INF] TTT_  - terms&conditionsPF_EN: "2025-02-03T17:06:57.7700000"
2025-02-05 10:14:36.018 +03:00 [INF] TTT_Page: loans
2025-02-05 10:14:36.018 +03:00 [INF] TTT_  - loan_ad: "2025-02-04T10:01:06.9430000"
2025-02-05 10:14:36.019 +03:00 [INF] TTT_Page: cards
2025-02-05 10:14:36.020 +03:00 [INF] TTT_  - card_ad: "2025-02-04T10:01:06.9430000"
2025-02-05 10:14:36.021 +03:00 [INF] TTT_Successfully retrieved all timestamps
2025-02-05 10:14:36.028 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 10:14:36.081 +03:00 [INF] Executed action NayifatAPI.Controllers.ContentController.GetTimestamps (NayifatAPI) in 1335.2505ms
2025-02-05 10:14:36.085 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.ContentController.GetTimestamps (NayifatAPI)'
2025-02-05 10:14:36.097 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/timestamps - 200 null application/json; charset=utf-8 1424.9287ms
2025-02-05 10:14:36.492 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - application/json; charset=utf-8 45
2025-02-05 10:14:36.498 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 10:14:36.506 +03:00 [INF] Route matched with {action = "MasterFetch", controller = "Content"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] MasterFetch(NayifatAPI.Controllers.MasterFetchRequest) on controller NayifatAPI.Controllers.ContentController (NayifatAPI).
2025-02-05 10:14:36.552 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 10:14:36.564 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[@__request_Page_0='?' (Size = 450), @__request_KeyName_1='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[config_id], [m].[key_name], [m].[last_updated], [m].[page], [m].[value]
FROM [master_config] AS [m]
WHERE [m].[page] = @__request_Page_0 AND [m].[key_name] = @__request_KeyName_1
2025-02-05 10:14:36.582 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 10:14:36.587 +03:00 [INF] Executed action NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI) in 77.5445ms
2025-02-05 10:14:36.588 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 10:14:36.590 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - 200 null application/json; charset=utf-8 97.8116ms
2025-02-05 10:14:37.969 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - application/json; charset=utf-8 48
2025-02-05 10:14:37.974 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 10:14:37.976 +03:00 [INF] Route matched with {action = "MasterFetch", controller = "Content"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] MasterFetch(NayifatAPI.Controllers.MasterFetchRequest) on controller NayifatAPI.Controllers.ContentController (NayifatAPI).
2025-02-05 10:14:38.038 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 10:14:38.043 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__request_Page_0='?' (Size = 450), @__request_KeyName_1='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[config_id], [m].[key_name], [m].[last_updated], [m].[page], [m].[value]
FROM [master_config] AS [m]
WHERE [m].[page] = @__request_Page_0 AND [m].[key_name] = @__request_KeyName_1
2025-02-05 10:14:38.045 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 10:14:38.046 +03:00 [INF] Executed action NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI) in 68.3423ms
2025-02-05 10:14:38.048 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 10:14:38.049 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - 200 null application/json; charset=utf-8 80.2487ms
2025-02-05 10:14:39.424 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - application/json; charset=utf-8 43
2025-02-05 10:14:39.428 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 10:14:39.428 +03:00 [INF] Route matched with {action = "MasterFetch", controller = "Content"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] MasterFetch(NayifatAPI.Controllers.MasterFetchRequest) on controller NayifatAPI.Controllers.ContentController (NayifatAPI).
2025-02-05 10:14:39.432 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 10:14:39.434 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__request_Page_0='?' (Size = 450), @__request_KeyName_1='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[config_id], [m].[key_name], [m].[last_updated], [m].[page], [m].[value]
FROM [master_config] AS [m]
WHERE [m].[page] = @__request_Page_0 AND [m].[key_name] = @__request_KeyName_1
2025-02-05 10:14:39.437 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 10:14:39.439 +03:00 [INF] Executed action NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI) in 9.5585ms
2025-02-05 10:14:39.440 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 10:14:39.441 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - 200 null application/json; charset=utf-8 16.9225ms
2025-02-05 10:14:39.744 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - application/json; charset=utf-8 46
2025-02-05 10:14:39.746 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 10:14:39.747 +03:00 [INF] Route matched with {action = "MasterFetch", controller = "Content"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] MasterFetch(NayifatAPI.Controllers.MasterFetchRequest) on controller NayifatAPI.Controllers.ContentController (NayifatAPI).
2025-02-05 10:14:39.751 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 10:14:39.754 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__request_Page_0='?' (Size = 450), @__request_KeyName_1='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[config_id], [m].[key_name], [m].[last_updated], [m].[page], [m].[value]
FROM [master_config] AS [m]
WHERE [m].[page] = @__request_Page_0 AND [m].[key_name] = @__request_KeyName_1
2025-02-05 10:14:39.757 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 10:14:39.759 +03:00 [INF] Executed action NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI) in 10.7472ms
2025-02-05 10:14:39.761 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 10:14:39.762 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - 200 null application/json; charset=utf-8 17.6556ms
2025-02-05 10:14:40.037 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - application/json; charset=utf-8 36
2025-02-05 10:14:40.042 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 10:14:40.043 +03:00 [INF] Route matched with {action = "MasterFetch", controller = "Content"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] MasterFetch(NayifatAPI.Controllers.MasterFetchRequest) on controller NayifatAPI.Controllers.ContentController (NayifatAPI).
2025-02-05 10:14:40.046 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 10:14:40.049 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__request_Page_0='?' (Size = 450), @__request_KeyName_1='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[config_id], [m].[key_name], [m].[last_updated], [m].[page], [m].[value]
FROM [master_config] AS [m]
WHERE [m].[page] = @__request_Page_0 AND [m].[key_name] = @__request_KeyName_1
2025-02-05 10:14:40.052 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 10:14:40.054 +03:00 [INF] Executed action NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI) in 10.311ms
2025-02-05 10:14:40.055 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 10:14:40.056 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - 200 null application/json; charset=utf-8 18.8477ms
2025-02-05 10:14:40.356 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - application/json; charset=utf-8 36
2025-02-05 10:14:40.360 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 10:14:40.361 +03:00 [INF] Route matched with {action = "MasterFetch", controller = "Content"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] MasterFetch(NayifatAPI.Controllers.MasterFetchRequest) on controller NayifatAPI.Controllers.ContentController (NayifatAPI).
2025-02-05 10:14:40.364 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 10:14:40.367 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__request_Page_0='?' (Size = 450), @__request_KeyName_1='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[config_id], [m].[key_name], [m].[last_updated], [m].[page], [m].[value]
FROM [master_config] AS [m]
WHERE [m].[page] = @__request_Page_0 AND [m].[key_name] = @__request_KeyName_1
2025-02-05 10:14:40.369 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 10:14:40.370 +03:00 [INF] Executed action NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI) in 7.2349ms
2025-02-05 10:14:40.370 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 10:14:40.371 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - 200 null application/json; charset=utf-8 14.6933ms
2025-02-05 10:14:40.654 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - application/json; charset=utf-8 38
2025-02-05 10:14:40.658 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 10:14:40.659 +03:00 [INF] Route matched with {action = "MasterFetch", controller = "Content"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] MasterFetch(NayifatAPI.Controllers.MasterFetchRequest) on controller NayifatAPI.Controllers.ContentController (NayifatAPI).
2025-02-05 10:14:40.664 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 10:14:40.667 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__request_Page_0='?' (Size = 450), @__request_KeyName_1='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[config_id], [m].[key_name], [m].[last_updated], [m].[page], [m].[value]
FROM [master_config] AS [m]
WHERE [m].[page] = @__request_Page_0 AND [m].[key_name] = @__request_KeyName_1
2025-02-05 10:14:40.669 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 10:14:40.671 +03:00 [INF] Executed action NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI) in 8.4432ms
2025-02-05 10:14:40.672 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 10:14:40.672 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - 200 null application/json; charset=utf-8 18.2106ms
2025-02-05 10:14:40.946 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - application/json; charset=utf-8 38
2025-02-05 10:14:40.948 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 10:14:40.950 +03:00 [INF] Route matched with {action = "MasterFetch", controller = "Content"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] MasterFetch(NayifatAPI.Controllers.MasterFetchRequest) on controller NayifatAPI.Controllers.ContentController (NayifatAPI).
2025-02-05 10:14:40.953 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 10:14:40.956 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__request_Page_0='?' (Size = 450), @__request_KeyName_1='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[config_id], [m].[key_name], [m].[last_updated], [m].[page], [m].[value]
FROM [master_config] AS [m]
WHERE [m].[page] = @__request_Page_0 AND [m].[key_name] = @__request_KeyName_1
2025-02-05 10:14:40.958 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 10:14:40.960 +03:00 [INF] Executed action NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI) in 8.4582ms
2025-02-05 10:14:40.961 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 10:14:40.962 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - 200 null application/json; charset=utf-8 16.1368ms
2025-02-05 10:14:41.242 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - application/json; charset=utf-8 36
2025-02-05 10:14:41.244 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 10:14:41.245 +03:00 [INF] Route matched with {action = "MasterFetch", controller = "Content"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] MasterFetch(NayifatAPI.Controllers.MasterFetchRequest) on controller NayifatAPI.Controllers.ContentController (NayifatAPI).
2025-02-05 10:14:41.292 +03:00 [INF] Executed DbCommand (44ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 10:14:41.329 +03:00 [INF] Executed DbCommand (34ms) [Parameters=[@__request_Page_0='?' (Size = 450), @__request_KeyName_1='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[config_id], [m].[key_name], [m].[last_updated], [m].[page], [m].[value]
FROM [master_config] AS [m]
WHERE [m].[page] = @__request_Page_0 AND [m].[key_name] = @__request_KeyName_1
2025-02-05 10:14:41.354 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 10:14:41.356 +03:00 [INF] Executed action NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI) in 109.7341ms
2025-02-05 10:14:41.357 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 10:14:41.359 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - 200 null application/json; charset=utf-8 116.711ms
2025-02-05 10:14:41.632 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - application/json; charset=utf-8 36
2025-02-05 10:14:41.636 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 10:14:41.637 +03:00 [INF] Route matched with {action = "MasterFetch", controller = "Content"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] MasterFetch(NayifatAPI.Controllers.MasterFetchRequest) on controller NayifatAPI.Controllers.ContentController (NayifatAPI).
2025-02-05 10:14:41.642 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 10:14:41.646 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__request_Page_0='?' (Size = 450), @__request_KeyName_1='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[config_id], [m].[key_name], [m].[last_updated], [m].[page], [m].[value]
FROM [master_config] AS [m]
WHERE [m].[page] = @__request_Page_0 AND [m].[key_name] = @__request_KeyName_1
2025-02-05 10:14:41.729 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 10:14:41.931 +03:00 [INF] Executed action NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI) in 292.0994ms
2025-02-05 10:14:41.932 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 10:14:41.935 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - 200 null application/json; charset=utf-8 302.6566ms
2025-02-05 10:14:42.233 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - application/json; charset=utf-8 38
2025-02-05 10:14:42.238 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 10:14:42.239 +03:00 [INF] Route matched with {action = "MasterFetch", controller = "Content"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] MasterFetch(NayifatAPI.Controllers.MasterFetchRequest) on controller NayifatAPI.Controllers.ContentController (NayifatAPI).
2025-02-05 10:14:42.324 +03:00 [INF] Executed DbCommand (26ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 10:14:42.390 +03:00 [INF] Executed DbCommand (64ms) [Parameters=[@__request_Page_0='?' (Size = 450), @__request_KeyName_1='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[config_id], [m].[key_name], [m].[last_updated], [m].[page], [m].[value]
FROM [master_config] AS [m]
WHERE [m].[page] = @__request_Page_0 AND [m].[key_name] = @__request_KeyName_1
2025-02-05 10:14:42.524 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 10:14:42.525 +03:00 [INF] Executed action NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI) in 229.2526ms
2025-02-05 10:14:42.526 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 10:14:42.528 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - 200 null application/json; charset=utf-8 294.3796ms
2025-02-05 10:14:42.873 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - application/json; charset=utf-8 38
2025-02-05 10:14:42.875 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 10:14:42.876 +03:00 [INF] Route matched with {action = "MasterFetch", controller = "Content"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] MasterFetch(NayifatAPI.Controllers.MasterFetchRequest) on controller NayifatAPI.Controllers.ContentController (NayifatAPI).
2025-02-05 10:14:42.944 +03:00 [INF] Executed DbCommand (65ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 10:14:42.988 +03:00 [INF] Executed DbCommand (41ms) [Parameters=[@__request_Page_0='?' (Size = 450), @__request_KeyName_1='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[config_id], [m].[key_name], [m].[last_updated], [m].[page], [m].[value]
FROM [master_config] AS [m]
WHERE [m].[page] = @__request_Page_0 AND [m].[key_name] = @__request_KeyName_1
2025-02-05 10:14:43.077 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 10:14:43.078 +03:00 [INF] Executed action NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI) in 200.785ms
2025-02-05 10:14:43.080 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 10:14:43.081 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - 200 null application/json; charset=utf-8 207.412ms
2025-02-05 10:14:43.548 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - application/json; charset=utf-8 49
2025-02-05 10:14:43.611 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 10:14:43.612 +03:00 [INF] Route matched with {action = "MasterFetch", controller = "Content"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] MasterFetch(NayifatAPI.Controllers.MasterFetchRequest) on controller NayifatAPI.Controllers.ContentController (NayifatAPI).
2025-02-05 10:14:43.615 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 10:14:43.618 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__request_Page_0='?' (Size = 450), @__request_KeyName_1='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[config_id], [m].[key_name], [m].[last_updated], [m].[page], [m].[value]
FROM [master_config] AS [m]
WHERE [m].[page] = @__request_Page_0 AND [m].[key_name] = @__request_KeyName_1
2025-02-05 10:14:43.620 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 10:14:43.621 +03:00 [INF] Executed action NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI) in 7.9795ms
2025-02-05 10:14:43.622 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 10:14:43.624 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - 200 null application/json; charset=utf-8 75.8932ms
2025-02-05 10:14:44.025 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - application/json; charset=utf-8 49
2025-02-05 10:14:44.030 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 10:14:44.031 +03:00 [INF] Route matched with {action = "MasterFetch", controller = "Content"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] MasterFetch(NayifatAPI.Controllers.MasterFetchRequest) on controller NayifatAPI.Controllers.ContentController (NayifatAPI).
2025-02-05 10:14:44.034 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 10:14:44.039 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__request_Page_0='?' (Size = 450), @__request_KeyName_1='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[config_id], [m].[key_name], [m].[last_updated], [m].[page], [m].[value]
FROM [master_config] AS [m]
WHERE [m].[page] = @__request_Page_0 AND [m].[key_name] = @__request_KeyName_1
2025-02-05 10:14:44.041 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 10:14:44.043 +03:00 [INF] Executed action NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI) in 9.9661ms
2025-02-05 10:14:44.043 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 10:14:44.044 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - 200 null application/json; charset=utf-8 18.8648ms
2025-02-05 10:14:44.538 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - application/json; charset=utf-8 49
2025-02-05 10:14:44.541 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 10:14:44.543 +03:00 [INF] Route matched with {action = "MasterFetch", controller = "Content"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] MasterFetch(NayifatAPI.Controllers.MasterFetchRequest) on controller NayifatAPI.Controllers.ContentController (NayifatAPI).
2025-02-05 10:14:44.547 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 10:14:44.550 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__request_Page_0='?' (Size = 450), @__request_KeyName_1='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[config_id], [m].[key_name], [m].[last_updated], [m].[page], [m].[value]
FROM [master_config] AS [m]
WHERE [m].[page] = @__request_Page_0 AND [m].[key_name] = @__request_KeyName_1
2025-02-05 10:14:44.553 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 10:14:44.556 +03:00 [INF] Executed action NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI) in 10.9311ms
2025-02-05 10:14:44.558 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 10:14:44.559 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - 200 null application/json; charset=utf-8 21.1268ms
2025-02-05 10:14:44.966 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - application/json; charset=utf-8 49
2025-02-05 10:14:44.968 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 10:14:44.969 +03:00 [INF] Route matched with {action = "MasterFetch", controller = "Content"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] MasterFetch(NayifatAPI.Controllers.MasterFetchRequest) on controller NayifatAPI.Controllers.ContentController (NayifatAPI).
2025-02-05 10:14:44.976 +03:00 [INF] Executed DbCommand (4ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 10:14:44.980 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__request_Page_0='?' (Size = 450), @__request_KeyName_1='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[config_id], [m].[key_name], [m].[last_updated], [m].[page], [m].[value]
FROM [master_config] AS [m]
WHERE [m].[page] = @__request_Page_0 AND [m].[key_name] = @__request_KeyName_1
2025-02-05 10:14:44.982 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 10:14:44.983 +03:00 [INF] Executed action NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI) in 12.6764ms
2025-02-05 10:14:44.984 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 10:14:44.985 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - 200 null application/json; charset=utf-8 18.8933ms
2025-02-05 10:14:45.398 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - application/json; charset=utf-8 36
2025-02-05 10:14:45.402 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 10:14:45.404 +03:00 [INF] Route matched with {action = "MasterFetch", controller = "Content"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] MasterFetch(NayifatAPI.Controllers.MasterFetchRequest) on controller NayifatAPI.Controllers.ContentController (NayifatAPI).
2025-02-05 10:14:45.411 +03:00 [INF] Executed DbCommand (4ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 10:14:45.417 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[@__request_Page_0='?' (Size = 450), @__request_KeyName_1='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[config_id], [m].[key_name], [m].[last_updated], [m].[page], [m].[value]
FROM [master_config] AS [m]
WHERE [m].[page] = @__request_Page_0 AND [m].[key_name] = @__request_KeyName_1
2025-02-05 10:14:45.419 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 10:14:45.421 +03:00 [INF] Executed action NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI) in 15.5437ms
2025-02-05 10:14:45.422 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 10:14:45.423 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - 200 null application/json; charset=utf-8 25.0164ms
2025-02-05 10:14:46.173 +03:00 [INF] Request starting HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - application/json; charset=utf-8 36
2025-02-05 10:14:46.176 +03:00 [INF] Executing endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 10:14:46.177 +03:00 [INF] Route matched with {action = "MasterFetch", controller = "Content"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] MasterFetch(NayifatAPI.Controllers.MasterFetchRequest) on controller NayifatAPI.Controllers.ContentController (NayifatAPI).
2025-02-05 10:14:46.182 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__providedApiKey_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Key], [a].[CreatedAt], [a].[Description], [a].[ExpiresAt], [a].[IsActive], [a].[LastUsedAt]
FROM [ApiKeys] AS [a]
WHERE [a].[Key] = @__providedApiKey_0 AND [a].[IsActive] = CAST(1 AS bit)
2025-02-05 10:14:46.189 +03:00 [INF] Executed DbCommand (4ms) [Parameters=[@__request_Page_0='?' (Size = 450), @__request_KeyName_1='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[config_id], [m].[key_name], [m].[last_updated], [m].[page], [m].[value]
FROM [master_config] AS [m]
WHERE [m].[page] = @__request_Page_0 AND [m].[key_name] = @__request_KeyName_1
2025-02-05 10:14:46.191 +03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType10`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-05 10:14:46.192 +03:00 [INF] Executed action NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI) in 13.2507ms
2025-02-05 10:14:46.193 +03:00 [INF] Executed endpoint 'NayifatAPI.Controllers.ContentController.MasterFetch (NayifatAPI)'
2025-02-05 10:14:46.194 +03:00 [INF] Request finished HTTP/1.1 POST http://45f9-51-252-155-185.ngrok-free.app/api/content/fetch - 200 null application/json; charset=utf-8 21.7558ms
2025-02-05 10:16:03.966 +03:00 [INF] Request starting HTTP/1.1 GET http://45f9-51-252-155-185.ngrok-free.app/api/api/card-application/latest-status/1064448614 - application/json null
2025-02-05 10:16:03.984 +03:00 [INF] Request finished HTTP/1.1 GET http://45f9-51-252-155-185.ngrok-free.app/api/api/card-application/latest-status/1064448614 - 404 0 null 18.6488ms
2025-02-05 10:16:03.995 +03:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET http://45f9-51-252-155-185.ngrok-free.app/api/api/card-application/latest-status/1064448614, Response status code: 404
2025-02-05 10:16:11.216 +03:00 [INF] Application is shutting down...
